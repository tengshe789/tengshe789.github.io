<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[window terminal ç©æ³•å¤§å…¨]]></title>
    <url>%2F2020%2F07%2F01%2Fwindow-terminal-%E7%8E%A9%E6%B3%95%E5%A4%A7%E5%85%A8%2F</url>
    <content type="text"><![CDATA[window terminal ç©æ³•å¤§å…¨æ·»åŠ åˆ°å³é”®èœå•ç¬¬ä¸€æ­¥ï¼Œåˆ›å»ºæ–‡ä»¶å¤¹é¦–å…ˆæ‰“å¼€cmdï¼Œæ³¨æ„ï¼Œgitbashæ— æ•ˆã€‚ è¿è¡Œä¸‹æ–¹å‘½ä»¤ï¼š 1mkdir "%USERPROFILE%\AppData\Local\Terminal" ç¬¬äºŒæ­¥ï¼Œä¸‹è½½window terminal icoå›¾æ ‡æ‰“å¼€ä¸‹æ–¹ç½‘å€ï¼Œå°†å›¾æ ‡å¤åˆ¶åˆ°ä¸Šæ–¹ï¼Œå‘½ä»¤çš„è·¯å¾„ https://raw.githubusercontent.com/microsoft/terminal/master/res/terminal.ico ç¬¬ä¸‰æ­¥ï¼Œæ·»åŠ æ³¨å†Œè¡¨æ–‡ä»¶åˆ›å»ºæ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼Œé‡å‘½åæˆ.regæ ¼å¼ 12345678Windows Registry Editor Version 5.00[HKEY_CLASSES_ROOT\Directory\Background\shell\wt]@=&quot;Windows Terminal here&quot;&quot;Icon&quot;=&quot;C:\\Users\\[ä½ çš„ç”¨æˆ·å]\\AppData\\Local\\Terminal\\terminal.ico&quot;[HKEY_CLASSES_ROOT\Directory\Background\shell\wt\command]@=&quot;C:\\Users\\[ä½ çš„ç”¨æˆ·å]\\AppData\\Local\\Microsoft\\WindowsApps\\wt.exe&quot;]]></content>
      <tags>
        <tag>è½¯ä»¶åˆ†äº«</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¿«é€Ÿgit pullæ›´æ–°æ‰€æœ‰é¡¹ç›®æ–‡ä»¶]]></title>
    <url>%2F2019%2F09%2F17%2F%E5%BF%AB%E9%80%9Fgit-pull%E6%89%80%E6%9C%89%E9%A1%B9%E7%9B%AE%E6%96%87%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[æ²³èŸ¹ï¼Œæœ¬å±±å¤§ç‹å›æ¥äº†ã€‚å›æƒ³ä¸€ä¸‹ï¼Œå·²ç»å¤§æ¦‚æ•´æ•´7ä¸ªæœˆæ²¡ç”¨æ›´æ–°åšå®¢äº†ï¼ï¼ï¼ç­‰æˆ‘æ„è¯†åˆ°è¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œå±…ç„¶è¿markdownéƒ½ä¸ä¼šå†™äº†ï¼Œç½ªæ¶ç½ªæ¶ã€‚ä»Šæ—¥ï¼Œé‡æ‹¾æˆ‘çš„çº¸å¸ï¼Œç»§ç»­æ›´æ–°åšå®¢ï¼Œè¯·å„ä½çœ‹å®¢ç»™äºˆé¼“åŠ±ã€‚ éœ€æ±‚åˆ†ææ•…äº‹çš„å¼€å§‹æ˜¯è¿™æ ·çš„ï¼Œæœ‰ä½æ¬ç –å·¥ï¼Œåå­—å«å°å¾ï¼Œä»–æ‰€åœ¨çš„å…¬å¸ç”¨çš„æ˜¯VMware Horizon 7è™šæ‹Ÿæ¡Œé¢ç¯å¢ƒï¼Œè½¯ä»¶å¼€å‘æ ¹æœ¬è¿ä¸ä¸Šå¤–éƒ¨ç½‘ç»œï¼Œè¿™è®©ä»–éå¸¸è‹¦æ¼ã€‚ çªç„¶æœ‰ä¸€å¤©ï¼Œå…¬å¸å†…éƒ¨å¤§å˜é©ï¼Œè¦å¼€å§‹ä½¿ç”¨mavenç§æœï¼Œè¦å¼€å§‹ä½¿ç”¨å†…éƒ¨PaaSï¼Œè¿™è®©å°å¾å¿ƒé‡Œä¹å¼€äº†èŠ±ã€‚â€œå¯æ˜¯æ–°çŸ¥è¯†å¤ªå¤šï¼Œè¿™è¯¥å¦‚ä½•å­¦ä¹ å‘¢ï¼Ÿâ€å°å¾æ³›èµ·äº†å˜€å’•ã€‚ åŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼Œåœ¨å°å¾çš„æ—¥å¤œåŠªåŠ›ä¸­ï¼Œåœ¨ä¸€ä¸ªå·ç§°å…¨çƒæœ€å¤§çš„åŒæ€§äº¤å‹ç½‘ç«™ä¸Šï¼Œæ‰¾åˆ°äº†å¾ˆå¤šå­¦ä¹ èµ„æ–™ã€‚å°å¾åœ¨è‡ªå·±æŸ¥è¯¢å¤–éƒ¨äº’è”ç½‘èµ„æ–™çš„ç¬”è®°æœ¬ä¸Šï¼Œç†Ÿç»ƒçš„git cloneå„ç§å„æ ·çš„ä»“åº“ï¼Œå¾ˆå¿«ï¼Œæ»¡æ»¡ä¸€ä¸ªç¡¬ç›˜éƒ½æ˜¯è¿™äº›ä»“åº“çš„æ–‡ä»¶å¤¹ã€‚ æ—¶é—´è¿‡çš„å¾ˆå¿«ï¼Œè½¬çœ¼7ä¸ªæœˆè¿‡å»äº†ã€‚ æŠ€æœ¯å˜åŒ–çš„å¾ˆå¿«ï¼Œè½¬çœ¼ï¼Œæ»¡æ»¡ç¡¬ç›˜çš„å­¦ä¹ èµ„æ–™éƒ½è¿‡æ—¶äº†ï¼Œæ€ä¹ˆä¸€ä¸‹å­å°†ä»–ä»¬æ›´æ–°å‘¢ï¼Ÿ ä»¥ä¸Šå°±æ˜¯å°å¾å‘æˆ‘æå‡ºäº†éœ€æ±‚ã€‚ è®¾è®¡è½¯ä»¶pythonæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ğŸ˜† è®¾è®¡æ€è·¯å¾ˆç®€å•ï¼Œåˆ¤æ–­å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶å¤¹ä¸­ï¼Œæ˜¯å¦å…¶ä¸­åŒ…å«åç¼€æ˜¯.gitçš„æ–‡ä»¶å¤¹ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™ä¸ºä»“åº“ï¼Œè¿›è¡Œæ›´æ–°ï¼Œä¸æ˜¯å°±è·³è¿‡ã€‚ å…¶ä¸­éœ€è¦ä¾èµ–gitpythonè¿™ä¸ªåŒ…ï¼Œæ¥è¿›è¡Œgit pullæ“ä½œã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748import gitfrom git import *import threadingimport osdef isGitDir(dir): repdir = os.path.join(os.path.abspath('.'), dir) repgitdir = os.path.join(repdir, '.git') if not os.path.exists(repgitdir): return False return Truedef updateSub(subdir): repdir = os.path.join(os.path.abspath('.'), subdir) try: repo = git.Repo(repdir) if repo.is_dirty(): dirSubDir.append(subdir) return remote = repo.remote() print("start pulling from remote for: %s\r\n" %subdir) remote.pull() print("Done pulling for %s\r\n" %subdir) except NoSuchPathError as e: pass except InvalidGitRepositoryError as e: pass finally: passcurrDir = os.path.abspath('.')subDirs = [x for x in os.listdir('.') if isGitDir(x)]print("ready to update git repo:")for dir in subDirs: print(dir+ '\r\n')dirSubDir = []poole = []for subdir in subDirs: t = threading.Thread(target=updateSub,args=(subdir,)) t.start() poole.append(t)for t in poole: t.join(30)print('\r\n')if len(dirSubDir)!= 0: print('these repos have uncommitted changes:') for dirtyDir in dirSubDir: print('dir %s has uncommited change, please check' % dirtyDir) æµ‹è¯•æŠ•äº§æ‰“å¼€ç”µè„‘ï¼Œåœ¨cmdä¸­è¿è¡Œpip install gitpythonæˆ–è€…conda install gitpythonï¼Œæ¥å®‰è£…å¿…è¦çš„åŒ…ã€‚ å°†ä¸Šè¿°æ–‡ä»¶ä¿å­˜åˆ°ä»“åº“çš„ç›®å½•ï¼Œå¹¶ä¸”å‘½åä¸ºupdate.pyï¼Œå³é”®ä½¿ç”¨VS Codeè¿è¡Œï¼Œå³å¯å‘ç°ç›®å½•ä¸­æ‰€æœ‰ä»“åº“éƒ½æˆåŠŸgit pull äº†ï¼Œå¤§æˆåŠŸï¼ ç»­1sæ—¶é—´å†™å®Œè¿™ä¸ªåšå®¢çš„æ—¶å€™ï¼Œå·å·çœ‹äº†ä¸€ä¸‹è®°å½•åšå®¢æµè§ˆé‡çš„ç½‘ç«™ï¼Œçˆ†ç‚¸äº†ï¼ï¼ï¼è¿™7ä¸ªæœˆæˆ‘ä¸åœ¨çº¿çš„æ—¥å­ï¼Œè¿™ä¹ˆå¤šäººè®¿é—®æˆ‘åšå®¢å•Šã€‚å¾ˆå¼€å¿ƒï¼Œè°¢è°¢ä½ é‚£ä¹ˆå¯çˆ±ï¼Œè¿˜ä¸€ç›´å…³æ³¨ç€æˆ‘~â¤ğŸ˜ å…¨ç‰‡ç»“æŸï¼Œè§‰å¾—æˆ‘å†™çš„ä¸é”™ï¼Ÿæƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿèµ¶å¿«æ‰“å¼€æˆ‘çš„ğŸ‘‰ä¸ªäººåšå®¢ ğŸ‘ˆå§ï¼]]></content>
      <tags>
        <tag>åˆ†äº«</tag>
        <tag>çªé—¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆ†äº«ä¸€ä¸‹å¾®æœåŠ¡ç›‘æ§è½¯ä»¶ä»¥åŠå…¶éƒ¨ç½²]]></title>
    <url>%2F2019%2F02%2F15%2F%E5%88%86%E4%BA%AB%E4%B8%80%E4%B8%8B%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9B%91%E6%8E%A7%E8%BD%AF%E4%BB%B6%E4%BB%A5%E5%8F%8A%E5%85%B6%E9%83%A8%E7%BD%B2%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨å¯»æ‰¾æœ‰åˆ©çš„ç›‘æ§è½¯ä»¶ä¸ºæˆ‘çš„å¾®æœåŠ¡çŒ®èº«ï¼Œäºæ˜¯ä¹æ•´ç†æ–‡æ¡£ï¼Œè¯•éªŒï¼ŒèŠ±äº†å¾ˆé•¿æ—¶é—´ã€‚ä»Šå¤©åˆ†äº«ä¸€ä¸‹æ•´ç†çš„éƒ¨åˆ†å·¥å…·ï¼Œæœ‰æ—¶é—´ä¼šç»§ç»­åœ¨æ­¤postä¸­æ›´æ–°çš„ï¼ğŸ™ƒ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ã€‚ influxDBä»€ä¹ˆæ˜¯influxDBinfluxDBæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ—¶é—´åºåˆ—æ•°æ®åº“ã€‚cAdvisorä»…ä»…æ˜¾ç¤ºå®æ—¶ä¿¡æ¯ï¼Œä½†æ˜¯ä¸å­˜å‚¨ç›‘è§†æ•°æ®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æä¾›æ—¶åºæ•°æ®åº“ç”¨äºå­˜å‚¨cAdvisorç»„ä»¶æ‰€æä¾›çš„ç›‘æ§ä¿¡æ¯ï¼Œä»¥ä¾¿æ˜¾ç¤ºé™¤å®æ—¶ä¿¡æ¯ä¹‹å¤–çš„æ—¶åºæ•°æ®ã€‚ influxDBå®‰è£…ï¼ˆ1ï¼‰ä¸‹è½½é•œåƒ1docker pull tutum/influxdb ï¼ˆ2ï¼‰åˆ›å»ºå®¹å™¨1234567docker run â€di \â€p 8083:8083 \â€p 8086:8086 \â€â€expose 8090 \â€â€expose 8099 \â€â€name influxsrv \tutum/influxdb ç«¯å£æ¦‚è¿°ï¼š 8083ç«¯å£:webè®¿é—®ç«¯å£ 8086:æ•°æ®å†™å…¥ç«¯å£æ‰“å¼€æµè§ˆå™¨ http://192.168.184.135:8083/ (ipè‡ªè§‰æ›¿æ¢) influxDBå¸¸ç”¨æ“ä½œåˆ›å»ºæ•°æ®åº“1CREATE DATABASE &quot;cadvisor&quot; å›è½¦åˆ›å»ºæ•°æ®åº“1SHOW DATABASES æŸ¥çœ‹æ•°æ®åº“ åˆ›å»ºç”¨æˆ·å¹¶æˆæƒåˆ›å»ºç”¨æˆ·1CREATE USER &quot;cadvisor&quot; WITH PASSWORD &apos;cadvisor&apos; WITH ALL PRIVILEGES æŸ¥çœ‹ç”¨æˆ·1SHOW USRES ç”¨æˆ·æˆæƒ123grant all privileges on cadvisor to cadvisorgrant WRITE on cadvisor to cadvisorgrant READ on cadvisor to cadvisor æŸ¥çœ‹é‡‡é›†çš„æ•°æ®åˆ‡æ¢åˆ°cadvisoræ•°æ®åº“ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹é‡‡é›†çš„æ•°æ®1SHOW MEASUREMENTS å¦‚æœæƒ³é‡‡é›†ç³»ç»Ÿçš„æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨Cadvisorè½¯ä»¶æ¥å®ç° Moreå®˜æ–¹æ–‡æ¡£ ï¼š https://github.com/influxdata/docs.influxdata.com cAdvisorå•¥ä¹ˆæ˜¯cAdvisorGoogleå¼€æºçš„ç”¨äºç›‘æ§åŸºç¡€è®¾æ–½åº”ç”¨çš„å·¥å…·ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç›‘æ§å·¥å…·ï¼Œä¸éœ€è¦ä»»ä½•é…ç½®å°±å¯ä»¥é€šè¿‡è¿è¡Œåœ¨Dockerä¸»æœºä¸Šçš„å®¹å™¨æ¥ç›‘æ§Dockerå®¹å™¨ï¼Œè€Œä¸”å¯ä»¥ç›‘æ§Dockerä¸»æœºã€‚ cAdvisorå®‰è£…ï¼ˆ1ï¼‰ä¸‹è½½é•œåƒdocker pull google/cadvisorï¼ˆ2ï¼‰åˆ›å»ºå®¹å™¨ 12345docker run â€â€volume=/:/rootfs:ro â€â€volume=/var/run:/var/run:rw â€â€volume=/sys:/sys:ro â€â€volume=/var/lib/docker/:/var/lib/docker:ro â€â€publish=8080:8080 â€â€detach=true â€â€link influxsrv:influxsrv â€â€name=cadvisorgoogle/cadvisor â€storage_driver=influxdb â€storage_driver_db=cadvisor â€storage_driver_host=influxsrv:8086 WEBå‰ç«¯è®¿é—®åœ°å€http://192.168.184.135:8080/containers/ (è¯·è‡ªè§‰æ›¿æ¢å®é™…ip)æ€§èƒ½æŒ‡æ ‡å«ä¹‰å‚ç…§å¦‚ä¸‹åœ°å€https://blog.csdn.net/ZHANG_H_A/article/details/53097084å†æ¬¡æŸ¥çœ‹influxDBï¼Œå‘ç°å·²ç»æœ‰å¾ˆå¤šæ•°æ®è¢«é‡‡é›†è¿›å»äº†ã€‚ GrafanaGrafanaæ˜¯ä¸€ä¸ªå¯è§†åŒ–é¢æ¿ï¼ˆDashboardï¼‰ï¼Œæœ‰ç€éå¸¸æ¼‚äº®çš„å›¾è¡¨å’Œå¸ƒå±€å±•ç¤ºï¼ŒåŠŸèƒ½é½å…¨çš„åº¦é‡ä»ªè¡¨ç›˜å’Œå›¾å½¢ç¼–è¾‘å™¨ã€‚æ”¯æŒGraphiteã€zabbixã€InfluxDBã€Prometheuså’ŒOpenTSDBä½œä¸ºæ•°æ®æºã€‚ Grafanaä¸»è¦ç‰¹æ€§ï¼šçµæ´»ä¸°å¯Œçš„å›¾å½¢åŒ–é€‰é¡¹ï¼›å¯ä»¥æ··åˆå¤šç§é£æ ¼ï¼›æ”¯æŒç™½å¤©å’Œå¤œé—´æ¨¡å¼ï¼›å¤šä¸ªæ•°æ®æºã€‚ Grafanaå®‰è£…ï¼ˆ1ï¼‰ä¸‹è½½é•œåƒdocker pull grafana/grafanaï¼ˆ2ï¼‰åˆ›å»ºå®¹å™¨1234docker run â€d â€p 3001:3000 â€e INFLUXDB_HOST=influxsrv â€eINFLUXDB_PORT=8086 â€e INFLUXDB_NAME=cadvisor â€e INFLUXDB_USER=cadvisor â€eINFLUXDB_PASS=cadvisor â€â€link influxsrv:influxsrv â€â€name grafanagrafana/grafana æ³¨æ„ï¼ŒINFLUXDBé…ç½®è¯·ä¸ä¸Šæ–‡æˆ‘çš„å†™çš„é…ç½®ç›¸åŒã€‚ï¼ˆ3ï¼‰è®¿é—®http://192.168.184.135:3001 ï¼ˆè‡ªè§‰æ›´æ¢ipï¼‰ç”¨æˆ·åå¯†ç å‡ä¸ºadmin ä½¿ç”¨//TODO pinpointæ˜¯å•¥pinpointæ˜¯å¼€æºåœ¨githubä¸Šçš„ä¸€æ¬¾APMç›‘æ§å·¥å…·ï¼Œå®ƒæ˜¯ç”¨Javaç¼–å†™çš„ï¼Œç”¨äºå¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿç›‘æ§ã€‚å®ƒå¯¹æ€§èƒ½çš„å½±å“æœ€å°ï¼ˆåªå¢åŠ çº¦3ï¼…èµ„æºåˆ©ç”¨ç‡ï¼‰ï¼Œå®‰è£…agentæ˜¯æ— ä¾µå…¥å¼çš„ï¼Œåªéœ€è¦åœ¨è¢«æµ‹è¯•çš„Tomcatä¸­åŠ ä¸Š3å¥è¯ï¼Œæ‰“ä¸‹æ¢é’ˆï¼Œå°±å¯ä»¥ç›‘æ§æ•´å¥—ç¨‹åºäº†ã€‚ æ‰€éœ€è½¯ä»¶1234567hbase-1.2.6-bin.tar.gzpinpoint-1.6.2.zip pinpointæºç ï¼Œä½¿ç”¨hbase-create.hbaseè„šæœ¬åˆå§‹åŒ–hbasepinpoint-collector-1.6.2.war collectoræ¨¡å—ï¼Œä½¿ç”¨tomcatè¿›è¡Œéƒ¨ç½²pinpoint-web-1.6.2.war webç®¡æ§å°ï¼Œä½¿ç”¨tomcatè¿›è¡Œéƒ¨ç½²pinpoint-agent-1.6.2.tar.gz ä¸éœ€è¦éƒ¨ç½²ï¼Œåœ¨è¢«ç›‘æ§åº”ç”¨ä¸€ç«¯apache-tomcat-8.5.15.zip å‡†å¤‡ä¸¤ä¸ªtomcatç¯å¢ƒï¼Œä¸€ä¸ªéƒ¨ç½²pinpoint-collector-1.6.2.warï¼Œå¦ä¸€ä¸ªéƒ¨ç½²pinpoint-web-1.6.2.war å®‰è£…hbaseç¯å¢ƒé…ç½®è§£å‹hbase-1.2.6-bin.tar.gzï¼Œä¿®æ”¹hbase/conf/hbase-site.xmlæ–‡ä»¶å†…å®¹å¦‚ä¸‹123456789101112131415161718&lt;configuration&gt;&lt;property&gt;&lt;name&gt;hbase.rootdir&lt;/name&gt;&lt;value&gt;file:///pinpoint/data/hbase&lt;/value&gt;&lt;/property&gt;&lt;property&gt;&lt;name&gt;hbase.zookeeper.property.dataDir&lt;/name&gt;&lt;value&gt;/pinpoint/data/zookeeper&lt;/value&gt;&lt;/property&gt;&lt;property&gt;&lt;name&gt;hbase.master.port&lt;/name&gt;&lt;value&gt;60000&lt;/value&gt;&lt;/property&gt;&lt;property&gt;&lt;name&gt;hbase.regionserver.port&lt;/name&gt;&lt;value&gt;60020&lt;/value&gt;&lt;/property&gt;&lt;/configuration&gt; ä¿®æ”¹hbase/conf/hbase-env.shæ–‡ä»¶ï¼Œè®¾ç½®JAVA_HOMEç¯å¢ƒå˜é‡export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk1.8.0_112.jdk/Contents/Home å¯åŠ¨hbasehbase/bin/start-hbase.sh æ‰§è¡ŒjpsæŸ¥çœ‹æ˜¯å¦æœ‰HMasterè¿›ç¨‹è®¿é—® http://127.0.0.1:16010/master-status æŸ¥çœ‹hbase webç®¡æ§å°å¯¼å…¥hbaseåˆå§‹åŒ–è„šæ­¥1234567891011121314151617181920212223242526272829303132333435363738hbase/bin/hbase shell /pinpoint-1.6.2/hbase/scripts/hbase-create.hbase...0 row(s) in 1.4160 seconds0 row(s) in 1.2420 seconds0 row(s) in 2.2410 seconds0 row(s) in 1.2400 seconds0 row(s) in 1.2450 seconds0 row(s) in 1.2420 seconds0 row(s) in 1.2360 seconds0 row(s) in 1.2400 seconds0 row(s) in 1.2370 seconds0 row(s) in 2.2450 seconds0 row(s) in 4.2480 seconds0 row(s) in 1.2310 seconds0 row(s) in 1.2430 seconds0 row(s) in 1.2390 seconds0 row(s) in 1.2440 seconds0 row(s) in 1.2440 secondsTABLEAgentEventAgentInfoAgentLifeCycleAgentStatAgentStatV2ApiMetaDataApplicationIndexApplicationMapStatisticsCallee_Ver2ApplicationMapStatisticsCaller_Ver2ApplicationMapStatisticsSelf_Ver2ApplicationTraceIndexHostApplicationMap_Ver2SqlMetaData_Ver2StringMetaDataTraceV2Traces16 row(s) in 0.0190 seconds è¿›å…¥hbase shell12345hbase/bin/hbase shellHBase Shell; enter &apos;help&lt;RETURN&gt;&apos; for list of supported commands.Type &quot;exit&lt;RETURN&gt;&quot; to leave the HBase ShellVersion 1.2.6, rUnknown, Mon May 29 02:25:32 CDT 2017hbase(main):001:0&gt; è¾“å…¥status â€˜detailedâ€™æŸ¥çœ‹åˆšæ‰åˆå§‹åŒ–çš„è¡¨ï¼Œæ˜¯å¦å­˜åœ¨1hbase(main):001:0&gt; status &apos;detailed&apos; è®¿é—® http://127.0.0.1:16010/master-status æŸ¥çœ‹hbase webç®¡æ§å° éƒ¨ç½²collectorè§£å‹apache-tomcat-8.5.15.zipå¹¶é‡å‘½åä¸ºcollectoræ‹·è´pinpoint-collector-1.6.2.waråˆ°collector\webapps\ç›®å½•ä¸‹å¹¶é‡å‘½åä¸ºROOT.waræ¶‰åŠåˆ°ä¸¤ä¸ªé…ç½®æ–‡ä»¶ hbase.propertiesç”±äºä½¿ç”¨çš„ä¸ºhbaseè‡ªå¸¦çš„zookeeperå³hbaseå’Œzookeeperåœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œåˆ™ä¸éœ€è¦ä¿®æ”¹collector/webapps/ROOT/WEB-INF/classes/hbase.propertiesæ–‡ä»¶ pinpoint-collector.propertiesæ³¨æ„è§‚å¯Ÿè¯¥é…ç½®æ–‡ä»¶ä¸­ä¸­çš„ä¸‰ä¸ªç«¯å£9994ã€9995ã€9996 é»˜è®¤ä¸éœ€è¦ä¿®æ”¹ï¼Œå…¶ä¸­9994ä¸ºcollectorç›‘å¬çš„tcpç«¯å£ï¼Œ9995ä¸ºcollectorç›‘å¬çš„udpç«¯å£ æ‰§è¡Œcollector/bin/startup.shå¯åŠ¨collectoréƒ¨ç½²webç®¡æ§å°è§£å‹apache-tomcat-8.5.15.zipå¹¶é‡å‘½åä¸ºwebæ‹·è´pinpoint-web-1.6.2.waråˆ°web\webapps\ç›®å½•ä¸‹å¹¶é‡å‘½åä¸ºROOT.waråŒæ ·ç•™æ„web/webapps/ROOT/WEB-INF/classes/hbase.propertiesä¸­çš„é…ç½®ï¼Œè‹¥ä¸hbaseåœ¨åŒä¸€å°æœºå™¨åˆ™ä¸éœ€è¦ä¿®æ”¹æ‰§è¡Œweb/bin/startup.shå¯åŠ¨webç®¡æ§å°(æ³¨æ„ä¿®æ”¹tomcatç«¯å£å·ï¼Œé˜²æ­¢å†²çªï¼Œè¿™é‡Œä¿®æ”¹ç«¯å£ä¸º8088)æµè§ˆå™¨è®¿é—® http://127.0.0.1:8088/ æŸ¥çœ‹pinpointç®¡æ§å° ç›‘æ§spring bootåº”ç”¨è¿™é‡Œæœ‰ä¸€ä¸ªspring-boot-example.jarçš„åº”ç”¨ï¼Œç°åœ¨è¦ä½¿ç”¨pinpointæ¥å¯¹å…¶ç›‘æ§è·Ÿè¸ªã€‚æ“ä½œå¾ˆç®€å•ï¼Œåˆ†ä¸¤æ­¥è§£å‹pinpoint-agent-1.6.2.tar.gzå¹¶å¯¹å…¶è¿›è¡Œé…ç½®1tar zxvf pinpoint-agent-1.6.2.tar.gz -C pinpoint-agent ä¿®æ”¹pinpoint-agent/pinpoint.configä¸­çš„é…ç½®ä¸collectoræœåŠ¡ä¸€è‡´ã€‚æ­¤å¤„å› ä¸ºpinpoint-agentä¸collectoråœ¨åŒä¸€å°æœºå™¨ï¼Œå› æ­¤é»˜è®¤é…ç½®å³å¯ä¸éœ€è¦ä¿®æ”¹ã€‚ä¸ºspring-bootåº”ç”¨é…ç½®pinpoint-agentå¯åŠ¨spring-bootåº”ç”¨æ—¶æ·»åŠ å¦‚ä¸‹å‚æ•°123-javaagent:$AGENT_PATH/pinpoint-bootstrap-$VERSION.jar-Dpinpoint.agentId-Dpinpoint.applicationName æœ¬ä¾‹ä¸­çš„å¯åŠ¨å‚æ•°ä¸º1java -javaagent:/pinpoint-agent/pinpoint-bootstrap-1.6.2.jar -Dpinpoint.agentId=spring-boot-app -Dpinpoint.applicationName=spring-boot-app -jar spring-boot-docker-example-1.0.jar è®¿é—® http://127.0.0.1:8088/ ï¼Œç¬¬ä¸€æ¬¡è®¿é—®å¯èƒ½æ²¡æœ‰æ•°æ®ï¼Œå¯ä»¥å…ˆè®¿é—®ä¸‹åº”ç”¨ï¼Œç„¶ååœ¨åˆ·æ–°pinpointç®¡æ§å°å³å¯ morehttps://www.cnblogs.com/yyhh/p/6106472.html Open-FalconOpen-Falconï¼Œå°ç±³å®¶çš„å¼€æºç›‘æ§ç³»ç»Ÿã€‚ ç‰¹ç‚¹1ã€å¼ºå¤§çµæ´»çš„æ•°æ®é‡‡é›†ï¼šè‡ªåŠ¨å‘ç°ï¼Œæ”¯æŒfalcon-agentã€snmpã€æ”¯æŒç”¨æˆ·ä¸»åŠ¨pushã€ç”¨æˆ·è‡ªå®šä¹‰æ’ä»¶æ”¯æŒã€opentsdb data model likeï¼ˆtimestampã€endpointã€metricã€key-value tagsï¼‰ 2ã€æ°´å¹³æ‰©å±•èƒ½åŠ›ï¼šæ”¯æŒæ¯ä¸ªå‘¨æœŸä¸Šäº¿æ¬¡çš„æ•°æ®é‡‡é›†ã€å‘Šè­¦åˆ¤å®šã€å†å²æ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢ 3ã€é«˜æ•ˆç‡çš„å‘Šè­¦ç­–ç•¥ç®¡ç†ï¼šé«˜æ•ˆçš„portalã€æ”¯æŒç­–ç•¥æ¨¡æ¿ã€æ¨¡æ¿ç»§æ‰¿å’Œè¦†ç›–ã€å¤šç§å‘Šè­¦æ–¹å¼ã€æ”¯æŒcallbackè°ƒç”¨ 4ã€äººæ€§åŒ–çš„å‘Šè­¦è®¾ç½®ï¼šæœ€å¤§å‘Šè­¦æ¬¡æ•°ã€å‘Šè­¦çº§åˆ«ã€å‘Šè­¦æ¢å¤é€šçŸ¥ã€å‘Šè­¦æš‚åœã€ä¸åŒæ—¶æ®µä¸åŒé˜ˆå€¼ã€æ”¯æŒç»´æŠ¤å‘¨æœŸ 5ã€é«˜æ•ˆç‡çš„graphç»„ä»¶ï¼šå•æœºæ”¯æ’‘200ä¸‡metricçš„ä¸ŠæŠ¥ã€å½’æ¡£ã€å­˜å‚¨ï¼ˆå‘¨æœŸä¸º1åˆ†é’Ÿï¼‰ 6ã€é«˜æ•ˆçš„å†å²æ•°æ®queryç»„ä»¶ï¼šé‡‡ç”¨rrdtoolçš„æ•°æ®å½’æ¡£ç­–ç•¥ï¼Œç§’çº§è¿”å›ä¸Šç™¾ä¸ªmetricä¸€å¹´çš„å†å²æ•°æ® 7ã€dashboardï¼šå¤šç»´åº¦çš„æ•°æ®å±•ç¤ºï¼Œç”¨æˆ·è‡ªå®šä¹‰Screen 8ã€é«˜å¯ç”¨ï¼šæ•´ä¸ªç³»ç»Ÿæ— æ ¸å¿ƒå•ç‚¹ï¼Œæ˜“è¿ç»´ï¼Œæ˜“éƒ¨ç½²ï¼Œå¯æ°´å¹³æ‰©å±• 9ã€å¼€å‘è¯­è¨€ï¼š æ•´ä¸ªç³»ç»Ÿçš„åç«¯ï¼Œå…¨éƒ¨golangç¼–å†™ï¼Œportalå’Œdashboardä½¿ç”¨pythonç¼–å†™ã€‚ ç¤¾åŒºå’Œæ–‡æ¡£æ”¯æŒhttp://book.open-falcon.org/zh/index.html ç¯å¢ƒå‡†å¤‡å®‰è£…redisyumå®‰è£…1yum install -y redis ä¿®æ”¹é…ç½®redis.conf1vi /etc/redis.conf å¯åŠ¨redisï¼šredis-server &amp; å®‰è£…mysql1yum install -y mysql-server å¯åŠ¨mysqlï¼šservice mysqld startæŸ¥çœ‹mysqlçŠ¶æ€ï¼šservice mysqld status åˆå§‹åŒ–mysqlæ•°æ®åº“è¡¨æ•°æ®é»˜è®¤æ²¡æœ‰è®¾ç½®å¯†ç ï¼Œæ‰§è¡Œçš„æ—¶å€™å‡ºç°è¾“å…¥å¯†ç ï¼Œç›´æ¥å›è½¦ã€‚12345678cd /tmp/ &amp;&amp; git clone https://github.com/open-falcon/falcon-plus.git cd /tmp/falcon-plus/scripts/mysql/db_schema/mysql -h 127.0.0.1 -u root -p &lt; 1_uic-db-schema.sqlmysql -h 127.0.0.1 -u root -p &lt; 2_portal-db-schema.sqlmysql -h 127.0.0.1 -u root -p &lt; 3_dashboard-db-schema.sqlmysql -h 127.0.0.1 -u root -p &lt; 4_graph-db-schema.sqlmysql -h 127.0.0.1 -u root -p &lt; 5_alarms-db-schema.sqlrm -rf /tmp/falcon-plus/ è®¾ç½®mysqlçš„rootç”¨æˆ·å¯†ç ï¼šmysql â€“u rootæŸ¥çœ‹mysqlç”¨æˆ·å’Œå¯†ç select user,host,password from mysql.user; å‘ç°æŸ¥è¯¢å¯†ç éƒ½æ˜¯ç©ºï¼Œç„¶åå¼€å§‹è®¾ç½®rootçš„å¯†ç ä¸ºbigdata1mysql&gt; set password for root@localhost=password(&apos;bigdata&apos;); é€€å‡ºï¼šmysql&gt;exit ä¸‹è½½ç¼–è¯‘åçš„äºŒè¿›åˆ¶åŒ…12cd /data/program/softwarewget https://github.com/open-falcon/falcon-plus/releases/download/v0.2.1/open-falcon-v0.2.1.tar.gz åç«¯å®‰è£…åˆ›å»ºå·¥ä½œç›®å½•123export FALCON_HOME=/home/workexport WORKSPACE=$FALCON_HOME/open-falconmkdir -p $WORKSPACE è§£å‹äºŒè¿›åˆ¶åŒ…12cd /data/program/softwaretar -xzvf open-falcon-v0.2.1.tar.gz -C $WORKSPACE é…ç½®æ•°æ®åº“è´¦å·å’Œå¯†ç 12cd $WORKSPACEgrep -Ilr 3306 ./ | xargs -n1 -- sed -i &apos;s/root:/root:bigdata/g&apos; æ³¨æ„root:åé¢é»˜è®¤å¯†ç ä¸ºç©º. å¯åŠ¨æŸ¥çœ‹ç›®å½•ä¸‹åŒ…æ‹¬Open-Falconçš„æ‰€æœ‰ç»„ä»¶12cd $WORKSPACE./open-falcon start æ£€æŸ¥æ‰€æœ‰æ¨¡å—çš„å¯åŠ¨çŠ¶å†µ./open-falcon check æ›´å¤šå‘½ä»¤è¡Œå·¥å…·12345678910111213141516./open-falcon [start|stop|restart|check|monitor|reload] module./open-falcon start agent./open-falcon check falcon-graph UP 53007 falcon-hbs UP 53014 falcon-judge UP 53020 falcon-transfer UP 53026 falcon-nodata UP 53032 falcon-aggregator UP 53038 falcon-agent UP 53044 falcon-gateway UP 53050 falcon-api UP 53056 falcon-alarm UP 53063For debugging , You can check $WorkDir/$moduleName/log/logs/xxx.log å‰ç«¯å®‰è£…åˆ›å»ºå·¥ä½œç›®å½•è¿™ä¸€æ­¥åœ¨åˆ›å»ºåç«¯æœåŠ¡çš„æ—¶å€™å·²ç»å»ºç«‹å¥½ï¼Œæ‰€ä»¥ä¸éœ€è¦å†è¿›è¡Œæ“ä½œã€‚1234export HOME=/home/workexport WORKSPACE=$HOME/open-falconmkdir -p $WORKSPACEcd $WORKSPACE å…‹éš†å‰ç«¯ç»„ä»¶ä»£ç 12cd $WORKSPACEgit clone https://github.com/open-falcon/dashboard.git å®‰è£…ä¾èµ–åŒ…12345yum install -y python-virtualenvyum install -y python-develyum install -y openldap-develyum install -y mysql-develyum groupinstall &quot;Development tools&quot; 12cd $WORKSPACE/dashboard/virtualenv ./env 1./env/bin/pip install -r pip_requirements.txt -i https://pypi.douban.com/simple æ³¨æ„ï¼šå¦‚æœæ‰§è¡Œä¸Šé¢æœ‰é—®é¢˜ï¼Œå°±ç›´æ¥æ‰§è¡Œ./env/bin/pip install -r pip_requirements.txt ä¿®æ”¹é…ç½®dashboardçš„é…ç½®æ–‡ä»¶ä¸ºï¼š â€˜rrd/config.pyâ€™ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹1234## API_ADDR è¡¨ç¤ºåç«¯apiç»„ä»¶çš„åœ°å€API_ADDR = &quot;http://127.0.0.1:8080/api/v1&quot; ## æ ¹æ®å®é™…æƒ…å†µï¼Œä¿®æ”¹PORTAL_DB_*, é»˜è®¤ç”¨æˆ·åä¸ºrootï¼Œé»˜è®¤å¯†ç ä¸º&quot;&quot;## æ ¹æ®å®é™…æƒ…å†µï¼Œä¿®æ”¹ALARM_DB_*, é»˜è®¤ç”¨æˆ·åä¸ºrootï¼Œé»˜è®¤å¯†ç ä¸º&quot;&quot; å¯åŠ¨1bash control start open http://127.0.0.1:8081 in your browser. åœæ­¢bash control stop å®‰è£…-Agentä»‹ç»agentç”¨äºé‡‡é›†æœºå™¨è´Ÿè½½ç›‘æ§æŒ‡æ ‡ï¼Œæ¯”å¦‚cpu.idleã€load.1minã€disk.io.utilç­‰ç­‰ï¼Œæ¯éš”60ç§’pushç»™Transferã€‚agentä¸Transferå»ºç«‹äº†é•¿è¿æ¥ï¼Œæ•°æ®å‘é€é€Ÿåº¦æ¯”è¾ƒå¿«ï¼Œagentæä¾›äº†ä¸€ä¸ªhttpæ¥å£/v1/pushç”¨äºæ¥æ”¶ç”¨æˆ·æ‰‹å·¥pushçš„ä¸€äº›æ•°æ®ï¼Œç„¶åé€šè¿‡é•¿è¿æ¥è¿…é€Ÿè½¬å‘ç»™Transferã€‚ éƒ¨ç½²agentéœ€è¦éƒ¨ç½²åˆ°æ‰€æœ‰è¦è¢«ç›‘æ§çš„æœºå™¨ä¸Šï¼Œæ¯”å¦‚å…¬å¸æœ‰10ä¸‡å°æœºå™¨ï¼Œé‚£å°±è¦éƒ¨ç½²10ä¸‡ä¸ªagentã€‚agentæœ¬èº«èµ„æºæ¶ˆè€—å¾ˆå°‘ï¼Œä¸ç”¨æ‹…å¿ƒã€‚é¦–å…ˆæ‰¾åˆ°ä¹‹å‰åç«¯æœåŠ¡çš„è§£å‹ç›®å½•ï¼š/home/work/open-falcon/æ‹·è´agentåˆ°éœ€è¦ç›‘æ§çš„æœåŠ¡å™¨ä¸Šé¢scp -r agent/ root@dst1:/home/work/open-falconæ‹·è´open-falconåˆ°éœ€è¦ç›‘æ§çš„æœåŠ¡å™¨ä¸Šé¢scp -r open-falcon root@dst1:/home/work/open-falconä¿®æ”¹é…ç½®æ–‡ä»¶ï¼šé…ç½®æ–‡ä»¶å¿…é¡»å«cfg.jsonï¼Œå¦‚ä¸‹å‚ç…§ä¿®æ”¹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&#123; &quot;debug&quot;: true, # æ§åˆ¶ä¸€äº›debugä¿¡æ¯çš„è¾“å‡ºï¼Œç”Ÿäº§ç¯å¢ƒé€šå¸¸è®¾ç½®ä¸ºfalse &quot;hostname&quot;: &quot;&quot;, # agenté‡‡é›†äº†æ•°æ®å‘ç»™transferï¼Œendpointå°±è®¾ç½®ä¸ºäº†hostnameï¼Œé»˜è®¤é€šè¿‡`hostname`è·å–ï¼Œå¦‚æœé…ç½®ä¸­é…ç½®äº†hostnameï¼Œå°±ç”¨é…ç½®ä¸­çš„ &quot;ip&quot;: &quot;&quot;, # agentä¸hbså¿ƒè·³çš„æ—¶å€™ä¼šæŠŠè‡ªå·±çš„ipåœ°å€å‘ç»™hbsï¼Œagentä¼šè‡ªåŠ¨æ¢æµ‹æœ¬æœºipï¼Œå¦‚æœä¸æƒ³è®©agentè‡ªåŠ¨æ¢æµ‹ï¼Œå¯ä»¥æ‰‹å·¥ä¿®æ”¹è¯¥é…ç½® &quot;plugin&quot;: &#123; &quot;enabled&quot;: false, # é»˜è®¤ä¸å¼€å¯æ’ä»¶æœºåˆ¶ &quot;dir&quot;: &quot;./plugin&quot;, # æŠŠæ”¾ç½®æ’ä»¶è„šæœ¬çš„git repo cloneåˆ°è¿™ä¸ªç›®å½• &quot;git&quot;: &quot;https://github.com/open-falcon/plugin.git&quot;, # æ”¾ç½®æ’ä»¶è„šæœ¬çš„git repoåœ°å€ &quot;logs&quot;: &quot;./logs&quot; # æ’ä»¶æ‰§è¡Œçš„logï¼Œå¦‚æœæ’ä»¶æ‰§è¡Œæœ‰é—®é¢˜ï¼Œå¯ä»¥å»è¿™ä¸ªç›®å½•çœ‹log &#125;, &quot;heartbeat&quot;: &#123; &quot;enabled&quot;: true, # æ­¤å¤„enabledè¦è®¾ç½®ä¸ºtrue &quot;addr&quot;: &quot;127.0.0.1:6030&quot;, # hbsçš„åœ°å€ï¼Œç«¯å£æ˜¯hbsçš„rpcç«¯å£ &quot;interval&quot;: 60, # å¿ƒè·³å‘¨æœŸï¼Œå•ä½æ˜¯ç§’ &quot;timeout&quot;: 1000 # è¿æ¥hbsçš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ &#125;, &quot;transfer&quot;: &#123; &quot;enabled&quot;: true, &quot;addrs&quot;: [ &quot;127.0.0.1:18433&quot; ], # transferçš„åœ°å€ï¼Œç«¯å£æ˜¯transferçš„rpcç«¯å£, å¯ä»¥æ”¯æŒå†™å¤šä¸ªtransferçš„åœ°å€ï¼Œagentä¼šä¿è¯HA &quot;interval&quot;: 60, # é‡‡é›†å‘¨æœŸï¼Œå•ä½æ˜¯ç§’ï¼Œå³agentä¸€åˆ†é’Ÿé‡‡é›†ä¸€æ¬¡æ•°æ®å‘ç»™transfer &quot;timeout&quot;: 1000 # è¿æ¥transferçš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ &#125;, &quot;http&quot;: &#123; &quot;enabled&quot;: true, # æ˜¯å¦è¦ç›‘å¬httpç«¯å£ &quot;listen&quot;: &quot;:1988&quot;, &quot;backdoor&quot;: false &#125;, &quot;collector&quot;: &#123; &quot;ifacePrefix&quot;: [&quot;eth&quot;, &quot;em&quot;], # é»˜è®¤é…ç½®åªä¼šé‡‡é›†ç½‘å¡åç§°å‰ç¼€æ˜¯ethã€emçš„ç½‘å¡æµé‡ï¼Œé…ç½®ä¸ºç©ºå°±ä¼šé‡‡é›†æ‰€æœ‰çš„ï¼Œloçš„ä¹Ÿä¼šé‡‡é›†ã€‚å¯ä»¥ä»/proc/net/devçœ‹åˆ°å„ä¸ªç½‘å¡çš„æµé‡ä¿¡æ¯ &quot;mountPoint&quot;: [] &#125;, &quot;default_tags&quot;: &#123; &#125;, &quot;ignore&quot;: &#123; # é»˜è®¤é‡‡é›†äº†200å¤šä¸ªmetricï¼Œå¯ä»¥é€šè¿‡ignoreè®¾ç½®ä¸ºä¸é‡‡é›† &quot;cpu.busy&quot;: true, &quot;df.bytes.free&quot;: true, &quot;df.bytes.total&quot;: true, &quot;df.bytes.used&quot;: true, &quot;df.bytes.used.percent&quot;: true, &quot;df.inodes.total&quot;: true, &quot;df.inodes.free&quot;: true, &quot;df.inodes.used&quot;: true, &quot;df.inodes.used.percent&quot;: true, &quot;mem.memtotal&quot;: true, &quot;mem.memused&quot;: true, &quot;mem.memused.percent&quot;: true, &quot;mem.memfree&quot;: true, &quot;mem.swaptotal&quot;: true, &quot;mem.swapused&quot;: true, &quot;mem.swapfree&quot;: true &#125;&#125; å¯åŠ¨./open-falcon start agent å¯åŠ¨è¿›ç¨‹./open-falcon stop agent åœæ­¢è¿›ç¨‹./open-falcon monitor agent æŸ¥çœ‹æ—¥å¿—çœ‹varç›®å½•ä¸‹çš„logæ˜¯å¦æ­£å¸¸ï¼Œæˆ–è€…æµè§ˆå™¨è®¿é—®å…¶1988ç«¯å£ã€‚å¦å¤–agentæä¾›äº†ä¸€ä¸ªâ€“checkå‚æ•°ï¼Œå¯ä»¥æ£€æŸ¥agentæ˜¯å¦å¯ä»¥æ­£å¸¸è·‘åœ¨å½“å‰æœºå™¨ä¸Š./falcon-agent --checkå¯è¿›å…¥ç›‘æ§ç•Œé¢æŸ¥çœ‹ å®‰è£…æ•°æ®è½¬å‘æœåŠ¡-Transferç®€ä»‹transferæ˜¯æ•°æ®è½¬å‘æœåŠ¡ã€‚å®ƒæ¥æ”¶agentä¸ŠæŠ¥çš„æ•°æ®ï¼Œç„¶åæŒ‰ç…§å“ˆå¸Œè§„åˆ™è¿›è¡Œæ•°æ®åˆ†ç‰‡ã€å¹¶å°†åˆ†ç‰‡åçš„æ•°æ®åˆ†åˆ«pushç»™graph&amp;judgeç­‰ç»„ä»¶ã€‚ æœåŠ¡éƒ¨ç½²æœåŠ¡éƒ¨ç½²ï¼ŒåŒ…æ‹¬é…ç½®ä¿®æ”¹ã€å¯åŠ¨æœåŠ¡ã€æ£€éªŒæœåŠ¡ã€åœæ­¢æœåŠ¡ç­‰ã€‚è¿™ä¹‹å‰ï¼Œéœ€è¦å°†å®‰è£…åŒ…è§£å‹åˆ°æœåŠ¡çš„éƒ¨ç½²ç›®å½•ä¸‹ã€‚12# ä¿®æ”¹é…ç½®, é…ç½®é¡¹å«ä¹‰è§ä¸‹æ–‡vim cfg.json 12# å¯åŠ¨æœåŠ¡./open-falcon start transfer 12# æ ¡éªŒæœåŠ¡,è¿™é‡Œå‡å®šæœåŠ¡å¼€å¯äº†6060çš„httpç›‘å¬ç«¯å£ã€‚æ£€éªŒç»“æœä¸ºokè¡¨æ˜æœåŠ¡æ­£å¸¸å¯åŠ¨ã€‚curl -s &quot;127.0.0.1:6060/health&quot; 12# åœæ­¢æœåŠ¡./open-falcon stop transfer 12# æŸ¥çœ‹æ—¥å¿—./open-falcon monitor transfer é…ç½®è¯´æ˜é…ç½®æ–‡ä»¶é»˜è®¤ä¸º./cfg.jsondebug: true/false, å¦‚æœä¸ºtrueï¼Œæ—¥å¿—ä¸­ä¼šæ‰“å°debugä¿¡æ¯123456789101112131415161718192021222324252627282930313233343536373839404142434445minStep: 30, å…è®¸ä¸ŠæŠ¥çš„æ•°æ®æœ€å°é—´éš”ï¼Œé»˜è®¤ä¸º30ç§’http - enabled: true/false, è¡¨ç¤ºæ˜¯å¦å¼€å¯è¯¥httpç«¯å£ï¼Œè¯¥ç«¯å£ä¸ºæ§åˆ¶ç«¯å£ï¼Œä¸»è¦ç”¨æ¥å¯¹transferå‘é€æ§åˆ¶å‘½ä»¤ã€ç»Ÿè®¡å‘½ä»¤ã€debugå‘½ä»¤ç­‰ - listen: è¡¨ç¤ºç›‘å¬çš„httpç«¯å£rpc - enabled: true/false, è¡¨ç¤ºæ˜¯å¦å¼€å¯è¯¥jsonrpcæ•°æ®æ¥æ”¶ç«¯å£, Agentå‘é€æ•°æ®ä½¿ç”¨çš„å°±æ˜¯è¯¥ç«¯å£ - listen: è¡¨ç¤ºç›‘å¬çš„httpç«¯å£socket #å³å°†è¢«åºŸå¼ƒ,è¯·é¿å…ä½¿ç”¨ - enabled: true/false, è¡¨ç¤ºæ˜¯å¦å¼€å¯è¯¥telnetæ–¹å¼çš„æ•°æ®æ¥æ”¶ç«¯å£ï¼Œè¿™æ˜¯ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä¸€è¡Œè¡Œçš„å‘é€æ•°æ®ç»™transfer - listen: è¡¨ç¤ºç›‘å¬çš„httpç«¯å£judge - enabled: true/false, è¡¨ç¤ºæ˜¯å¦å¼€å¯å‘judgeå‘é€æ•°æ® - batch: æ•°æ®è½¬å‘çš„æ‰¹é‡å¤§å°ï¼Œå¯ä»¥åŠ å¿«å‘é€é€Ÿåº¦ï¼Œå»ºè®®ä¿æŒé»˜è®¤å€¼ - connTimeout: å•ä½æ˜¯æ¯«ç§’ï¼Œä¸åç«¯å»ºç«‹è¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼Œå¯ä»¥æ ¹æ®ç½‘ç»œè´¨é‡å¾®è°ƒï¼Œå»ºè®®ä¿æŒé»˜è®¤ - callTimeout: å•ä½æ˜¯æ¯«ç§’ï¼Œå‘é€æ•°æ®ç»™åç«¯çš„è¶…æ—¶æ—¶é—´ï¼Œå¯ä»¥æ ¹æ®ç½‘ç»œè´¨é‡å¾®è°ƒï¼Œå»ºè®®ä¿æŒé»˜è®¤ - pingMethod: åç«¯æä¾›çš„pingæ¥å£ï¼Œç”¨æ¥æ¢æµ‹è¿æ¥æ˜¯å¦å¯ç”¨ï¼Œå¿…é¡»ä¿æŒé»˜è®¤ - maxConns: è¿æ¥æ± ç›¸å…³é…ç½®ï¼Œæœ€å¤§è¿æ¥æ•°ï¼Œå»ºè®®ä¿æŒé»˜è®¤ - maxIdle: è¿æ¥æ± ç›¸å…³é…ç½®ï¼Œæœ€å¤§ç©ºé—²è¿æ¥æ•°ï¼Œå»ºè®®ä¿æŒé»˜è®¤ - replicas: è¿™æ˜¯ä¸€è‡´æ€§hashç®—æ³•éœ€è¦çš„èŠ‚ç‚¹å‰¯æœ¬æ•°é‡ï¼Œå»ºè®®ä¸è¦å˜æ›´ï¼Œä¿æŒé»˜è®¤å³å¯ - cluster: key-valueå½¢å¼çš„å­—å…¸ï¼Œè¡¨ç¤ºåç«¯çš„judgeåˆ—è¡¨ï¼Œå…¶ä¸­keyä»£è¡¨åç«¯judgeåå­—ï¼Œvalueä»£è¡¨çš„æ˜¯å…·ä½“çš„ip:portgraph - enabled: true/false, è¡¨ç¤ºæ˜¯å¦å¼€å¯å‘graphå‘é€æ•°æ® - batch: æ•°æ®è½¬å‘çš„æ‰¹é‡å¤§å°ï¼Œå¯ä»¥åŠ å¿«å‘é€é€Ÿåº¦ï¼Œå»ºè®®ä¿æŒé»˜è®¤å€¼ - connTimeout: å•ä½æ˜¯æ¯«ç§’ï¼Œä¸åç«¯å»ºç«‹è¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼Œå¯ä»¥æ ¹æ®ç½‘ç»œè´¨é‡å¾®è°ƒï¼Œå»ºè®®ä¿æŒé»˜è®¤ - callTimeout: å•ä½æ˜¯æ¯«ç§’ï¼Œå‘é€æ•°æ®ç»™åç«¯çš„è¶…æ—¶æ—¶é—´ï¼Œå¯ä»¥æ ¹æ®ç½‘ç»œè´¨é‡å¾®è°ƒï¼Œå»ºè®®ä¿æŒé»˜è®¤ - pingMethod: åç«¯æä¾›çš„pingæ¥å£ï¼Œç”¨æ¥æ¢æµ‹è¿æ¥æ˜¯å¦å¯ç”¨ï¼Œå¿…é¡»ä¿æŒé»˜è®¤ - maxConns: è¿æ¥æ± ç›¸å…³é…ç½®ï¼Œæœ€å¤§è¿æ¥æ•°ï¼Œå»ºè®®ä¿æŒé»˜è®¤ - maxIdle: è¿æ¥æ± ç›¸å…³é…ç½®ï¼Œæœ€å¤§ç©ºé—²è¿æ¥æ•°ï¼Œå»ºè®®ä¿æŒé»˜è®¤ - replicas: è¿™æ˜¯ä¸€è‡´æ€§hashç®—æ³•éœ€è¦çš„èŠ‚ç‚¹å‰¯æœ¬æ•°é‡ï¼Œå»ºè®®ä¸è¦å˜æ›´ï¼Œä¿æŒé»˜è®¤å³å¯ - cluster: key-valueå½¢å¼çš„å­—å…¸ï¼Œè¡¨ç¤ºåç«¯çš„graphåˆ—è¡¨ï¼Œå…¶ä¸­keyä»£è¡¨åç«¯graphåå­—ï¼Œvalueä»£è¡¨çš„æ˜¯å…·ä½“çš„ip:port(å¤šä¸ªåœ°å€ç”¨é€—å·éš”å¼€, transferä¼šå°†åŒä¸€ä»½æ•°æ®å‘é€è‡³å„ä¸ªåœ°å€ï¼Œåˆ©ç”¨è¿™ä¸ªç‰¹æ€§å¯ä»¥å®ç°æ•°æ®çš„å¤šé‡å¤‡ä»½)tsdb - enabled: true/false, è¡¨ç¤ºæ˜¯å¦å¼€å¯å‘open tsdbå‘é€æ•°æ® - batch: æ•°æ®è½¬å‘çš„æ‰¹é‡å¤§å°ï¼Œå¯ä»¥åŠ å¿«å‘é€é€Ÿåº¦ - connTimeout: å•ä½æ˜¯æ¯«ç§’ï¼Œä¸åç«¯å»ºç«‹è¿æ¥çš„è¶…æ—¶æ—¶é—´ï¼Œå¯ä»¥æ ¹æ®ç½‘ç»œè´¨é‡å¾®è°ƒï¼Œå»ºè®®ä¿æŒé»˜è®¤ - callTimeout: å•ä½æ˜¯æ¯«ç§’ï¼Œå‘é€æ•°æ®ç»™åç«¯çš„è¶…æ—¶æ—¶é—´ï¼Œå¯ä»¥æ ¹æ®ç½‘ç»œè´¨é‡å¾®è°ƒï¼Œå»ºè®®ä¿æŒé»˜è®¤ - maxConns: è¿æ¥æ± ç›¸å…³é…ç½®ï¼Œæœ€å¤§è¿æ¥æ•°ï¼Œå»ºè®®ä¿æŒé»˜è®¤ - maxIdle: è¿æ¥æ± ç›¸å…³é…ç½®ï¼Œæœ€å¤§ç©ºé—²è¿æ¥æ•°ï¼Œå»ºè®®ä¿æŒé»˜è®¤ - retry: è¿æ¥åç«¯çš„é‡è¯•æ¬¡æ•°å’Œå‘é€æ•°æ®çš„é‡è¯•æ¬¡æ•° - address: tsdbåœ°å€æˆ–è€…tsdbé›†ç¾¤vipåœ°å€, é€šè¿‡tcpè¿æ¥tsdb. éƒ¨ç½²å®Œæˆtransferç»„ä»¶åï¼Œè¯·ä¿®æ”¹agentçš„é…ç½®ï¼Œä½¿å…¶æŒ‡å‘æ­£ç¡®çš„transferåœ°å€ã€‚åœ¨å®‰è£…å®Œgraphå’Œjudgeåï¼Œè¯·ä¿®æ”¹transferçš„ç›¸åº”é…ç½®ã€ä½¿å…¶èƒ½å¤Ÿæ­£ç¡®å¯»å€åˆ°è¿™ä¸¤ä¸ªç»„ä»¶ã€‚ å®‰è£…æŸ¥è¯¢ç»„ä»¶-APIä»‹ç»apiç»„ä»¶ï¼Œæä¾›ç»Ÿä¸€çš„restAPIæ“ä½œæ¥å£ã€‚æ¯”å¦‚ï¼šapiç»„ä»¶æ¥æ”¶æŸ¥è¯¢è¯·æ±‚ï¼Œæ ¹æ®ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•å»ç›¸åº”çš„graphå®ä¾‹æŸ¥è¯¢ä¸åŒmetricçš„æ•°æ®ï¼Œç„¶åæ±‡æ€»æ‹¿åˆ°çš„æ•°æ®ï¼Œæœ€åç»Ÿä¸€è¿”å›ç»™ç”¨æˆ·ã€‚ æœåŠ¡éƒ¨ç½²æœåŠ¡éƒ¨ç½²ï¼ŒåŒ…æ‹¬é…ç½®ä¿®æ”¹ã€å¯åŠ¨æœåŠ¡ã€æ£€éªŒæœåŠ¡ã€åœæ­¢æœåŠ¡ç­‰ã€‚è¿™ä¹‹å‰ï¼Œéœ€è¦å°†å®‰è£…åŒ…è§£å‹åˆ°æœåŠ¡çš„éƒ¨ç½²ç›®å½•ä¸‹ã€‚1234567891011# ä¿®æ”¹é…ç½®, é…ç½®é¡¹å«ä¹‰è§ä¸‹æ–‡, æ³¨æ„graphé›†ç¾¤çš„é…ç½®vim cfg.json# å¯åŠ¨æœåŠ¡./open-falcon start api# åœæ­¢æœåŠ¡./open-falcon stop api# æŸ¥çœ‹æ—¥å¿—./open-falcon monitor api æœåŠ¡è¯´æ˜æ³¨æ„: è¯·ç¡®ä¿ graphsçš„å†…å®¹ä¸transferçš„é…ç½®å®Œå…¨ä¸€è‡´1234567891011121314151617181920212223242526272829&#123; &quot;log_level&quot;: &quot;debug&quot;, &quot;db&quot;: &#123; //æ•°æ®åº“ç›¸å…³çš„è¿æ¥é…ç½®ä¿¡æ¯ &quot;faclon_portal&quot;: &quot;root:@tcp(127.0.0.1:3306)/falcon_portal?charset=utf8&amp;parseTime=True&amp;loc=Local&quot;, &quot;graph&quot;: &quot;root:@tcp(127.0.0.1:3306)/graph?charset=utf8&amp;parseTime=True&amp;loc=Local&quot;, &quot;uic&quot;: &quot;root:@tcp(127.0.0.1:3306)/uic?charset=utf8&amp;parseTime=True&amp;loc=Local&quot;, &quot;dashboard&quot;: &quot;root:@tcp(127.0.0.1:3306)/dashboard?charset=utf8&amp;parseTime=True&amp;loc=Local&quot;, &quot;alarms&quot;: &quot;root:@tcp(127.0.0.1:3306)/alarms?charset=utf8&amp;parseTime=True&amp;loc=Local&quot;, &quot;db_bug&quot;: true &#125;, &quot;graphs&quot;: &#123; // graphæ¨¡å—çš„éƒ¨ç½²åˆ—è¡¨ä¿¡æ¯ &quot;cluster&quot;: &#123; &quot;graph-00&quot;: &quot;127.0.0.1:6070&quot; &#125;, &quot;max_conns&quot;: 100, &quot;max_idle&quot;: 100, &quot;conn_timeout&quot;: 1000, &quot;call_timeout&quot;: 5000, &quot;numberOfReplicas&quot;: 500 &#125;, &quot;metric_list_file&quot;: &quot;./api/data/metric&quot;, &quot;web_port&quot;: &quot;:8080&quot;, // httpç›‘å¬ç«¯å£ &quot;access_control&quot;: true, // å¦‚æœè®¾ç½®ä¸ºfalseï¼Œé‚£ä¹ˆä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥å…·å¤‡ç®¡ç†å‘˜æƒé™ &quot;salt&quot;: &quot;pleaseinputwhichyouareusingnow&quot;, //æ•°æ®åº“åŠ å¯†å¯†ç çš„æ—¶å€™çš„salt &quot;skip_auth&quot;: false, //å¦‚æœè®¾ç½®ä¸ºtrueï¼Œé‚£ä¹ˆè®¿é—®apiå°±ä¸éœ€è¦ç»è¿‡è®¤è¯ &quot;default_token&quot;: &quot;default-token-used-in-server-side&quot;, //ç”¨äºæœåŠ¡ç«¯å„æ¨¡å—é—´çš„è®¿é—®æˆæƒ &quot;gen_doc&quot;: false, &quot;gen_doc_path&quot;: &quot;doc/module.html&quot;&#125; å¤‡æ³¨ï¼š éƒ¨ç½²å®Œæˆapiç»„ä»¶åï¼Œè¯·ä¿®æ”¹dashboardç»„ä»¶çš„é…ç½®ã€ä½¿å…¶èƒ½å¤Ÿæ­£ç¡®å¯»å€åˆ°apiç»„ä»¶ã€‚è¯·ç¡®ä¿apiç»„ä»¶çš„graphåˆ—è¡¨ ä¸ transferçš„é…ç½® ä¸€è‡´ã€‚ å®‰è£…ç»˜å›¾æ•°æ®çš„ç»„ä»¶- Graphä»‹ç»graphæ˜¯å­˜å‚¨ç»˜å›¾æ•°æ®çš„ç»„ä»¶ã€‚graphç»„ä»¶ æ¥æ”¶transferç»„ä»¶æ¨é€ä¸Šæ¥çš„ç›‘æ§æ•°æ®ï¼ŒåŒæ—¶å¤„ç†apiç»„ä»¶çš„æŸ¥è¯¢è¯·æ±‚ã€è¿”å›ç»˜å›¾æ•°æ®ã€‚ æœåŠ¡éƒ¨ç½²æœåŠ¡éƒ¨ç½²ï¼ŒåŒ…æ‹¬é…ç½®ä¿®æ”¹ã€å¯åŠ¨æœåŠ¡ã€æ£€éªŒæœåŠ¡ã€åœæ­¢æœåŠ¡ç­‰ã€‚è¿™ä¹‹å‰ï¼Œéœ€è¦å°†å®‰è£…åŒ…è§£å‹åˆ°æœåŠ¡çš„éƒ¨ç½²ç›®å½•ä¸‹ã€‚ï¼ˆé€šçŸ¥ä¹‹å‰çš„ä¸€æ ·ï¼Œæ‹·è´éœ€è¦çš„åŒ…åˆ°æŒ‡å®šçš„æœåŠ¡å™¨ï¼‰ ä¿®æ”¹é…ç½®, é…ç½®é¡¹å«ä¹‰è§ä¸‹æ–‡12345678910vim cfg.json# å¯åŠ¨æœåŠ¡./open-falcon start graph# åœæ­¢æœåŠ¡./open-falcon stop graph# æŸ¥çœ‹æ—¥å¿— ./open-falcon monitor graph ä¸‰ã€ é…ç½®è¯´æ˜é…ç½®æ–‡ä»¶é»˜è®¤ä¸º./cfg.jsonï¼Œé…ç½®å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627&#123; &quot;debug&quot;: false, //true or false, æ˜¯å¦å¼€å¯debugæ—¥å¿— &quot;http&quot;: &#123; &quot;enabled&quot;: true, //true or false, è¡¨ç¤ºæ˜¯å¦å¼€å¯è¯¥httpç«¯å£ï¼Œè¯¥ç«¯å£ä¸ºæ§åˆ¶ç«¯å£ï¼Œä¸»è¦ç”¨æ¥å¯¹graphå‘é€æ§åˆ¶å‘½ä»¤ã€ç»Ÿè®¡å‘½ä»¤ã€debugå‘½ä»¤ &quot;listen&quot;: &quot;0.0.0.0:6071&quot; //è¡¨ç¤ºç›‘å¬çš„httpç«¯å£ &#125;, &quot;rpc&quot;: &#123; &quot;enabled&quot;: true, //true or false, è¡¨ç¤ºæ˜¯å¦å¼€å¯è¯¥rpcç«¯å£ï¼Œè¯¥ç«¯å£ä¸ºæ•°æ®æ¥æ”¶ç«¯å£ &quot;listen&quot;: &quot;0.0.0.0:6070&quot; //è¡¨ç¤ºç›‘å¬çš„rpcç«¯å£ &#125;, &quot;rrd&quot;: &#123; &quot;storage&quot;: &quot;./data/6070&quot; // å†å²æ•°æ®çš„æ–‡ä»¶å­˜å‚¨è·¯å¾„ï¼ˆå¦‚æœ‰å¿…è¦ï¼Œè¯·ä¿®æ”¹ä¸ºåˆé€‚çš„è·¯å¾„ï¼‰ &#125;, &quot;db&quot;: &#123; &quot;dsn&quot;: &quot;root:@tcp(127.0.0.1:3306)/graph?loc=Local&amp;parseTime=true&quot;, //MySQLçš„è¿æ¥ä¿¡æ¯ï¼Œé»˜è®¤ç”¨æˆ·åæ˜¯rootï¼Œå¯†ç ä¸ºç©ºï¼Œhostä¸º127.0.0.1ï¼Œdatabaseä¸ºgraphï¼ˆå¦‚æœ‰å¿…è¦ï¼Œè¯·ä¿®æ”¹) &quot;maxIdle&quot;: 4 //MySQLè¿æ¥æ± é…ç½®ï¼Œè¿æ¥æ± å…è®¸çš„æœ€å¤§è¿æ¥æ•°ï¼Œä¿æŒé»˜è®¤å³å¯ &#125;, &quot;callTimeout&quot;: 5000, //RPCè°ƒç”¨è¶…æ—¶æ—¶é—´ï¼Œå•ä½ms &quot;migrate&quot;: &#123; //æ‰©å®¹graphæ—¶å†å²æ•°æ®è‡ªåŠ¨è¿ç§» &quot;enabled&quot;: false, //true or false, è¡¨ç¤ºgraphæ˜¯å¦å¤„äºæ•°æ®è¿ç§»çŠ¶æ€ &quot;concurrency&quot;: 2, //æ•°æ®è¿ç§»æ—¶çš„å¹¶å‘è¿æ¥æ•°ï¼Œå»ºè®®ä¿æŒé»˜è®¤ &quot;replicas&quot;: 500, //è¿™æ˜¯ä¸€è‡´æ€§hashç®—æ³•éœ€è¦çš„èŠ‚ç‚¹å‰¯æœ¬æ•°é‡ï¼Œå»ºè®®ä¸è¦å˜æ›´ï¼Œä¿æŒé»˜è®¤å³å¯ï¼ˆå¿…é¡»å’Œtransferçš„é…ç½®ä¸­ä¿æŒä¸€è‡´ï¼‰ &quot;cluster&quot;: &#123; //æœªæ‰©å®¹å‰è€çš„graphå®ä¾‹åˆ—è¡¨ &quot;graph-00&quot; : &quot;127.0.0.1:6070&quot; &#125; &#125;&#125; å¤‡æ³¨å¦‚æœä¸Šå›¾çº¢æ¡†ä¸­å‡ºç°åŒä¸€å°æœåŠ¡å™¨çš„ä¸åŒåå­—çš„é…ç½®ï¼Œåˆ™è¿›å…¥æ•°æ®åº“ï¼Œè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼šè¿›å…¥æ•°æ®åº“ï¼šmysql â€“u root â€“pæŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“ï¼šshow databses;é€‰æ‹©æ•°æ®åº“ï¼šuse graph;æŸ¥çœ‹è¡¨ï¼šshow tables;æŸ¥è¯¢è¡¨ï¼šselect * from endpoint;åˆ é™¤ä¸éœ€è¦çš„æ•°æ®ï¼šdelete from endpoint where id=153;å¦‚ä¸‹å¯ä»¥ä¸æ“ä½œï¼šå¯ä»¥ä¸€èµ·åˆ é™¤falcon_portalåº“ä¸­çš„hostè¡¨ä¸­çš„æ— ç”¨æ•°æ®ã€‚ Mysqlç›‘æ§å·¥ä½œåŸç†åœ¨æ•°æ®é‡‡é›†ä¸€èŠ‚ä¸­æˆ‘ä»¬ä»‹ç»äº†å¸¸è§çš„ç›‘æ§æ•°æ®æºã€‚open-falconä½œä¸ºä¸€ä¸ªç›‘æ§æ¡†æ¶ï¼Œå¯ä»¥å»é‡‡é›†ä»»ä½•ç³»ç»Ÿçš„ç›‘æ§æŒ‡æ ‡æ•°æ®ï¼Œåªè¦å°†ç›‘æ§æ•°æ®ç»„ç»‡ä¸ºopen-falconè§„èŒƒçš„æ ¼å¼å°±OKäº†ã€‚MySQLçš„æ•°æ®é‡‡é›†å¯ä»¥é€šè¿‡mymonæ¥åšã€‚mymonæ˜¯ä¸€ä¸ªcronï¼Œæ¯åˆ†é’Ÿè·‘ä¸€æ¬¡ï¼Œé…ç½®æ–‡ä»¶ä¸­é…ç½®äº†æ•°æ®åº“è¿æ¥åœ°å€ï¼Œmymonè¿åˆ°è¯¥æ•°æ®åº“ï¼Œé‡‡é›†ä¸€äº›ç›‘æ§æŒ‡æ ‡ï¼Œæ¯”å¦‚global status, global variables, slave statusç­‰ç­‰ï¼Œç„¶åç»„è£…ä¸ºopen-falconè§„å®šçš„æ ¼å¼çš„æ•°æ®ï¼Œpostç»™æœ¬æœºçš„falcon-agentã€‚falcon-agentæä¾›äº†ä¸€ä¸ªhttpæ¥å£ï¼Œä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒæ•°æ®é‡‡é›†ä¸­çš„ä¾‹å­ã€‚æ¯”å¦‚æˆ‘ä»¬æœ‰1000å°æœºå™¨éƒ½éƒ¨ç½²äº†MySQLå®ä¾‹ï¼Œå¯ä»¥åœ¨è¿™1000å°æœºå™¨ä¸Šåˆ†åˆ«éƒ¨ç½²1000ä¸ªcronï¼Œå³ï¼šä¸æ•°æ®åº“å®ä¾‹ä¸€ä¸€å¯¹åº”ã€‚ é…ç½®å®‰è£…ä¸‹è½½åœ°å€ï¼šhttps://github.com/open-falcon/mymonå®‰è£…ï¼šè®¾ç½®$GOPATHï¼šexport $GOPATH =/src/123456789mkdir -p $GOPATH/src/github.com/open-falconcd $GOPATH/src/github.com/open-falcongit clone https://github.com/open-falcon/mymon.gitcd mymongo get ./...go build -o mymonecho &apos;* * * * * cd $GOPATH/src/github.com/open-falcon/mymon &amp;&amp; ./mymon -c etc/mon.cfg&apos; &gt; /etc/cron.d/mymon æ‰§è¡Œgo get ./â€¦çš„æ—¶å€™å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š12package golang.org/x/crypto/ssh/terminal: unrecognized import path &quot;golang.org/x/crypto/ssh/terminal&quot; (https fetch: Get https://golang.org/x/crypto/ssh/terminal?go-get=1: dial tcp 216.239.37.1:443: i/o timeout)package golang.org/x/sys/unix: unrecognized import path &quot;golang.org/x/sys/unix&quot; (https fetch: Get https://golang.org/x/sys/unix?go-get=1: dial tcp 216.239.37.1:443: i/o timeout) è§£å†³åŠæ³•ï¼šæ–¹æ³•ä¸€ï¼šç›´æ¥ä¸‹è½½æ–‡ä»¶ï¼Œç„¶åæŠŠè§£å‹å‡ºæ¥çš„æ–‡ä»¶å¤¹æ”¾åœ¨srcé‡Œã€‚ä¸‹è½½åœ°å€ï¼šhttps://pan.baidu.com/s/1boVAtJp æ–¹æ³•äºŒï¼šç›´æ¥ä»gitä¸Šä¸‹è½½å¯¹åº”æ–‡ä»¶æ”¾åˆ°srcä¸‹é¢ã€‚mkdir -p $GOPATH/src/golang.org/xcd $GOPATH/src/golang.org/xgit clone https://github.com/golang/crypto.gitgit clone https://github.com/golang/sys.git ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š/src/github.com/open-falcon/mymon/etcvi mon.cfg1234567891011121314151617181920[default] log_file=mymon.log # æ—¥å¿—è·¯å¾„å’Œæ–‡ä»¶å # Panic 0 # Fatal 1 # Error 2 # Warn 3 # Info 4 # Debug 5 log_level=4 # æ—¥å¿—çº§åˆ« falcon_client=http://127.0.0.1:1988/v1/push # falcon agentè¿æ¥åœ°å€ #è‡ªå®šä¹‰endpoint endpoint=127.0.0.1 #è‹¥ä¸è®¾ç½®åˆ™ä½¿ç”¨OSçš„hostname [mysql] user=root # æ•°æ®åº“ç”¨æˆ·å password= # æ•°æ®åº“å¯†ç  host=127.0.0.1 # æ•°æ®åº“è¿æ¥åœ°å€ port=3306 # æ•°æ®åº“ç«¯å£ é‡‡é›†æˆåŠŸ! Redisç›‘æ§ä»‹ç»~Redisçš„æ•°æ®é‡‡é›†å¯ä»¥é€šè¿‡é‡‡é›†è„šæœ¬redis-monitor æˆ–è€… redismonæ¥åšã€‚ redis-monitoræ˜¯ä¸€ä¸ªcronï¼Œæ¯åˆ†é’Ÿè·‘ä¸€æ¬¡é‡‡é›†è„šæœ¬redis-monitor.pyï¼Œå…¶ä¸­é…ç½®äº†redisæœåŠ¡çš„åœ°å€ï¼Œredis-monitorè¿åˆ°rediså®ä¾‹ï¼Œé‡‡é›†ä¸€äº›ç›‘æ§æŒ‡æ ‡ï¼Œæ¯”å¦‚connected_clientsã€used_memoryç­‰ç­‰ï¼Œç„¶åç»„è£…ä¸ºopen-falconè§„å®šçš„æ ¼å¼çš„æ•°æ®ï¼Œpostç»™æœ¬æœºçš„falcon-agentã€‚falcon-agentæä¾›äº†ä¸€ä¸ªhttpæ¥å£ï¼Œä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒæ•°æ®é‡‡é›†ä¸­çš„ä¾‹å­ã€‚ æ¯”å¦‚ï¼Œæˆ‘ä»¬æœ‰1000å°æœºå™¨éƒ½éƒ¨ç½²äº†Rediså®ä¾‹ï¼Œå¯ä»¥åœ¨è¿™1000å°æœºå™¨ä¸Šåˆ†åˆ«éƒ¨ç½²1000ä¸ªcronï¼Œå³ï¼šä¸Rediså®ä¾‹ä¸€ä¸€å¯¹åº”ã€‚ å®‰è£…ä¸‹è½½åœ°å€ï¼šhttps://github.com/iambocai/falcon-monit-scripts è¿›å…¥ç›®å½•ï¼š/data/program/software/falcon-monit-scripts-master/redis ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼švi redis-monitor.pyä¿®æ”¹å¯¹åº”è¿æ¥åˆ°agentçš„åœ°å€ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122#!/bin/env python#-*- coding:utf-8 -*-__author__ = 'iambocai'import jsonimport timeimport socketimport osimport reimport sysimport commandsimport urllib2, base64class RedisStats: # ÄºÃ½ÃÃ½?ÄƒÅ”Ã­Å¥ÄÅ¯??ÃÅ¥ÃŸÅ£Ã“Ä‘redisÅÅ¹??Å¯Å¥Å˜Ã¼Ã®Ãœ?Ã´Ä‘???Ã“Ä‘redis-cliÃ–Å˜? _redis_cli = '/usr/local/redis/redis-cli' _stat_regex = re.compile(ur'(\w+):([0-9]+\.?[0-9]*)\r') def __init__(self, port='6379', passwd=None, host='127.0.0.1'): self._cmd = '%s -h %s -p %s info' % (self._redis_cli, host, port) if passwd not in ['', None]: self._cmd = '%s -h %s -p %s -a %s info' % (self._redis_cli, host, port, passwd) def stats(self): ' Return a dict containing redis stats ' info = commands.getoutput(self._cmd) return dict(self._stat_regex.findall(info))def main(): ip = "dst6-redis" timestamp = int(time.time()) step = 60 # inst_listÅ„Ã©ÃœÃÄ‘Ã­Ã–Å‘redisÅ°ÅÃ¶Ã‡Å®Å£Ã‹Ä›Ã–ÅÅ™ÃºÅÅ¹ÄÄÃŸÃ­???Å¢ÃÅ°ÅÃ¶Ã‡Å„Ã©?Ã¶Ë˜portÅ±ÃºpasswordÅÅ¹Ã‹Ä?Å¢Ä¹Ã©Ã„????Ã®ÃœÅ°Â°Å°Ã¶?Ã”Ä‘ÅÅ¹ÄºÃ½ÅÅŸ # inst_list = [ i for i in commands.getoutput("find /etc/ -name 'redis*.conf'" ).split('\n') ] insts_list = [ '/usr/local/redis/redis.conf' ] p = [] monit_keys = [ ('connected_clients','GAUGE'), ('blocked_clients','GAUGE'), ('used_memory','GAUGE'), ('used_memory_rss','GAUGE'), ('mem_fragmentation_ratio','GAUGE'), ('total_commands_processed','COUNTER'), ('rejected_connections','COUNTER'), ('expired_keys','COUNTER'), ('evicted_keys','COUNTER'), ('keyspace_hits','COUNTER'), ('keyspace_misses','COUNTER'), ('keyspace_hit_ratio','GAUGE'), ] for inst in insts_list: port = commands.getoutput("sed -n 's/^port *\([0-9]\&#123;4,5\&#125;\)/\\1/p' %s" % inst) passwd = commands.getoutput("sed -n 's/^requirepass *\([^ ]*\)/\\1/p' %s" % inst) metric = "redis" endpoint = ip tags = 'port=%s' % port try: conn = RedisStats(port, passwd) stats = conn.stats() except Exception,e: continue for key,vtype in monit_keys: #Ä›Ã©Å¢ÃÃ–ÅÃ·ÃºÃœÃ¢Ã®ÃœredisÅ„Ã©info?Å‘Ã³Ã®ÃœÄƒÃ¡ÄƒÃ“?Ã¡Â´ÅÅ¹ÄºÃ½ÃÃ½ÄšÅ”Ã¡Â´Ä›Ã©Å¢ÃÃ¤Ë›?Ã¢ÃÃ©Å Ã³ÃºÃ³Ë˜Ã®ÃœkeyÃ¶ÅšÃ”Å»? if key not in stats.keys(): continue #?ÃŸÅ Å®Â¤Å„Ã©Ã¡Äƒ if key == 'keyspace_hit_ratio': try: value = float(stats['keyspace_hits'])/(int(stats['keyspace_hits']) + int(stats['keyspace_misses'])) except ZeroDivisionError: value = 0 #Ã¡ÄÅ™Â¸Ã¡ÄƒÄƒÅ”ÃÅ ÄÄ‚? elif key == 'mem_fragmentation_ratio': value = float(stats[key]) else: #ÄÄ›Ã¶Ã¢Ã®ÃœÃ”Â´Ã³ÃºÃ³Ë˜Å•Ã·counterÅÅ¹int try: value = int(stats[key]) except: continue i = &#123; 'Metric': '%s.%s' % (metric, key), 'Endpoint': endpoint, 'Timestamp': timestamp, 'Step': step, 'Value': value, 'CounterType': vtype, 'TAGS': tags &#125; p.append(i) print json.dumps(p, sort_keys=True,indent=4) method = "POST" handler = urllib2.HTTPHandler() opener = urllib2.build_opener(handler) url = 'http://127.0.0.1:1988/v1/push' request = urllib2.Request(url, data=json.dumps(p) ) request.add_header("Content-Type",'application/json') request.get_method = lambda: method try: connection = opener.open(request) except urllib2.HTTPError,e: connection = e # check. Substitute with appropriate HTTP code. if connection.code == 200: print connection.read() else: print '&#123;"err":1,"msg":"%s"&#125;' % connectionif __name__ == '__main__': proc = commands.getoutput(' ps -ef|grep %s|grep -v grep|wc -l ' % os.path.basename(sys.argv[0])) sys.stdout.flush() if int(proc) &lt; 5: main() å¯åŠ¨æµ‹è¯•python redis-monitor.py å°†è„šæœ¬åŠ å…¥crontabæ‰§è¡Œå³å¯ æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼šservice crond status ç¼–è¾‘ï¼šcrontab â€“e åŠ å…¥å‘½ä»¤ï¼Œä¸€åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œç„¶åä¿å­˜ã€‚ 1*/1 * * * * python /data/program/software/falcon-monit-scripts-master/redis/redis-monitor.py é‡å¯æœåŠ¡service crond restart æ±‡æŠ¥å­—æ®µ key tag type note redis.connected_clients port GAUGE å·²è¿æ¥å®¢æˆ·ç«¯çš„æ•°é‡ redis.blocked_clients port GAUGE æ­£åœ¨ç­‰å¾…é˜»å¡å‘½ä»¤ï¼ˆBLPOPã€BRPOPã€BRPOPLPUSHï¼‰çš„å®¢æˆ·ç«¯çš„æ•°é‡ redis.used_memory port GAUGE ç”± Redis åˆ†é…å™¨åˆ†é…çš„å†…å­˜æ€»é‡ï¼Œä»¥å­—èŠ‚ï¼ˆbyteï¼‰ä¸ºå•ä½ redis.used_memory_rss port GAUGE ä»æ“ä½œç³»ç»Ÿçš„è§’åº¦ï¼Œè¿”å› Redis å·²åˆ†é…çš„å†…å­˜æ€»é‡ï¼ˆä¿—ç§°å¸¸é©»é›†å¤§å°ï¼‰ redis.mem_fragmentation_ratio port GAUGE used_memory_rss å’Œ used_memory ä¹‹é—´çš„æ¯”ç‡ redis.total_commands_processed port COUNTER é‡‡é›†å‘¨æœŸå†…æ‰§è¡Œå‘½ä»¤æ€»æ•° redis.rejected_connections port COUNTER é‡‡é›†å‘¨æœŸå†…æ‹’ç»è¿æ¥æ€»æ•° redis.expired_keys port COUNTER é‡‡é›†å‘¨æœŸå†…è¿‡æœŸkeyæ€»æ•° redis.evicted_keys port COUNTER é‡‡é›†å‘¨æœŸå†…è¸¢å‡ºkeyæ€»æ•° redis.keyspace_hits port COUNTER é‡‡é›†å‘¨æœŸå†…keyå‘½ä¸­æ€»æ•° redis.keyspace_misses port COUNTER é‡‡é›†å‘¨æœŸå†…keyæ‹’ç»æ€»æ•° redis.keyspace_hit_ratio port GAUGE è®¿é—®å‘½ä¸­ç‡ å¦‚éœ€å¢å‡å­—æ®µï¼Œè¯·ä¿®æ”¹monit_keyså˜é‡ Rabbitmqç›‘æ§ä»‹ç»åœ¨æ•°æ®é‡‡é›†ä¸€èŠ‚ä¸­æˆ‘ä»¬ä»‹ç»äº†å¸¸è§çš„ç›‘æ§æ•°æ®æºã€‚open-falconä½œä¸ºä¸€ä¸ªç›‘æ§æ¡†æ¶ï¼Œå¯ä»¥å»é‡‡é›†ä»»ä½•ç³»ç»Ÿçš„ç›‘æ§æŒ‡æ ‡æ•°æ®ï¼Œåªè¦å°†ç›‘æ§æ•°æ®ç»„ç»‡ä¸ºopen-falconè§„èŒƒçš„æ ¼å¼å°±OKäº†ã€‚ RMQçš„æ•°æ®é‡‡é›†å¯ä»¥é€šè¿‡è„šæœ¬rabbitmq-monitoræ¥åšã€‚ rabbitmq-monitoræ˜¯ä¸€ä¸ªcronï¼Œæ¯åˆ†é’Ÿè·‘ä¸€æ¬¡è„šæœ¬rabbitmq-monitor.pyï¼Œå…¶ä¸­é…ç½®äº†RMQçš„ç”¨æˆ·å&amp;å¯†ç ç­‰ï¼Œè„šæœ¬è¿åˆ°è¯¥RMQå®ä¾‹ï¼Œé‡‡é›†ä¸€äº›ç›‘æ§æŒ‡æ ‡ï¼Œæ¯”å¦‚messages_readyã€messages_totalã€deliver_rateã€publish_rateç­‰ç­‰ï¼Œç„¶åç»„è£…ä¸ºopen-falconè§„å®šçš„æ ¼å¼çš„æ•°æ®ï¼Œpostç»™æœ¬æœºçš„falcon-agentã€‚falcon-agentæä¾›äº†ä¸€ä¸ªhttpæ¥å£ï¼Œä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒæ•°æ®é‡‡é›†ä¸­çš„ä¾‹å­ã€‚ å®‰è£…é…ç½®ä¸‹è½½åœ°å€ï¼šhttps://github.com/iambocai/falcon-monit-scripts/tree/master/rabbitmqä¿®æ”¹é…ç½®ï¼švi rabbitmq-monitor.py 1ã€æ ¹æ®å®é™…éƒ¨ç½²æƒ…å†µï¼Œä¿®æ”¹15,16è¡Œçš„rabbitmq-serverç®¡ç†ç«¯å£å’Œç™»å½•ç”¨æˆ·åå¯†ç  2ã€ç¡®è®¤1ä¸­é…ç½®çš„rabbitmqç”¨æˆ·æœ‰ä½ æƒ³ç›‘æ§çš„queue/vhostsçš„æƒé™3ã€å°†è„šæœ¬åŠ å…¥crontabå³å¯æ–°å»ºè„šæœ¬ : vi rabbitmq_cron12* * * * * root (cd /data/program/software/falcon-monit-scripts-master/rabbitmq &amp;&amp; python rabbitmq-monitor.py &gt; /dev/null)cp rabbitmq_cron /etc/cron.d/ æ±‡æŠ¥å­—æ®µ key tag type note rabbitmq.messages_ready name(Queueåå­—) GAUGE é˜Ÿåˆ—ä¸­å¤„äºç­‰å¾…è¢«æ¶ˆè´¹çŠ¶æ€æ¶ˆæ¯æ•° rabbitmq.messages_unacknowledged name(Queueåå­—) GAUGE é˜Ÿåˆ—ä¸­å¤„äºæ¶ˆè´¹ä¸­çŠ¶æ€çš„æ¶ˆæ¯æ•° rabbitmq.messages_total name(Queueåå­—) GAUGE é˜Ÿåˆ—ä¸­æ‰€æœ‰æœªå®Œæˆæ¶ˆè´¹çš„æ¶ˆæ¯æ•°ï¼Œç­‰äºmessages_ready+messages_unacknowledged rabbitmq.ack_rate name(Queueåå­—) GAUGE æ¶ˆè´¹è€…ackçš„é€Ÿç‡ rabbitmq.deliver_rate name(Queueåå­—) GAUGE deliverçš„é€Ÿç‡ rabbitmq.deliver_get_rate name(Queueåå­—) GAUGE deliver_getçš„é€Ÿç‡ rabbitmq.publish_rate name(Queueåå­—) GAUGE publishçš„é€Ÿç‡ å®Œå…¨ç‰‡ç»“æŸï¼Œè§‰å¾—æˆ‘å†™çš„ä¸é”™ï¼Ÿæƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿèµ¶å¿«æ‰“å¼€æˆ‘çš„ğŸ‘‰ä¸ªäººåšå®¢ ğŸ‘ˆå§ï¼ è°¢è°¢ä½ é‚£ä¹ˆå¯çˆ±ï¼Œè¿˜ä¸€ç›´å…³æ³¨ç€æˆ‘~â¤ğŸ˜]]></content>
      <tags>
        <tag>åˆ†äº«</tag>
        <tag>è½¯ä»¶æ•™å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¸€æ¬¡Gitlabå®‰è£…å¹¶ä¸Gitbooké›†æˆçš„ç»å†]]></title>
    <url>%2F2019%2F01%2F25%2F%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1Gitlab%E5%AE%89%E8%A3%85%E5%B9%B6%E4%B8%8EGitbook%E9%9B%86%E6%88%90%E7%9A%84%E7%BB%8F%E5%8E%86%2F</url>
    <content type="text"><![CDATA[è€æ¿ä»Šå¤©åˆæ¥æéœ€æ±‚å•¦d=====(ï¿£â–½ï¿£*)b éœ€è¦æŠŠå…¬å¸çš„ä¸€äº›æŠ€æœ¯æ–‡æ¡£æ”¾åˆ°ä¸€ä¸ªå¹³å°ä¸Šï¼Œå‘˜å·¥é˜…è¯»ï¼ŒåŒæ—¶æ–‡æ¡£è¦æœ‰è¾ƒå¥½çš„ç»´æŠ¤æ€§ï¼Œæˆæœ¬å°½å¯èƒ½ä½ã€‚ æ‰€ä»¥ï¼Œå°±æœ‰ä»Šå¤©åšå®¢çš„å†…å®¹äº†ï¼ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢https://blog.tengshe789.tech/ï¼ˆğŸ˜˜ å®‰è£…gitlab1. å®‰è£…å¹¶é…ç½®å¿…è¦çš„ä¾èµ–å…³ç³»åœ¨CentOS 7ï¼ˆå’ŒRedHat / Oracle / Scientific Linux 7ï¼‰ä¸Šï¼Œä»¥ä¸‹å‘½ä»¤è¿˜å°†åœ¨ç³»ç»Ÿé˜²ç«å¢™ä¸­æ‰“å¼€HTTPå’ŒSSHè®¿é—®ã€‚ 12345sudo yum install -y curl policycoreutils-python openssh-serversudo systemctl enable sshdsudo systemctl start sshdsudo firewall-cmd --permanent --add-service=httpsudo systemctl reload firewalld æ¥ä¸‹æ¥ï¼Œå®‰è£…Postfixä»¥å‘é€é€šçŸ¥ç”µå­é‚®ä»¶ã€‚å¦‚æœæ‚¨æƒ³ä½¿ç”¨å…¶ä»–è§£å†³æ–¹æ¡ˆå‘é€ç”µå­é‚®ä»¶ï¼Œè¯·åœ¨å®‰è£…GitLabåè·³è¿‡æ­¤æ­¥éª¤å¹¶[é…ç½®å¤–éƒ¨SMTPæœåŠ¡å™¨]ï¼ˆhttps://docs.gitlab.com/omnibus/settings/smtp.htmlï¼‰ã€‚ 123sudo yum install postfixsudo systemctl enable postfixsudo systemctl start postfix åœ¨Postfixå®‰è£…æœŸé—´ï¼Œå¯èƒ½ä¼šå‡ºç°é…ç½®å±å¹•ã€‚é€‰æ‹©â€œInternet Siteâ€å¹¶æŒ‰Enteré”®ã€‚ä½¿ç”¨æœåŠ¡å™¨çš„å¤–éƒ¨DNSä½œä¸ºâ€œé‚®ä»¶åç§°â€ï¼Œç„¶åæŒ‰Enteré”®ã€‚å¦‚æœå‡ºç°å…¶ä»–å±å¹•ï¼Œè¯·ç»§ç»­æŒ‰Enteré”®æ¥å—é»˜è®¤å€¼ã€‚ 2. æ·»åŠ GitlabåŒ…å­˜å‚¨åº“å¹¶å®‰è£…åŒ…Add the GitLab package repository. 1curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash æ¥ä¸‹æ¥ï¼Œå®‰è£…GitLabåŒ…ã€‚å°†httpï¼š// gitlab.example.comæ›´æ”¹ä¸ºæ‚¨è¦è®¿é—®GitLabå®ä¾‹çš„URLã€‚å®‰è£…å°†è‡ªåŠ¨é…ç½®å¹¶å¯åŠ¨è¯¥URLçš„GitLabã€‚ HTTPSåœ¨å®‰è£…åéœ€è¦å…¶ä»–é…ç½®ã€‚ 1sudo EXTERNAL_URL="http://192.168.190.132:33333" yum install -y gitlab-ee 3. ç™»é™†å¹¶éªŒè¯åœ¨æ‚¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶ï¼Œæ‚¨å°†è¢«é‡å®šå‘åˆ°å¯†ç é‡ç½®å±å¹•ã€‚æä¾›åˆå§‹ç®¡ç†å‘˜å¸æˆ·çš„å¯†ç ï¼Œæ‚¨å°†è¢«é‡å®šå‘å›ç™»å½•å±å¹•ã€‚ä½¿ç”¨é»˜è®¤å¸æˆ·çš„ç”¨æˆ·årootç™»å½•ã€‚ See our documentation for detailed instructions on installing and configuration. ä¸gitbooké›†æˆå®‰è£…nodeJsåªèƒ½å®‰è£…ç¬¬ä¸‰æ–¹ä»“åº“ä¸­å­˜åœ¨çš„ç‰ˆæœ¬ï¼Œä¸€èˆ¬è½å node æœ€æ–°ç‰ˆæœ¬ å®‰è£…EPEL ä»“åº“yum install epel-release å®‰è£… nodejsyum install nodejs å®‰è£… npm yum install npm å®‰è£…gitbookGitBook æ˜¯ä¸€ä¸ªåŸºäº Node.js çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä½¿ç”¨ Github/Git å’Œ Markdown æ¥åˆ¶ä½œç²¾ç¾çš„ç”µå­ä¹¦ã€‚GitBookæ”¯æŒè¾“å‡ºä»¥ä¸‹å‡ ç§æ–‡æ¡£æ ¼å¼ é™æ€ç«™ç‚¹ï¼šGitBooké»˜è®¤è¾“å‡ºè¯¥ç§æ ¼å¼ PDFï¼šéœ€è¦å®‰è£…gitbook-pdfä¾èµ– eBookï¼šéœ€è¦å®‰è£…ebook-convert 12npm install gitbook -gnpm install -g gitbook-cli QA å‡ºç°npm ERR! Error: connect ECONNREFUSED 104.16.24.35:443é—®é¢˜ä½¿ç”¨å¦‚ä¸‹è¯­å¥å…³é—­ä»£ç†è§£å†³é—®é¢˜ï¼šnpm config set proxy null å®‰è£…GitLab Ci Runner æ·»åŠ repositorycurl -L https://packages.gitlab.com/install/repositories/runner/gitlab-ci-multi-runner/script.rpm.sh | sudo bash å®‰è£…åŒ…yum install gitlab-runner æ‰§è¡Œä¸Šè¿°å‘½ä»¤ä¹‹åï¼Œä¹‹åçš„æµç¨‹å¦‚ä¸‹ï¼š ç¬¬ä¸€å¤„çº¢çº¿ï¼šè¾“å…¥éƒ¨ç½²å®Œæˆçš„gitlabåœ°å€æ¯”å¦‚http://111.111.111.111:8080/ ç¬¬äºŒå¤„çº¢çº¿: ç™»é™†gitlabï¼Œå…ˆç‚¹å‡»å³ä¸Šæ–¹Admin Settingsï¼Œå†æ‰¾åˆ°å·¦ä¾§åˆ—è¡¨çš„ä¸­çš„overviewä¸€æ æ‰¾åˆ°runneré€‰é¡¹ï¼Œæ‰¾åˆ°å¹¶åœ¨shellä¸­è¾“å…¥token. å‰©ä¸‹çš„è¿‡ç¨‹éšä¾¿å†™å³å¯ æœ€åçœ‹åˆ°Runner registered successfullyè¡¨ç¤ºæ³¨å†ŒæˆåŠŸã€‚ æœ€åå¯ä»¥ç™»å½•gitlabè¿›è¡ŒéªŒè¯ï¼Œæœ‰å¦‚å›¾æ‰€æœ‰åˆ—è¡¨è¯´æ˜æ³¨å†ŒæˆåŠŸ é…ç½®æŒç»­é›†æˆhttps://docs.gitlab.com/ce/ci/quick_start/README.html#creating-a-gitlab-ciyml-file åœ¨ä»“åº“ä¸‹ï¼Œåˆ›å»º.gitlab-ci.yml,å†™å…¥ä»¥ä¸‹é…ç½®ï¼š 123456789stages: - buildGenerateHTML: stage: build script: - p=`pwd` - echo $p - gitbook build - gitbook serve æ‰“å¼€gitlabé‡Œé¢çš„pinelineï¼ŒæŸ¥çœ‹logã€‚ QA å‡ºç°This job is in pending state and is waiting to be picked by a runneré”™è¯¯ è§£å†³ï¼šæ²¡æ‰¾åˆ°ä¼˜é›…çš„æ–¹å¼ã€‚ç²—æš´ç‚¹ï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨ç«¯é‡å¯runnerï¼Œä½¿ç”¨å‘½ä»¤gitlab-ci-multi-runner restartã€‚ æœ¬åœ°ä½¿ç”¨ å°†ä»“åº“cloneä¸‹æ¥ï¼Œgitbook init bookname å‰µå»ºæ›¸åçˆ²booknameçš„æ›¸ å†™ä¹¦ï¼Œå¿…è¦æ—¶ä½¿ç”¨gitbook serve é¢„è§ˆä¹¦ã€‚ åˆ›å»º.gitlab-ci.yml,å†™å…¥é…ç½®ã€‚ç„¶åä½¿ç”¨gitå‘½ä»¤ä¸Šä¼ åˆ°ä¹¦åº“ã€‚ QA CI/CDçš„logç•Œé¢å‡ºç°æ— æ³•åˆ é™¤å›¾ä¹¦é”™è¯¯ è§£å†³ï¼š CI/CDå›¾å½¢ç•Œé¢ï¼Œå³ä¾§ï¼Œç‚¹å‡»cancelå³å¯ã€‚ å‡ºç°RangeError: Maximum call stack size exceededé”™è¯¯ è§£å†³ï¼š æ–‡ç« å†…å®¹è¿‡é•¿ï¼Œå¯¼è‡´jså †æ ˆæº¢å‡ºã€‚ å‚è€ƒgitbooké…ç½®å®ä¾‹https://gitlab.com/pages/gitbook#building-locally å…¶å®ç±»ä¼¼gitbookçš„è½¯ä»¶è¿˜æœ‰å¾ˆå¤šï¼Œå°±è­¬å¦‚docsifyï¼Œå¤§å®¶å¯ä»¥å¤šæŸ¥é˜…ç›¸å…³èµ„æ–™ä½¿ç”¨ã€‚ å®Œå…¨ç‰‡ç»“æŸï¼Œè§‰å¾—æˆ‘å†™çš„ä¸é”™ï¼Ÿæƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿèµ¶å¿«æ‰“å¼€æˆ‘çš„ğŸ‘‰ä¸ªäººåšå®¢ ğŸ‘ˆå§ï¼ è°¢è°¢ä½ é‚£ä¹ˆå¯çˆ±ï¼Œè¿˜ä¸€ç›´å…³æ³¨ç€æˆ‘~â¤ğŸ˜]]></content>
      <tags>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
        <tag>åˆ†äº«</tag>
        <tag>è½¯ä»¶æ•™å­¦</tag>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä»0å¼€å§‹éƒ¨ç½²Rancher2.0åˆ°å¾®æœåŠ¡å®¹å™¨éƒ¨ç½²ä¸æŒç»­é›†æˆ]]></title>
    <url>%2F2019%2F01%2F22%2F%E4%BB%8E0%E5%BC%80%E5%A7%8B%E9%83%A8%E7%BD%B2Rancher2-0%2F</url>
    <content type="text"><![CDATA[Rancheræ˜¯ä¸€ä¸ªå¼€æºçš„ä¼ä¸šçº§å®¹å™¨ç®¡ç†å¹³å°ã€‚é€šè¿‡Rancherï¼Œä¼ä¸šå†ä¹Ÿä¸å¿…è‡ªå·±ä½¿ç”¨ä¸€ç³»åˆ—çš„å¼€æºè½¯ä»¶å»ä»å¤´æ­å»ºå®¹å™¨æœåŠ¡å¹³å°ã€‚Rancheræä¾›äº†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨çš„ç®¡ç†Dockerå’ŒKubernetesçš„å…¨æ ˆåŒ–å®¹å™¨éƒ¨ç½²ä¸ç®¡ç†å¹³å°ã€‚ä»Šå¤©åˆ†äº«ä¸€ä¸‹æˆ‘ä»0å¼€å§‹éƒ¨ç½²Rancher2.0åˆ°å¾®æœåŠ¡å®¹å™¨éƒ¨ç½²ä¸æŒç»­é›†æˆçš„å†ç¨‹ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢https://blog.tengshe789.tech/ï¼ˆğŸ˜˜ dockerå®‰è£…è¯·çœ‹æˆ‘ä¸Šç¯‡åšæ–‡ã€‚ å®¹å™¨ä¸‹å®‰è£…rancheråŸºç¡€ç¯å¢ƒé…ç½®åˆ‡æ¢åˆ°å—æ”¯æŒçš„dockerç‰ˆæœ¬1sudo ros engine switch docker-17.03.2-ce å…³é—­é˜²ç«å¢™(å¯é€‰)æˆ–è€…æ”¾è¡Œç›¸åº”ç«¯å£å¯¹äºåˆšåˆšæ¥è§¦Rancherçš„ç”¨æˆ·ï¼Œå»ºè®®åœ¨å…³é—­é˜²ç«å¢™çš„æµ‹è¯•ç¯å¢ƒæˆ–æ¡Œé¢è™šæ‹Ÿæœºæ¥è¿è¡Œrancherï¼Œä»¥é¿å…å‡ºç°ç½‘ç»œé€šä¿¡é—®é¢˜ã€‚ å…³é—­é˜²ç«å¢™ 1ã€CentOS systemctl stop firewalld.service &amp;&amp; systemctl disable firewalld.service 2ã€Ubuntu ufw disable ç«¯å£æ”¾è¡Œ ç«¯å£æ”¾è¡Œè¯·æŸ¥çœ‹ç«¯å£éœ€æ±‚ CentOSå…³é—­selinux1sudo sed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config é…ç½®ä¸»æœºæ—¶é—´ã€æ—¶åŒºã€ç³»ç»Ÿè¯­è¨€ æŸ¥çœ‹æ—¶åŒº date -Ræˆ–è€…timedatectl ä¿®æ”¹æ—¶åŒº ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime ä¿®æ”¹ç³»ç»Ÿè¯­è¨€ç¯å¢ƒ sudo echo &#39;LANG=&quot;en_US.UTF-8&quot;&#39; &gt;&gt; /etc/profile;source /etc/profile é…ç½®ä¸»æœºNTPæ—¶é—´åŒæ­¥ Kernelæ€§èƒ½è°ƒä¼˜1234567cat &gt;&gt; /etc/sysctl.conf&lt;&lt;EOFnet.ipv4.ip_forward=1net.bridge.bridge-nf-call-iptables=1net.ipv4.neigh.default.gc_thresh1=4096net.ipv4.neigh.default.gc_thresh2=6144net.ipv4.neigh.default.gc_thresh3=8192EOF Hostsé…ç½®æ¯å°ä¸»æœºçš„hosts(/etc/hosts),æ·»åŠ host_ip $hostnameåˆ°/etc/hostsæ–‡ä»¶ä¸­ã€‚ å®‰è£…è¿è¡Œrancherç½‘ç»œç»„ä»¶å®‰è£…rancherä»¥åå¯èƒ½ä¼šç¢°åˆ°ä¸€äº›è«åå…¶å¦™çš„è¿æ¥é—®é¢˜ï¼Œè­¬å¦‚æ‰¾ä¸åˆ°å‘½åè™šæ‹Ÿæœºä¸‹èƒ½ä½¿ç”¨curlå‘½åè®¿é—®å…¶ä»–è™šæ‹Ÿæœºï¼Œä½†æ˜¯å®¹å™¨å´ä¸èƒ½è®¿é—®å…¶ä»–å®¹å™¨ï¼Œè¿™æ—¶å€™å°±éœ€è¦å…ˆå®‰è£…weaveç½‘ç»œç»„ä»¶äº†ã€‚ 1docker pull weaveworks/weave-npc:2.5.0 æ­£å¼å®‰è£…å¯ä»¥å‚è€ƒå¦‚ä¸‹å‘½ä»¤å®‰è£…rancher 1sudo docker run -d --restart=unless-stopped -p 80:80 -p 443:443 rancher/rancher å½“ç„¶å‘½ä»¤å¯ä»¥æ‰©å±•ï¼Œè¯¦æƒ…è§„åˆ™å¦‚ä¸‹ï¼š 1$sudo docker run -d -v &lt;ä¸»æœºè·¯å¾„&gt;:/var/lib/rancher/ --restart=unless-stopped -p 80:80 -p 443:443 rancher/rancher:stable ç™»é™†rancherRancher Serverå®¹å™¨å¯åŠ¨å¾ˆå¿«é€Ÿï¼Œä¸åˆ°ä¸€åˆ†é’Ÿä½ å°±å¯ä»¥é€šè¿‡https://&lt;server_ip&gt;è®¿é—®Rancher UIã€‚ ç¬¬ä¸€æ¬¡ç™»å½•ä¼šè¦æ±‚è®¾ç½®ç®¡ç†å‘˜å¯†ç ï¼Œé»˜è®¤ç®¡ç†å‘˜è´¦å·ä¸º: adminã€‚ä¸€æ—¦Rancher ServeræˆåŠŸå®‰è£…ï¼Œç”¨æˆ·ç•Œé¢å°†æŒ‡å¯¼ä½ æ·»åŠ ç¬¬ä¸€ä¸ªé›†ç¾¤ åˆ›å»ºK8Sé›†ç¾¤é¦–å…ˆï¼Œå³ä¸‹è§’æ‰¾è¯­è¨€é€‰é¡¹ï¼Œé€‰ä¸­æ–‡ã€‚ç‚¹å‡»æ·»åŠ é›†ç¾¤ã€‚ æ¥ä¸‹æ¥å†™ä¸€ä¸‹é›†ç¾¤çš„åç§°ï¼Œç‚¹å¼€å¦‚å›¾æ‰€ç¤ºçš„é€‰é¡¹ï¼ŒæŠŠå‘½ä»¤å¤åˆ¶ä¸€ä¸‹ï¼Œç²˜è´´åˆ°å®¿ä¸»æœºä¸­è¿è¡Œã€‚ æ³¨æ„ï¼Œrancher2.0åŸºäºk8sï¼Œè€Œk8séœ€è¦etcdèŠ‚ç‚¹å’ŒcontrolèŠ‚ç‚¹ã€‚ç°åœ¨ï¼Œrancherä¼šè‡ªåŠ¨å¸®ä½ å‹¾é€‰ä¸ŠworkerèŠ‚ç‚¹ï¼Œå¦‚æœä½ æ˜¯å•æœºç¯å¢ƒï¼Œå¿…é¡»è¦å…¨éƒ¨å‹¾é€‰è¿™ä¸‰ä¸ªä¸»æœºè§’è‰²åœ¨å¤åˆ¶å‘½ä»¤ã€‚ Dockerç§æœ‰ä»“åº“ç§æœ‰ä»“åº“æ­å»ºä¸é…ç½®ï¼ˆ1ï¼‰æ‹‰å–ç§æœ‰ä»“åº“é•œåƒï¼ˆæ­¤æ­¥çœç•¥ï¼‰1docker pull registry ï¼ˆ2ï¼‰å¯åŠ¨ç§æœ‰ä»“åº“å®¹å™¨1docker run -di --name=registry -p 5000:5000 registry ï¼ˆ3ï¼‰æ‰“å¼€æµè§ˆå™¨ è¾“å…¥åœ°å€http://192.168.190.137:5000/v2/_catalog çœ‹åˆ°123&#123;repositories: [ ]&#125; è¡¨ç¤ºç§æœ‰ä»“åº“æ­å»ºæˆåŠŸå¹¶ä¸”å†…å®¹ä¸ºç©º ï¼ˆ4ï¼‰ä¿®æ”¹dockerçš„daemon.json1vim /etc/docker/daemon.json æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š123&#123; "insecure-registries":[&lt;server ip&gt;:5000]&#125; ï¼ˆ5ï¼‰é‡å¯docker æœåŠ¡æ³¨æ„ï¼Œå¦‚æœä¸Šé¢çš„daemon.jsonæ ¼å¼å‡ºé”™ï¼Œæ­¤ä½¿dockerä¼šæŠ¥é”™ï¼Œå¯åŠ¨èµ·ä¸æ¥ã€‚è¯·ä»”ç»†æŸ¥çœ‹ã€‚1systemctl restart docker é•œåƒä¸Šä¼ è‡³ç§æœ‰ä»“åº“ï¼ˆ1ï¼‰æ ‡è®°æ­¤é•œåƒä¸ºç§æœ‰ä»“åº“çš„é•œåƒ1docker tag &lt;imgName&gt; &lt;server ip&gt;:5000/&lt;ä»“åº“ name&gt; ï¼ˆ2ï¼‰å†æ¬¡å¯åŠ¨ç§æœå®¹å™¨1docker start registry ï¼ˆ3ï¼‰ä¸Šä¼ æ ‡è®°çš„é•œåƒ1docker push &lt;server ip&gt;:5000/&lt;ä»“åº“ name&gt; æ›´å¤šç§æœ‰ä»“åº“ç»å†è¿‡ç‰ˆæœ¬è¿­ä»£ï¼Œä¹Ÿæœ‰æˆæƒè®¤è¯ç­‰åŠŸèƒ½ï¼Œæƒ³è¦äº†è§£æ›´å¤šèµ„æ–™è¯·çœ‹åšæ–‡ï¼Œhttps://www.cnblogs.com/wade-luffy/p/6590849.html dockerfileDockerfileæ˜¯ç”±ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°æ„æˆçš„è„šæœ¬ï¼Œè¿™äº›å‘½ä»¤åº”ç”¨äºåŸºç¡€é•œåƒå¹¶æœ€ç»ˆåˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒã€‚ å¯¹äºå¼€å‘äººå‘˜ï¼šå¯ä»¥ä¸ºå¼€å‘å›¢é˜Ÿæä¾›ä¸€ä¸ªå®Œå…¨ä¸€è‡´çš„å¼€å‘ç¯å¢ƒï¼› å¯¹äºæµ‹è¯•äººå‘˜ï¼šå¯ä»¥ç›´æ¥æ‹¿å¼€å‘æ—¶æ‰€æ„å»ºçš„é•œåƒæˆ–è€…é€šè¿‡Dockerfileæ–‡ä»¶æ„å»ºä¸€ä¸ªæ–°çš„é•œåƒå¼€å§‹å·¥ä½œäº†ï¼› å¯¹äºè¿ç»´äººå‘˜ï¼šåœ¨éƒ¨ç½²æ—¶ï¼Œå¯ä»¥å®ç°åº”ç”¨çš„æ— ç¼ç§»æ¤ dockerfileå†…å®¹è¯¦è§£1234567891011121314151617181920# FROM : æŒ‡å®šåŸºç¡€é•œåƒï¼Œè¦åœ¨å“ªä¸ªé•œåƒå»ºç«‹FROM anapsix/alpine-java:8_server-jre_unlimited ## æˆ‘è¦çš„å¾®æœåŠ¡éœ€è¦ä¾èµ–jreç¯å¢ƒ# å®¹å™¨å·ï¼ŒæŒä¹…åŒ–çš„ç¯å¢ƒVOLUME /tmp# MAINTAINERï¼šæŒ‡å®šç»´æŠ¤è€…ä¿¡æ¯MAINTAINER randyvan007@qq.com# RUNï¼šåœ¨é•œåƒä¸­è¦æ‰§è¡Œçš„å‘½ä»¤ è¿™ä¸ªå‘½åæ˜¯åŒæ­¥å®¹å™¨å†…æ—¶é—´ï¼Œé˜²æ­¢éƒ¨åˆ†æ“ä½œå‡ºé”™çš„ã€‚ä¸éœ€è¦å¯ä»¥ä¸æ‰§è¡ŒRUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtimeRUN mkdir -p /miaosha-redis# WORKDIRï¼šæŒ‡å®šå½“å‰å·¥ä½œç›®å½•ï¼Œç›¸å½“äº cdWORKDIR /miaosha-redis# EXPOSEï¼šæŒ‡å®šå®¹å™¨è¦æ‰“å¼€çš„ç«¯å£EXPOSE 8080# ADDï¼šç›¸å½“äº COPYï¼Œä½†æ˜¯æ¯” COPY åŠŸèƒ½æ›´å¼ºå¤§ COPY ï¼šå¤åˆ¶æœ¬åœ°ä¸»æœºçš„ ï¼ˆä¸º Dockerfile æ‰€åœ¨ç›®å½•çš„ç›¸å¯¹è·¯å¾„ï¼‰åˆ°å®¹å™¨ä¸­çš„ADD ./miaosha-redis/target/miaosha-redis.jar ./# å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡ŒæŒ‡ä»¤ENTRYPOINT ["java", "-Djava.security.egd=file:/dev/./urandom", "-jar", "app.jar"]# å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡ŒæŒ‡ä»¤CMD ["--spring.profiles.active=test"] æ‰§è¡Œå‘½ä»¤æ„å»ºé•œåƒåœ¨dockerfileçš„ç›®å½•ä¸‹ï¼Œè¾“å…¥1docker build [options] PATH | URL docker buildï¼š ç”¨ Dockerfile æ„å»ºé•œåƒçš„å‘½ä»¤å…³é”®è¯ã€‚ [OPTIONS] : å‘½ä»¤é€‰é¡¹ï¼Œå¸¸ç”¨çš„æŒ‡ä»¤åŒ…æ‹¬ -t æŒ‡å®šé•œåƒçš„åå­—ï¼Œ-f æ˜¾ç¤ºæŒ‡å®šæ„å»ºé•œåƒçš„ Dockerfile æ–‡ä»¶ï¼ˆDockerfile å¯ä¸åœ¨å½“å‰è·¯å¾„ä¸‹ï¼‰ï¼Œå¦‚æœä¸ä½¿ç”¨ -fï¼Œåˆ™é»˜è®¤å°†ä¸Šä¸‹æ–‡è·¯å¾„ä¸‹çš„åä¸º Dockerfile çš„æ–‡ä»¶è®¤ä¸ºæ˜¯æ„å»ºé•œåƒçš„ â€œDockerfileâ€ ã€‚ ä¸Šä¸‹æ–‡è·¯å¾„|URLï¼š æŒ‡å®šæ„å»ºé•œåƒçš„ä¸Šä¸‹æ–‡çš„è·¯å¾„ï¼Œæ„å»ºé•œåƒçš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ä¸”åªå¯ä»¥å¼•ç”¨ä¸Šä¸‹æ–‡ä¸­çš„ä»»ä½•æ–‡ä»¶ ã€‚ æŸ¥çœ‹é•œåƒæ˜¯å¦å»ºç«‹å®Œæˆ1docker images åˆ›å»ºå®¹å™¨1docker run -di --name=æ™¯è±¡åç§° /bin/bash å¾®æœåŠ¡éƒ¨ç½²å¾®æœåŠ¡éƒ¨ç½²æœ‰ä¸¤ç§æ–¹æ³•ï¼š æ‰‹åŠ¨éƒ¨ç½²ï¼š é¦–å…ˆåŸºäºæºç æ‰“åŒ…ç”ŸæˆjaråŒ…ï¼ˆæˆ–waråŒ…ï¼‰,å°†jaråŒ…ï¼ˆæˆ–waråŒ…ï¼‰ä¸Šä¼ è‡³è™šæ‹Ÿæœºå¹¶æ‹·è´è‡³JDKå®¹å™¨ã€‚ é€šè¿‡Mavenæ’ä»¶è‡ªåŠ¨éƒ¨ç½²ã€‚ å¯¹äºæ•°é‡ä¼—å¤šçš„å¾®æœåŠ¡ï¼Œæ‰‹åŠ¨éƒ¨ç½²æ— ç–‘æ˜¯éå¸¸éº»çƒ¦çš„åšæ³•ï¼Œå¹¶ä¸”å®¹æ˜“å‡ºé”™ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œå­¦ä¹ å¦‚ä½•è‡ªåŠ¨éƒ¨ç½²ï¼Œè¿™ä¹Ÿæ˜¯ä¼ä¸šå®é™…å¼€å‘ä¸­ç»å¸¸ä½¿ç”¨çš„æ–¹æ³•ã€‚ Mavenæ’ä»¶è‡ªåŠ¨éƒ¨ç½²æ­¥éª¤ï¼šï¼ˆ1ï¼‰ä¿®æ”¹å®¿ä¸»æœºçš„dockeré…ç½®ï¼Œè®©å…¶å¯ä»¥è¿œç¨‹è®¿é—® 1vi /lib/systemd/system/docker.service å…¶ä¸­ExecStart=åæ·»åŠ é…ç½® â€H tcp://0.0.0.0:2375 â€H unix:///var/run/docker.sock ï¼ˆ2ï¼‰åˆ·æ–°é…ç½®ï¼Œé‡å¯æœåŠ¡ 123systemctl daemonâ€reloadsystemctl restart dockerdocker start registry ï¼ˆ3ï¼‰å¾®æœåŠ¡çš„mavenå·¥ç¨‹pom.xml å¢åŠ é…ç½®123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596 &lt;build&gt; &lt;finalName&gt;$&#123;project.name&#125;&lt;/finalName&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;filtering&gt;true&lt;/filtering&gt; &lt;/resource&gt; &lt;/resources&gt; &lt;pluginManagement&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;version&gt;$&#123;spring-boot.version&#125;&lt;/version&gt; &lt;configuration&gt; &lt;finalName&gt;$&#123;project.build.finalName&#125;&lt;/finalName&gt; &lt;/configuration&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;repackage&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt;&lt;!-- dockerçš„mavenæ’ä»¶ï¼Œå®˜ç½‘ï¼šhttps://github.com/spotify/docker-maven-plugin --&gt; &lt;plugin&gt; &lt;groupId&gt;com.spotify&lt;/groupId&gt; &lt;artifactId&gt;docker-maven-plugin&lt;/artifactId&gt; &lt;version&gt;0.4.12&lt;/version&gt; &lt;configuration&gt; &lt;!-- æ³¨æ„imageNameä¸€å®šè¦æ˜¯ç¬¦åˆæ­£åˆ™[a-z0-9-_.]çš„ï¼Œå¦åˆ™æ„å»ºä¸ä¼šæˆåŠŸ --&gt; &lt;!-- è¯¦è§ï¼šhttps://github.com/spotify/docker-maven-plugin Invalid repository name ... only [a-z0-9-_.] are allowed--&gt; &lt;imageName&gt;$&#123;registry.url&#125;/$&#123;project.name&#125;:0.0.1&lt;/imageName&gt; &lt;dockerHost&gt;$&#123;docker.url&#125;&lt;/dockerHost&gt; &lt;dockerDirectory&gt;$&#123;project.basedir&#125;&lt;/dockerDirectory&gt; &lt;baseImage&gt;java&lt;/baseImage&gt; &lt;entryPoint&gt;["java", "-jar", "/$&#123;project.build.finalName&#125;.jar"]&lt;/entryPoint&gt; &lt;resources&gt; &lt;resource&gt; &lt;targetPath&gt;/&lt;/targetPath&gt; &lt;directory&gt;$&#123;project.build.directory&#125;&lt;/directory&gt; &lt;include&gt;$&#123;project.build.finalName&#125;.jar&lt;/include&gt; &lt;/resource&gt; &lt;/resources&gt; &lt;serverId&gt;docker-hub&lt;/serverId&gt; &lt;registryUrl&gt;https://index.docker.io/v1/&lt;/registryUrl&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;com.spotify&lt;/groupId&gt; &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.4.4&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;default&lt;/id&gt; &lt;goals&gt; &lt;goal&gt;build&lt;/goal&gt; &lt;goal&gt;push&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;javax.activation&lt;/groupId&gt; &lt;artifactId&gt;activation&lt;/artifactId&gt; &lt;version&gt;1.1.1&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;configuration&gt; &lt;!--ä¸Šä¸‹æ–‡è·¯å¾„é…ç½®ï¼Œæ­¤å¤„è®¾ç½®ä¸ºé¡¹ç›®æ ¹è·¯å¾„--&gt; &lt;contextDirectory&gt;$&#123;project.basedir&#125;&lt;/contextDirectory&gt; &lt;useMavenSettingsForAuth&gt;true&lt;/useMavenSettingsForAuth&gt; &lt;repository&gt;$&#123;registryUrl&#125;/hush/$&#123;project.build.finalName&#125;&lt;/repository&gt; &lt;tag&gt;$&#123;imageVersion&#125;&lt;/tag&gt; &lt;!--ä½œä¸ºDockerfileæ–‡ä»¶ä¼ å…¥--&gt; &lt;buildArgs&gt; &lt;JAR_FILE&gt;$&#123;project.build.finalName&#125;.jar&lt;/JAR_FILE&gt; &lt;/buildArgs&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/pluginManagement&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.8.0&lt;/version&gt; &lt;configuration&gt; &lt;target&gt;$&#123;maven.compiler.target&#125;&lt;/target&gt; &lt;source&gt;$&#123;maven.compiler.source&#125;&lt;/source&gt; &lt;encoding&gt;UTF-8&lt;/encoding&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; ä½¿ç”¨ä»¥ä¸Šæ’ä»¶å¯ä»¥è‡ªåŠ¨ç”Ÿæˆdockerfile ï¼ˆ5ï¼‰åœ¨windowsçš„CMDä¸‹ï¼Œè¿›å…¥å¾®æœåŠ¡å·¥ç¨‹æ‰€åœ¨çš„ç›®å½•ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œè¿›è¡Œæ‰“åŒ…å’Œä¸Šä¼ é•œåƒ 1mvn clean package docker:build -DpushImage ï¼ˆ6ï¼‰å»é•œåƒåº“æŸ¥çœ‹é•œåƒæµè§ˆå™¨è®¿é—®http://&lt;server ip&gt;:5000/v2/_catalog ï¼Œè¾“å‡ºäº†æˆ‘ä»¬ä¸Šä¸€æ­¥å‘½åçš„é•œåƒåç§°ï¼Œåˆ™ä¸Šä¼ æˆåŠŸã€‚ ï¼ˆ7ï¼‰åœ¨è™šæ‹ŸæœºæŸ¥çœ‹é•œåƒä¸å¯åŠ¨å®¹å™¨ 1docker images æ‰“å®Œä»¥åæ˜¾ç¤ºé•œåƒåç§°ã€‚ä¸‹é¢è¯¥å¯åŠ¨å®¹å™¨äº†ï¼1docker run -di --name=æœåŠ¡åç§° -p å®¹å™¨å†…æœåŠ¡çš„ç«¯å£å·:å®¹å™¨å‘å¸ƒçš„ç«¯å£å· &lt;server ip&gt;:5000/é•œåƒåç§° æŒç»­é›†æˆæŒç»­éƒ¨ç½²ä»€ä¹ˆæ˜¯æŒç»­é›†æˆæŒç»­é›†æˆ Continuous integration ï¼Œç®€ç§°CIéšç€è½¯ä»¶å¼€å‘å¤æ‚åº¦çš„ä¸æ–­æé«˜ï¼Œå›¢é˜Ÿå¼€å‘æˆå‘˜é—´å¦‚ä½•æ›´å¥½åœ°ååŒå·¥ä½œä»¥ç¡®ä¿è½¯ä»¶å¼€å‘çš„è´¨é‡å·²ç»æ…¢æ…¢æˆä¸ºå¼€å‘è¿‡ç¨‹ä¸­ä¸å¯å›é¿çš„é—®é¢˜ã€‚å°¤å…¶æ˜¯è¿‘äº›å¹´æ¥ï¼Œæ•æ·ï¼ˆAgileï¼‰åœ¨è½¯ä»¶å·¥ç¨‹é¢†åŸŸè¶Šæ¥è¶Šçº¢ç«ï¼Œå¦‚ä½•èƒ½å†ä¸æ–­å˜åŒ–çš„éœ€æ±‚ä¸­å¿«é€Ÿé€‚åº”å’Œä¿è¯è½¯ä»¶çš„è´¨é‡ä¹Ÿæ˜¾å¾—å°¤å…¶çš„é‡è¦ã€‚æŒç»­é›†æˆæ­£æ˜¯é’ˆå¯¹è¿™ä¸€ç±»é—®é¢˜çš„ä¸€ç§è½¯ä»¶å¼€å‘å®è·µã€‚å®ƒå€¡å¯¼å›¢é˜Ÿå¼€å‘æˆå‘˜å¿…é¡»ç»å¸¸é›†æˆä»–ä»¬çš„å·¥ä½œï¼Œç”šè‡³æ¯å¤©éƒ½å¯èƒ½å‘ç”Ÿå¤šæ¬¡é›†æˆã€‚è€Œæ¯æ¬¡çš„é›†æˆéƒ½æ˜¯é€šè¿‡è‡ªåŠ¨åŒ–çš„æ„å»ºæ¥éªŒè¯ï¼ŒåŒ…æ‹¬è‡ªåŠ¨ç¼–è¯‘ã€å‘å¸ƒå’Œæµ‹è¯•ï¼Œä»è€Œå°½å¿«åœ°å‘ç°é›†æˆé”™è¯¯ï¼Œè®©å›¢é˜Ÿèƒ½å¤Ÿæ›´å¿«çš„å¼€å‘å†…èšçš„è½¯ä»¶ã€‚ æŒç»­é›†æˆçš„ç‰¹ç‚¹å®ƒæ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„å‘¨æœŸæ€§çš„é›†æˆæµ‹è¯•è¿‡ç¨‹ï¼Œä»æ£€å‡ºä»£ç ã€ç¼–è¯‘æ„å»ºã€è¿è¡Œæµ‹è¯•ã€ç»“æœè®°å½•ã€æµ‹è¯•ç»Ÿè®¡ç­‰éƒ½æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œæ— éœ€äººå·¥å¹²é¢„ï¼›éœ€è¦æœ‰ä¸“é—¨çš„é›†æˆæœåŠ¡å™¨æ¥æ‰§è¡Œé›†æˆæ„å»ºï¼›éœ€è¦æœ‰ä»£ç æ‰˜ç®¡å·¥å…·æ”¯æŒï¼Œæˆ‘ä»¬ä¸‹ä¸€å°èŠ‚å°†ä»‹ç»Gitä»¥åŠå¯è§†åŒ–ç•Œé¢Gogsçš„ä½¿ç”¨ æŒç»­é›†æˆä½œç”¨ä¿è¯å›¢é˜Ÿå¼€å‘äººå‘˜æäº¤ä»£ç çš„è´¨é‡ï¼Œå‡è½»äº†è½¯ä»¶å‘å¸ƒæ—¶çš„å‹åŠ›ï¼›æŒç»­é›†æˆä¸­çš„ä»»ä½•ä¸€ä¸ªç¯èŠ‚éƒ½æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œæ— éœ€å¤ªå¤šçš„äººå·¥å¹²é¢„ï¼Œæœ‰åˆ©äºå‡å°‘é‡å¤è¿‡ç¨‹ä»¥èŠ‚çœæ—¶é—´ã€è´¹ç”¨å’Œå·¥ä½œé‡ï¼› rancherå’ŒæŒç»­é›†æˆrancheræ”¯æŒä¸GitHubå¹³å°ä¸GitLabå¹³å°æŒç»­é›†æˆã€‚æ¥ä¸‹æ¥æˆ‘ä¼šæ–°å¼€ç¯‡æ–‡ç« è®²è®²gitå¹³å°ç§æœçš„æ­å»ºä»¥åŠæŒç»­é›†æˆã€‚ å‚è€ƒèµ„æ–™rancherå®˜æ–¹æ–‡æ¡£]]></content>
      <tags>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
        <tag>k8s</tag>
        <tag>åˆ†äº«</tag>
        <tag>è½¯ä»¶æ•™å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•docker å®‰è£…ä¸è°ƒä¼˜]]></title>
    <url>%2F2019%2F01%2F18%2F%E8%AE%B0%E5%BD%95docker-%E5%AE%89%E8%A3%85%E4%B8%8E%E8%B0%83%E4%BC%98%2F</url>
    <content type="text"><![CDATA[k8sæ˜¯å®¹å™¨ç¼–æ’ç³»ç»Ÿï¼Œéœ€è¦dockerçš„æ”¯æŒï¼Œä»Šå¤©åˆ†äº«ä¸€æ³¢dockerçš„å®‰è£…ä¸è°ƒä¼˜è¿‡ç¨‹ã€‚ ä¸äº†è§£dockerçš„ç«¥é‹å¯ä»¥å‚è€ƒåšæ–‡ï¼Œæœ¬ç¯‡æ–‡ç« çš„ä¸»é¢˜ä¸åœ¨è®²è§£dockeråŸç†~ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®https://blog.tengshe789.tech/ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ docker å®‰è£…centos7ä¸‹æ›´æ–° yum æº1yum -y update ä¿®æ”¹ç³»ç»Ÿæº 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455sudo cp /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bakcat &gt; /etc/yum.repos.d/CentOS-Base.repo &lt;&lt; EOF[base]name=CentOS-$releasever - Base - mirrors.aliyun.comfailovermethod=prioritybaseurl=http://mirrors.aliyun.com/centos/$releasever/os/$basearch/ http://mirrors.aliyuncs.com/centos/$releasever/os/$basearch/ http://mirrors.cloud.aliyuncs.com/centos/$releasever/os/$basearch/gpgcheck=1gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7#released updates[updates]name=CentOS-$releasever - Updates - mirrors.aliyun.comfailovermethod=prioritybaseurl=http://mirrors.aliyun.com/centos/$releasever/updates/$basearch/ http://mirrors.aliyuncs.com/centos/$releasever/updates/$basearch/ http://mirrors.cloud.aliyuncs.com/centos/$releasever/updates/$basearch/gpgcheck=1gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7#additional packages that may be useful[extras]name=CentOS-$releasever - Extras - mirrors.aliyun.comfailovermethod=prioritybaseurl=http://mirrors.aliyun.com/centos/$releasever/extras/$basearch/ http://mirrors.aliyuncs.com/centos/$releasever/extras/$basearch/ http://mirrors.cloud.aliyuncs.com/centos/$releasever/extras/$basearch/gpgcheck=1gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7#additional packages that extend functionality of existing packages[centosplus]name=CentOS-$releasever - Plus - mirrors.aliyun.comfailovermethod=prioritybaseurl=http://mirrors.aliyun.com/centos/$releasever/centosplus/$basearch/ http://mirrors.aliyuncs.com/centos/$releasever/centosplus/$basearch/ http://mirrors.cloud.aliyuncs.com/centos/$releasever/centosplus/$basearch/gpgcheck=1enabled=0gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7#contrib - packages by Centos Users[contrib]name=CentOS-$releasever - Contrib - mirrors.aliyun.comfailovermethod=prioritybaseurl=http://mirrors.aliyun.com/centos/$releasever/contrib/$basearch/ http://mirrors.aliyuncs.com/centos/$releasever/contrib/$basearch/ http://mirrors.cloud.aliyuncs.com/centos/$releasever/contrib/$basearch/gpgcheck=1enabled=0gpgkey=http://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7EOF å®‰è£… netstatï¼ˆç”¨äºæŸ¥çœ‹å½“å‰æœºå™¨ç«¯å£å ç”¨æƒ…å†µï¼‰1234#å®‰è£…yum install net-tools#ä½¿ç”¨netstat -ntlp æ·»åŠ  yum æº12345678cat &gt;/etc/yum.repos.d/docker.repo &lt;&lt;-EOF [dockerrepo] name=Docker Repository baseurl=https://yum.dockerproject.org/repo/main/centos/7 enabled=1 gpgcheck=1 gpgkey=https://yum.dockerproject.org/gpgEOF å®‰è£… docker1yum install -y docker-selinux 1yum install -y docker-engine é…ç½®docker é…ç½®æ‰€æœ‰ipçš„æ•°æ®åŒ…è½¬å‘ 1234vi /lib/systemd/system/docker.service #æ‰¾åˆ°ExecStart=xxxï¼Œåœ¨è¿™è¡Œä¸‹é¢åŠ å…¥ä¸€è¡Œï¼Œå†…å®¹å¦‚ä¸‹ï¼š(k8sçš„ç½‘ç»œéœ€è¦)ExecStartPost=/sbin/iptables -I FORWARD -s 0.0.0.0/0 -j ACCEPT å¯åŠ¨æœåŠ¡ 12345#è®¾ç½® docker å¼€æœºæœåŠ¡å¯åŠ¨systemctl enable docker.service #ç«‹å³å¯åŠ¨ docker æœåŠ¡$ systemctl start docker.service docker ce å› ä¸ºCentOSçš„å®‰å…¨é™åˆ¶ï¼Œé€šè¿‡RKEå®‰è£…K8Sé›†ç¾¤æ—¶å€™æ— æ³•ä½¿ç”¨rootè´¦æˆ·ã€‚æ‰€ä»¥ï¼Œå»ºè®®CentOSç”¨æˆ·ä½¿ç”¨érootç”¨æˆ·æ¥è¿è¡Œdocker,ä¸ç®¡æ˜¯RKEè¿˜æ˜¯customå®‰è£…k8s,è¯¦æƒ…æŸ¥çœ‹æ— æ³•ä¸ºä¸»æœºé…ç½®SSHéš§é“ã€‚ 1234567891011121314151617181920212223242526272829303132333435# æ·»åŠ ç”¨æˆ·(å¯é€‰)sudo adduser `&lt;new_user&gt;`# ä¸ºæ–°ç”¨æˆ·è®¾ç½®å¯†ç sudo passwd `&lt;new_user&gt;`# ä¸ºæ–°ç”¨æˆ·æ·»åŠ sudoæƒé™sudo echo '&lt;new_user&gt; ALL=(ALL) ALL' &gt;&gt; /etc/sudoers# å¸è½½æ—§ç‰ˆæœ¬Dockerè½¯ä»¶sudo yum remove docker \ docker-client \ docker-client-latest \ docker-common \ docker-latest \ docker-latest-logrotate \ docker-logrotate \ docker-selinux \ docker-engine-selinux \ docker-engine \ container*# å®šä¹‰å®‰è£…ç‰ˆæœ¬export docker_version=17.03.2# step 1: å®‰è£…å¿…è¦çš„ä¸€äº›ç³»ç»Ÿå·¥å…·sudo yum update -ysudo yum install -y yum-utils device-mapper-persistent-data lvm2 bash-completion# Step 2: æ·»åŠ è½¯ä»¶æºä¿¡æ¯sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo# Step 3: æ›´æ–°å¹¶å®‰è£… Docker-CEsudo yum makecache allversion=$(yum list docker-ce.x86_64 --showduplicates | sort -r|grep $&#123;docker_version&#125;|awk '&#123;print $2&#125;')sudo yum -y install --setopt=obsoletes=0 docker-ce-$&#123;version&#125; docker-ce-selinux-$&#123;version&#125;# å¦‚æœå·²ç»å®‰è£…é«˜ç‰ˆæœ¬Docker,å¯è¿›è¡Œé™çº§å®‰è£…(å¯é€‰)yum downgrade --setopt=obsoletes=0 -y docker-ce-$&#123;version&#125; docker-ce-selinux-$&#123;version&#125;# æŠŠå½“å‰ç”¨æˆ·åŠ å…¥dockerç»„sudo usermod -aG docker `&lt;new_user&gt;`# è®¾ç½®å¼€æœºå¯åŠ¨sudo systemctl enable docker Ubuntuä¸‹å¸è½½æ—§ç‰ˆæœ¬(å¦‚æœæœ‰çš„è¯)1$ apt-get remove docker docker-engine docker.io æ›´æ–°apt-getæº1$ add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" ä¿®æ”¹ç³»ç»Ÿæº 1234567891011121314151617sudo cp /etc/apt/sources.list /etc/apt/sources.list.bakcat &gt; /etc/apt/sources.list &lt;&lt; EOFdeb http://mirrors.aliyun.com/ubuntu/ xenial maindeb-src http://mirrors.aliyun.com/ubuntu/ xenial maindeb http://mirrors.aliyun.com/ubuntu/ xenial-updates maindeb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates maindeb http://mirrors.aliyun.com/ubuntu/ xenial universedeb-src http://mirrors.aliyun.com/ubuntu/ xenial universedeb http://mirrors.aliyun.com/ubuntu/ xenial-updates universedeb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates universedeb http://mirrors.aliyun.com/ubuntu/ xenial-security maindeb-src http://mirrors.aliyun.com/ubuntu/ xenial-security maindeb http://mirrors.aliyun.com/ubuntu/ xenial-security universedeb-src http://mirrors.aliyun.com/ubuntu/ xenial-security universeEOF 1$ apt-get update å®‰è£…aptçš„httpsæ”¯æŒåŒ…å¹¶æ·»åŠ gpgç§˜é’¥123456$ apt-get install \ apt-transport-https \ ca-certificates \ curl \ software-properties-common$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add - å®‰è£…docker-ce å®‰è£…æœ€æ–°çš„ç¨³å®šç‰ˆ 1$ apt-get install -y docker-ce å®‰è£…æŒ‡å®šç‰ˆæœ¬ 12345#è·å–ç‰ˆæœ¬åˆ—è¡¨$ apt-cache madison docker-ce #æŒ‡å®šç‰ˆæœ¬å®‰è£…(æ¯”å¦‚ç‰ˆæœ¬æ˜¯17.09.1~ce-0~ubuntu)$ apt-get install -y docker-ce=17.09.1~ce-0~ubuntu æ¥å—æ‰€æœ‰ipçš„æ•°æ®åŒ…è½¬å‘ 1234$ vi /lib/systemd/system/docker.service #æ‰¾åˆ°ExecStart=xxxï¼Œåœ¨è¿™è¡Œä¸Šé¢åŠ å…¥ä¸€è¡Œï¼Œå†…å®¹å¦‚ä¸‹ï¼š(k8sçš„ç½‘ç»œéœ€è¦)ExecStartPost=/sbin/iptables -I FORWARD -s 0.0.0.0/0 -j ACCEPT å¯åŠ¨æœåŠ¡ 12$ systemctl daemon-reload$ service docker start é‡åˆ°é—®é¢˜å¯ä»¥å‚è€ƒï¼š[å®˜æ–¹æ•™ç¨‹][1] éƒ¨ç½²k8så‰ç³»ç»Ÿçš„è®¾ç½®å…³é—­ã€ç¦ç”¨é˜²ç«å¢™(è®©æ‰€æœ‰æœºå™¨ä¹‹é—´éƒ½å¯ä»¥é€šè¿‡ä»»æ„ç«¯å£å»ºç«‹è¿æ¥)123$ ufw disable#æŸ¥çœ‹çŠ¶æ€$ ufw status è®¾ç½®ç³»ç»Ÿå‚æ•° - å…è®¸è·¯ç”±è½¬å‘ï¼Œä¸å¯¹bridgeçš„æ•°æ®è¿›è¡Œå¤„ç†123456789#å†™å…¥é…ç½®æ–‡ä»¶$ cat &lt;&lt;EOF &gt; /etc/sysctl.d/k8s.confnet.ipv4.ip_forward = 1net.bridge.bridge-nf-call-ip6tables = 1net.bridge.bridge-nf-call-iptables = 1EOF #ç”Ÿæ•ˆé…ç½®æ–‡ä»¶$ sysctl -p /etc/sysctl.d/k8s.conf é…ç½®hostæ–‡ä»¶1234567#é…ç½®hostï¼Œä½¿æ¯ä¸ªNodeéƒ½å¯ä»¥é€šè¿‡åå­—è§£æåˆ°ipåœ°å€$ vim /etc/hosts#åŠ å…¥å¦‚ä¸‹ç‰‡æ®µ(ipåœ°å€å’Œservernameæ›¿æ¢æˆè‡ªå·±çš„)192.168.190.137 ubuntu01192.168.190.136 ubuntu03192.168.190.132 centos7192.168.190.135 ubuntu02 è°ƒä¼˜å¯¹äºé€šè¿‡systemdæ¥ç®¡ç†æœåŠ¡çš„ç³»ç»Ÿ(æ¯”å¦‚CentOS7.Xã€Ubuntu16.X), Dockeræœ‰ä¸¤å¤„å¯ä»¥é…ç½®å‚æ•°: ä¸€ä¸ªæ˜¯docker.serviceæœåŠ¡é…ç½®æ–‡ä»¶,ä¸€ä¸ªæ˜¯Docker daemoné…ç½®æ–‡ä»¶daemon.jsonã€‚ docker.service å¯¹äºCentOSç³»ç»Ÿï¼Œdocker.serviceé»˜è®¤ä½äº/usr/lib/systemd/system/docker.serviceï¼›å¯¹äºUbuntuç³»ç»Ÿï¼Œdocker.serviceé»˜è®¤ä½äº/lib/systemd/system/docker.service daemon.json daemon.jsoné»˜è®¤ä½äº/etc/docker/daemon.jsonï¼Œå¦‚æœæ²¡æœ‰å¯æ‰‹åŠ¨åˆ›å»ºï¼ŒåŸºäºsystemdç®¡ç†çš„ç³»ç»Ÿéƒ½æ˜¯ç›¸åŒçš„è·¯å¾„ã€‚é€šè¿‡ä¿®æ”¹daemon.jsonæ¥æ”¹è¿‡Dockeré…ç½®ï¼Œä¹Ÿæ˜¯Dockerå®˜æ–¹æ¨èçš„æ–¹æ³•ã€‚ ä»¥ä¸‹è¯´æ˜å‡åŸºäºsystemd,å¹¶é€šè¿‡/etc/docker/daemon.jsonæ¥ä¿®æ”¹é…ç½®ã€‚ è°ƒä¼˜ä¸é…ç½®é…ç½®é•œåƒä¸‹è½½å’Œä¸Šä¼ å¹¶å‘æ•°ä»Docker1.12å¼€å§‹ï¼Œæ”¯æŒè‡ªå®šä¹‰ä¸‹è½½å’Œä¸Šä¼ é•œåƒçš„å¹¶å‘æ•°ï¼Œé»˜è®¤å€¼ä¸Šä¼ ä¸º3ä¸ªå¹¶å‘ï¼Œä¸‹è½½ä¸º5ä¸ªå¹¶å‘ã€‚é€šè¿‡æ·»åŠ â€max-concurrent-downloadsâ€å’Œâ€max-concurrent-uploadsâ€å‚æ•°å¯¹å…¶ä¿®æ”¹: 12"max-concurrent-downloads": 3,"max-concurrent-uploads": 5 é…ç½®é•œåƒåŠ é€Ÿåœ°å€Rancherä»v1.6.15å¼€å§‹åˆ°v2.x.x,Rancherç³»ç»Ÿç›¸å…³çš„æ‰€æœ‰é•œåƒ(åŒ…æ‹¬1.6.xä¸Šçš„K8Sé•œåƒ)éƒ½æ‰˜ç®¡åœ¨Dockerhubä»“åº“ã€‚DockerhubèŠ‚ç‚¹åœ¨å›½å¤–ï¼Œå›½å†…ç›´æ¥æ‹‰å–é•œåƒä¼šæœ‰äº›ç¼“æ…¢ã€‚ä¸ºäº†åŠ é€Ÿé•œåƒçš„ä¸‹è½½ï¼Œå¯ä»¥ç»™Dockeré…ç½®å›½å†…çš„é•œåƒåœ°å€ã€‚ ç¼–è¾‘/etc/docker/daemon.jsonåŠ å…¥ä»¥ä¸‹å†…å®¹ 123&#123;"registry-mirrors": ["https://7bezldxe.mirror.aliyuncs.com/","https://IP:PORT/"]&#125; å¯ä»¥è®¾ç½®å¤šä¸ªregistry-mirrorsåœ°å€ï¼Œä»¥æ•°ç»„å½¢å¼ä¹¦å†™ï¼Œåœ°å€éœ€è¦æ·»åŠ åè®®å¤´(httpsæˆ–è€…http)ã€‚ é…ç½®insecure-registriesç§æœ‰ä»“åº“Dockeré»˜è®¤åªä¿¡ä»»TLSåŠ å¯†çš„ä»“åº“åœ°å€(https)ï¼Œæ‰€æœ‰éhttpsä»“åº“é»˜è®¤æ— æ³•ç™»é™†ä¹Ÿæ— æ³•æ‹‰å–é•œåƒã€‚insecure-registrieså­—é¢æ„æ€ä¸ºä¸å®‰å…¨çš„ä»“åº“ï¼Œé€šè¿‡æ·»åŠ è¿™ä¸ªå‚æ•°å¯¹éhttpsä»“åº“è¿›è¡Œæˆä¿¡ã€‚å¯ä»¥è®¾ç½®å¤šä¸ªinsecure-registriesåœ°å€ï¼Œä»¥æ•°ç»„å½¢å¼ä¹¦å†™ï¼Œåœ°å€ä¸èƒ½æ·»åŠ åè®®å¤´(http)ã€‚ ç¼–è¾‘/etc/docker/daemon.jsonåŠ å…¥ä»¥ä¸‹å†…å®¹: 123&#123;"insecure-registries": ["192.168.1.100","IP:PORT"]&#125; é…ç½®Dockerå­˜å‚¨é©±åŠ¨OverlayFSæ˜¯ä¸€ä¸ªæ–°ä¸€ä»£çš„è”åˆæ–‡ä»¶ç³»ç»Ÿï¼Œç±»ä¼¼äºAUFSï¼Œä½†é€Ÿåº¦æ›´å¿«ï¼Œå®ç°æ›´ç®€å•ã€‚Dockerä¸ºOverlayFSæä¾›äº†ä¸¤ä¸ªå­˜å‚¨é©±åŠ¨ç¨‹åº:æ—§ç‰ˆçš„overlayï¼Œæ–°ç‰ˆçš„overlay2(æ›´ç¨³å®š)ã€‚ å…ˆå†³æ¡ä»¶: overlay2: Linuxå†…æ ¸ç‰ˆæœ¬4.0æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–ä½¿ç”¨å†…æ ¸ç‰ˆæœ¬3.10.0-514+çš„RHELæˆ–CentOSã€‚ overlay: ä¸»æœºLinuxå†…æ ¸ç‰ˆæœ¬3.18+ æ”¯æŒçš„ç£ç›˜æ–‡ä»¶ç³»ç»Ÿ ext4(ä»…é™RHEL 7.1) xfs(RHEL7.2åŠæ›´é«˜ç‰ˆæœ¬)ï¼Œéœ€è¦å¯ç”¨d_type=trueã€‚ &gt;å…·ä½“è¯¦æƒ…å‚è€ƒ Docker Use the OverlayFS storage driver ç¼–è¾‘/etc/docker/daemon.jsonåŠ å…¥ä»¥ä¸‹å†…å®¹ 1234&#123;"storage-driver": "overlay2","storage-opts": ["overlay2.override_kernel_check=true"]&#125; é…ç½®æ—¥å¿—é©±åŠ¨å®¹å™¨åœ¨è¿è¡Œæ—¶ä¼šäº§ç”Ÿå¤§é‡æ—¥å¿—æ–‡ä»¶ï¼Œå¾ˆå®¹æ˜“å æ»¡ç£ç›˜ç©ºé—´ã€‚é€šè¿‡é…ç½®æ—¥å¿—é©±åŠ¨æ¥é™åˆ¶æ–‡ä»¶å¤§å°ä¸æ–‡ä»¶çš„æ•°é‡ã€‚ &gt;é™åˆ¶å•ä¸ªæ—¥å¿—æ–‡ä»¶ä¸º100M,æœ€å¤šäº§ç”Ÿ3ä¸ªæ—¥å¿—æ–‡ä»¶ 1234567&#123;"log-driver": "json-file","log-opts": &#123; "max-size": "100m", "max-file": "3" &#125;&#125; å¸¸è§é—®é¢˜Ubuntu\Debianç³»ç»Ÿ ï¼Œdocker infoæç¤ºWARNING: No swap limit supportUbuntu\Debianç³»ç»Ÿä¸‹ï¼Œé»˜è®¤cgroupsæœªå¼€å¯swap accountåŠŸèƒ½ï¼Œè¿™æ ·ä¼šå¯¼è‡´è®¾ç½®å®¹å™¨å†…å­˜æˆ–è€…swapèµ„æºé™åˆ¶ä¸ç”Ÿæ•ˆã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è§£å†³: 12sudo sed -i 's/GRUB_CMDLINE_LINUX="/GRUB_CMDLINE_LINUX="cgroup_enable=memory swapaccount=1 /g' /etc/default/grubsudo update-grub æ³¨æ„é€šè¿‡ä»¥ä¸Šå‘½ä»¤å¯è‡ªåŠ¨é…ç½®å‚æ•°ï¼Œå¦‚æœ/etc/default/grubéé»˜è®¤é…ç½®ï¼Œéœ€æ ¹æ®å®é™…å‚æ•°åšè°ƒæ•´ã€‚æç¤ºä»¥ä¸Šé…ç½®å®Œæˆåï¼Œå»ºè®®é‡å¯ä¸€æ¬¡ä¸»æœºã€‚ è°ƒä¼˜é…ç½®æ€»ç»“1ã€Dockeré•œåƒä¸‹è½½æœ€å¤§å¹¶å‘æ•° é€šè¿‡é…ç½®é•œåƒä¸Šä¼ \ä¸‹è½½å¹¶å‘æ•°max-concurrent-downloads,max-concurrent-uploads,ç¼©çŸ­é•œåƒä¸Šä¼ \ä¸‹è½½çš„æ—¶é—´ã€‚ 2ã€é…ç½®é•œåƒåŠ é€Ÿåœ°å€ é€šè¿‡é…ç½®é•œåƒåŠ é€Ÿåœ°å€registry-mirrors,å¯ä»¥å¾ˆå¤§ç¨‹åº¦æé«˜é•œåƒä¸‹è½½é€Ÿåº¦ã€‚ 3ã€é…ç½®Dockerå­˜å‚¨é©±åŠ¨ OverlayFSæ˜¯ä¸€ä¸ªæ–°ä¸€ä»£çš„è”åˆæ–‡ä»¶ç³»ç»Ÿï¼Œç±»ä¼¼äºAUFSï¼Œä½†é€Ÿåº¦æ›´å¿«ï¼Œå®ç°æ›´ç®€å•ã€‚Dockerä¸ºOverlayFSæä¾›äº†ä¸¤ä¸ªå­˜å‚¨é©±åŠ¨ç¨‹åº:æ—§ç‰ˆçš„overlayï¼Œæ–°ç‰ˆçš„overlay2(æ›´ç¨³å®š)ã€‚ 4ã€é…ç½®æ—¥å¿—æ–‡ä»¶å¤§å° å®¹å™¨ä¸­ä¼šäº§ç”Ÿå¤§é‡æ—¥å¿—æ–‡ä»¶ï¼Œå¾ˆå®¹å™¨å æ»¡ç£ç›˜ç©ºé—´ã€‚é€šè¿‡è®¾ç½®æ—¥å¿—æ–‡ä»¶å¤§å°ï¼Œå¯ä»¥æœ‰æ•ˆæ§åˆ¶æ—¥å¿—æ–‡ä»¶å¯¹ç£ç›˜çš„å ç”¨é‡ã€‚ä¾‹å¦‚ï¼š 5ã€å¼€å¯WARNING: No swap limit supportï¼ŒWARNING: No memory limit supportæ”¯æŒ å¯¹äºUbuntu\Debianç³»ç»Ÿï¼Œæ‰§è¡Œdocker infoå‘½ä»¤æ—¶èƒ½çœ‹åˆ°è­¦å‘ŠWARNING: No swap limit supportæˆ–è€…WARNING: No memory limit supportã€‚å› ä¸ºUbuntu\Debianç³»ç»Ÿé»˜è®¤å…³é—­äº†swap accountæˆ–è€…åŠŸèƒ½ï¼Œè¿™æ ·ä¼šå¯¼è‡´è®¾ç½®å®¹å™¨å†…å­˜æˆ–è€…swapèµ„æºé™åˆ¶ä¸ç”Ÿæ•ˆï¼Œè§£å†³æ–¹æ³•ã€‚ æœ€ç»ˆå‘½ä»¤è¾“å…¥å¦‚ä¸‹ï¼š 123456789101112131415161718touch /etc/docker/daemon.jsoncat &gt; /etc/docker/daemon.json &lt;&lt;EOF&#123; "log-driver": "json-file", "log-opts": &#123; "max-size": "100m", "max-file": "3" &#125;, "max-concurrent-downloads": 10, "max-concurrent-uploads": 10, "registry-mirrors": ["https://7bezldxe.mirror.aliyuncs.com"], "storage-driver": "overlay2", "storage-opts": [ "overlay2.override_kernel_check=true" ]&#125;EOFsystemctl daemon-reload &amp;&amp; systemctl restart docker å®Œå‚è€ƒèµ„æ–™http://www.docker.org.cn/ https://www.cnrancher.com/docs/rancher/v2.x/cn/overview/quick-start-guide/ ç»“æŸå…¨ç‰‡ç»“æŸï¼Œè§‰å¾—æˆ‘å†™çš„ä¸é”™ï¼Ÿæƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿèµ¶å¿«æ‰“å¼€æˆ‘çš„ğŸ‘‰ä¸ªäººåšå®¢ ğŸ‘ˆå§ï¼ è°¢è°¢ä½ é‚£ä¹ˆå¯çˆ±ï¼Œè¿˜ä¸€ç›´å…³æ³¨ç€æˆ‘~â¤ğŸ˜]]></content>
      <tags>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
        <tag>k8s</tag>
        <tag>è½¯ä»¶æ•™å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°å½•ä¸€æ¬¡Ubuntuçš„è¿æ¥]]></title>
    <url>%2F2019%2F01%2F18%2F%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1Ubuntu%E7%9A%84%E8%BF%9E%E6%8E%A5%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘å…¬å¸çš„spring cloud äº‘å¹³å°å³å°†æ„é€ å®Œæˆï¼Œè½¬è€Œè¦è¿›å…¥éƒ¨ç½²ä¸å»ºè®¾å¹³å°çš„è¿‡ç¨‹ã€‚æ•…å‡†å¤‡ç ”ç©¶ä¸€ä¸‹kubernetesï¼Œå¯æ˜¯æœ€è¿‘æ‰‹å¤´ç‰¹åˆ«ç´§ï¼Œæˆ‘éƒ¨é—¨åˆæ²¡æœ‰ç‹¬ç«‹çš„äº‘æœåŠ¡å™¨ï¼Œè€Œä¸”ç½‘é€Ÿå¾ˆæ…¢æ²¡æ³•ä¸‹è½½centosé•œåƒï¼Œæ•…å‡†å¤‡å®‰è£…è™šæ‹Ÿæœºï¼Œä½¿ç”¨æˆ‘ä»æœªç”¨è¿‡çš„Ubuntuæ¥è§£å†³é—®é¢˜ã€‚è¿™å°±æœ‰äº†è¿™æ¬¡æ–‡ç« çš„ä¸»é¢˜ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢https://blog.tengshe789.tech/ï¼ˆğŸ˜˜ Ubuntuå¼€æœºç¬¬ä¸€æ¬¡è®¾ç½®æˆ‘æ˜¯ç”¨çš„æ˜¯Ubuntu desktop x64ç‰ˆï¼Œä¸æ˜¯æœåŠ¡å™¨ç‰ˆï¼Œå¸¦æœ‰å›¾å½¢åŒ–ç•Œé¢ã€‚è£…ç³»ç»Ÿï¼Œå¼€æœºï¼Œç‚¹å‡»å·¦ä¸Šè§’è®¾ç½®,ä½¿ç”¨crtl+få¿«æ·é”®ç»„åˆï¼Œåˆ†åˆ«æœç´¢lock,power save,å°†é”å±å’Œçœç”µå…¨éƒ¨å…³é—­ã€‚ç»“æŸã€‚ SSHè¿æ¥é»˜è®¤Ubuntuæ˜¯ä¸èƒ½ä½¿ç”¨sshè¿æ¥çš„ï¼Œéœ€è¦åœ¨ç³»ç»Ÿå†…å®‰è£…å’Œé…ç½®sshã€‚ å‡†å¤‡å·¥ä½œæ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥sudo apt-get updateæ¥æ›´æ–°æºåˆ—è¡¨ã€‚ æˆåŠŸåï¼Œè¾“å…¥sudo apt-get install openssh-serveræ ¹æ®æç¤ºæ¥å®‰è£…sshæœåŠ¡ã€‚ æ¥ä¸‹æ¥ï¼Œè¾“å…¥sudo apt install net-toolsæ ¹æ®æç¤ºæ¥å®‰è£…ç½‘ç»œå·¥å…·ã€‚ æœ€åï¼Œè¾“å…¥sudo apt-get install vim-gtkæ¥å®‰è£…vimå·¥å…·ï¼ˆvimå¤§æ³•å¥½ï¼ï¼‰ ç»“æŸã€‚ è®¾ç½®sshæŸ¥çœ‹sshæœåŠ¡æ˜¯å¦å¯åŠ¨è¾“å…¥sudo ps -e |grep sshï¼Œç»“æœå¦‚ä¸‹ å¦‚æœæœ‰sshdè¿›ç¨‹ï¼Œåˆ™è¯´æ˜sshæœåŠ¡å·²ç»å¯åŠ¨ï¼Œå¦‚æœæ²¡æœ‰å¯åŠ¨ï¼Œè¾“å…¥sudo service ssh startï¼ŒsshæœåŠ¡å°±ä¼šå¯åŠ¨ã€‚ ä½¿ç”¨geditä¿®æ”¹é…ç½®æ–‡ä»¶è¾“å…¥sudo gedit /etc/ssh/sshd_configï¼ŒæŠŠé…ç½®æ–‡ä»¶ä¸­çš„â€PermitRootLogin without-passwordâ€åŠ ä¸€ä¸ªâ€#â€å·,æŠŠå®ƒæ³¨é‡Šæ‰ï¼Œå†å¢åŠ ä¸€å¥â€PermitRootLogin yesâ€ï¼Œä¿®æ”¹æˆåŠŸã€‚ æŸ¥æ‰¾IPåœ°å€è¾“å…¥ifconfigï¼Œæ ¹æ®ipé…ç½®åˆ°sshè¿æ¥å·¥å…·å°±å¥½ã€‚ å®Œæˆï¼ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ ã€‚]]></content>
      <tags>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
        <tag>è½¯ä»¶æ•™å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å°†æˆ‘çš„javaç¨‹åºç»„ä»¶éƒ¨ç½²åˆ°mavenä¸­å¤®ä»“åº“]]></title>
    <url>%2F2019%2F01%2F17%2F%E5%B0%86%E6%88%91%E7%9A%84%E7%A8%8B%E5%BA%8F%E7%BB%84%E4%BB%B6%E6%B3%A8%E5%86%8C%E5%88%B0maven%2F</url>
    <content type="text"><![CDATA[å‰ä¸€é˜µå­å·¥ä½œæœ‰ç‚¹å¿™ï¼Œä¹Ÿæ¯”è¾ƒç„¦è™‘ã€‚æ²¡æœ‰æ—¶é—´å†™ä¸€äº›åšå®¢æ–‡ç« ï¼Œä»Šå¤©æ¥è¡¥å……ä¸€ä¸‹ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ã€‚ğŸ˜ åšç‚¹ä»€ä¹ˆï¼Ÿé¢ä¸´æ¯•ä¸šï¼Œä¸æƒ³ä¸€ç›´å’¸é±¼ï¼Œå¯æ˜¯åˆä»€ä¹ˆéƒ½ä¸ä¼šï¼Œåšç‚¹ä»€ä¹ˆçš„ï¼Ÿæ€æ¥æƒ³å»ï¼Œä¹Ÿæ˜¯ä¸ºäº†ç»™è‡ªå·±å°‘ä¸€ç‚¹éº»çƒ¦ï¼Œå°±å†³å®šæŠŠè‡ªå·±åŠå¹´å‰é‚£ä¸ªç§’æ€å•†åŸé¡¹ç›®é‡æ„ä¸€ä¸‹ï¼Œæ”¾åˆ°äº‘å¹³å°ä¸Šã€‚ä¸è¿‡æ—¢ç„¶éƒ½æ˜¯äº‘å¹³å°äº†ï¼Œè‚¯å®šä¼šæœ‰å„ç§æ”¯æ’‘æœåŠ¡ï¼Œå°±è­¬å¦‚è¯´ç¼“å­˜ä¸­å¿ƒï¼Œæ—¥å¿—ä¸­å¿ƒï¼Œç›‘æ§ä¸­å¿ƒï¼Œæƒé™ç®¡ç†ä¸­å¿ƒç­‰ç­‰ï¼Œä½†æ˜¯è¿™äº›åŠŸèƒ½ï¼Œåœ¨åˆ«çš„é¡¹ç›®ä¸­ä¹Ÿå¯ä»¥ç”¨åˆ°ï¼Œè¿™å°±å¸¦æ¥ä¸€äº›ä¸å¿…è¦çš„éº»çƒ¦ã€‚ è¿™æ—¶å€™ï¼Œå°±æ¨èä½¿ç”¨mavenæ¥ç»Ÿä¸€ç®¡ç†äº†ã€‚ å‰äº›æ—¥å­ï¼Œè¶ç€æ¯•ä¸šç”Ÿåˆ›ä¸šæŒ‡å¯¼å¼€è¯¾çš„æ—¶å€™ï¼Œæˆ‘æŠŠç¼“å­˜ä¸­å¿ƒæ•²å®Œäº†ã€‚ç„¶åå°†ä»–éƒ¨ç½²åˆ°mavenä¸­å¤®ä»“åº“ã€‚ä¸‹é¢æˆ‘å°±æ¥åˆ†äº«ä¸€ä¸‹éƒ¨ç½²åˆ°ä¸­å¤®ä»“åº“çš„é‚£äº›å‘ğŸ•³ã€‚ éƒ¨ç½²åˆ°ä¸­å¤®ä»“åº“å‡†å¤‡å·¥ä½œ æ‰“å¼€æµè§ˆå™¨ï¼Œ sonatype å®˜ç½‘ï¼Œè¿™ä¸ªåœ°å€ï¼Œæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œå¹¶ä¸”è®°ä½ç”¨æˆ·åå¯†ç  ä¸‹è½½å¥½gitå®¢æˆ·ç«¯ æäº¤issueåœ¨ https://issues.sonatype.org/secure/CreateIssue.jspa?issuetype=21&amp;pid=10134 ä¸­æ–°å»ºä¸€ä¸ªâ€œProject ticketâ€ã€‚ ä¸‹é¢å¼•ä»¥ä¸‹Spiderman.Lå¤§ä½¬åšå®¢ä¸Šçš„å›¾ç‰‡ï¼ˆå¤ªæ‡’äº†ä¸æƒ³é‡æ–°å¡«ä¸€éï¼‰ï¼Œç…§ç€è¿™ä¸ªæ­¥éª¤æ¥ã€‚ ç‚¹å‡»Createä¹‹åï¼Œä½ å°±ä¼šè¿›å…¥ä¸€ä¸ª jira é¡µé¢(sonatype ä½¿ç”¨jira æ¥è¿½è¸ªæ¯ä¸€ä¸ªé¡¹ç›®è¿›åº¦)ï¼Œä¸æ­¤åŒæ—¶ä½ æ³¨å†Œæ—¶ä½¿ç”¨çš„é‚®ç®±ä¸­ä¹Ÿä¼šæ”¶åˆ°ä¸€å°é‚®ä»¶æç¤ºä½ ï¼Œä»»åŠ¡åˆ›å»ºæˆåŠŸ,æ­£åœ¨ç­‰å¾…å¤„ç†ã€‚ ç­‰å¾…æ—¶é—´åˆ›å»ºå®Œæ¯•åå°±ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œåˆ·æ–°é¡µé¢ã€‚å½“çŠ¶æ€å˜ä¸ºâ€œresolvedâ€ï¼Œç„¶åä½ å°±å¯ä»¥ä½¿ç”¨mavenä¸Šä¼ é¡¹ç›®äº†ã€‚æˆ–è€…å°±ç­‰ç€æ¥æ”¶ sonatypeçš„åé¦ˆé‚®ä»¶ï¼Œç¡®è®¤å·²ç»ä¸ºä½ åˆ›å»ºå¥½äº†æ–°é¡¹ç›® å›å¤commitå‘å¸ƒå®Œåï¼Œå¯èƒ½å‡ åˆ†é’Ÿï¼Œä¹Ÿå¯èƒ½å‡ å°æ—¶ï¼Œä¼šæœ‰å·¥ä½œäººå‘˜é—®ä½ æ˜¯å¦æœ‰Group Idå¯¹åº”çš„é‚£ä¸ªåŸŸåçš„æ‰€æœ‰æƒï¼Œå¦‚æœæœ‰çš„è¯å°±å›å¤æœ‰ï¼Œå¹¶ä¸”æŒ‰ç…§ä»–è¯´çš„ä¸‰ä¸ªæ–¹æ³•æ¥ï¼ˆä¸‹å›¾ä¸ºå‚è€ƒè¯­å¥ï¼‰ï¼Œç„¶åå°±ä¼šå¾—åˆ°Configuration has been preparedçš„å›å¤ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥å‡†å¤‡å‘å¸ƒäº†ã€‚ æˆ‘ç”¨çš„æ˜¯ç¬¬ä¸€ä¸ªæ–¹æ³•ï¼Œå› ä¸ºæˆ‘çš„åŸŸåæ˜¯ä»é˜¿é‡Œäº‘ä¸Šä¹°çš„ï¼Œæˆ‘åœ¨é˜¿é‡Œäº‘å¹³å°çš„åŸŸåç®¡ç†ä¸­å¿ƒå¤„ï¼Œæ·»åŠ äº†ä¸€ä¸ªTXTè®°å½•åˆ°è¿™ä¸ªticketä¸Šï¼Œè¿™æ ·ä»–ä¼šè‡ªå·±æ£€æµ‹ã€‚ å½“ç„¶äº†ï¼Œå¦‚æœè‡ªå·±æ²¡æœ‰åŸŸåçš„è¯å¯ä»¥æŒ‚åœ¨å¼€æºçš„åŸŸåä¸‹é¢ï¼Œä¾‹å¦‚com.github.tengshe789ï¼Œè¿™æ ·ä¸€æ ·å¯ä»¥å‘å¸ƒã€‚ æœ€å·®çš„æ–¹æ³•ï¼Œå°±æ˜¯ç”¨ä¸ªäººåŸŸåé‚®ç®±å‘é€ç»™ä»–é‚®ä»¶ã€‚ è·å¾—éƒ¨ç½²æƒé™åšå®Œä¸Šä¸€æ­¥ï¼Œä»–ä¼šåœ¨ç¾å›½å·¥ä½œæ—¥æ—¶é—´é‡Œå›å¤éƒ¨ç½²çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚å›¾ï¼š å½“æˆ‘ä»¬çš„ticketæœ€ç»ˆçŠ¶æ€å˜ä¸ºResolvedçš„æ—¶å€™ï¼Œè¡¨ç¤ºæˆ‘ä»¬æœ‰æƒé™å¯ä»¥ä¸Šä¼ ä¸œè¥¿äº†ã€‚ mavenæœ¬åœ°è®¾ç½®æ‰¾åˆ°ä½ å®‰è£…mavençš„ç›®å½•ä¸‹é¢ï¼Œæ‰“å¼€mavenç›®å½•\conf\settings.xmlæ–‡ä»¶ã€‚åœ¨serversæ ‡ç­¾ä¸­å¡«å†™å¦‚ä¸‹ä¿¡æ¯ 123456789101112&lt;servers&gt; &lt;server&gt; &lt;id&gt;sonatype-nexus-snapshots&lt;/id&gt; &lt;username&gt;tengshe789ï¼ˆæˆ‘çš„ç”¨æˆ·åï¼‰&lt;/username&gt; &lt;password&gt;ï¼ˆæˆ‘çš„sonatypeå¯†ç ï¼‰&lt;/password&gt; &lt;/server&gt; &lt;server&gt; &lt;id&gt;sonatype-nexus-staging&lt;/id&gt; &lt;username&gt;tengshe789ï¼ˆæˆ‘çš„ç”¨æˆ·åï¼‰&lt;/username&gt; &lt;password&gt;ï¼ˆæˆ‘çš„sonatypeå¯†ç ï¼‰&lt;/password&gt; &lt;/server&gt;&lt;/servers&gt; javaç¨‹åºpom.XMLè®¾ç½®æŒ‰ç…§ä¸‹é¢ä»£ç æ·»åŠ ã€‚ 12345&lt;scm&gt; &lt;connection&gt;scm:git:https://github.com/tengshe789/miaocache.git&lt;/connection&gt; &lt;developerConnection&gt;scm:git:https://github.com/tengshe789/miaocache.git&lt;/developerConnection&gt; &lt;url&gt;https://github.com/tengshe789/miaocache&lt;/url&gt; &lt;tag&gt;0.0.1&lt;/tag&gt; &lt;/scm&gt; è¿™äº›åœ°å€å¡«çš„æ˜¯ä½ githubä¸Šçš„åœ°å€ã€‚ 12345678910111213141516&lt;distributionManagement&gt; &lt;snapshotRepository&gt; &lt;!-- è¿™ä¸ªidä¸æˆ‘ä¸Šä¸€æ­¥åœ¨setting.xmlä¸­è®¾ç½®çš„idä¸€è‡´çš„ --&gt; &lt;id&gt;sonatype-nexus-snapshots&lt;/id&gt; &lt;name&gt;OSS Snapshots Repository&lt;/name&gt; &lt;!-- è¿™é‡Œçš„urlå°±æ˜¯Issueä¸­å›å¤çš„snapshots çš„repoåœ°å€--&gt; &lt;url&gt;https://oss.sonatype.org/content/repositories/snapshots&lt;/url&gt; &lt;/snapshotRepository&gt; &lt;repository&gt; &lt;!-- è¿™ä¸ªidä¸æˆ‘ä¸Šä¸€æ­¥åœ¨setting.xmlä¸­è®¾ç½®çš„idä¸€è‡´çš„ --&gt; &lt;id&gt;sonatype-nexus-staging&lt;/id&gt; &lt;name&gt;OSS Staging Repository&lt;/name&gt; &lt;!-- è¿™é‡Œçš„urlå°±æ˜¯Issueä¸­å›å¤çš„staging çš„repoåœ°å€--&gt; &lt;url&gt;https://oss.sonatype.org/service/local/staging/deploy/maven2&lt;/url&gt; &lt;/repository&gt;&lt;/distributionManagement&gt; è¿™äº›åœ°å€ç›´æ¥å¤åˆ¶ä¸Šå°±è¡Œã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130 &lt;build&gt; &lt;finalName&gt;$&#123;project.name&#125;&lt;/finalName&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;filtering&gt;true&lt;/filtering&gt; &lt;/resource&gt; &lt;/resources&gt; &lt;pluginManagement&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;version&gt;$&#123;spring-boot.version&#125;&lt;/version&gt; &lt;configuration&gt; &lt;finalName&gt;$&#123;project.build.finalName&#125;&lt;/finalName&gt; &lt;/configuration&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;repackage&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/pluginManagement&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.8.0&lt;/version&gt; &lt;configuration&gt; &lt;target&gt;$&#123;maven.compiler.target&#125;&lt;/target&gt; &lt;source&gt;$&#123;maven.compiler.source&#125;&lt;/source&gt; &lt;encoding&gt;UTF-8&lt;/encoding&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;repositories&gt; &lt;!--é˜¿é‡Œäº‘ä¸»ä»“åº“ï¼Œä»£ç†äº†maven centralå’Œjcenterä»“åº“--&gt; &lt;repository&gt; &lt;id&gt;aliyun&lt;/id&gt; &lt;name&gt;aliyun&lt;/name&gt; &lt;url&gt;https://maven.aliyun.com/repository/public&lt;/url&gt; &lt;releases&gt; &lt;enabled&gt;true&lt;/enabled&gt; &lt;/releases&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt; &lt;!--é˜¿é‡Œäº‘ä»£ç†Spring å®˜æ–¹ä»“åº“--&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://maven.aliyun.com/repository/spring&lt;/url&gt; &lt;releases&gt; &lt;enabled&gt;true&lt;/enabled&gt; &lt;/releases&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt; &lt;/repositories&gt; &lt;pluginRepositories&gt; &lt;!--é˜¿é‡Œäº‘ä»£ç†Spring æ’ä»¶ä»“åº“--&gt; &lt;pluginRepository&gt; &lt;id&gt;spring-plugin&lt;/id&gt; &lt;name&gt;spring-plugin&lt;/name&gt; &lt;url&gt;https://maven.aliyun.com/repository/spring-plugin&lt;/url&gt; &lt;releases&gt; &lt;enabled&gt;true&lt;/enabled&gt; &lt;/releases&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/pluginRepository&gt; &lt;/pluginRepositories&gt; &lt;profiles&gt; &lt;profile&gt; &lt;id&gt;release&lt;/id&gt; &lt;build&gt; &lt;plugins&gt; &lt;!-- Source --&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-source-plugin&lt;/artifactId&gt; &lt;version&gt;2.2.1&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;phase&gt;package&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;jar-no-fork&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;!-- Javadoc --&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-javadoc-plugin&lt;/artifactId&gt; &lt;version&gt;2.9.1&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;phase&gt;package&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;jar&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;distributionManagement&gt; &lt;snapshotRepository&gt; &lt;id&gt;sonatype-nexus-snapshots&lt;/id&gt; &lt;name&gt;OSS Snapshots Repository&lt;/name&gt; &lt;url&gt;https://oss.sonatype.org/content/repositories/snapshots&lt;/url&gt; &lt;/snapshotRepository&gt; &lt;repository&gt; &lt;id&gt;sonatype-nexus-staging&lt;/id&gt; &lt;name&gt;OSS Staging Repository&lt;/name&gt; &lt;!-- è¿™é‡Œçš„urlå°±æ˜¯Issueä¸­å›å¤çš„staging çš„repoåœ°å€--&gt; &lt;url&gt;https://oss.sonatype.org/service/local/staging/deploy/maven2&lt;/url&gt; &lt;/repository&gt; &lt;/distributionManagement&gt; &lt;/profile&gt; &lt;/profiles&gt;&lt;/project&gt; ä¸‹é¢åœ°å€æ˜¯é€šç”¨çš„æ’ä»¶å’Œprofilesé…ç½®ï¼Œä¸èƒ½å°‘ï¼ŒæŒ‰ç…§éœ€æ±‚æ¥è®¾ç½®ã€‚æœ‰èƒ½åŠ›çš„åŒå­¦è‡ªå·±ç ”ç©¶ä¸€ä¸‹ã€‚ ä½¿ç”¨gpgç”Ÿæˆå¯†é’¥æ‰“å¼€gitçª—å£ï¼Œè¾“å…¥gpg --gen-keyã€‚è¿™æ—¶å€™ä¼šå‡ºç°ä¸€å¤§ç‰‡è‹±æ–‡ï¼Œçœ‹ä¸æ‡‚çš„åŒå­¦ä¸è¦ç´§ï¼Œè·Ÿç€æˆ‘åšå°±è¡Œã€‚ 1gpg --list-keys è¿™ä¸ªå‘½ä»¤æ˜¯æŸ¥çœ‹è‡ªå·±keyçš„ç¼–å·ã€‚æ‰¾åˆ° pubå¯¹åº”çš„é‚£ä¸ªç¼–å·ï¼Œä¾‹å¦‚pub 2048R/8C473F5Cä¸Šä¼ åˆ°keyéªŒè¯åº“ï¼š 1gpg --keyserver hkp://keyserver.ubuntu.com:11371 --send-keys 8C473F5C mavenå‘½ä»¤æ‰“å¼€ideaï¼Œæ‰¾åˆ°ä¸‹é¢çš„ç»ˆç«¯ï¼Œè¾“å…¥mavenå‘½ä»¤ã€‚ 1mvn clean deploy -P sonatype-oss-release -Darguments="gpg.passphrase=è®¾ç½®gpgè®¾ç½®å¯†é’¥æ—¶å€™è¾“å…¥çš„Passphrase" å‚è€ƒèµ„æ–™https://www.cnblogs.com/aimqqroad-13/p/9645776.html https://blog.csdn.net/sun5769675/article/details/78519948 https://www.jianshu.com/p/bb930e9ad5f4 ç»“æŸã€ç‰ˆæƒç”³æ˜ã€‘æ­¤ç‰‡ä¸ºåŸåˆ›å†…å®¹ï¼Œä½¿ç”¨ CC BY-NC-SA 3.0æˆæƒæ¡æ¬¾ï¼Œè¯·éµå®ˆå¯¹åº”çš„ä¹‰åŠ¡ï¼Œå³è¢«æˆæƒäººæœ‰ä¹‰åŠ¡åœ¨æ‰€æœ‰å‰¯æœ¬ä¸­éƒ½å¿…é¡»åŒ…å«ç‰ˆæƒå£°æ˜ã€‚è°¢è°¢åˆä½œ~ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢https://blog.tengshe789.tech/ï¼ˆğŸ˜˜]]></content>
      <tags>
        <tag>åˆ†äº«</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ–°å¹´å¿«ä¹]]></title>
    <url>%2F2019%2F01%2F01%2F%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90%2F</url>
    <content type="text"><![CDATA[æœ€æ˜¯ä¸€å¹´æ˜¥å¥½å¤„,ç»èƒœçƒŸæŸ³æ»¡çš‡éƒ½ã€‚ è½¬çœ¼é—´å…ƒæ—¦åˆ°äº†ï¼Œé¦–å…ˆå‘¢ï¼Œç¥ç¦æ‰€æœ‰çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„ä½ ï¼Œå…ƒæ—¦å¿«ä¹ï¼Œç”Ÿæ´»ç¾æ»¡ï¼Œå¿ƒæƒ³äº‹æˆã€‚ æ˜¨å¤œåˆšåˆšä»é’å²›å›åˆ°æµå—çš„å­¦æ ¡å®¿èˆï¼Œåœ¨å­¦æ ¡åƒäº†ä¸€é¡¿é£Ÿå ‚ï¼Œèººåœ¨å®¿èˆé‡Œçœ‹å¹³æˆæœ€åçš„çº¢ç™½æ­Œä¼šã€‚æ„å¤–çš„å‘ç°ä¸€ä¸ªè¶…æ¼‚äº®å¾ˆæœ‰ä»™æ°”çš„å°å§å§ï¼Œè¥¿é‡ä¸ƒæ¿‘ ! æˆ‘è§‰å¾—æˆ‘çš„å¿ƒç¬é—´å°±è¢«å¥½å‡ å›¢å¤§å¤§çš„æ£‰èŠ±å¡«å……äº†ï¼Œå†¬å¤©å‡›å†½çš„å¯’é£ä¹Ÿä¸æ¯«å¸¦ä¸è¶³æˆ‘å¿ƒçš„ä¸€ä¸çƒ­é‡ï¼Œ å¦‚å›¾ æœ‰æ²¡æœ‰ï¼Ÿæ˜¯ä¸æ˜¯ä»™æ°”åè¶³ã€‚ å¯æƒœä¸ƒæ¿‘é…±å·²ç»å®£å¸ƒé€€å½¹äº†ï¼Œè¿™æ˜¯æœ€åä¸€åœºåœ¨ä¹ƒæœ¨å‚46çš„è¡¨æ¼”ã€‚çŸ¥é“è¿™ä¸ªæ¶ˆæ¯çš„æˆ‘ä¹Ÿæ˜¯æ¯”è¾ƒæƒ‹æƒœï¼Œåœ¨æ¨ç‰¹å’Œinsä¸Šç”¨æ—¥æ–‡é¼“åŠ±äº†å°å§å§ä»¥åï¼Œå®‰ç„¶å…¥ç¡~ ä¸€è§‰é†’æ¥ï¼Œæ—©ä¸Š9ç‚¹ã€‚è¿·ç³Šä¸­æ‹¿èµ·æ‰‹æœºï¼ŒæŠ¢äº†å‡ ä¸ªå‡Œæ™¨ç¾¤å‹å‘çš„çº¢åŒ…ï¼ŒæŠ–æ“æŠ–æ“ç²¾ç¥ã€‚æ¥ä¸‹æ¥çš„ä»»åŠ¡æœ‰å¾ˆå¤šï¼Œæˆ‘ä¸€ä¸€åˆ—äº†ä¸ªæ¸…å•ï¼š æŠ½ç©ºçœ‹ç‰æ´ å…ƒæ—¦æœŸé—´å°±è¦ä¸Šäº¤æ¯•ä¸šè®ºæ–‡çš„å¼€é¢˜æŠ¥å‘Šï¼Œå¯æˆ‘å› ä¸ºç©å½©è™¹å…­å·åˆ°ç°åœ¨è¿˜æ²¡æ€è€ƒå†™ä»€ä¹ˆã€‚ã€‚è€å¸ˆè¯´éšä¾¿åšå°±è¡Œï¼Œé‚£æˆ‘åˆçº ç»“èµ·æ¥äº†ã€‚ç”¨javaçš„å¾®æœåŠ¡ç§’æ€å•†åŸï¼Ÿè¿˜æ˜¯ç”¨pythonåšæˆ¿åœ°äº§ä»·æ ¼èµ°åŠ¿çˆ¬è™«ä¸­å¿ƒï¼Ÿç¬¬ä¸€ç§èŠ±æ—¶é—´å¤šä½†è¿˜ç®—ç†Ÿç»ƒï¼Œç¬¬äºŒå¼ æ—¶é—´æˆæœ¬å¤šä¸€äº›ã€‚ æ˜å¤©è¦å»åŒ—äº¬å‡ºå·® è¿‡å¹´å›å®¶ä¹°ç«è½¦ç¥¨ã€‚ å› ä¸ºæ²¡æœ‰é è°±çš„å·¥ä½œæ‰€æœ‰è¿˜åœ¨å‡†å¤‡å·¥ä½œé¢è¯•ã€‚é˜¿é‡Œå·´å·´çš„å†…æ¨åˆ°ç°åœ¨è¿˜æ²¡ç»™æˆ‘å‘é¢è¯•ç»“æœï¼ŒğŸ˜«ç»§ç»­å‡†å¤‡ å°±è¿™æ ·æŠŠ~æœç€è‡ªå·±å¿ƒä¸­ä¸æ–­åŠªåŠ›ï¼æ–°çš„ä¸€å¹´è¦åŠ æ²¹ï¼â€“9012]]></content>
      <tags>
        <tag>åˆ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç”¨å•ä¾‹æ¨¡å¼æ¥è¯´çº¿ç¨‹å®‰å…¨]]></title>
    <url>%2F2018%2F12%2F13%2F%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E4%B8%8E%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%2F</url>
    <content type="text"><![CDATA[ä¸Šä¸€ç¯‡åšæ–‡è®²äº†æœ‰å…³javaå’Œå†…å­˜é‚£äº›äº‹æƒ…ï¼Œä»Šå¤©æ¥å»¶ç”³ä¸€ä¸‹,ç»“åˆè®¾è®¡æ¨¡å¼çš„å•ä¾‹æ¨¡å¼ï¼Œæ¥è¯´è¯´çº¿ç¨‹å®‰å…¨é‚£äº›äº‹æƒ…ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®https://blog.tengshe789.tech/ å•ä¾‹æ¨¡å¼å•ä¾‹æ¨¡å¼å¤§å®¶åº”è¯¥éƒ½ä¸é™Œç”Ÿï¼Œä¸ºäº†ä¿è¯ç³»ç»Ÿä¸­ï¼Œåº”ç”¨çš„ç±»ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚ä¼ ç»Ÿè¯¾æœ¬ä¸Šå•ä¾‹æ¨¡å¼åˆ†ä¸¤ç§ï¼Œä¸€ç§é¥¿æ±‰å¼ï¼Œä¸€ç§æ‡’æ±‰å¼ã€‚å¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼š æ‡’æ±‰å¼12345678910111213141516171819202122/** * æ‡’æ±‰æ¨¡å¼ * å•ä¾‹å®ä¾‹åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶è¿›è¡Œåˆ›å»º */public class SingletonExample1 &#123; // ç§æœ‰æ„é€ å‡½æ•° private SingletonExample1() &#123; &#125; // å•ä¾‹å¯¹è±¡ private static SingletonExample1 instance = null; // é™æ€çš„å·¥å‚æ–¹æ³• public static SingletonExample1 getInstance() &#123; if (instance == null) &#123; instance = new SingletonExample1(); &#125; return instance; &#125;&#125; æ‡’æ±‰å¼çš„å®ä¾‹æ˜¯åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶åˆ›å»ºçš„ï¼Œç›¸åº”çš„é™æ€å·¥å‚åŠæ³•ä¼šå…ˆåˆ¤æ–­æœ‰æ²¡æœ‰å®ä¾‹ï¼Œæ²¡æœ‰å®ä¾‹åœ¨è¿›è¡Œåˆ›å»ºã€‚ ç„¶è€Œè¿™ç§åˆ›å»ºæ–¹æ³•æ—¶çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼ŒåŒä¸€æ—¶åˆ»æ‹¿åˆ°å•ä¾‹å¯¹è±¡ï¼Œè¦å»é™æ€å·¥å‚åŠæ³•è®¿é—®ï¼Œç”±äºå·¥å‚åŠæ³•æ²¡æœ‰é”ï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½è¿™ä¸¤ä¸ªçº¿ç¨‹æœ€ç»ˆä¼šæ‹¿åˆ°ä¸¤ä¸ªå®ä¾‹ã€‚ é¥¿æ±‰å¼12345678910111213141516171819/** * é¥¿æ±‰æ¨¡å¼ * å•ä¾‹å®ä¾‹åœ¨ç±»è£…è½½æ—¶è¿›è¡Œåˆ›å»º */public class SingletonExample2 &#123; // ç§æœ‰æ„é€ å‡½æ•° private SingletonExample2() &#123; &#125; // å•ä¾‹å¯¹è±¡ private static SingletonExample2 instance = new SingletonExample2(); // é™æ€çš„å·¥å‚æ–¹æ³• public static SingletonExample2 getInstance() &#123; return instance; &#125;&#125; ç›¸å¯¹äºä¸Šé¢é‚£ç§æ‡’æ±‰å¼ï¼Œé¥¿æ±‰å¼æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ç›´æ¥å°†å•ä¾‹å¯¹è±¡ç”¨staticä¿®é¥°ï¼ŒæŠŠå®ä¾‹å¯¹è±¡æ”¾åˆ°å †å†…å­˜ä¸­ï¼Œä¿è¯äº†å¤šä¸ªçº¿ç¨‹åœ¨è®¿é—®æ—¶çš„å¯è§æ€§ã€‚ä½†æ˜¯ç¼ºç‚¹ä¹Ÿæ˜¯å¾ˆå¤§çš„ï¼Œæ­£æ˜¯ç”±äºæŠŠå®ä¾‹å¯¹è±¡æ”¾åˆ°å †å†…å­˜ä¸­ï¼Œè¿™æ ·åº”ç”¨ä¸€åŠ è½½å°±ä¼šçœ‹åˆ°å¯¹åº”å®ä¾‹ï¼Œæå¤§æµªè´¹å†…å­˜ã€‚ å°è¯•ç”¨synchronizedæ”¹é€ æ‡’æ±‰å¼æ’ä¸€å¥å˜´ï¼Œsynchronizedåº•å±‚åŸç†ï¼Œä¸»è¦æ˜¯ä¸¤ä¸ªæŒ‡ä»¤å®ç°çš„ï¼Œåˆ†åˆ«æ˜¯monitorenterå’ŒmonitorexitæŒ‡ä»¤ï¼Œä¸‹é¢æ˜¯æˆ‘ä»ç½‘ç»œä¸Šæ‰¾åˆ°çš„å¯¹åº”æŒ‡ä»¤çš„è§£é‡Šï¼š monitorenterï¼š æ¯ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ªç›‘è§†å™¨é”ï¼ˆmonitorï¼‰ã€‚å½“monitorè¢«å ç”¨æ—¶å°±ä¼šå¤„äºé”å®šçŠ¶æ€ï¼Œçº¿ç¨‹æ‰§è¡ŒmonitorenteræŒ‡ä»¤æ—¶å°è¯•è·å–monitorçš„æ‰€æœ‰æƒï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š 1ã€å¦‚æœmonitorçš„è¿›å…¥æ•°ä¸º0ï¼Œåˆ™è¯¥çº¿ç¨‹è¿›å…¥monitorï¼Œç„¶åå°†è¿›å…¥æ•°è®¾ç½®ä¸º1ï¼Œè¯¥çº¿ç¨‹å³ä¸ºmonitorçš„æ‰€æœ‰è€…ã€‚ 2ã€å¦‚æœçº¿ç¨‹å·²ç»å æœ‰è¯¥monitorï¼Œåªæ˜¯é‡æ–°è¿›å…¥ï¼Œåˆ™è¿›å…¥monitorçš„è¿›å…¥æ•°åŠ 1. 3.å¦‚æœå…¶ä»–çº¿ç¨‹å·²ç»å ç”¨äº†monitorï¼Œåˆ™è¯¥çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç›´åˆ°monitorçš„è¿›å…¥æ•°ä¸º0ï¼Œå†é‡æ–°å°è¯•è·å–monitorçš„æ‰€æœ‰æƒã€‚ monitorexitï¼š æ‰§è¡Œmonitorexitçš„çº¿ç¨‹å¿…é¡»æ˜¯objectrefæ‰€å¯¹åº”çš„monitorçš„æ‰€æœ‰è€…ã€‚ æŒ‡ä»¤æ‰§è¡Œæ—¶ï¼Œmonitorçš„è¿›å…¥æ•°å‡1ï¼Œå¦‚æœå‡1åè¿›å…¥æ•°ä¸º0ï¼Œé‚£çº¿ç¨‹é€€å‡ºmonitorï¼Œä¸å†æ˜¯è¿™ä¸ªmonitorçš„æ‰€æœ‰è€…ã€‚å…¶ä»–è¢«è¿™ä¸ªmonitoré˜»å¡çš„çº¿ç¨‹å¯ä»¥å°è¯•å»è·å–è¿™ä¸ª monitor çš„æ‰€æœ‰æƒã€‚ é€šè¿‡è¿™ä¸¤æ®µæè¿°ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å¾ˆæ¸…æ¥šçš„çœ‹å‡ºSynchronizedçš„å®ç°åŸç†ï¼ŒSynchronizedçš„è¯­ä¹‰åº•å±‚æ˜¯é€šè¿‡ä¸€ä¸ªmonitorçš„å¯¹è±¡æ¥å®Œæˆï¼Œå…¶å®wait/notifyç­‰æ–¹æ³•ä¹Ÿä¾èµ–äºmonitorå¯¹è±¡ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåªæœ‰åœ¨åŒæ­¥çš„å—æˆ–è€…æ–¹æ³•ä¸­æ‰èƒ½è°ƒç”¨wait/notifyç­‰æ–¹æ³•ï¼Œå¦åˆ™ä¼šæŠ›å‡ºjava.lang.IllegalMonitorStateExceptionçš„å¼‚å¸¸çš„åŸå› ã€‚ æ¯«æ— ç–‘é—®ï¼Œæ‡’æ±‰å¼çš„æ€§èƒ½æ˜¯å‡ºè‰²çš„ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸åœ¨æ‡’æ±‰å¼çš„åŸºç¡€ä¸Šä½¿ç”¨synchronizedä¿®é¥°å‘¢ï¼Ÿ ä¸‹é¢æ˜¯ç›¸å…³ä»£ç ï¼š 12345678910111213141516171819202122/** * æ‡’æ±‰æ¨¡å¼ * å•ä¾‹å®ä¾‹åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶è¿›è¡Œåˆ›å»º */public class SingletonExample3 &#123; // ç§æœ‰æ„é€ å‡½æ•° private SingletonExample3() &#123; &#125; // å•ä¾‹å¯¹è±¡ private static SingletonExample3 instance = null; // é™æ€çš„å·¥å‚æ–¹æ³• public static synchronized SingletonExample3 getInstance() &#123; if (instance == null) &#123; instance = new SingletonExample3(); &#125; return instance; &#125;&#125; åŠ äº†synchronizedä¿®é¥°åçš„å·¥å‚æ–¹æ³•ï¼Œæ„å‘³ç€åœ¨åŒä¸€æ—¶é—´å†…åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®ã€‚è¿™æ¯«æ— ç–‘é—®æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†æ˜¯è¿™åŒæ—¶æ˜¯ä¸è¢«æ¨èçš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå’Œä¸Šé¢ä½¿ç”¨staticä¿®é¥°çš„æ‡’æ±‰æ¨¡å¼ä¸åŒï¼Œè¿™ä¸ªå·¥å‚æ–¹æ³•ï¼Œåœ¨åŒä¸€æ—¶é—´æ®µå†…åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®ï¼Œæå¤§çš„é™åˆ¶cpuèµ„æºï¼Œæ€§èƒ½æå…¶å·®ï¼ åŒé‡åŒæ­¥é”å•ä¾‹æ¨¡å¼é‚£ä¹ˆæˆ‘ä»¬å¸å–ä¸Šé¢çš„æ•™è®­ï¼Œå¯ä¸å¯ä»¥åœ¨ä½¿ç”¨synchronizedä¿®é¥°åŸºç¡€ä¸Šåœ¨åŠ ä»¥æ”¹è¿›å‘¢ï¼Ÿ 12345678910111213141516171819202122232425/** * æ‡’æ±‰æ¨¡å¼ -ã€‹ åŒé‡åŒæ­¥é”å•ä¾‹æ¨¡å¼ * å•ä¾‹å®ä¾‹åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶è¿›è¡Œåˆ›å»º */public class SingletonExample4 &#123; // ç§æœ‰æ„é€ å‡½æ•° private SingletonExample4() &#123; &#125; // å•ä¾‹å¯¹è±¡ private static SingletonExample4 instance = null; // é™æ€çš„å·¥å‚æ–¹æ³• public static SingletonExample4 getInstance() &#123; if (instance == null) &#123; // åŒé‡æ£€æµ‹æœºåˆ¶ // B synchronized (SingletonExample4.class) &#123; // åŒæ­¥é” if (instance == null) &#123; instance = new SingletonExample4(); // A - 3 &#125; &#125; &#125; return instance; &#125;&#125; å¾ˆå¤šäººä¼šè®¤ä¸ºè¿™ç§åŠæ³•æ˜¯æœ€ä½³çš„è§£å†³åŠæ³•äº†ï¼Œå…¶å®ä¸æ˜¯ï¼Œè¿™ä¹Ÿæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚æ€ä¹ˆè¯´å‘¢ï¼Ÿ å½“çº¿ç¨‹è¿›å…¥åŒæ­¥é”ï¼Œèµ°åˆ°instance = new SingletonExample4();æ—¶ï¼ŒJVMä¼šè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š memory = allocate() åˆ†é…å¯¹è±¡çš„å†…å­˜ç©ºé—´ ctorInstance() åˆå§‹åŒ–å¯¹è±¡ instance = memory è®¾ç½®instanceæŒ‡å‘åˆšåˆ†é…çš„å†…å­˜ å•çº¿ç¨‹æƒ…å†µä¸‹è‚¯å®šæ²¡é—®é¢˜ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼ŒJVMå’ŒCPUçš„ä¼˜åŒ–ä¸­å¯èƒ½ä¼šæ‰§è¡ŒæŒ‡ä»¤é‡æ’ã€‚ä¸Šé¢çš„ç¬¬äºŒæ­¥å’Œç¬¬ä¸‰æ­¥ä¸­ï¼Œç”±äºæ²¡æœ‰å‰åå¿…ç„¶å…³ç³»ï¼Œcpuå¯èƒ½éšæ—¶è°ƒæ¢ç¬¬äºŒæ­¥å’Œç¬¬ä¸‰æ­¥çš„æ‰§è¡Œé¡ºåºã€‚ä¹Ÿå°±æ˜¯ä¼šå‘ç”Ÿ132è¿™ç§é¡ºåºã€‚ å•ä¾‹å¯¹è±¡ volatile + åŒé‡æ£€æµ‹æœºåˆ¶å¸å–æ•™è®­ç»§ç»­æ”¹è¿›ï¼ 123456789101112131415161718192021222324252627282930/** * æ‡’æ±‰æ¨¡å¼ -ã€‹ åŒé‡åŒæ­¥é”å•ä¾‹æ¨¡å¼ * å•ä¾‹å®ä¾‹åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶è¿›è¡Œåˆ›å»º */public class SingletonExample5 &#123; // ç§æœ‰æ„é€ å‡½æ•° private SingletonExample5() &#123; &#125; // 1ã€memory = allocate() åˆ†é…å¯¹è±¡çš„å†…å­˜ç©ºé—´ // 2ã€ctorInstance() åˆå§‹åŒ–å¯¹è±¡ // 3ã€instance = memory è®¾ç½®instanceæŒ‡å‘åˆšåˆ†é…çš„å†…å­˜ // å•ä¾‹å¯¹è±¡ volatile + åŒé‡æ£€æµ‹æœºåˆ¶ -&gt; ç¦æ­¢æŒ‡ä»¤é‡æ’ private volatile static SingletonExample5 instance = null; // é™æ€çš„å·¥å‚æ–¹æ³• public static SingletonExample5 getInstance() &#123; if (instance == null) &#123; // åŒé‡æ£€æµ‹æœºåˆ¶ // B synchronized (SingletonExample5.class) &#123; // åŒæ­¥é” if (instance == null) &#123; instance = new SingletonExample5(); // A - 3 &#125; &#125; &#125; return instance; &#125;&#125; volatileçš„ç›¸å…³åŠŸèƒ½è¯·çœ‹æˆ‘ä¹‹å‰çš„åšå®¢ã€‚åˆ°è¿™é‡Œï¼Œæ‡’æ±‰æ¨¡å¼æ”¹è¿›å°±å®Œæˆäº†ã€‚ æšä¸¾æ¨¡å¼-ã€‹æœ€å®‰å…¨1234567891011121314151617181920212223242526272829/** * æšä¸¾æ¨¡å¼ï¼šæœ€å®‰å…¨ */public class SingletonExample6 &#123; // ç§æœ‰æ„é€ å‡½æ•° private SingletonExample6() &#123; &#125; public static SingletonExample6 getInstance() &#123; return Singleton.INSTANCE.getInstance(); &#125; private enum Singleton &#123; INSTANCE; private SingletonExample6 singleton; // JVMä¿è¯è¿™ä¸ªæ–¹æ³•ç»å¯¹åªè°ƒç”¨ä¸€æ¬¡ Singleton() &#123; singleton = new SingletonExample6(); &#125; public SingletonExample6 getInstance() &#123; return singleton; &#125; &#125;&#125; æœ€æ¨èçš„æ˜¯ä½¿ç”¨æšä¸¾ç±»å®ç°å•ä¾‹æ¨¡å¼ï¼Œè¿™æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚JVMä¼šä¿è¯æšä¸¾ç±»ä¸­çš„æ„é€ æ–¹æ³•åªè°ƒç”¨ä¸€æ¬¡ï¼Œå› æ­¤ä½¿ç”¨æšä¸¾ä¼šä¿è¯åªå®ä¾‹åŒ–ä¸€æ¬¡ã€‚ å‚è€ƒèµ„æ–™Javaå¹¶å‘ç¼–ç¨‹ï¼šSynchronizedåŠå…¶å®ç°åŸç† å…¨ç‰‡ç»“æŸï¼Œè§‰å¾—æˆ‘å†™çš„ä¸é”™ï¼Ÿæƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿèµ¶å¿«æ‰“å¼€æˆ‘çš„ğŸ‘‰ä¸ªäººåšå®¢ ğŸ‘ˆå§ï¼ è°¢è°¢ä½ é‚£ä¹ˆå¯çˆ±ï¼Œè¿˜ä¸€ç›´å…³æ³¨ç€æˆ‘~â¤ğŸ˜]]></content>
      <tags>
        <tag>java</tag>
        <tag>å¹¶å‘</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆ†äº«ä¸€ä¸‹æˆ‘å¸¸ç”¨çš„é«˜å¹¶å‘æµ‹è¯•å·¥å…·]]></title>
    <url>%2F2018%2F12%2F13%2F%E5%88%86%E4%BA%AB%E4%B8%80%E4%B8%8B%E6%88%91%E5%B8%B8%E7%94%A8%E7%9A%84%E9%AB%98%E5%B9%B6%E5%8F%91%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7%2F</url>
    <content type="text"><![CDATA[æˆ‘åŠå¹´å‰è¿™ä¸ªå­¦ä¹ é¡¹ç›®ğŸ‘‰ https://github.com/tengshe789/-miaosha ğŸ‘ˆåˆæœ‰äººç‚¹èµäº†23333ï¼Œçœ‹æ¥æŠ€æœ¯è¿˜æ²¡æ­»ã€‚é‚£ä¹ˆä»Šå¤©åˆ†äº«ä¸€ä¸‹è¿™ä¸ªç§’æ€ç³»ç»Ÿä½¿ç”¨çš„æµ‹è¯•å·¥å…·~ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ Postmanè¯·æ±‚æ¨¡æ‹Ÿå·¥å…·ä¸‹è½½å®‰è£…æ—¥åæ›´æ–° UI ä½¿ç”¨æµ‹è¯•ç•Œé¢å³ä¾§æœ‰ä¸ªè“è‰²çš„å·¨å¤§çš„buttonï¼Œä¸Šé¢å†™ç€sendï¼Œæ—è¾¹æœ‰å„ç§å‚æ•°ã€‚æƒ³æµ‹è¯•çš„è¯ï¼Œé€‰æ‹©è¯·æ±‚ç±»å‹ï¼Œè¯·æ±‚æ•°æ®ç­‰ç­‰ï¼Œç‚¹å‡»sendå°±å¥½ã€‚ ç¯å¢ƒæœ€å³ä¸Šè§’é½¿è½®å½¢çŠ¶çš„å›¾æ ‡ï¼Œæ·»åŠ ä½ éœ€è¦çš„é”®å’Œå€¼ã€‚ è®¿é—®çš„æ—¶å€™ç›´æ¥ä½¿ç”¨/æ¥å£å°±è¡Œ æµ‹è¯•è®°å½•ä¸€æ¸…äºŒæ¥š æ–°å¢collectionhistoryæ—è¾¹æœ‰collectionï¼Œå¯ä»¥ä½¿ç”¨å¹¶å‘æµ‹è¯•ã€‚ æ–°å»ºå¦‚å›¾ï¼š Iterationsé€‰æ‹©å¹¶å‘æ¬¡æ•°ï¼Œdelayé€‰æ‹©å»¶è¿Ÿæ—¶é—´ã€‚ ç»“æœæˆ‘å°±ä¸è´´å›¾äº†ï¼Œå¤§ä¼™è‡ªå·±æ¢ç´¢å§ã€‚ apache benchApacheBench æ˜¯ Apache æœåŠ¡å™¨è‡ªå¸¦çš„ä¸€ä¸ªwebå‹åŠ›æµ‹è¯•å·¥å…·ï¼Œç®€ç§°abã€‚abåˆæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯¹å‘èµ·è´Ÿè½½çš„æœ¬æœºè¦æ±‚å¾ˆä½ï¼Œæ ¹æ®abå‘½ä»¤å¯ä»¥åˆ›å»ºå¾ˆå¤šçš„å¹¶å‘è®¿é—®çº¿ç¨‹ï¼Œæ¨¡æ‹Ÿå¤šä¸ªè®¿é—®è€…åŒæ—¶å¯¹æŸä¸€URLåœ°å€è¿›è¡Œè®¿é—®ï¼Œå› æ­¤å¯ä»¥ç”¨æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨çš„è´Ÿè½½å‹åŠ›ã€‚æ€»çš„æ¥è¯´abå·¥å…·å°å·§ç®€å•ï¼Œä¸Šæ‰‹å­¦ä¹ è¾ƒå¿«ï¼Œå¯ä»¥æä¾›éœ€è¦çš„åŸºæœ¬æ€§èƒ½æŒ‡æ ‡ï¼Œä½†æ˜¯æ²¡æœ‰å›¾å½¢åŒ–ç»“æœï¼Œä¸èƒ½ç›‘æ§ã€‚ ä¸‹è½½å®‰è£…https://www.cnblogs.com/Ryana/p/6279232.html ä½¿ç”¨è¯´è¯´å‘½ä»¤å«ä¹‰ æœ€å¼€å¤´çš„å‘½ä»¤abæ˜¯apache benchçš„ç¼©å†™ï¼Œä½¿ç”¨ä»–å³æ„å‘³ç€ä½¿ç”¨è¿™ä¸ªè½¯ä»¶ -nå°±æ˜¯newäº†ã€‚ å‚æ•°1000æ˜¯æµ‹è¯•è¯·æ±‚æ¬¡æ•° -cå°±æ˜¯Concurrencyå¹¶å‘ï¼Œåé¢çš„å‚æ•°50ï¼Œæ˜¯åŒæ—¶å…è®¸çš„è¯·æ±‚æ•° ç»“æœå¦‚ä¸‹å›¾ğŸ‘‡ ç»“æœä¾æ¬¡çš„å«ä¹‰ä¸ºï¼š å¹¶å‘é‡50 æ•´ä¸ªæµ‹è¯•æ‰€ç”¨æ—¶é—´0.466 å®Œæˆè¯·æ±‚æ•°1000 å¤±è´¥è¯·æ±‚æ•°ç›®0 æ‰€æœ‰è¯·æ±‚å“åº”æ•°æ®çš„é•¿åº¦æ€»å’Œï¼ˆåŒ…æ‹¬æ‰€æœ‰httpå¤´éƒ¨å’Œæ­£æ–‡æ•°æ®çš„é•¿åº¦ï¼Œä¸åŒ…æ‹¬httpè¯·æ±‚æ•°æ®çš„é•¿åº¦ï¼‰136000B HTMLæ­£æ–‡æ•°æ®æ€»é•¿åº¦4000B ååç‡(TPS)2144.47 ç”¨æˆ·å¹³å‡è¯·æ±‚ç­‰å¾…æ—¶é—´23.316ms æœåŠ¡å™¨å¹³å‡è¯·æ±‚ç­‰å¾…æ—¶é—´0.466 å•ä½æ—¶é—´å†…çš„æ•°æ®é•¿åº¦284.81 Apache JMeterApache JMeteræ˜¯Apacheç»„ç»‡å¼€å‘çš„åŸºäºJavaçš„å‹åŠ›æµ‹è¯•å·¥å…·ã€‚ç”¨äºå¯¹è½¯ä»¶åšå‹åŠ›æµ‹è¯•ï¼Œå®ƒæœ€åˆè¢«è®¾è®¡ç”¨äºWebåº”ç”¨æµ‹è¯•ï¼Œä½†åæ¥æ‰©å±•åˆ°å…¶ä»–æµ‹è¯•é¢†åŸŸã€‚ å®ƒå¯ä»¥ç”¨äºæµ‹è¯•é™æ€å’ŒåŠ¨æ€èµ„æºï¼Œä¾‹å¦‚é™æ€æ–‡ä»¶ã€Java å°æœåŠ¡ç¨‹åºã€CGI è„šæœ¬ã€Java å¯¹è±¡ã€æ•°æ®åº“ã€FTP æœåŠ¡å™¨ï¼Œ ç­‰ç­‰ã€‚JMeter å¯ä»¥ç”¨äºå¯¹æœåŠ¡å™¨ã€ç½‘ç»œæˆ–å¯¹è±¡æ¨¡æ‹Ÿå·¨å¤§çš„è´Ÿè½½ï¼Œæ¥è‡ªä¸åŒå‹åŠ›ç±»åˆ«ä¸‹æµ‹è¯•å®ƒä»¬çš„å¼ºåº¦å’Œåˆ†ææ•´ä½“æ€§èƒ½ã€‚å¦å¤–ï¼ŒJMeterèƒ½å¤Ÿå¯¹åº”ç”¨ç¨‹åºåšåŠŸèƒ½/å›å½’æµ‹è¯•ï¼Œé€šè¿‡åˆ›å»ºå¸¦æœ‰æ–­è¨€çš„è„šæœ¬æ¥éªŒè¯ä½ çš„ç¨‹åºè¿”å›äº†ä½ æœŸæœ›çš„ç»“æœã€‚ä¸ºäº†æœ€å¤§é™åº¦çš„çµæ´»æ€§ï¼ŒJMeterå…è®¸ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åˆ›å»ºæ–­è¨€ã€‚ï¼ˆå¤åˆ¶çš„ç™¾åº¦ç™¾ç§‘çš„233ğŸ™ƒï¼‰ ä¸‹è½½å®‰è£…https://jmeter.apache.org/ UI ä½¿ç”¨æ–°å»ºæµ‹è¯•å¦‚å›¾ï¼Œåœ¨å³ä¾§æ–°å»ºçº¿ç¨‹ç»„ï¼Œè‡ªå·±å–ä¸ªåã€‚çœ‹å³ä¾§ã€‚ çº¿ç¨‹å±æ€§çš„çº¿ç¨‹æ•°æ˜¯ä»£è¡¨å¤šå°‘ç”¨æˆ·è®¿é—®è¿™ä¸ªç³»ç»Ÿã€‚è¿™é‡Œè¡¨ç¤ºæœ‰50ä¸ªç”¨æˆ·è®¿é—®ç³»ç»Ÿã€‚ ç¬¬äºŒè¡ŒR-U Pï¼Œæ˜¯è™šæ‹Ÿç”¨æˆ·å¢é•¿æ—¶é•¿ã€‚ä¸€èˆ¬çš„è¯æ—¶é—´è®¾ç½®æˆæœ€åˆä¹å¸¸è§„çš„ï¼Œç”¨æˆ·æ•°é‡å¢é•¿æœ€å¿«çš„æ—¶é—´æ®µã€‚ ç¬¬ä¸‰è¡Œï¼Œé»˜è®¤ä¸ºä¸€ï¼Œæ„æ€æ˜¯ä¸€ä¸ªè™šæ‹Ÿç”¨æˆ·é»˜è®¤è¿è¡Œå®Œä¸€è¾¹åå°±åœæ­¢äº†ã€‚æ—è¾¹çš„æ¡†æ¡†ï¼Œæ„å‘³ç€æµ‹è¯•è¿è¡Œèµ·æ¥å°±æ°¸è¿œä¸åœäº† æ–°å»ºhttpè¯·æ±‚å›åˆ°å·¦è¾¹ä¾§æ ï¼Œå³é”®çº¿ç¨‹ç»„ï¼Œæ–°å»ºHTTPè¯·æ±‚.å¦‚å›¾ æ–°å»ºç›‘å¬ç›‘å¬å°±æ˜¯ä»¥å›¾è¡¨å½¢å¼è¡¨ç°å‡ºæ¥æµ‹è¯•çš„ç»“æœã€‚ å®Œå…¨ç‰‡ç»“æŸï¼Œè§‰å¾—æˆ‘å†™çš„ä¸é”™ï¼Ÿæƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿèµ¶å¿«æ‰“å¼€æˆ‘çš„ğŸ‘‰ä¸ªäººåšå®¢ ğŸ‘ˆå§ï¼ è°¢è°¢ä½ é‚£ä¹ˆå¯çˆ±ï¼Œè¿˜ä¸€ç›´å…³æ³¨ç€æˆ‘~â¤ğŸ˜]]></content>
      <tags>
        <tag>å¹¶å‘</tag>
        <tag>åˆ†äº«</tag>
        <tag>è½¯ä»¶æ•™å­¦</tag>
        <tag>çªé—¨</tag>
        <tag>æµ‹è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[çœ‹Pigå¼€æºé¡¹ç›®çš„äº‘è¸©å‘è®°]]></title>
    <url>%2F2018%2F12%2F12%2F%E5%86%B7%E5%86%B7Pig%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘çœ‹åˆ°ä¸€ä¸ªæœ‰è¶£çš„å¼€æºé¡¹ç›®pigï¼Œä¸»è¦çš„æŠ€æœ¯ç‚¹åœ¨è®¤è¯æˆæƒä¸­å¿ƒï¼Œspring security oauthï¼Œzuulç½‘å…³å®ç°ï¼ŒElastic-Jobå®šæ—¶ä»»åŠ¡ï¼Œè¶ç€åˆšåˆšå…¥é—¨å¾®æœåŠ¡ï¼Œèµ¶å¿«å†™ä¸ªåšå®¢åˆ†æä¸€ä¸‹ã€‚æ­¤ç¯‡æ–‡ç« ä¸»è¦ç”¨äºä¸ªäººå¤‡å¿˜ã€‚å¦‚æœæœ‰ä¸å¯¹ï¼Œè¯·æ‰¹è¯„ã€‚ğŸ˜­ ç”±äºæ¯ä¸ªæ¨¡å—ç¯‡å¹…è¾ƒé•¿ï¼Œä¸”éƒ¨åˆ†å†…å®¹å’Œå‰æ–‡æœ‰é‡å ï¼Œå¹²è´§å’Œå›¾ç‰‡è¾ƒå°‘ï¼Œé˜…è¯»æ—¶ä½¿ç”¨æ—è¾¹çš„å¯¼èˆªåŠŸèƒ½ä½“éªŒè¾ƒä½³ã€‚ğŸ˜‰ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®https://blog.tengshe789.tech/ è¯´æ˜æœ¬ç¯‡æ–‡ç« æ˜¯å¯¹åŸºäºspring boot1.5çš„pig 1ç‰ˆæœ¬åšçš„åˆ†æï¼Œä¸æ˜¯æ”¶è´¹çš„pigx 2ç‰ˆæœ¬ã€‚ å¼€æºé¡¹ç›®åœ°å€https://gitee.com/log4j/pig é…ç½®ä¸­å¿ƒï¼šhttps://gitee.com/cqzqxq_lxh/pig-config å†·å†·å®˜æ–¹åœ°å€https://pig4cloud.com/zh-cn/index.html ä½“éªŒåœ°å€http://pigx.pig4cloud.com/#/wel/index é¡¹ç›®å¯åŠ¨é¡ºåºè¯·ç¡®ä¿å¯åŠ¨é¡ºåºï¼ˆè¦å…ˆå¯åŠ¨è®¤è¯ä¸­å¿ƒï¼Œå†å¯åŠ¨ç½‘å…³ï¼‰ eureka config auth gateway upms è®¤è¯ä¸­å¿ƒè€è§„çŸ©ï¼Œè‡ªä¸Šåˆ°ä¸‹çœ‹ä»£ç ï¼Œå…ˆä»æ¥å£å±‚çœ‹èµ· è¯·æ±‚restæ¥å£1234567891011121314151617181920212223242526272829303132333435363738@RestController@RequestMapping("/authentication")public class AuthenticationController &#123; @Autowired @Qualifier("consumerTokenServices") private ConsumerTokenServices consumerTokenServices; /** * è®¤è¯é¡µé¢ * @return ModelAndView */ @GetMapping("/require") public ModelAndView require() &#123; return new ModelAndView("ftl/login"); &#125; /** * ç”¨æˆ·ä¿¡æ¯æ ¡éªŒ * @param authentication ä¿¡æ¯ * @return ç”¨æˆ·ä¿¡æ¯ */ @RequestMapping("/user") public Object user(Authentication authentication) &#123; return authentication.getPrincipal(); &#125; /** * æ¸…é™¤Redisä¸­ accesstoken refreshtoken * * @param accesstoken accesstoken * @return true/false */ @PostMapping("/removeToken") @CacheEvict(value = SecurityConstants.TOKEN_USER_DETAIL, key = "#accesstoken") public R&lt;Boolean&gt; removeToken(String accesstoken) &#123; return new R&lt;&gt;( consumerTokenServices.revokeToken(accesstoken)); &#125;&#125; æ¥å£å±‚æœ‰ä¸‰ä¸ªæ¥å£è·¯å¾„ï¼Œç¬¬ä¸€ä¸ªåº”è¯¥æ²¡ç”¨ï¼Œå‰©ä¸‹ä¸¤ä¸ªæ˜¯æ ¡éªŒç”¨æˆ·ä¿¡æ¯çš„/userå’Œæ¸…é™¤Redisä¸­ accesstoken ä¸refreshtokençš„/removeToken æ¡†æ¶é…ç½®æ¡†æ¶é…ç½®ä¸‹é¢è¿™æ®µä»£ç æ—¶é…ç½®å„ç§spring securityé…ç½®ï¼ŒåŒ…æ‹¬ç™»é™†ç•Œé¢urlæ˜¯&quot;/authentication/require&quot;å•¦ã€‚å¦‚æœä¸ä½¿ç”¨é»˜è®¤çš„å¼¹å‡ºæ¡†è€Œä½¿ç”¨è‡ªå·±çš„é¡µé¢ï¼Œè¡¨å•çš„actionæ˜¯&quot;/authentication/form&quot;å•¦ã€‚ä½¿ç”¨è‡ªå·±å®šä¹‰çš„è¿‡æ»¤è§„åˆ™å•¦ã€‚ç¦ç”¨csrfå•¦ï¼ˆè‡ªè¡Œæœç´¢csrfï¼ŒjwtéªŒè¯ä¸éœ€è¦é˜²è·¨åŸŸï¼Œä½†æ˜¯éœ€è¦ä½¿ç”¨xssè¿‡æ»¤ï¼‰ã€‚ä½¿ç”¨æ‰‹æœºç™»é™†é…ç½®å•¦ã€‚ 1234567891011121314151617181920212223@Order(SecurityProperties.ACCESS_OVERRIDE_ORDER - 1)@Configuration@EnableWebSecuritypublic class PigSecurityConfigurerAdapter extends WebSecurityConfigurerAdapter &#123; @Autowired private FilterIgnorePropertiesConfig filterIgnorePropertiesConfig; @Autowired private MobileSecurityConfigurer mobileSecurityConfigurer; @Override public void configure(HttpSecurity http) throws Exception &#123; ExpressionUrlAuthorizationConfigurer&lt;HttpSecurity&gt;.ExpressionInterceptUrlRegistry registry = http.formLogin().loginPage("/authentication/require") .loginProcessingUrl("/authentication/form") .and() .authorizeRequests(); filterIgnorePropertiesConfig.getUrls().forEach(url -&gt; registry.antMatchers(url).permitAll()); registry.anyRequest().authenticated() .and() .csrf().disable(); http.apply(mobileSecurityConfigurer); &#125;&#125; æ ¡éªŒç”¨æˆ·ä¿¡æ¯è¯»é…ç½®ç±»å’Œæ¥å£å±‚ï¼Œæˆ‘ä»¬çŸ¥é“äº†ï¼Œæ€»çš„é€»è¾‘å¤§æ¦‚å°±æ˜¯ç”¨æˆ·ç™»é™†äº†ä»¥åï¼Œä½¿ç”¨spring securityæ¡†æ¶çš„è®¤è¯æ¥è·å–æƒé™ã€‚ æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥çœ‹ï¼Œè¾¹çŒœæƒ³è¾¹æ¥ã€‚æ¥å£å¤„æœ‰&quot;ftl/login&quot;ï¼Œè¿™å¤§æ¦‚å°±æ˜¯ä½¿ç”¨freemarkeræ¨¡æ¿ï¼Œloginä¿¡æ¯æºå¸¦çš„tokenä¼šä¼ åˆ°ç”¨æˆ·ä¿¡æ¯æ ¡éªŒurl&quot;/user&quot;ä¸Šï¼Œå¯ä½œè€…ç›´æ¥ä½¿ç”¨Authenticationè¿”å›ä¸€ä¸ªgetPrincipal()ï¼Œå°±æ²¡äº†ï¼Œæ ¹æœ¬æ²¡çœ‹è§è‡ªå®šä¹‰çš„ä»£ç ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ åŸæ¥ï¼Œä½œè€…ä½¿ç”¨spring securityæ¡†æ¶ï¼Œä½¿ç”¨æ¡†æ¶æ¥å®ç°æ ¡éªŒä¿¡æ¯ã€‚ æ‰“å¡configåŒ…ä¸‹çš„PigAuthorizationConfigï¼Œæˆ‘ä»¬æ¥ä¸€æ¢ç©¶ç«Ÿã€‚ ä½¿ç”¨spring security å®ç° æˆæƒæœåŠ¡å™¨æ³¨æ˜ï¼Œé˜…è¯»æ­¤å¤„æ¨¡å—éœ€è¦OAUTHåŸºç¡€ï¼Œhttps://blog.tengshe789.tech/2018/12/02/%E6%84%9F%E6%80%A7%E8%AE%A4%E8%AF%86jwt/#more è¿™é‡Œç®€å•æä¸€ä¸‹ï¼Œspring security oauthé‡Œæœ‰ä¸¤ä¸ªæ¦‚å¿µï¼ŒæˆæƒæœåŠ¡å™¨å’Œèµ„æºæœåŠ¡å™¨ã€‚ æˆæƒæœåŠ¡å™¨æ˜¯æ ¹æ®æˆæƒè®¸å¯ç»™è®¿é—®çš„å®¢æˆ·ç«¯å‘æ”¾access tokenä»¤ç‰Œçš„ï¼Œæä¾›è®¤è¯ã€æˆæƒæœåŠ¡ï¼› èµ„æºæœåŠ¡å™¨éœ€è¦éªŒè¯è¿™ä¸ªaccess token,å®¢æˆ·ç«¯æ‰èƒ½è®¿é—®å¯¹åº”æœåŠ¡ã€‚ å®¢æˆ·è¯¦ç»†ä¿¡æ¯æœåŠ¡é…ç½®ClientDetailsServiceConfigurer(AuthorizationServerConfigurer çš„ä¸€ä¸ªå›è°ƒé…ç½®é¡¹) èƒ½å¤Ÿä½¿ç”¨å†…å­˜æˆ–è€…JDBCæ¥å®ç°å®¢æˆ·ç«¯è¯¦æƒ…æœåŠ¡ï¼ˆClientDetailsServiceï¼‰ï¼ŒSpring Security OAuth2çš„é…ç½®æ–¹æ³•æ˜¯ç¼–å†™@Configurationç±»ç»§æ‰¿AuthorizationServerConfigurerAdapterï¼Œç„¶åé‡å†™void configure(ClientDetailsServiceConfigurer clients)æ–¹æ³• ä¸‹é¢ä»£ç ä¸»è¦é€»è¾‘æ˜¯ï¼Œä½¿ç”¨spring securityæ¡†æ¶å°è£…çš„ç®€å•sqlè¿æ¥å™¨ï¼ŒæŸ¥è¯¢å®¢æˆ·ç«¯çš„è¯¦ç»†ä¿¡æ¯ğŸ‘‡ 1234567@Override public void configure(` clients) throws Exception &#123; JdbcClientDetailsService clientDetailsService = new JdbcClientDetailsService(dataSource); clientDetailsService.setSelectClientDetailsSql(SecurityConstants.DEFAULT_SELECT_STATEMENT); clientDetailsService.setFindClientDetailsSql(SecurityConstants.DEFAULT_FIND_STATEMENT); clients.withClientDetails(clientDetailsService); &#125; ç›¸å…³çš„sqlè¯­å¥å¦‚ä¸‹ï¼Œç”±äºè€¦åˆåº¦è¾ƒå¤§ï¼Œæˆ‘å°†sqlå£°æ˜è¯­å¥æ”¹äº†ä¸€æ”¹ï¼Œæ–¹é¢é˜…è¯»ï¼š 123456789101112131415/** * é»˜è®¤çš„æŸ¥è¯¢è¯­å¥ */ String DEFAULT_FIND_STATEMENT = "select " + "client_id, client_secret, resource_ids, scope, " + "authorized_grant_types, web_server_redirect_uri, authorities, access_token_validity, " + "refresh_token_validity, additional_information, autoapprove" + " from sys_oauth_client_details" + " order by client_id"; /** * æŒ‰æ¡ä»¶client_id æŸ¥è¯¢ */ String DEFAULT_SELECT_STATEMENT = "select " +"client_id, client_secret, resource_ids, scope, " + "authorized_grant_types, web_server_redirect_uri, authorities, access_token_validity, " + "refresh_token_validity, additional_information, autoapprove" + " from sys_oauth_client_details" + " where client_id = ?"; ç›¸å…³æ•°æ®åº“ä¿¡æ¯å¦‚ä¸‹ï¼š æˆæƒæœåŠ¡å™¨ç«¯ç‚¹é…ç½®å™¨endpointså‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿæ‰€æœ‰è·å–ä»¤ç‰Œçš„è¯·æ±‚éƒ½å°†ä¼šåœ¨Spring MVC controller endpointsä¸­è¿›è¡Œå¤„ç† 1234567891011121314@Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) &#123; //tokenå¢å¼ºé…ç½® TokenEnhancerChain tokenEnhancerChain = new TokenEnhancerChain(); tokenEnhancerChain.setTokenEnhancers( Arrays.asList(tokenEnhancer(), jwtAccessTokenConverter())); endpoints .tokenStore(redisTokenStore()) .tokenEnhancer(tokenEnhancerChain) .authenticationManager(authenticationManager) .reuseRefreshTokens(false) .userDetailsService(userDetailsService); &#125; tokenå¢å¼ºå™¨ï¼ˆè‡ªå®šä¹‰tokenä¿¡æ¯ä¸­æºå¸¦çš„ä¿¡æ¯ï¼‰æœ‰æ—¶å€™éœ€è¦é¢å¤–çš„ä¿¡æ¯åŠ åˆ°tokenè¿”å›ä¸­ï¼Œè¿™éƒ¨åˆ†ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªTokenEnhancerï¼Œæ¥è‡ªå®šä¹‰ç”Ÿæˆtokenæºå¸¦çš„ä¿¡æ¯ã€‚TokenEnhanceræ¥å£æä¾›ä¸€ä¸ª enhance(OAuth2AccessToken var1, OAuth2Authentication var2) æ–¹æ³•ï¼Œç”¨äºå¯¹tokenä¿¡æ¯çš„æ·»åŠ ï¼Œä¿¡æ¯æ¥æºäºOAuth2Authenticationã€‚ ä½œè€…å°†ç”Ÿæˆçš„accessTokenä¸­ï¼ŒåŠ ä¸Šäº†è‡ªå·±çš„åå­—ï¼ŒåŠ ä¸Šäº†userId 12345678910111213@Bean public TokenEnhancer tokenEnhancer() &#123; return (accessToken, authentication) -&gt; &#123; final Map&lt;String, Object&gt; additionalInfo = new HashMap&lt;&gt;(2); additionalInfo.put("license", SecurityConstants.PIG_LICENSE); UserDetailsImpl user = (UserDetailsImpl) authentication.getUserAuthentication().getPrincipal(); if (user != null) &#123; additionalInfo.put("userId", user.getUserId()); &#125; ((DefaultOAuth2AccessToken) accessToken).setAdditionalInformation(additionalInfo); return accessToken; &#125;; &#125; JWTè½¬æ¢å™¨ï¼ˆè‡ªå®šä¹‰tokenä¿¡æ¯ä¸­æ·»åŠ çš„ä¿¡æ¯ï¼‰JWTä¸­ï¼Œéœ€è¦åœ¨tokenä¸­æºå¸¦é¢å¤–çš„ä¿¡æ¯ï¼Œè¿™æ ·å¯ä»¥åœ¨æœåŠ¡ä¹‹é—´å…±äº«éƒ¨åˆ†ç”¨æˆ·ä¿¡æ¯ï¼Œspring securityé»˜è®¤åœ¨JWTçš„tokenä¸­åŠ å…¥äº†user_nameï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦é¢å¤–çš„ä¿¡æ¯ï¼Œéœ€è¦è‡ªå®šä¹‰è¿™éƒ¨åˆ†å†…å®¹ã€‚ JwtAccessTokenConverteræ˜¯ä½¿ç”¨JWTæ›¿æ¢é»˜è®¤çš„Tokençš„è½¬æ¢å™¨ï¼Œè€Œtokenä»¤ç‰Œé»˜è®¤æ˜¯æœ‰ç­¾åçš„ï¼Œä¸”èµ„æºæœåŠ¡å™¨éœ€è¦éªŒè¯è¿™ä¸ªç­¾åã€‚æ­¤å¤„çš„åŠ å¯†åŠéªŒç­¾åŒ…æ‹¬ä¸¤ç§æ–¹å¼ï¼š å¯¹ç§°åŠ å¯† éå¯¹ç§°åŠ å¯†ï¼ˆå…¬é’¥å¯†é’¥ï¼‰ å¯¹ç§°åŠ å¯†éœ€è¦æˆæƒæœåŠ¡å™¨å’Œèµ„æºæœåŠ¡å™¨å­˜å‚¨åŒä¸€keyå€¼ï¼Œè€Œéå¯¹ç§°åŠ å¯†å¯ä½¿ç”¨å¯†é’¥åŠ å¯†ï¼Œæš´éœ²å…¬é’¥ç»™èµ„æºæœåŠ¡å™¨éªŒç­¾ 12345678910111213141516171819 public class PigJwtAccessTokenConverter extends JwtAccessTokenConverter &#123; @Override public Map&lt;String, ?&gt; convertAccessToken(OAuth2AccessToken token, OAuth2Authentication authentication) &#123; Map&lt;String, Object&gt; representation = (Map&lt;String, Object&gt;) super.convertAccessToken(token, authentication); representation.put("license", SecurityConstants.PIG_LICENSE); return representation; &#125; @Override public OAuth2AccessToken extractAccessToken(String value, Map&lt;String, ?&gt; map) &#123; return super.extractAccessToken(value, map); &#125; @Override public OAuth2Authentication extractAuthentication(Map&lt;String, ?&gt; map) &#123; return super.extractAuthentication(map); &#125;&#125; redisä¸tokenä½¿ç”¨é‰´æƒçš„endpointå°†åŠ ä¸Šè‡ªå·±åå­—çš„tokenæ”¾å…¥redisï¼Œredisè¿æ¥å™¨ç”¨çš„srping data redisæ¡†æ¶ 1234567891011121314/** * tokenstore å®šåˆ¶åŒ–å¤„ç† * * @return TokenStore * 1. å¦‚æœä½¿ç”¨çš„ redis-cluster æ¨¡å¼è¯·ä½¿ç”¨ PigRedisTokenStore * PigRedisTokenStore tokenStore = new PigRedisTokenStore(); * tokenStore.setRedisTemplate(redisTemplate); */ @Bean public TokenStore redisTokenStore() &#123; RedisTokenStore tokenStore = new RedisTokenStore(redisConnectionFactory); tokenStore.setPrefix(SecurityConstants.PIG_PREFIX); return tokenStore; &#125; æˆæƒæœåŠ¡å™¨å®‰å…¨é…ç½®å™¨1234567@Override public void configure(AuthorizationServerSecurityConfigurer security) throws Exception &#123; security .allowFormAuthenticationForClients() .tokenKeyAccess("isAuthenticated()") .checkTokenAccess("permitAll()"); &#125; è‡ªå®šä¹‰å®ç°çš„æ‰‹æœºå· è®¤è¯æœåŠ¡æ¥å£å±‚å…ˆçœ‹æ¥å£å±‚ï¼Œè¿™é‡Œå’Œpig-upms-serviceè”åŠ¨ï¼Œç»™äº†ä¸‰ä¸ªè·¯å¾„ï¼Œç”¨æˆ·ä½¿ç”¨æ‰‹æœºå·ç ç™»é™†å¯é€šè¿‡ä¸‰ä¸ªè·¯å¾„å‘é€è¯·æ±‚ 12345678910111213141516171819202122232425262728@FeignClient(name = "pig-upms-service", fallback = UserServiceFallbackImpl.class)public interface UserService &#123; /** * é€šè¿‡ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·ã€è§’è‰²ä¿¡æ¯ * * @param username ç”¨æˆ·å * @return UserVo */ @GetMapping("/user/findUserByUsername/&#123;username&#125;") UserVO findUserByUsername(@PathVariable("username") String username); /** * é€šè¿‡æ‰‹æœºå·æŸ¥è¯¢ç”¨æˆ·ã€è§’è‰²ä¿¡æ¯ * * @param mobile æ‰‹æœºå· * @return UserVo */ @GetMapping("/user/findUserByMobile/&#123;mobile&#125;") UserVO findUserByMobile(@PathVariable("mobile") String mobile); /** * æ ¹æ®OpenIdæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ * @param openId openId * @return UserVo */ @GetMapping("/user/findUserByOpenId/&#123;openId&#125;") UserVO findUserByOpenId(@PathVariable("openId") String openId);&#125; é…ç½®ç±»é‡å†™SecurityConfigurerAdapterçš„æ–¹æ³•ï¼Œé€šè¿‡httpè¯·æ±‚ï¼Œæ‰¾å‡ºæœ‰å…³æ‰‹æœºå·çš„tokenï¼Œç”¨tokenæ‰¾å‡ºç›¸å…³ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå·²Authenticationæ–¹å¼ä¿å­˜ã€‚æ‹¿åˆ°ä¿¡æ¯åï¼Œä½¿ç”¨è¿‡æ»¤å™¨éªŒè¯ 12345678910111213141516171819@Componentpublic class MobileSecurityConfigurer extends SecurityConfigurerAdapter&lt;DefaultSecurityFilterChain, HttpSecurity&gt; &#123; @Autowired private AuthenticationSuccessHandler mobileLoginSuccessHandler; @Autowired private UserService userService; @Override public void configure(HttpSecurity http) throws Exception &#123; MobileAuthenticationFilter mobileAuthenticationFilter = new MobileAuthenticationFilter(); mobileAuthenticationFilter.setAuthenticationManager(http.getSharedObject(AuthenticationManager.class)); mobileAuthenticationFilter.setAuthenticationSuccessHandler(mobileLoginSuccessHandler); MobileAuthenticationProvider mobileAuthenticationProvider = new MobileAuthenticationProvider(); mobileAuthenticationProvider.setUserService(userService); http.authenticationProvider(mobileAuthenticationProvider) .addFilterAfter(mobileAuthenticationFilter, UsernamePasswordAuthenticationFilter.class); &#125;&#125; æ‰‹æœºå·ç™»å½•æ ¡éªŒé€»è¾‘MobileAuthenticationProvideråœ¨spring security ä¸­ï¼ŒAuthenticationManageç®¡ç†ä¸€ç³»åˆ—çš„AuthenticationProviderï¼Œè€Œæ¯ä¸€ä¸ªProvideréƒ½ä¼šé€šUserDetailsServiceå’ŒUserDetailæ¥è¿”å›ä¸€ä¸ªä»¥MobileAuthenticationTokenå®ç°çš„å¸¦ç”¨æˆ·ä»¥åŠæƒé™çš„Authentication æ­¤å¤„é€»è¾‘æ˜¯ï¼Œé€šè¿‡UserServiceæŸ¥æ‰¾å·²æœ‰ç”¨æˆ·çš„æ‰‹æœºå·ç ï¼Œç”Ÿæˆå¯¹åº”çš„UserDetails,ä½¿ç”¨UserDetailsç”Ÿæˆæ‰‹æœºéªŒè¯Authentication 123456789101112131415161718192021222324@Override public Authentication authenticate(Authentication authentication) throws AuthenticationException &#123; MobileAuthenticationToken mobileAuthenticationToken = (MobileAuthenticationToken) authentication; UserVO userVo = userService.findUserByMobile((String) mobileAuthenticationToken.getPrincipal()); if (userVo == null) &#123; throw new UsernameNotFoundException("æ‰‹æœºå·ä¸å­˜åœ¨:" + mobileAuthenticationToken.getPrincipal()); &#125; UserDetailsImpl userDetails = buildUserDeatils(userVo); MobileAuthenticationToken authenticationToken = new MobileAuthenticationToken(userDetails, userDetails.getAuthorities()); authenticationToken.setDetails(mobileAuthenticationToken.getDetails()); return authenticationToken; &#125; private UserDetailsImpl buildUserDeatils(UserVO userVo) &#123; return new UserDetailsImpl(userVo); &#125; @Override public boolean supports(Class&lt;?&gt; authentication) &#123; return MobileAuthenticationToken.class.isAssignableFrom(authentication); &#125; æ‰‹æœºå·ç™»å½•ä»¤ç‰Œç±»MobileAuthenticationTokenMobileAuthenticationTokenç»§æ‰¿AbstractAuthenticationTokenå®ç°Authenticationæ‰€ä»¥å½“åœ¨é¡µé¢ä¸­è¾“å…¥æ‰‹æœºä¹‹åé¦–å…ˆä¼šè¿›å…¥åˆ°MobileAuthenticationTokenéªŒè¯(Authentication)ï¼Œç„¶åç”Ÿæˆçš„Authenticationä¼šè¢«äº¤ç”±æˆ‘ä¸Šé¢è¯´çš„AuthenticationManageræ¥è¿›è¡Œç®¡ç† 1234567891011121314151617181920212223242526272829303132333435363738394041424344public class MobileAuthenticationToken extends AbstractAuthenticationToken &#123; private static final long serialVersionUID = SpringSecurityCoreVersion.SERIAL_VERSION_UID; private final Object principal; public MobileAuthenticationToken(String mobile) &#123; super(null); this.principal = mobile; setAuthenticated(false); &#125; public MobileAuthenticationToken(Object principal, Collection&lt;? extends GrantedAuthority&gt; authorities) &#123; super(authorities); this.principal = principal; super.setAuthenticated(true); &#125; @Override public Object getPrincipal() &#123; return this.principal; &#125; @Override public Object getCredentials() &#123; return null; &#125; @Override public void setAuthenticated(boolean isAuthenticated) throws IllegalArgumentException &#123; if (isAuthenticated) &#123; throw new IllegalArgumentException( "Cannot set this token to trusted - use constructor which takes a GrantedAuthority list instead"); &#125; super.setAuthenticated(false); &#125; @Override public void eraseCredentials() &#123; super.eraseCredentials(); &#125;&#125; æ‰‹æœºå·ç™»å½•éªŒè¯filteråˆ¤æ–­httpè¯·æ±‚æ˜¯å¦æ˜¯postï¼Œä¸æ˜¯åˆ™è¿”å›é”™è¯¯ã€‚ æ ¹æ®requestè¯·æ±‚æ‹¿åˆ°moblieä¿¡æ¯ï¼Œä½¿ç”¨moblieä¿¡æ¯è¿”å›æ‰‹æœºå·ç ç™»é™†æˆåŠŸçš„oauth tokenã€‚ 12345678910111213141516171819202122@Override public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response) throws AuthenticationException &#123; if (postOnly &amp;&amp; !request.getMethod().equals(HttpMethod.POST.name())) &#123; throw new AuthenticationServiceException( "Authentication method not supported: " + request.getMethod()); &#125; String mobile = obtainMobile(request); if (mobile == null) &#123; mobile = ""; &#125; mobile = mobile.trim(); MobileAuthenticationToken mobileAuthenticationToken = new MobileAuthenticationToken(mobile); setDetails(request, mobileAuthenticationToken); return this.getAuthenticationManager().authenticate(mobileAuthenticationToken); &#125; æ‰‹æœºç™»é™†æˆåŠŸçš„å¤„ç†å™¨MobileLoginSuccessHandlerè¿™ä¸ªå¤„ç†å™¨å¯ä»¥è¿”å›æ‰‹æœºå·ç™»å½•æˆåŠŸçš„oauth tokenï¼Œä½†æ˜¯è¦å°†oauth tokenä¼ è¾“å‡ºå»å¿…é¡»é…åˆä¸Šé¢çš„æ‰‹æœºå·ç™»å½•éªŒè¯filter é€»è¾‘éƒ½åœ¨æ³¨é‡Šä¸­ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667@Override public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication) &#123; String header = request.getHeader("Authorization"); if (header == null || !header.startsWith(BASIC_)) &#123; throw new UnapprovedClientAuthenticationException("è¯·æ±‚å¤´ä¸­clientä¿¡æ¯ä¸ºç©º"); &#125; try &#123; String[] tokens = AuthUtils.extractAndDecodeHeader(header); assert tokens.length == 2; String clientId = tokens[0]; ClientDetails clientDetails = clientDetailsService.loadClientByClientId(clientId); //æ ¡éªŒsecret if (!clientDetails.getClientSecret().equals(tokens[1])) &#123; throw new InvalidClientException("Given client ID does not match authenticated client"); &#125; TokenRequest tokenRequest = new TokenRequest(MapUtil.newHashMap(), clientId, clientDetails.getScope(), "mobile"); //æ ¡éªŒscope new DefaultOAuth2RequestValidator().validateScope(tokenRequest, clientDetails); OAuth2Request oAuth2Request = tokenRequest.createOAuth2Request(clientDetails); OAuth2Authentication oAuth2Authentication = new OAuth2Authentication(oAuth2Request, authentication); OAuth2AccessToken oAuth2AccessToken = authorizationServerTokenServices.createAccessToken(oAuth2Authentication); log.info("è·å–token æˆåŠŸï¼š&#123;&#125;", oAuth2AccessToken.getValue()); response.setCharacterEncoding(CommonConstant.UTF8); response.setContentType(CommonConstant.CONTENT_TYPE); PrintWriter printWriter = response.getWriter(); printWriter.append(objectMapper.writeValueAsString(oAuth2AccessToken)); &#125; catch (IOException e) &#123; throw new BadCredentialsException( "Failed to decode basic authentication token"); &#125; &#125;/** * ä»header è¯·æ±‚ä¸­çš„clientId/clientsecect * * @param header headerä¸­çš„å‚æ•° * @throws CheckedException if the Basic header is not present or is not valid * Base64 */ public static String[] extractAndDecodeHeader(String header) throws IOException &#123; byte[] base64Token = header.substring(6).getBytes("UTF-8"); byte[] decoded; try &#123; decoded = Base64.decode(base64Token); &#125; catch (IllegalArgumentException e) &#123; throw new CheckedException( "Failed to decode basic authentication token"); &#125; String token = new String(decoded, CommonConstant.UTF8); int delim = token.indexOf(":"); if (delim == -1) &#123; throw new CheckedException("Invalid basic authentication token"); &#125; return new String[]&#123;token.substring(0, delim), token.substring(delim + 1)&#125;; &#125; å…¶ä»–é…ç½®redisé›†ç¾¤æŒºå¥½çš„æ¨¡æ¿ï¼Œæ”¶è—ä¸€ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196public class PigRedisTokenStore implements TokenStore &#123; private static final String ACCESS = "access:"; private static final String AUTH_TO_ACCESS = "auth_to_access:"; private static final String AUTH = "auth:"; private static final String REFRESH_AUTH = "refresh_auth:"; private static final String ACCESS_TO_REFRESH = "access_to_refresh:"; private static final String REFRESH = "refresh:"; private static final String REFRESH_TO_ACCESS = "refresh_to_access:"; private static final String CLIENT_ID_TO_ACCESS = "client_id_to_access:"; private static final String UNAME_TO_ACCESS = "uname_to_access:"; private RedisTemplate&lt;String, Object&gt; redisTemplate; public RedisTemplate&lt;String, Object&gt; getRedisTemplate() &#123; return redisTemplate; &#125; public void setRedisTemplate(RedisTemplate&lt;String, Object&gt; redisTemplate) &#123; this.redisTemplate = redisTemplate; &#125; private AuthenticationKeyGenerator authenticationKeyGenerator = new DefaultAuthenticationKeyGenerator(); public void setAuthenticationKeyGenerator(AuthenticationKeyGenerator authenticationKeyGenerator) &#123; this.authenticationKeyGenerator = authenticationKeyGenerator; &#125; @Override public OAuth2AccessToken getAccessToken(OAuth2Authentication authentication) &#123; String key = authenticationKeyGenerator.extractKey(authentication); OAuth2AccessToken accessToken = (OAuth2AccessToken) redisTemplate.opsForValue().get(AUTH_TO_ACCESS + key); if (accessToken != null &amp;&amp; !key.equals(authenticationKeyGenerator.extractKey(readAuthentication(accessToken.getValue())))) &#123; storeAccessToken(accessToken, authentication); &#125; return accessToken; &#125; @Override public OAuth2Authentication readAuthentication(OAuth2AccessToken token) &#123; return readAuthentication(token.getValue()); &#125; @Override public OAuth2Authentication readAuthentication(String token) &#123; return (OAuth2Authentication) this.redisTemplate.opsForValue().get(AUTH + token); &#125; @Override public OAuth2Authentication readAuthenticationForRefreshToken(OAuth2RefreshToken token) &#123; return readAuthenticationForRefreshToken(token.getValue()); &#125; public OAuth2Authentication readAuthenticationForRefreshToken(String token) &#123; return (OAuth2Authentication) this.redisTemplate.opsForValue().get(REFRESH_AUTH + token); &#125; @Override public void storeAccessToken(OAuth2AccessToken token, OAuth2Authentication authentication) &#123; this.redisTemplate.opsForValue().set(ACCESS + token.getValue(), token); this.redisTemplate.opsForValue().set(AUTH + token.getValue(), authentication); this.redisTemplate.opsForValue().set(AUTH_TO_ACCESS + authenticationKeyGenerator.extractKey(authentication), token); if (!authentication.isClientOnly()) &#123; redisTemplate.opsForList().rightPush(UNAME_TO_ACCESS + getApprovalKey(authentication), token); &#125; redisTemplate.opsForList().rightPush(CLIENT_ID_TO_ACCESS + authentication.getOAuth2Request().getClientId(), token); if (token.getExpiration() != null) &#123; int seconds = token.getExpiresIn(); redisTemplate.expire(ACCESS + token.getValue(), seconds, TimeUnit.SECONDS); redisTemplate.expire(AUTH + token.getValue(), seconds, TimeUnit.SECONDS); redisTemplate.expire(AUTH_TO_ACCESS + authenticationKeyGenerator.extractKey(authentication), seconds, TimeUnit.SECONDS); redisTemplate.expire(CLIENT_ID_TO_ACCESS + authentication.getOAuth2Request().getClientId(), seconds, TimeUnit.SECONDS); redisTemplate.expire(UNAME_TO_ACCESS + getApprovalKey(authentication), seconds, TimeUnit.SECONDS); &#125; if (token.getRefreshToken() != null &amp;&amp; token.getRefreshToken().getValue() != null) &#123; this.redisTemplate.opsForValue().set(REFRESH_TO_ACCESS + token.getRefreshToken().getValue(), token.getValue()); this.redisTemplate.opsForValue().set(ACCESS_TO_REFRESH + token.getValue(), token.getRefreshToken().getValue()); &#125; &#125; private String getApprovalKey(OAuth2Authentication authentication) &#123; String userName = authentication.getUserAuthentication() == null ? "" : authentication.getUserAuthentication() .getName(); return getApprovalKey(authentication.getOAuth2Request().getClientId(), userName); &#125; private String getApprovalKey(String clientId, String userName) &#123; return clientId + (userName == null ? "" : ":" + userName); &#125; @Override public void removeAccessToken(OAuth2AccessToken accessToken) &#123; removeAccessToken(accessToken.getValue()); &#125; @Override public OAuth2AccessToken readAccessToken(String tokenValue) &#123; return (OAuth2AccessToken) this.redisTemplate.opsForValue().get(ACCESS + tokenValue); &#125; public void removeAccessToken(String tokenValue) &#123; OAuth2AccessToken removed = (OAuth2AccessToken) redisTemplate.opsForValue().get(ACCESS + tokenValue); // caller to do that OAuth2Authentication authentication = (OAuth2Authentication) this.redisTemplate.opsForValue().get(AUTH + tokenValue); this.redisTemplate.delete(AUTH + tokenValue); redisTemplate.delete(ACCESS + tokenValue); this.redisTemplate.delete(ACCESS_TO_REFRESH + tokenValue); if (authentication != null) &#123; this.redisTemplate.delete(AUTH_TO_ACCESS + authenticationKeyGenerator.extractKey(authentication)); String clientId = authentication.getOAuth2Request().getClientId(); redisTemplate.opsForList().leftPop(UNAME_TO_ACCESS + getApprovalKey(clientId, authentication.getName())); redisTemplate.opsForList().leftPop(CLIENT_ID_TO_ACCESS + clientId); this.redisTemplate.delete(AUTH_TO_ACCESS + authenticationKeyGenerator.extractKey(authentication)); &#125; &#125; @Override public void storeRefreshToken(OAuth2RefreshToken refreshToken, OAuth2Authentication authentication) &#123; this.redisTemplate.opsForValue().set(REFRESH + refreshToken.getValue(), refreshToken); this.redisTemplate.opsForValue().set(REFRESH_AUTH + refreshToken.getValue(), authentication); &#125; @Override public OAuth2RefreshToken readRefreshToken(String tokenValue) &#123; return (OAuth2RefreshToken) this.redisTemplate.opsForValue().get(REFRESH + tokenValue); &#125; @Override public void removeRefreshToken(OAuth2RefreshToken refreshToken) &#123; removeRefreshToken(refreshToken.getValue()); &#125; public void removeRefreshToken(String tokenValue) &#123; this.redisTemplate.delete(REFRESH + tokenValue); this.redisTemplate.delete(REFRESH_AUTH + tokenValue); this.redisTemplate.delete(REFRESH_TO_ACCESS + tokenValue); &#125; @Override public void removeAccessTokenUsingRefreshToken(OAuth2RefreshToken refreshToken) &#123; removeAccessTokenUsingRefreshToken(refreshToken.getValue()); &#125; private void removeAccessTokenUsingRefreshToken(String refreshToken) &#123; String token = (String) this.redisTemplate.opsForValue().get(REFRESH_TO_ACCESS + refreshToken); if (token != null) &#123; redisTemplate.delete(ACCESS + token); &#125; &#125; @Override public Collection&lt;OAuth2AccessToken&gt; findTokensByClientIdAndUserName(String clientId, String userName) &#123; List&lt;Object&gt; result = redisTemplate.opsForList().range(UNAME_TO_ACCESS + getApprovalKey(clientId, userName), 0, -1); if (result == null || result.size() == 0) &#123; return Collections.emptySet(); &#125; List&lt;OAuth2AccessToken&gt; accessTokens = new ArrayList&lt;&gt;(result.size()); for (Iterator&lt;Object&gt; it = result.iterator(); it.hasNext(); ) &#123; OAuth2AccessToken accessToken = (OAuth2AccessToken) it.next(); accessTokens.add(accessToken); &#125; return Collections.unmodifiableCollection(accessTokens); &#125; @Override public Collection&lt;OAuth2AccessToken&gt; findTokensByClientId(String clientId) &#123; List&lt;Object&gt; result = redisTemplate.opsForList().range((CLIENT_ID_TO_ACCESS + clientId), 0, -1); if (result == null || result.size() == 0) &#123; return Collections.emptySet(); &#125; List&lt;OAuth2AccessToken&gt; accessTokens = new ArrayList&lt;&gt;(result.size()); for (Iterator&lt;Object&gt; it = result.iterator(); it.hasNext(); ) &#123; OAuth2AccessToken accessToken = (OAuth2AccessToken) it.next(); accessTokens.add(accessToken); &#125; return Collections.unmodifiableCollection(accessTokens); &#125;&#125; æœåŠ¡ç½‘å…³æ¨¡å—ç½‘å…³ä¸»ä½“åœ¨åŒ…pig\pig-gateway\src\main\java\com\github\pig\gatewayä¸‹ ä½œè€…ä½¿ç”¨äº†Zuulåšä¸ºç½‘å…³ï¼Œå®ƒNetflixå¼€æºçš„å¾®æœåŠ¡ç½‘å…³ï¼Œå¯ä»¥å’ŒEureka,Ribbon,Hystrixç­‰ç»„ä»¶é…åˆä½¿ç”¨ã€‚ Zuulç»„ä»¶çš„æ ¸å¿ƒæ˜¯ä¸€ç³»åˆ—çš„è¿‡æ»¤å™¨ï¼Œè¿™äº›è¿‡æ»¤å™¨å¯ä»¥å®Œæˆä»¥ä¸‹åŠŸèƒ½ï¼š èº«ä»½è®¤è¯å’Œå®‰å…¨: è¯†åˆ«æ¯ä¸€ä¸ªèµ„æºçš„éªŒè¯è¦æ±‚ï¼Œå¹¶æ‹’ç»é‚£äº›ä¸ç¬¦çš„è¯·æ±‚ å®¡æŸ¥ä¸ç›‘æ§ï¼š åŠ¨æ€è·¯ç”±ï¼šåŠ¨æ€å°†è¯·æ±‚è·¯ç”±åˆ°ä¸åŒåç«¯é›†ç¾¤ å‹åŠ›æµ‹è¯•ï¼šé€æ¸å¢åŠ æŒ‡å‘é›†ç¾¤çš„æµé‡ï¼Œä»¥äº†è§£æ€§èƒ½ è´Ÿè½½åˆ†é…ï¼šä¸ºæ¯ä¸€ç§è´Ÿè½½ç±»å‹åˆ†é…å¯¹åº”å®¹é‡ï¼Œå¹¶å¼ƒç”¨è¶…å‡ºé™å®šå€¼çš„è¯·æ±‚ é™æ€å“åº”å¤„ç†ï¼šè¾¹ç¼˜ä½ç½®è¿›è¡Œå“åº”ï¼Œé¿å…è½¬å‘åˆ°å†…éƒ¨é›†ç¾¤ å¤šåŒºåŸŸå¼¹æ€§ï¼šè·¨åŸŸAWS Regionè¿›è¡Œè¯·æ±‚è·¯ç”±ï¼Œæ—¨åœ¨å®ç°ELB(ElasticLoad Balancing)ä½¿ç”¨å¤šæ ·åŒ– å¤šç§åŠŸèƒ½çš„è¿‡æ»¤å™¨è¿‡æ»¤å™¨Zuulç»„ä»¶çš„æ ¸å¿ƒæ˜¯ä¸€ç³»åˆ—çš„è¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å…ˆä»è¿‡æ»¤å™¨ä¸‹æ‰‹ã€‚ ç½‘å…³ç»Ÿä¸€å¼‚å¸¸è¿‡æ»¤å™¨123456789101112131415161718192021222324@Componentpublic class ErrorHandlerFilter extends ZuulFilter &#123; @Autowired private LogSendService logSendService; @Override public String filterType() &#123; return ERROR_TYPE; &#125; @Override public int filterOrder() &#123; return SEND_RESPONSE_FILTER_ORDER + 1; &#125; @Override public boolean shouldFilter() &#123; RequestContext requestContext = RequestContext.getCurrentContext(); return requestContext.getThrowable() != null; &#125; @Override public Object run() &#123; RequestContext requestContext = RequestContext.getCurrentContext(); logSendService.send(requestContext); return null; &#125;&#125; ä½œè€…ä»¥åŸç”Ÿzuulè¿‡æ»¤å™¨ä¸ºåŸºç¡€åŠ äº†æ—¥å¿—é…ç½®,ä¼˜å…ˆçº§ä¸º+1ï¼Œæ•°å­—è¶Šå¤§ä¼˜å…ˆçº§è¶Šä½ã€‚ XSSè¿‡æ»¤å™¨123456public class XssSecurityFilter extends OncePerRequestFilter &#123; @Override protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException &#123; XssHttpServletRequestWrapper xssRequest = new XssHttpServletRequestWrapper(request); filterChain.doFilter(xssRequest, response); &#125; é‡å†™springMVCé‡Œé¢çš„çš„ç¡®ä¿åœ¨ä¸€æ¬¡è¯·æ±‚åªé€šè¿‡ä¸€æ¬¡filterçš„ç±»OncePerRequestFilterï¼Œæ·»åŠ ä¸€æ¡https://gitee.com/renrenio/renren-fastçš„å·¥å…·ç±»`XssHttpServletRequestWrapper`ä¸ºè¿‡æ»¤é“¾æ¡ã€‚ 1234567891011@Override public ServletInputStream getInputStream() throws IOException &#123;Â·Â·Â·Â·ç•¥ //xssè¿‡æ»¤ json = xssEncode(json); final ByteArrayInputStream bis = new ByteArrayInputStream(json.getBytes("utf-8")); return new ServletInputStream() &#123;Â·Â·Â·ç•¥ &#125; &#125;; &#125; å¯†ç è¿‡æ»¤å™¨DecodePasswordFilteræ­¤è¿‡æ»¤å™¨ä¼˜å…ˆçº§ä¸º+2.æ¯å½“ä¸€ä¸ªè¯·æ±‚ä¸æ˜¯è¯·æ±‚/oauth/tokenæˆ–è€…/mobile/tokenè¿™ä¸ªåœ°å€æ—¶ï¼Œéƒ½ä¼šè§£æä½¿ç”¨aesè§£ç å™¨passwordã€‚ 12345678910111213141516171819202122232425@Override public Object run() &#123; RequestContext ctx = RequestContext.getCurrentContext(); Map&lt;String, List&lt;String&gt;&gt; params = ctx.getRequestQueryParams(); if (params == null) &#123; return null; &#125; List&lt;String&gt; passList = params.get(PASSWORD); if (CollUtil.isEmpty(passList)) &#123; return null; &#125; String password = passList.get(0); if (StrUtil.isNotBlank(password)) &#123; try &#123; password = decryptAES(password, key); &#125; catch (Exception e) &#123; log.error("å¯†ç è§£å¯†å¤±è´¥:&#123;&#125;", password); &#125; params.put(PASSWORD, CollUtil.newArrayList(password.trim())); &#125; ctx.setRequestQueryParams(params); return null; &#125; æ ¡éªŒç è¿‡æ»¤å™¨ValidateCodeFilteré€»è¾‘ä½œè€…éƒ½å†™åœ¨æ³¨é‡Šä¸­äº†ï¼Œæ­¤å¤„ä½¿ç”¨äº†redisåšä¸ºæœåŠ¡ç«¯éªŒè¯ç çš„ç¼“å­˜ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192** * æ˜¯å¦æ ¡éªŒéªŒè¯ç  * 1. åˆ¤æ–­éªŒè¯ç å¼€å…³æ˜¯å¦å¼€å¯ * 2. åˆ¤æ–­è¯·æ±‚æ˜¯å¦ç™»å½•è¯·æ±‚ * 2.1 åˆ¤æ–­æ˜¯ä¸æ˜¯åˆ·æ–°è¯·æ±‚(ä¸ç”¨å•ç‹¬åœ¨å»ºç«‹åˆ·æ–°å®¢æˆ·ç«¯) * 3. åˆ¤æ–­ç»ˆç«¯æ˜¯å¦æ”¯æŒ * * @return true/false */ @Override public boolean shouldFilter() &#123; HttpServletRequest request = RequestContext.getCurrentContext().getRequest(); if (!StrUtil.containsAnyIgnoreCase(request.getRequestURI(), SecurityConstants.OAUTH_TOKEN_URL, SecurityConstants.MOBILE_TOKEN_URL)) &#123; return false; &#125; if (SecurityConstants.REFRESH_TOKEN.equals(request.getParameter(GRANT_TYPE))) &#123; return false; &#125; try &#123; String[] clientInfos = AuthUtils.extractAndDecodeHeader(request); if (CollUtil.containsAny(filterIgnorePropertiesConfig.getClients(), Arrays.asList(clientInfos))) &#123; return false; &#125; &#125; catch (IOException e) &#123; log.error("è§£æç»ˆç«¯ä¿¡æ¯å¤±è´¥", e); &#125; return true; &#125; @Override public Object run() &#123; try &#123; checkCode(RequestContext.getCurrentContext().getRequest()); &#125; catch (ValidateCodeException e) &#123; RequestContext ctx = RequestContext.getCurrentContext(); R&lt;String&gt; result = new R&lt;&gt;(e); result.setCode(478); ctx.setResponseStatusCode(478); ctx.setSendZuulResponse(false); ctx.getResponse().setContentType("application/json;charset=UTF-8"); ctx.setResponseBody(JSONObject.toJSONString(result)); &#125; return null; &#125; /** * æ£€æŸ¥code * * @param httpServletRequest request * @throws ValidateCodeException éªŒè¯ç æ ¡éªŒå¼‚å¸¸ */ private void checkCode(HttpServletRequest httpServletRequest) throws ValidateCodeException &#123; String code = httpServletRequest.getParameter("code"); if (StrUtil.isBlank(code)) &#123; throw new ValidateCodeException("è¯·è¾“å…¥éªŒè¯ç "); &#125; String randomStr = httpServletRequest.getParameter("randomStr"); if (StrUtil.isBlank(randomStr)) &#123; randomStr = httpServletRequest.getParameter("mobile"); &#125; String key = SecurityConstants.DEFAULT_CODE_KEY + randomStr; if (!redisTemplate.hasKey(key)) &#123; throw new ValidateCodeException(EXPIRED_CAPTCHA_ERROR); &#125; Object codeObj = redisTemplate.opsForValue().get(key); if (codeObj == null) &#123; throw new ValidateCodeException(EXPIRED_CAPTCHA_ERROR); &#125; String saveCode = codeObj.toString(); if (StrUtil.isBlank(saveCode)) &#123; redisTemplate.delete(key); throw new ValidateCodeException(EXPIRED_CAPTCHA_ERROR); &#125; if (!StrUtil.equals(saveCode, code)) &#123; redisTemplate.delete(key); throw new ValidateCodeException("éªŒè¯ç é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥"); &#125; redisTemplate.delete(key); &#125; ç°åº¦å‘å¸ƒç°åº¦å‘å¸ƒï¼Œå·²ç»ä¸æ˜¯ä¸€ä¸ªå¾ˆæ–°çš„æ¦‚å¿µäº†ï¼ä¸€ä¸ªäº§å“ï¼Œå¦‚æœéœ€è¦å¿«é€Ÿè¿­ä»£å¼€å‘ä¸Šçº¿ï¼Œåˆè¦ä¿è¯è´¨é‡ï¼Œä¿è¯åˆšä¸Šçº¿çš„ç³»ç»Ÿï¼Œä¸€æ—¦å‡ºç°é—®é¢˜é‚£ä¹ˆå¯ä»¥å¾ˆå¿«çš„æ§åˆ¶å½±å“é¢ï¼Œå°±éœ€è¦è®¾è®¡ä¸€å¥—ç°åº¦å‘å¸ƒç³»ç»Ÿï¼ ç°åº¦å‘å¸ƒç³»ç»Ÿçš„ä½œç”¨åœ¨äºï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„é…ç½®ï¼Œæ¥å°†ç”¨æˆ·çš„æµé‡å¯¼åˆ°æ–°ä¸Šçº¿çš„ç³»ç»Ÿä¸Šï¼Œæ¥å¿«é€ŸéªŒè¯æ–°çš„åŠŸèƒ½ä¿®æ”¹ï¼Œè€Œä¸€æ—¦å‡ºé—®é¢˜ï¼Œä¹Ÿå¯ä»¥é©¬ä¸Šçš„æ¢å¤ï¼Œç®€å•çš„è¯´ï¼Œå°±æ˜¯ä¸€å¥—A/BTestç³»ç»Ÿï¼ åˆå§‹åŒ–ä¸‹é¢æ˜¯ç°åº¦è·¯ç”±åˆå§‹åŒ–ç±»ï¼š 12345678910111213@Configuration@ConditionalOnClass(DiscoveryEnabledNIWSServerList.class)@AutoConfigureBefore(RibbonClientConfiguration.class)@ConditionalOnProperty(value = "zuul.ribbon.metadata.enabled")public class RibbonMetaFilterAutoConfiguration &#123; @Bean @ConditionalOnMissingBean @Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE) public ZoneAvoidanceRule metadataAwareRule() &#123; return new MetadataCanaryRuleHandler(); &#125;&#125; ç°åº¦å‘å¸ƒæœ‰å…³è¿‡æ»¤å™¨AccessFilteré¦–å…ˆé‡å†™filterOrder()æ–¹æ³•ï¼Œä½¿è¿™ä¸ªè¿‡æ»¤å™¨åœ¨åœ¨RateLimitPreFilterä¹‹å‰è¿è¡Œï¼Œä¸ä¼šå‡ºç°ç©ºæŒ‡é’ˆé—®é¢˜ã€‚æ­¤å¤„ä¼˜å…ˆçº§FORM_BODY_WRAPPER_FILTER_ORDER-1. 12345678910111213141516171819202122232425262728293031323334353637@Componentpublic class AccessFilter extends ZuulFilter &#123; @Value("$&#123;zuul.ribbon.metadata.enabled:false&#125;") private boolean canary; @Override public String filterType() &#123; return FilterConstants.PRE_TYPE; &#125; @Override public int filterOrder() &#123; return FORM_BODY_WRAPPER_FILTER_ORDER - 1; &#125; @Override public boolean shouldFilter() &#123; return true; &#125; @Override public Object run() &#123; RequestContext requestContext = RequestContext.getCurrentContext(); String version = requestContext.getRequest().getHeader(SecurityConstants.VERSION); if (canary &amp;&amp; StrUtil.isNotBlank(version)) &#123; RibbonVersionHolder.setContext(version); &#125; requestContext.set("startTime", System.currentTimeMillis()); Authentication authentication = SecurityContextHolder.getContext().getAuthentication(); if (authentication != null) &#123; requestContext.addZuulRequestHeader(SecurityConstants.USER_HEADER, authentication.getName()); requestContext.addZuulRequestHeader(SecurityConstants.ROLE_HEADER, CollectionUtil.join(authentication.getAuthorities(), ",")); &#125; return null; &#125;&#125; æ ¸å¿ƒæ–¹æ³•åœ¨run()ä¸Šï¼Œé¦–å…ˆå—åˆ°requestè¯·æ±‚ï¼Œæ‹¿åˆ°ä»–çš„ç‰ˆæœ¬çº¦æŸä¿¡æ¯ï¼Œç„¶åæ ¹æ®é€‰æ‹©æ·»åŠ token è·¯ç”±å¾®æœåŠ¡æ–­è¨€å¤„ç†å™¨MetadataCanaryRuleHandlerè‡ªå®šä¹‰ribbonè·¯ç”±è§„åˆ™åŒ¹é…å¤šç‰ˆæœ¬è¯·æ±‚ï¼Œå®ç°ç°åº¦å‘å¸ƒã€‚å¤åˆåˆ¤æ–­serveræ‰€åœ¨åŒºåŸŸçš„æ€§èƒ½å’Œserverçš„å¯ç”¨æ€§é€‰æ‹©serverï¼Œå³ï¼Œä½¿ç”¨ZoneAvoidancePredicateå’ŒAvailabilityPredicateæ¥åˆ¤æ–­æ˜¯å¦é€‰æ‹©æŸä¸ªserverï¼Œå‰ä¸€ä¸ªåˆ¤æ–­åˆ¤å®šä¸€ä¸ªzoneçš„è¿è¡Œæ€§èƒ½æ˜¯å¦å¯ç”¨ï¼Œå‰”é™¤ä¸å¯ç”¨çš„zoneï¼ˆçš„æ‰€æœ‰serverï¼‰ï¼ŒAvailabilityPredicateç”¨äºè¿‡æ»¤æ‰è¿æ¥æ•°è¿‡å¤šçš„Serverã€‚ æ­¤å¤„é€»è¾‘æ˜¯ eureka metadata ï¼ˆä¸»æœºåï¼ŒIPåœ°å€ï¼Œç«¯å£å·ï¼ŒçŠ¶æ€é¡µå¥åº·æ£€æŸ¥ç­‰ä¿¡æ¯ï¼Œæˆ–è€…é€šè¿‡é…ç½®æ–‡ä»¶è‡ªå®šä¹‰å…ƒæ•°æ®ï¼‰å­˜åœ¨ç‰ˆæœ¬å®šä¹‰æ—¶å€™è¿›è¡Œåˆ¤æ–­ ä¸å­˜åœ¨ metadata ç›´æ¥è¿”å›true 1234567891011121314151617181920212223242526272829@Override public AbstractServerPredicate getPredicate() &#123; return new AbstractServerPredicate() &#123; @Override public boolean apply(PredicateKey predicateKey) &#123; String targetVersion = RibbonVersionHolder.getContext(); RibbonVersionHolder.clearContext(); if (StrUtil.isBlank(targetVersion)) &#123; log.debug("å®¢æˆ·ç«¯æœªé…ç½®ç›®æ ‡ç‰ˆæœ¬ç›´æ¥è·¯ç”±"); return true; &#125; DiscoveryEnabledServer server = (DiscoveryEnabledServer) predicateKey.getServer(); final Map&lt;String, String&gt; metadata = server.getInstanceInfo().getMetadata(); if (StrUtil.isBlank(metadata.get(SecurityConstants.VERSION))) &#123; log.debug("å½“å‰å¾®æœåŠ¡&#123;&#125; æœªé…ç½®ç‰ˆæœ¬ç›´æ¥è·¯ç”±"); return true; &#125; if (metadata.get(SecurityConstants.VERSION).equals(targetVersion)) &#123; return true; &#125; else &#123; log.debug("å½“å‰å¾®æœåŠ¡&#123;&#125; ç‰ˆæœ¬ä¸º&#123;&#125;ï¼Œç›®æ ‡ç‰ˆæœ¬&#123;&#125; åŒ¹é…å¤±è´¥", server.getInstanceInfo().getAppName() , metadata.get(SecurityConstants.VERSION), targetVersion); return false; &#125; &#125; &#125;; &#125; åŠ¨æ€è·¯ç”±é…ç½®123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687public class DynamicRouteLocator extends DiscoveryClientRouteLocator &#123; private ZuulProperties properties; private RedisTemplate redisTemplate; public DynamicRouteLocator(String servletPath, DiscoveryClient discovery, ZuulProperties properties, ServiceInstance localServiceInstance, RedisTemplate redisTemplate) &#123; super(servletPath, discovery, properties, localServiceInstance); this.properties = properties; this.redisTemplate = redisTemplate; &#125; /** * é‡å†™è·¯ç”±é…ç½® * &lt;p&gt; * 1. properties é…ç½®ã€‚ * 2. eureka é»˜è®¤é…ç½®ã€‚ * 3. DBæ•°æ®åº“é…ç½®ã€‚ * * @return è·¯ç”±è¡¨ */ @Override protected LinkedHashMap&lt;String, ZuulProperties.ZuulRoute&gt; locateRoutes() &#123; LinkedHashMap&lt;String, ZuulProperties.ZuulRoute&gt; routesMap = new LinkedHashMap&lt;&gt;(); //è¯»å–propertiesé…ç½®ã€eurekaé»˜è®¤é…ç½® routesMap.putAll(super.locateRoutes()); log.debug("åˆå§‹é»˜è®¤çš„è·¯ç”±é…ç½®å®Œæˆ"); routesMap.putAll(locateRoutesFromDb()); LinkedHashMap&lt;String, ZuulProperties.ZuulRoute&gt; values = new LinkedHashMap&lt;&gt;(); for (Map.Entry&lt;String, ZuulProperties.ZuulRoute&gt; entry : routesMap.entrySet()) &#123; String path = entry.getKey(); if (!path.startsWith("/")) &#123; path = "/" + path; &#125; if (StrUtil.isNotBlank(this.properties.getPrefix())) &#123; path = this.properties.getPrefix() + path; if (!path.startsWith("/")) &#123; path = "/" + path; &#125; &#125; values.put(path, entry.getValue()); &#125; return values; &#125; /** * Redisä¸­ä¿å­˜çš„ï¼Œæ²¡æœ‰ä»upmsæ‹‰å»ï¼Œé¿å…å¯åŠ¨é“¾è·¯ä¾èµ–é—®é¢˜ï¼ˆå–èˆï¼‰ï¼Œç½‘å…³ä¾èµ–ä¸šåŠ¡æ¨¡å—çš„é—®é¢˜ * * @return */ private Map&lt;String, ZuulProperties.ZuulRoute&gt; locateRoutesFromDb() &#123; Map&lt;String, ZuulProperties.ZuulRoute&gt; routes = new LinkedHashMap&lt;&gt;(); Object obj = redisTemplate.opsForValue().get(CommonConstant.ROUTE_KEY); if (obj == null) &#123; return routes; &#125; List&lt;SysZuulRoute&gt; results = (List&lt;SysZuulRoute&gt;) obj; for (SysZuulRoute result : results) &#123; if (StrUtil.isBlank(result.getPath()) &amp;&amp; StrUtil.isBlank(result.getUrl())) &#123; continue; &#125; ZuulProperties.ZuulRoute zuulRoute = new ZuulProperties.ZuulRoute(); try &#123; zuulRoute.setId(result.getServiceId()); zuulRoute.setPath(result.getPath()); zuulRoute.setServiceId(result.getServiceId()); zuulRoute.setRetryable(StrUtil.equals(result.getRetryable(), "0") ? Boolean.FALSE : Boolean.TRUE); zuulRoute.setStripPrefix(StrUtil.equals(result.getStripPrefix(), "0") ? Boolean.FALSE : Boolean.TRUE); zuulRoute.setUrl(result.getUrl()); List&lt;String&gt; sensitiveHeadersList = StrUtil.splitTrim(result.getSensitiveheadersList(), ","); if (sensitiveHeadersList != null) &#123; Set&lt;String&gt; sensitiveHeaderSet = CollUtil.newHashSet(); sensitiveHeadersList.forEach(sensitiveHeader -&gt; sensitiveHeaderSet.add(sensitiveHeader)); zuulRoute.setSensitiveHeaders(sensitiveHeaderSet); zuulRoute.setCustomSensitiveHeaders(true); &#125; &#125; catch (Exception e) &#123; log.error("ä»æ•°æ®åº“åŠ è½½è·¯ç”±é…ç½®å¼‚å¸¸", e); &#125; log.debug("æ·»åŠ æ•°æ®åº“è‡ªå®šä¹‰çš„è·¯ç”±é…ç½®,pathï¼š&#123;&#125;ï¼ŒserviceId:&#123;&#125;", zuulRoute.getPath(), zuulRoute.getServiceId()); routes.put(zuulRoute.getPath(), zuulRoute); &#125; return routes; &#125;&#125; ç½‘å…³æ—¥å¿—å¤„ç†ä»£ç æ³¨é‡Šå·²ç»å°†é€»è¾‘å†™çš„å¾ˆæ¸…æ¥šäº† 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576@Slf4j@Componentpublic class LogSendServiceImpl implements LogSendService &#123; private static final String SERVICE_ID = "serviceId"; @Autowired private AmqpTemplate rabbitTemplate; /** * 1. è·å– requestContext ä¸­çš„è¯·æ±‚ä¿¡æ¯ * 2. å¦‚æœè¿”å›çŠ¶æ€ä¸æ˜¯OKï¼Œåˆ™è·å–è¿”å›ä¿¡æ¯ä¸­çš„é”™è¯¯ä¿¡æ¯ * 3. å‘é€åˆ°MQ * * @param requestContext ä¸Šä¸‹æ–‡å¯¹è±¡ */ @Override public void send(RequestContext requestContext) &#123; HttpServletRequest request = requestContext.getRequest(); String requestUri = request.getRequestURI(); String method = request.getMethod(); SysLog sysLog = new SysLog(); sysLog.setType(CommonConstant.STATUS_NORMAL); sysLog.setRemoteAddr(HttpUtil.getClientIP(request)); sysLog.setRequestUri(URLUtil.getPath(requestUri)); sysLog.setMethod(method); sysLog.setUserAgent(request.getHeader("user-agent")); sysLog.setParams(HttpUtil.toParams(request.getParameterMap())); Long startTime = (Long) requestContext.get("startTime"); sysLog.setTime(System.currentTimeMillis() - startTime); if (requestContext.get(SERVICE_ID) != null) &#123; sysLog.setServiceId(requestContext.get(SERVICE_ID).toString()); &#125; //æ­£å¸¸å‘é€æœåŠ¡å¼‚å¸¸è§£æ if (requestContext.getResponseStatusCode() == HttpStatus.SC_INTERNAL_SERVER_ERROR &amp;&amp; requestContext.getResponseDataStream() != null) &#123; InputStream inputStream = requestContext.getResponseDataStream(); ByteArrayOutputStream baos = new ByteArrayOutputStream(); InputStream stream1 = null; InputStream stream2; byte[] buffer = IoUtil.readBytes(inputStream); try &#123; baos.write(buffer); baos.flush(); stream1 = new ByteArrayInputStream(baos.toByteArray()); stream2 = new ByteArrayInputStream(baos.toByteArray()); String resp = IoUtil.read(stream1, CommonConstant.UTF8); sysLog.setType(CommonConstant.STATUS_LOCK); sysLog.setException(resp); requestContext.setResponseDataStream(stream2); &#125; catch (IOException e) &#123; log.error("å“åº”æµè§£æå¼‚å¸¸ï¼š", e); throw new RuntimeException(e); &#125; finally &#123; IoUtil.close(stream1); IoUtil.close(baos); IoUtil.close(inputStream); &#125; &#125; //ç½‘å…³å†…éƒ¨å¼‚å¸¸ Throwable throwable = requestContext.getThrowable(); if (throwable != null) &#123; log.error("ç½‘å…³å¼‚å¸¸", throwable); sysLog.setException(throwable.getMessage()); &#125; //ä¿å­˜å‘å¾€MQï¼ˆåªä¿å­˜æˆæƒï¼‰ Authentication authentication = SecurityContextHolder.getContext().getAuthentication(); if (authentication != null &amp;&amp; StrUtil.isNotBlank(authentication.getName())) &#123; LogVO logVo = new LogVO(); sysLog.setCreateBy(authentication.getName()); logVo.setSysLog(sysLog); logVo.setUsername(authentication.getName()); rabbitTemplate.convertAndSend(MqQueueConstant.LOG_QUEUE, logVo); &#125; &#125;&#125; å¤šç»´åº¦é™æµé™æµé™çº§å¤„ç†å™¨ZuulRateLimiterErrorHandleré‡å†™zuulä¸­é»˜è®¤çš„é™æµå¤„ç†å™¨DefaultRateLimiterErrorHandlerï¼Œä½¿ä¹‹è®°å½•æ—¥å¿—å†…å®¹ 12345678910111213141516171819@Bean public RateLimiterErrorHandler rateLimitErrorHandler() &#123; return new DefaultRateLimiterErrorHandler() &#123; @Override public void handleSaveError(String key, Exception e) &#123; log.error("ä¿å­˜key:[&#123;&#125;]å¼‚å¸¸", key, e); &#125; @Override public void handleFetchError(String key, Exception e) &#123; log.error("è·¯ç”±å¤±è´¥:[&#123;&#125;]å¼‚å¸¸", key); &#125; @Override public void handleError(String msg, Exception e) &#123; log.error("é™æµå¼‚å¸¸:[&#123;&#125;]", msg, e); &#125; &#125;; &#125; ä¸spring security oAuthæ–¹æ³•æ•´åˆå•ç‚¹ç™»é™†æˆæƒæ‹’ç»å¤„ç†å™¨ PigAccessDeniedHandleré‡å†™Srping security oAuth æä¾›å•ç‚¹ç™»å½•éªŒè¯æ‹’ç»OAuth2AccessDeniedHandleræ¥å£ï¼Œä½¿ç”¨RåŒ…è£…å¤±è´¥ä¿¡æ¯åˆ°PigDeniedException 12345678910@Override public void handle(HttpServletRequest request, HttpServletResponse response, AccessDeniedException authException) throws IOException, ServletException &#123; log.info("æˆæƒå¤±è´¥ï¼Œç¦æ­¢è®¿é—® &#123;&#125;", request.getRequestURI()); response.setCharacterEncoding(CommonConstant.UTF8); response.setContentType(CommonConstant.CONTENT_TYPE); R&lt;String&gt; result = new R&lt;&gt;(new PigDeniedException("æˆæƒå¤±è´¥ï¼Œç¦æ­¢è®¿é—®")); response.setStatus(HttpStatus.SC_FORBIDDEN); PrintWriter printWriter = response.getWriter(); printWriter.append(objectMapper.writeValueAsString(result)); &#125; èœå•ç®¡ç†MenuService1234567891011@FeignClient(name = "pig-upms-service", fallback = MenuServiceFallbackImpl.class)public interface MenuService &#123; /** * é€šè¿‡è§’è‰²åæŸ¥è¯¢èœå• * * @param role è§’è‰²åç§° * @return èœå•åˆ—è¡¨ */ @GetMapping(value = "/menu/findMenuByRole/&#123;role&#125;") Set&lt;MenuVO&gt; findMenuByRole(@PathVariable("role") String role);&#125; ä½¿ç”¨feignè¿æ¥pigç³»ç»Ÿçš„èœå•å¾®æœåŠ¡ èœå•æƒé™123456789101112131415161718192021222324252627282930313233343536373839@Service("permissionService")public class PermissionServiceImpl implements PermissionService &#123; @Autowired private MenuService menuService; private AntPathMatcher antPathMatcher = new AntPathMatcher(); @Override public boolean hasPermission(HttpServletRequest request, Authentication authentication) &#123; //ele-admin options è·¨åŸŸé…ç½®ï¼Œç°åœ¨å¤„ç†æ˜¯é€šè¿‡å‰ç«¯é…ç½®ä»£ç†ï¼Œä¸ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå­˜åœ¨é£é™©// if (HttpMethod.OPTIONS.name().equalsIgnoreCase(request.getMethod())) &#123;// return true;// &#125; Object principal = authentication.getPrincipal(); List&lt;SimpleGrantedAuthority&gt; authorityList = (List&lt;SimpleGrantedAuthority&gt;) authentication.getAuthorities(); AtomicBoolean hasPermission = new AtomicBoolean(false); if (principal != null) &#123; if (CollUtil.isEmpty(authorityList)) &#123; log.warn("è§’è‰²åˆ—è¡¨ä¸ºç©ºï¼š&#123;&#125;", authentication.getPrincipal()); return false; &#125; Set&lt;MenuVO&gt; urls = new HashSet&lt;&gt;(); authorityList.stream().filter(authority -&gt; !StrUtil.equals(authority.getAuthority(), "ROLE_USER")) .forEach(authority -&gt; &#123; Set&lt;MenuVO&gt; menuVOSet = menuService.findMenuByRole(authority.getAuthority()); CollUtil.addAll(urls, menuVOSet); &#125;); urls.stream().filter(menu -&gt; StrUtil.isNotEmpty(menu.getUrl()) &amp;&amp; antPathMatcher.match(menu.getUrl(), request.getRequestURI()) &amp;&amp; request.getMethod().equalsIgnoreCase(menu.getMethod())) .findFirst().ifPresent(menuVO -&gt; hasPermission.set(true)); &#125; return hasPermission.get(); &#125;&#125; ç½‘å…³æ€»ç»“pigè¿™ä¸ªç³»ç»Ÿæ˜¯ä¸ªå¾ˆå¥½çš„æ¡†æ¶ï¼Œæœ¬æ¬¡ä½“éªŒçš„æ˜¯pigçš„zuulç½‘å…³æ¨¡å—ï¼Œæ­¤æ¨¡å—ä¸feignï¼Œribbonï¼Œspring securityï¼ŒEurasiaè¿›è¡Œæ•´åˆï¼Œå®Œæˆæˆ–éƒ¨åˆ†å®Œæˆäº†åŠ¨æ€è·¯ç”±ï¼Œç°åº¦å‘å¸ƒ,èœå•æƒé™ç®¡ç†ï¼ŒæœåŠ¡é™æµï¼Œç½‘å…³æ—¥å¿—å¤„ç†ï¼Œéå¸¸å€¼å¾—å­¦ä¹ ï¼ UPMsæƒé™ç®¡ç†ç³»ç»Ÿæ¨¡å—ç™¾åº¦äº†ä¸€ä¸‹ï¼ŒUPMSæ˜¯User Permissions Management Systemï¼Œé€šç”¨ç”¨æˆ·æƒé™ç®¡ç†ç³»ç»Ÿ æ•°æ®åº“è®¾è®¡éƒ¨é—¨è¡¨ éƒ¨é—¨å…³ç³»è¡¨ å­—å…¸è¡¨1234567891011121314151617181920212223242526272829303132333435363738394041424344/** * ç¼–å· */ @TableId(value="id", type= IdType.AUTO) private Integer id; /** * æ•°æ®å€¼ */ private String value; /** * æ ‡ç­¾å */ private String label; /** * ç±»å‹ */ private String type; /** * æè¿° */ private String description; /** * æ’åºï¼ˆå‡åºï¼‰ */ private BigDecimal sort; /** * åˆ›å»ºæ—¶é—´ */ @TableField("create_time") private Date createTime; /** * æ›´æ–°æ—¶é—´ */ @TableField("update_time") private Date updateTime; /** * å¤‡æ³¨ä¿¡æ¯ */ private String remarks; /** * åˆ é™¤æ ‡è®° */ @TableField("del_flag") private String delFlag; æ—¥å¿—è¡¨1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465@Datapublic class SysLog implements Serializable &#123; private static final long serialVersionUID = 1L; /** * ç¼–å· */ @TableId(type = IdType.ID_WORKER) @JsonSerialize(using = ToStringSerializer.class) private Long id; /** * æ—¥å¿—ç±»å‹ */ private String type; /** * æ—¥å¿—æ ‡é¢˜ */ private String title; /** * åˆ›å»ºè€… */ private String createBy; /** * åˆ›å»ºæ—¶é—´ */ private Date createTime; /** * æ›´æ–°æ—¶é—´ */ private Date updateTime; /** * æ“ä½œIPåœ°å€ */ private String remoteAddr; /** * ç”¨æˆ·ä»£ç† */ private String userAgent; /** * è¯·æ±‚URI */ private String requestUri; /** * æ“ä½œæ–¹å¼ */ private String method; /** * æ“ä½œæäº¤çš„æ•°æ® */ private String params; /** * æ‰§è¡Œæ—¶é—´ */ private Long time; /** * åˆ é™¤æ ‡è®° */ private String delFlag; /** * å¼‚å¸¸ä¿¡æ¯ */ private String exception; /** * æœåŠ¡ID */ private String serviceId; &#125;&#125; èœå•æƒé™è¡¨ è§’è‰²è¡¨ è§’è‰²ä¸éƒ¨é—¨å¯¹åº”å…³ç³»ç•¥ è§’è‰²ä¸èœå•æƒé™å¯¹åº”å…³ç³»ç•¥ ç”¨æˆ·è¡¨12345678910111213141516171819202122232425262728293031323334353637383940414243444546/** * ä¸»é”®ID */@TableId(value = "user_id", type = IdType.AUTO)private Integer userId;/** * ç”¨æˆ·å */private String username;private String password;/** * éšæœºç› */@JsonIgnoreprivate String salt;/** * åˆ›å»ºæ—¶é—´ */@TableField("create_time")private Date createTime;/** * ä¿®æ”¹æ—¶é—´ */@TableField("update_time")private Date updateTime;/** * 0-æ­£å¸¸ï¼Œ1-åˆ é™¤ */@TableField("del_flag")private String delFlag;/** * ç®€ä»‹ */private String phone;/** * å¤´åƒ */private String avatar;/** * éƒ¨é—¨ID */@TableField("dept_id")private Integer deptId; åŠ¨æ€è·¯ç”±é…ç½®è¡¨ ä¸šåŠ¡é€»è¾‘ å…¨æ˜¯åŸºäºmybatis plusçš„CRUDï¼Œæœ‰ç‚¹å¤šã€‚å¤§éƒ¨åˆ†å¹²è¿™è¡Œçš„éƒ½æ‡‚ï¼Œæˆ‘å°±ä¸è¯¦ç»†å±•å¼€äº†ã€‚ éªŒè¯ç åˆ›å»ºValidateCodeControllerå¯ä»¥æ‰¾åˆ°åˆ›å»ºéªŒè¯ç ç›¸å…³ä»£ç 123456789101112131415161718192021/** * åˆ›å»ºéªŒè¯ç  * * @param request request * @throws Exception */ @GetMapping(SecurityConstants.DEFAULT_VALIDATE_CODE_URL_PREFIX + "/&#123;randomStr&#125;") public void createCode(@PathVariable String randomStr, HttpServletRequest request, HttpServletResponse response) throws Exception &#123; Assert.isBlank(randomStr, "æœºå™¨ç ä¸èƒ½ä¸ºç©º"); response.setHeader("Cache-Control", "no-store, no-cache"); response.setContentType("image/jpeg"); //ç”Ÿæˆæ–‡å­—éªŒè¯ç  String text = producer.createText(); //ç”Ÿæˆå›¾ç‰‡éªŒè¯ç  BufferedImage image = producer.createImage(text); userService.saveImageCode(randomStr, text); ServletOutputStream out = response.getOutputStream(); ImageIO.write(image, "JPEG", out); IOUtils.closeQuietly(out); &#125; å…¶ä¸­çš„ produceræ˜¯ä½¿ç”¨Kaptchaï¼Œä¸‹é¢æ˜¯é…ç½®ç±» 123456789101112131415161718192021222324252627@Configurationpublic class KaptchaConfig &#123; private static final String KAPTCHA_BORDER = "kaptcha.border"; private static final String KAPTCHA_TEXTPRODUCER_FONT_COLOR = "kaptcha.textproducer.font.color"; private static final String KAPTCHA_TEXTPRODUCER_CHAR_SPACE = "kaptcha.textproducer.char.space"; private static final String KAPTCHA_IMAGE_WIDTH = "kaptcha.image.width"; private static final String KAPTCHA_IMAGE_HEIGHT = "kaptcha.image.height"; private static final String KAPTCHA_TEXTPRODUCER_CHAR_LENGTH = "kaptcha.textproducer.char.length"; private static final Object KAPTCHA_IMAGE_FONT_SIZE = "kaptcha.textproducer.font.size"; @Bean public DefaultKaptcha producer() &#123; Properties properties = new Properties(); properties.put(KAPTCHA_BORDER, SecurityConstants.DEFAULT_IMAGE_BORDER); properties.put(KAPTCHA_TEXTPRODUCER_FONT_COLOR, SecurityConstants.DEFAULT_COLOR_FONT); properties.put(KAPTCHA_TEXTPRODUCER_CHAR_SPACE, SecurityConstants.DEFAULT_CHAR_SPACE); properties.put(KAPTCHA_IMAGE_WIDTH, SecurityConstants.DEFAULT_IMAGE_WIDTH); properties.put(KAPTCHA_IMAGE_HEIGHT, SecurityConstants.DEFAULT_IMAGE_HEIGHT); properties.put(KAPTCHA_IMAGE_FONT_SIZE, SecurityConstants.DEFAULT_IMAGE_FONT_SIZE); properties.put(KAPTCHA_TEXTPRODUCER_CHAR_LENGTH, SecurityConstants.DEFAULT_IMAGE_LENGTH); Config config = new Config(properties); DefaultKaptcha defaultKaptcha = new DefaultKaptcha(); defaultKaptcha.setConfig(config); return defaultKaptcha; &#125;&#125; å‘é€æ‰‹æœºéªŒè¯ç å¤§ä½“é€»è¾‘ä¸ºï¼Œå…ˆæŸ¥è¯¢éªŒè¯ç redisç¼“å­˜ï¼Œæ²¡æœ‰ç¼“å­˜åˆ™è¯´æ˜éªŒè¯ç ç¼“å­˜æ²¡æœ‰å¤±æ•ˆï¼Œè¿”å›é”™è¯¯ã€‚ æŸ¥åˆ°æ²¡æœ‰éªŒè¯ç ï¼Œåˆ™æ ¹æ®æ‰‹æœºå·ç ä»æ•°æ®åº“è·å¾—ç”¨æˆ·ä¿¡æ¯ï¼Œç”Ÿæˆä¸€ä¸ª4ä½çš„éªŒè¯ç ï¼Œä½¿ç”¨rabbbitmqé˜Ÿåˆ—æŠŠçŸ­ä¿¡éªŒè¯ç ä¿å­˜åˆ°é˜Ÿåˆ—ï¼ŒåŒæ—¶åŠ ä¸Šæ‰‹æœºéªŒè¯ç çš„redisç¼“å­˜ 1234567891011121314151617181920212223242526272829303132333435363738394041424344/** * å‘é€éªŒè¯ç  * &lt;p&gt; * 1. å…ˆå»redis æŸ¥è¯¢æ˜¯å¦ 60Så†…å·²ç»å‘é€ * 2. æœªå‘é€ï¼š åˆ¤æ–­æ‰‹æœºå·æ˜¯å¦å­˜ ? false :äº§ç”Ÿ4ä½æ•°å­— æ‰‹æœºå·-éªŒè¯ç  * 3. å‘å¾€æ¶ˆæ¯ä¸­å¿ƒ-ã€‹å‘é€ä¿¡æ¯ * 4. ä¿å­˜redis * * @param mobile æ‰‹æœºå· * @return trueã€false */ @Override public R&lt;Boolean&gt; sendSmsCode(String mobile) &#123; Object tempCode = redisTemplate.opsForValue().get(SecurityConstants.DEFAULT_CODE_KEY + mobile); if (tempCode != null) &#123; log.error("ç”¨æˆ·:&#123;&#125;éªŒè¯ç æœªå¤±æ•ˆ&#123;&#125;", mobile, tempCode); return new R&lt;&gt;(false, "éªŒè¯ç æœªå¤±æ•ˆï¼Œè¯·å¤±æ•ˆåå†æ¬¡ç”³è¯·"); &#125; SysUser params = new SysUser(); params.setPhone(mobile); List&lt;SysUser&gt; userList = this.selectList(new EntityWrapper&lt;&gt;(params)); if (CollectionUtil.isEmpty(userList)) &#123; log.error("æ ¹æ®ç”¨æˆ·æ‰‹æœºå·&#123;&#125;æŸ¥è¯¢ç”¨æˆ·ä¸ºç©º", mobile); return new R&lt;&gt;(false, "æ‰‹æœºå·ä¸å­˜åœ¨"); &#125; String code = RandomUtil.randomNumbers(4); JSONObject contextJson = new JSONObject(); contextJson.put("code", code); contextJson.put("product", "Pig4Cloud"); log.info("çŸ­ä¿¡å‘é€è¯·æ±‚æ¶ˆæ¯ä¸­å¿ƒ -&gt; æ‰‹æœºå·:&#123;&#125; -&gt; éªŒè¯ç ï¼š&#123;&#125;", mobile, code); rabbitTemplate.convertAndSend(MqQueueConstant.MOBILE_CODE_QUEUE, new MobileMsgTemplate( mobile, contextJson.toJSONString(), CommonConstant.ALIYUN_SMS, EnumSmsChannelTemplate.LOGIN_NAME_LOGIN.getSignName(), EnumSmsChannelTemplate.LOGIN_NAME_LOGIN.getTemplate() )); redisTemplate.opsForValue().set(SecurityConstants.DEFAULT_CODE_KEY + mobile, code, SecurityConstants.DEFAULT_IMAGE_EXPIRE, TimeUnit.SECONDS); return new R&lt;&gt;(true); &#125; æ ‘å½¢èŠ‚ç‚¹å·¥å…·æ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889public class TreeUtil &#123; /** * ä¸¤å±‚å¾ªç¯å®ç°å»ºæ ‘ * * @param treeNodes ä¼ å…¥çš„æ ‘èŠ‚ç‚¹åˆ—è¡¨ * @return */ public static &lt;T extends TreeNode&gt; List&lt;T&gt; bulid(List&lt;T&gt; treeNodes, Object root) &#123; List&lt;T&gt; trees = new ArrayList&lt;T&gt;(); for (T treeNode : treeNodes) &#123; if (root.equals(treeNode.getParentId())) &#123; trees.add(treeNode); &#125; for (T it : treeNodes) &#123; if (it.getParentId() == treeNode.getId()) &#123; if (treeNode.getChildren() == null) &#123; treeNode.setChildren(new ArrayList&lt;TreeNode&gt;()); &#125; treeNode.add(it); &#125; &#125; &#125; return trees; &#125; /** * ä½¿ç”¨é€’å½’æ–¹æ³•å»ºæ ‘ * * @param treeNodes * @return */ public static &lt;T extends TreeNode&gt; List&lt;T&gt; buildByRecursive(List&lt;T&gt; treeNodes, Object root) &#123; List&lt;T&gt; trees = new ArrayList&lt;T&gt;(); for (T treeNode : treeNodes) &#123; if (root.equals(treeNode.getParentId())) &#123; trees.add(findChildren(treeNode, treeNodes)); &#125; &#125; return trees; &#125; /** * é€’å½’æŸ¥æ‰¾å­èŠ‚ç‚¹ * * @param treeNodes * @return */ public static &lt;T extends TreeNode&gt; T findChildren(T treeNode, List&lt;T&gt; treeNodes) &#123; for (T it : treeNodes) &#123; if (treeNode.getId() == it.getParentId()) &#123; if (treeNode.getChildren() == null) &#123; treeNode.setChildren(new ArrayList&lt;TreeNode&gt;()); &#125; treeNode.add(findChildren(it, treeNodes)); &#125; &#125; return treeNode; &#125; /** * é€šè¿‡sysMenuåˆ›å»ºæ ‘å½¢èŠ‚ç‚¹ * * @param menus * @param root * @return */ public static List&lt;MenuTree&gt; bulidTree(List&lt;SysMenu&gt; menus, int root) &#123; List&lt;MenuTree&gt; trees = new ArrayList&lt;MenuTree&gt;(); MenuTree node; for (SysMenu menu : menus) &#123; node = new MenuTree(); node.setId(menu.getMenuId()); node.setParentId(menu.getParentId()); node.setName(menu.getName()); node.setUrl(menu.getUrl()); node.setPath(menu.getPath()); node.setCode(menu.getPermission()); node.setLabel(menu.getName()); node.setComponent(menu.getComponent()); node.setIcon(menu.getIcon()); trees.add(node); &#125; return TreeUtil.bulid(trees, root); &#125;&#125; ç”Ÿæˆavueæ¨¡æ¿ç±»123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100public class PigResourcesGenerator &#123; public static void main(String[] args) &#123; String outputDir = "/Users/lengleng/work/temp"; final String viewOutputDir = outputDir + "/view/"; AutoGenerator mpg = new AutoGenerator(); // å…¨å±€é…ç½® GlobalConfig gc = new GlobalConfig(); gc.setOutputDir(outputDir); gc.setFileOverride(true); gc.setActiveRecord(true); // XML äºŒçº§ç¼“å­˜ gc.setEnableCache(false); // XML ResultMap gc.setBaseResultMap(true); // XML columList gc.setBaseColumnList(true); gc.setAuthor("lengleng"); mpg.setGlobalConfig(gc); // æ•°æ®æºé…ç½® DataSourceConfig dsc = new DataSourceConfig(); dsc.setDbType(DbType.MYSQL); dsc.setDriverName("com.mysql.jdbc.Driver"); dsc.setUsername("root"); dsc.setPassword("lengleng"); dsc.setUrl("jdbc:mysql://139.224.200.249:3309/pig?characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=false"); mpg.setDataSource(dsc); // ç­–ç•¥é…ç½® StrategyConfig strategy = new StrategyConfig(); // strategy.setCapitalMode(true);// å…¨å±€å¤§å†™å‘½å ORACLE æ³¨æ„ strategy.setSuperControllerClass("com.github.pig.common.web.BaseController"); // è¡¨åç”Ÿæˆç­–ç•¥ strategy.setNaming(NamingStrategy.underline_to_camel); mpg.setStrategy(strategy); // åŒ…é…ç½® PackageConfig pc = new PackageConfig(); pc.setParent("com.github.pig.admin"); pc.setController("controller"); mpg.setPackageInfo(pc); // æ³¨å…¥è‡ªå®šä¹‰é…ç½®ï¼Œå¯ä»¥åœ¨ VM ä¸­ä½¿ç”¨ cfg.abc è®¾ç½®çš„å€¼ InjectionConfig cfg = new InjectionConfig() &#123; @Override public void initMap() &#123; &#125; &#125;; // ç”Ÿæˆçš„æ¨¡ç‰ˆè·¯å¾„ï¼Œä¸å­˜åœ¨æ—¶éœ€è¦å…ˆæ–°å»º File viewDir = new File(viewOutputDir); if (!viewDir.exists()) &#123; viewDir.mkdirs(); &#125; List&lt;FileOutConfig&gt; focList = new ArrayList&lt;FileOutConfig&gt;(); focList.add(new FileOutConfig("/templates/listvue.vue.vm") &#123; @Override public String outputFile(TableInfo tableInfo) &#123; return getGeneratorViewPath(viewOutputDir, tableInfo, ".vue"); &#125; &#125;); cfg.setFileOutConfigList(focList); mpg.setCfg(cfg); //ç”Ÿæˆcontrollerç›¸å…³ mpg.execute(); &#125; /** * è·å–é…ç½®æ–‡ä»¶ * * @return é…ç½®Props */ private static Properties getProperties() &#123; // è¯»å–é…ç½®æ–‡ä»¶ Resource resource = new ClassPathResource("/config/application.properties"); Properties props = new Properties(); try &#123; props = PropertiesLoaderUtils.loadProperties(resource); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; return props; &#125; /** * é¡µé¢ç”Ÿæˆçš„æ–‡ä»¶å */ private static String getGeneratorViewPath(String viewOutputDir, TableInfo tableInfo, String suffixPath) &#123; String name = StringUtils.firstToLowerCase(tableInfo.getEntityName()); String path = viewOutputDir + "/" + name + "/index" + suffixPath; File viewDir = new File(path).getParentFile(); if (!viewDir.exists()) &#123; viewDir.mkdirs(); &#125; return path; &#125;&#125; velocityæ¨¡æ¿ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788package $!&#123;package.Controller&#125;;import java.util.Map;import java.util.Date;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.web.bind.annotation.*;import com.github.pig.common.constant.CommonConstant;import com.baomidou.mybatisplus.mapper.EntityWrapper;import com.baomidou.mybatisplus.plugins.Page;import com.github.pig.common.util.Query;import com.github.pig.common.util.R;import $!&#123;package.Entity&#125;.$!&#123;entity&#125;;import $!&#123;package.Service&#125;.$!&#123;entity&#125;Service;#if($!&#123;superControllerClassPackage&#125;)import $!&#123;superControllerClassPackage&#125;;#end/** * &lt;p&gt; * $!&#123;table.comment&#125; å‰ç«¯æ§åˆ¶å™¨ * &lt;/p&gt; * * @author $!&#123;author&#125; * @since $!&#123;date&#125; */@RestController@RequestMapping("/$!&#123;table.entityPath&#125;")public class $!&#123;table.controllerName&#125; extends $!&#123;superControllerClass&#125; &#123; @Autowired private $!&#123;entity&#125;Service $!&#123;table.entityPath&#125;Service; /** * é€šè¿‡IDæŸ¥è¯¢ * * @param id ID * @return $!&#123;entity&#125; */ @GetMapping("/&#123;id&#125;") public R&lt;$!&#123;entity&#125;&gt; get(@PathVariable Integer id) &#123; return new R&lt;&gt;($!&#123;table.entityPath&#125;Service.selectById(id)); &#125; /** * åˆ†é¡µæŸ¥è¯¢ä¿¡æ¯ * * @param params åˆ†é¡µå¯¹è±¡ * @return åˆ†é¡µå¯¹è±¡ */ @RequestMapping("/page") public Page page(@RequestParam Map&lt;String, Object&gt; params) &#123; params.put(CommonConstant.DEL_FLAG, CommonConstant.STATUS_NORMAL); return $!&#123;table.entityPath&#125;Service.selectPage(new Query&lt;&gt;(params), new EntityWrapper&lt;&gt;()); &#125; /** * æ·»åŠ  * @param $!&#123;table.entityPath&#125; å®ä½“ * @return success/false */ @PostMapping public R&lt;Boolean&gt; add(@RequestBody $!&#123;entity&#125; $!&#123;table.entityPath&#125;) &#123; return new R&lt;&gt;($!&#123;table.entityPath&#125;Service.insert($!&#123;table.entityPath&#125;)); &#125; /** * åˆ é™¤ * @param id ID * @return success/false */ @DeleteMapping("/&#123;id&#125;") public R&lt;Boolean&gt; delete(@PathVariable Integer id) &#123; $!&#123;entity&#125; $!&#123;table.entityPath&#125; = new $!&#123;entity&#125;(); $!&#123;table.entityPath&#125;.setId(id); $!&#123;table.entityPath&#125;.setUpdateTime(new Date()); $!&#123;table.entityPath&#125;.setDelFlag(CommonConstant.STATUS_DEL); return new R&lt;&gt;($!&#123;table.entityPath&#125;Service.updateById($!&#123;table.entityPath&#125;)); &#125; /** * ç¼–è¾‘ * @param $!&#123;table.entityPath&#125; å®ä½“ * @return success/false */ @PutMapping public R&lt;Boolean&gt; edit(@RequestBody $!&#123;entity&#125; $!&#123;table.entityPath&#125;) &#123; $!&#123;table.entityPath&#125;.setUpdateTime(new Date()); return new R&lt;&gt;($!&#123;table.entityPath&#125;Service.updateById($!&#123;table.entityPath&#125;)); &#125;&#125; ç¼“å­˜åœ¨éƒ¨åˆ†å®ç°ç±»ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ä½œè€…ä½¿ç”¨äº†spring cacheç›¸å…³çš„æ³¨è§£ã€‚ç°åœ¨æˆ‘ä»¬å›å¿†ä¸€ä¸‹ç›¸å…³ç¼“å­˜æ³¨è§£çš„å«ä¹‰ï¼š @Cacheable:ç”¨æ¥å®šä¹‰ç¼“å­˜çš„ã€‚å¸¸ç”¨åˆ°æ˜¯value,key;åˆ†åˆ«ç”¨æ¥æŒ‡æ˜ç¼“å­˜çš„åç§°å’Œæ–¹æ³•ä¸­å‚æ•°ï¼Œå¯¹äºvalueä½ ä¹Ÿå¯ä»¥ä½¿ç”¨cacheNameï¼Œåœ¨æŸ¥çœ‹æºä»£ç æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼šä¸¤è€…æ˜¯æŒ‡çš„åŒä¸€ä¸ªä¸œè¥¿ã€‚ @CacheEvict:ç”¨æ¥æ¸…ç†ç¼“å­˜ã€‚å¸¸ç”¨æœ‰cacheNamesï¼ŒallEntriesï¼ˆé»˜è®¤å€¼falseï¼‰ï¼›åˆ†åˆ«ä»£è¡¨äº†è¦æ¸…é™¤çš„ç¼“å­˜åç§°å’Œæ˜¯å¦å…¨éƒ¨æ¸…é™¤(trueä»£è¡¨å…¨éƒ¨æ¸…é™¤)ã€‚ @CachePut:ç”¨æ¥æ›´æ–°ç¼“å­˜ï¼Œç”¨å®ƒæ¥æ³¨è§£çš„æ–¹æ³•éƒ½ä¼šè¢«æ‰§è¡Œï¼Œæ‰§è¡Œå®Œåç»“æœè¢«æ·»åŠ åˆ°ç¼“å­˜ä¸­ã€‚è¯¥æ–¹æ³•ä¸èƒ½å’Œ@CacheableåŒæ—¶åœ¨åŒä¸€ä¸ªæ–¹æ³•ä¸Šä½¿ç”¨ã€‚ åå°è·‘æ‰¹å®šæ—¶ä»»åŠ¡æ¨¡å—Elastic-Jobæ˜¯ddframeä¸­dd-jobçš„ä½œä¸šæ¨¡å—ä¸­åˆ†ç¦»å‡ºæ¥çš„åˆ†å¸ƒå¼å¼¹æ€§ä½œä¸šæ¡†æ¶ã€‚å»æ‰äº†å’Œdd-jobä¸­çš„ç›‘æ§å’Œddframeæ¥å…¥è§„èŒƒéƒ¨åˆ†ã€‚è¯¥é¡¹ç›®åŸºäºæˆç†Ÿçš„å¼€æºäº§å“Quartzå’ŒZookeeperåŠå…¶å®¢æˆ·ç«¯Curatorè¿›è¡ŒäºŒæ¬¡å¼€å‘ã€‚ä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š å®šæ—¶ä»»åŠ¡ï¼š åŸºäºæˆç†Ÿçš„å®šæ—¶ä»»åŠ¡ä½œä¸šæ¡†æ¶Quartz cronè¡¨è¾¾å¼æ‰§è¡Œå®šæ—¶ä»»åŠ¡ã€‚ ä½œä¸šæ³¨å†Œä¸­å¿ƒï¼š åŸºäºZookeeperå’Œå…¶å®¢æˆ·ç«¯Curatorå®ç°çš„å…¨å±€ä½œä¸šæ³¨å†Œæ§åˆ¶ä¸­å¿ƒã€‚ç”¨äºæ³¨å†Œï¼Œæ§åˆ¶å’Œåè°ƒåˆ†å¸ƒå¼ä½œä¸šæ‰§è¡Œã€‚ ä½œä¸šåˆ†ç‰‡ï¼š å°†ä¸€ä¸ªä»»åŠ¡åˆ†ç‰‡æˆä¸ºå¤šä¸ªå°ä»»åŠ¡é¡¹åœ¨å¤šæœåŠ¡å™¨ä¸ŠåŒæ—¶æ‰§è¡Œã€‚ å¼¹æ€§æ‰©å®¹ç¼©å®¹ï¼š è¿è¡Œä¸­çš„ä½œä¸šæœåŠ¡å™¨å´©æºƒï¼Œæˆ–æ–°å¢åŠ nå°ä½œä¸šæœåŠ¡å™¨ï¼Œä½œä¸šæ¡†æ¶å°†åœ¨ä¸‹æ¬¡ä½œä¸šæ‰§è¡Œå‰é‡æ–°åˆ†ç‰‡ï¼Œä¸å½±å“å½“å‰ä½œä¸šæ‰§è¡Œã€‚ æ”¯æŒå¤šç§ä½œä¸šæ‰§è¡Œæ¨¡å¼ï¼š æ”¯æŒOneOffï¼ŒPerpetualå’ŒSequencePerpetualä¸‰ç§ä½œä¸šæ¨¡å¼ã€‚ å¤±æ•ˆè½¬ç§»ï¼š è¿è¡Œä¸­çš„ä½œä¸šæœåŠ¡å™¨å´©æºƒä¸ä¼šå¯¼è‡´é‡æ–°åˆ†ç‰‡ï¼Œåªä¼šåœ¨ä¸‹æ¬¡ä½œä¸šå¯åŠ¨æ—¶åˆ†ç‰‡ã€‚å¯ç”¨å¤±æ•ˆè½¬ç§»åŠŸèƒ½å¯ä»¥åœ¨æœ¬æ¬¡ä½œä¸šæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç›‘æµ‹å…¶ä»–ä½œä¸šæœåŠ¡å™¨ç©ºé—²ï¼ŒæŠ“å–æœªå®Œæˆçš„å­¤å„¿åˆ†ç‰‡é¡¹æ‰§è¡Œã€‚ è¿è¡Œæ—¶çŠ¶æ€æ”¶é›†ï¼š ç›‘æ§ä½œä¸šè¿è¡Œæ—¶çŠ¶æ€ï¼Œç»Ÿè®¡æœ€è¿‘ä¸€æ®µæ—¶é—´å¤„ç†çš„æ•°æ®æˆåŠŸå’Œå¤±è´¥æ•°é‡ï¼Œè®°å½•ä½œä¸šä¸Šæ¬¡è¿è¡Œå¼€å§‹æ—¶é—´ï¼Œç»“æŸæ—¶é—´å’Œä¸‹æ¬¡è¿è¡Œæ—¶é—´ã€‚ ä½œä¸šåœæ­¢ï¼Œæ¢å¤å’Œç¦ç”¨ï¼šç”¨äºæ“ä½œä½œä¸šå¯åœï¼Œå¹¶å¯ä»¥ç¦æ­¢æŸä½œä¸šè¿è¡Œï¼ˆä¸Šçº¿æ—¶å¸¸ç”¨ï¼‰ã€‚ è¢«é”™è¿‡æ‰§è¡Œçš„ä½œä¸šé‡è§¦å‘ï¼šè‡ªåŠ¨è®°å½•é”™è¿‡æ‰§è¡Œçš„ä½œä¸šï¼Œå¹¶åœ¨ä¸Šæ¬¡ä½œä¸šå®Œæˆåè‡ªåŠ¨è§¦å‘ã€‚å¯å‚è€ƒQuartzçš„misfireã€‚ å¤šçº¿ç¨‹å¿«é€Ÿå¤„ç†æ•°æ®ï¼šä½¿ç”¨å¤šçº¿ç¨‹å¤„ç†æŠ“å–åˆ°çš„æ•°æ®ï¼Œæå‡ååé‡ã€‚ å¹‚ç­‰æ€§ï¼šé‡å¤ä½œä¸šä»»åŠ¡é¡¹åˆ¤å®šï¼Œä¸é‡å¤æ‰§è¡Œå·²è¿è¡Œçš„ä½œä¸šä»»åŠ¡é¡¹ã€‚ç”±äºå¼€å¯å¹‚ç­‰æ€§éœ€è¦ç›‘å¬ä½œä¸šè¿è¡ŒçŠ¶æ€ï¼Œå¯¹ç¬æ—¶åå¤è¿è¡Œçš„ä½œä¸šå¯¹æ€§èƒ½æœ‰è¾ƒå¤§å½±å“ã€‚ å®¹é”™å¤„ç†ï¼šä½œä¸šæœåŠ¡å™¨ä¸ZookeeperæœåŠ¡å™¨é€šä¿¡å¤±è´¥åˆ™ç«‹å³åœæ­¢ä½œä¸šè¿è¡Œï¼Œé˜²æ­¢ä½œä¸šæ³¨å†Œä¸­å¿ƒå°†å¤±æ•ˆçš„åˆ†ç‰‡åˆ†é¡¹é…ç»™å…¶ä»–ä½œä¸šæœåŠ¡å™¨ï¼Œè€Œå½“å‰ä½œä¸šæœåŠ¡å™¨ä»åœ¨æ‰§è¡Œä»»åŠ¡ï¼Œå¯¼è‡´é‡å¤æ‰§è¡Œã€‚ Springæ”¯æŒï¼šæ”¯æŒspringå®¹å™¨ï¼Œè‡ªå®šä¹‰å‘½åç©ºé—´ï¼Œæ”¯æŒå ä½ç¬¦ã€‚ è¿ç»´å¹³å°ï¼šæä¾›è¿ç»´ç•Œé¢ï¼Œå¯ä»¥ç®¡ç†ä½œä¸šå’Œæ³¨å†Œä¸­å¿ƒã€‚ é…ç½®ä½œè€…ç›´æ¥ä½¿ç”¨äº†å¼€æºé¡¹ç›®çš„é…ç½®ï¼Œæˆ‘é¡ºç€ä»–çš„pomæ–‡ä»¶æ‰¾åˆ°äº†è¿™å®¶çš„githubï¼Œåœ°å€å¦‚ä¸‹ https://github.com/xjzrc/elastic-job-lite-spring-boot-starter å·¥ä½œæµä½œä¸šé…ç½®1234567891011121314@ElasticJobConfig(cron = "0 0 0/1 * * ? ", shardingTotalCount = 3, shardingItemParameters = "0=Beijing,1=Shanghai,2=Guangzhou")public class PigDataflowJob implements DataflowJob&lt;Integer&gt; &#123; @Override public List&lt;Integer&gt; fetchData(ShardingContext shardingContext) &#123; return null; &#125; @Override public void processData(ShardingContext shardingContext, List&lt;Integer&gt; list) &#123; &#125;&#125; æµ‹è¯•ä»£ç 1234567891011121314151617@Slf4j@ElasticJobConfig(cron = "0 0 0/1 * * ?", shardingTotalCount = 3, shardingItemParameters = "0=pig1,1=pig2,2=pig3", startedTimeoutMilliseconds = 5000L, completedTimeoutMilliseconds = 10000L, eventTraceRdbDataSource = "dataSource")public class PigSimpleJob implements SimpleJob &#123; /** * ä¸šåŠ¡æ‰§è¡Œé€»è¾‘ * * @param shardingContext åˆ†ç‰‡ä¿¡æ¯ */ @Override public void execute(ShardingContext shardingContext) &#123; log.info("shardingContext:&#123;&#125;", shardingContext); &#125;&#125; å¼€æºç‰ˆå¯¹è¿™ä¸ªæ”¯æŒæœ‰é™ï¼Œç­‰åˆ°æ‹¿åˆ°æ”¶è´¹ç‰ˆæˆ‘åœ¨åšåˆ†æã€‚ æ¶ˆæ¯ä¸­å¿ƒè¿™é‡Œçš„æ¶ˆæ¯ä¸­å¿ƒä¸»è¦æ˜¯é›†æˆäº†é’‰é’‰æœåŠ¡å’Œé˜¿é‡Œå¤§é±¼çŸ­æ¯æœåŠ¡ é’‰é’‰é…ç½®é’‰é’‰æ˜¯ç›¸å½“ç®€å•äº†ï¼Œåªéœ€è¦ä¸€ä¸ªwebhookä¿¡æ¯å°±å¤Ÿäº†ã€‚ webhookæ˜¯ä¸€ç§webå›è°ƒæˆ–è€…httpçš„push APIï¼Œæ˜¯å‘APPæˆ–è€…å…¶ä»–åº”ç”¨æä¾›å®æ—¶ä¿¡æ¯çš„ä¸€ç§æ–¹å¼ã€‚Webhookåœ¨æ•°æ®äº§ç”Ÿæ—¶ç«‹å³å‘é€æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ä½ èƒ½å®æ—¶æ”¶åˆ°æ•°æ®ã€‚è¿™ä¸€ç§ä¸åŒäºå…¸å‹çš„APIï¼Œéœ€è¦ç”¨äº†å®æ—¶æ€§éœ€è¦è¶³å¤Ÿå¿«çš„è½®è¯¢ã€‚è¿™æ— è®ºæ˜¯å¯¹ç”Ÿäº§è¿˜æ˜¯å¯¹æ¶ˆè´¹è€…éƒ½æ˜¯é«˜æ•ˆçš„ï¼Œå”¯ä¸€çš„ç¼ºç‚¹æ˜¯åˆå§‹å»ºç«‹å›°éš¾ã€‚Webhookæœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºåå‘APIï¼Œå› ä¸ºä»–æä¾›äº†APIè§„åˆ™ï¼Œä½ éœ€è¦è®¾è®¡è¦ä½¿ç”¨çš„APIã€‚Webhookå°†å‘ä½ çš„åº”ç”¨å‘èµ·httpè¯·æ±‚ï¼Œå…¸å‹çš„æ˜¯postè¯·æ±‚ï¼Œåº”ç”¨ç¨‹åºç”±è¯·æ±‚é©±åŠ¨ã€‚ 123456789@Data@Configuration@ConfigurationProperties(prefix = "sms.dingtalk")public class DingTalkPropertiesConfig &#123; /** * webhook */ private String webhook;&#125; æ¶ˆæ¯æ¨¡æ¿123456789101112131415161718192021222324252627282930313233343536373839404142434445/** * @author lengleng * @date 2018/1/15 * é’‰é’‰æ¶ˆæ¯æ¨¡æ¿ * msgtype : text * text : &#123;"content":"æœåŠ¡: pig-upms-service çŠ¶æ€ï¼šUP"&#125; */@Data@ToStringpublic class DingTalkMsgTemplate implements Serializable &#123; private String msgtype; private TextBean text; public String getMsgtype() &#123; return msgtype; &#125; public void setMsgtype(String msgtype) &#123; this.msgtype = msgtype; &#125; public TextBean getText() &#123; return text; &#125; public void setText(TextBean text) &#123; this.text = text; &#125; public static class TextBean &#123; /** * content : æœåŠ¡: pig-upms-service çŠ¶æ€ï¼šUP */ private String content; public String getContent() &#123; return content; &#125; public void setContent(String content) &#123; this.content = content; &#125; &#125;&#125; ç›‘å¬ä½¿ç”¨é˜Ÿåˆ—æ—¶æ—¶ç›‘å¬ 12345678910111213141516@Slf4j@Component@RabbitListener(queues = MqQueueConstant.DINGTALK_SERVICE_STATUS_CHANGE)public class DingTalkServiceChangeReceiveListener &#123; @Autowired private DingTalkMessageHandler dingTalkMessageHandler; @RabbitHandler public void receive(String text) &#123; long startTime = System.currentTimeMillis(); log.info("æ¶ˆæ¯ä¸­å¿ƒæ¥æ”¶åˆ°é’‰é’‰å‘é€è¯·æ±‚-&gt; å†…å®¹ï¼š&#123;&#125; ", text); dingTalkMessageHandler.process(text); long useTime = System.currentTimeMillis() - startTime; log.info("è°ƒç”¨ é’‰é’‰ç½‘å…³å¤„ç†å®Œæ¯•ï¼Œè€—æ—¶ &#123;&#125;æ¯«ç§’", useTime); &#125;&#125; å‘é€ä½¿ç”¨é˜Ÿåˆ—å‘é€ 12345678910111213141516171819202122232425262728@Slf4j@Componentpublic class DingTalkMessageHandler &#123; @Autowired private DingTalkPropertiesConfig dingTalkPropertiesConfig; /** * ä¸šåŠ¡å¤„ç† * * @param text æ¶ˆæ¯ */ public boolean process(String text) &#123; String webhook = dingTalkPropertiesConfig.getWebhook(); if (StrUtil.isBlank(webhook)) &#123; log.error("é’‰é’‰é…ç½®é”™è¯¯ï¼Œwebhookä¸ºç©º"); return false; &#125; DingTalkMsgTemplate dingTalkMsgTemplate = new DingTalkMsgTemplate(); dingTalkMsgTemplate.setMsgtype("text"); DingTalkMsgTemplate.TextBean textBean = new DingTalkMsgTemplate.TextBean(); textBean.setContent(text); dingTalkMsgTemplate.setText(textBean); String result = HttpUtil.post(webhook, JSONObject.toJSONString(dingTalkMsgTemplate)); log.info("é’‰é’‰æé†’æˆåŠŸ,æŠ¥æ–‡å“åº”:&#123;&#125;", result); return true; &#125;&#125; é˜¿é‡Œå¤§é±¼çŸ­æ¯æœåŠ¡é…ç½®1234567891011121314151617181920@Data@Configuration@ConditionalOnExpression("!'$&#123;sms.aliyun&#125;'.isEmpty()")@ConfigurationProperties(prefix = "sms.aliyun")public class SmsAliyunPropertiesConfig &#123; /** * åº”ç”¨ID */ private String accessKey; /** * åº”ç”¨ç§˜é’¥ */ private String secretKey; /** * çŸ­ä¿¡æ¨¡æ¿é…ç½® */ private Map&lt;String, String&gt; channels;&#125; ç›‘å¬123456789101112131415161718192021222324@Slf4j@Component@RabbitListener(queues = MqQueueConstant.MOBILE_SERVICE_STATUS_CHANGE)public class MobileServiceChangeReceiveListener &#123; @Autowired private Map&lt;String, SmsMessageHandler&gt; messageHandlerMap; @RabbitHandler public void receive(MobileMsgTemplate mobileMsgTemplate) &#123; long startTime = System.currentTimeMillis(); log.info("æ¶ˆæ¯ä¸­å¿ƒæ¥æ”¶åˆ°çŸ­ä¿¡å‘é€è¯·æ±‚-&gt; æ‰‹æœºå·ï¼š&#123;&#125; -&gt; ä¿¡æ¯ä½“ï¼š&#123;&#125; ", mobileMsgTemplate.getMobile(), mobileMsgTemplate.getContext()); String channel = mobileMsgTemplate.getChannel(); SmsMessageHandler messageHandler = messageHandlerMap.get(channel); if (messageHandler == null) &#123; log.error("æ²¡æœ‰æ‰¾åˆ°æŒ‡å®šçš„è·¯ç”±é€šé“ï¼Œä¸è¿›è¡Œå‘é€å¤„ç†å®Œæ¯•ï¼"); return; &#125; messageHandler.execute(mobileMsgTemplate); long useTime = System.currentTimeMillis() - startTime; log.info("è°ƒç”¨ &#123;&#125; çŸ­ä¿¡ç½‘å…³å¤„ç†å®Œæ¯•ï¼Œè€—æ—¶ &#123;&#125;æ¯«ç§’", mobileMsgTemplate.getType(), useTime); &#125;&#125; å‘é€ä¸é”™çš„æ¨¡æ¿ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576@Slf4j@Component(CommonConstant.ALIYUN_SMS)public class SmsAliyunMessageHandler extends AbstractMessageHandler &#123; @Autowired private SmsAliyunPropertiesConfig smsAliyunPropertiesConfig; private static final String PRODUCT = "Dysmsapi"; private static final String DOMAIN = "dysmsapi.aliyuncs.com"; /** * æ•°æ®æ ¡éªŒ * * @param mobileMsgTemplate æ¶ˆæ¯ */ @Override public void check(MobileMsgTemplate mobileMsgTemplate) &#123; Assert.isBlank(mobileMsgTemplate.getMobile(), "æ‰‹æœºå·ä¸èƒ½ä¸ºç©º"); Assert.isBlank(mobileMsgTemplate.getContext(), "çŸ­ä¿¡å†…å®¹ä¸èƒ½ä¸ºç©º"); &#125; /** * ä¸šåŠ¡å¤„ç† * * @param mobileMsgTemplate æ¶ˆæ¯ */ @Override public boolean process(MobileMsgTemplate mobileMsgTemplate) &#123; //å¯è‡ªåŠ©è°ƒæ•´è¶…æ—¶æ—¶é—´ System.setProperty("sun.net.client.defaultConnectTimeout", "10000"); System.setProperty("sun.net.client.defaultReadTimeout", "10000"); //åˆå§‹åŒ–acsClient,æš‚ä¸æ”¯æŒregionåŒ– IClientProfile profile = DefaultProfile.getProfile("cn-hangzhou", smsAliyunPropertiesConfig.getAccessKey(), smsAliyunPropertiesConfig.getSecretKey()); try &#123; DefaultProfile.addEndpoint("cn-hou", "cn-hangzhou", PRODUCT, DOMAIN); &#125; catch (ClientException e) &#123; log.error("åˆå§‹åŒ–SDK å¼‚å¸¸", e); e.printStackTrace(); &#125; IAcsClient acsClient = new DefaultAcsClient(profile); //ç»„è£…è¯·æ±‚å¯¹è±¡-å…·ä½“æè¿°è§æ§åˆ¶å°-æ–‡æ¡£éƒ¨åˆ†å†…å®¹ SendSmsRequest request = new SendSmsRequest(); //å¿…å¡«:å¾…å‘é€æ‰‹æœºå· request.setPhoneNumbers(mobileMsgTemplate.getMobile()); //å¿…å¡«:çŸ­ä¿¡ç­¾å-å¯åœ¨çŸ­ä¿¡æ§åˆ¶å°ä¸­æ‰¾åˆ° request.setSignName(mobileMsgTemplate.getSignName()); //å¿…å¡«:çŸ­ä¿¡æ¨¡æ¿-å¯åœ¨çŸ­ä¿¡æ§åˆ¶å°ä¸­æ‰¾åˆ° request.setTemplateCode(smsAliyunPropertiesConfig.getChannels().get(mobileMsgTemplate.getTemplate())); //å¯é€‰:æ¨¡æ¿ä¸­çš„å˜é‡æ›¿æ¢JSONä¸²,å¦‚æ¨¡æ¿å†…å®¹ä¸º"äº²çˆ±çš„$&#123;name&#125;,æ‚¨çš„éªŒè¯ç ä¸º$&#123;code&#125;" request.setTemplateParam(mobileMsgTemplate.getContext()); request.setOutId(mobileMsgTemplate.getMobile()); //hint æ­¤å¤„å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ³¨æ„catch try &#123; SendSmsResponse sendSmsResponse = acsClient.getAcsResponse(request); log.info("çŸ­ä¿¡å‘é€å®Œæ¯•ï¼Œæ‰‹æœºå·ï¼š&#123;&#125;ï¼Œè¿”å›çŠ¶æ€ï¼š&#123;&#125;", mobileMsgTemplate.getMobile(), sendSmsResponse.getCode()); &#125; catch (ClientException e) &#123; log.error("å‘é€å¼‚å¸¸"); e.printStackTrace(); &#125; return true; &#125; /** * å¤±è´¥å¤„ç† * * @param mobileMsgTemplate æ¶ˆæ¯ */ @Override public void fail(MobileMsgTemplate mobileMsgTemplate) &#123; log.error("çŸ­ä¿¡å‘é€å¤±è´¥ -&gt; ç½‘å…³ï¼š&#123;&#125; -&gt; æ‰‹æœºå·ï¼š&#123;&#125;", mobileMsgTemplate.getType(), mobileMsgTemplate.getMobile()); &#125;&#125; èµ„æºè®¤è¯æœåŠ¡å™¨ ï¼ˆå•ç‚¹ç™»é™†åŠŸèƒ½ï¼‰ç”±äºä½œè€…åœ¨è®¤è¯ä¸­å¿ƒä½¿ç”¨äº†spring security oauthæ¡†æ¶ï¼Œæ‰€ä»¥éœ€è¦åœ¨å¾®æœåŠ¡çš„å®¢æˆ·ç«¯å®ç°ä¸€ä¸ªèµ„æºè®¤è¯æœåŠ¡å™¨ï¼Œæ¥å®ŒæˆSSOéœ€æ±‚ã€‚ é…ç½®æš´éœ²ç›‘æ§ä¿¡æ¯ 1234567891011121314@Configuration@EnableResourceServerpublic class ResourceServerConfiguration extends ResourceServerConfigurerAdapter &#123; @Override public void configure(HttpSecurity http) throws Exception &#123; http .authorizeRequests() .anyRequest().authenticated() .and() .csrf().disable(); &#125;&#125; æ¥å£123456789@EnableOAuth2Sso@SpringBootApplicationpublic class PigSsoClientDemoApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(PigSsoClientDemoApplication.class, args); &#125;&#125; ç›‘æ§æ¨¡å—springboot adminé…ç½®RemindingNotifierä¼šåœ¨åº”ç”¨ä¸Šçº¿æˆ–å®•æ‰çš„æ—¶å€™å‘é€æé†’ï¼Œä¹Ÿå°±æ˜¯æŠŠnotificationså‘é€ç»™å…¶ä»–çš„notifierï¼Œnotifierçš„å®ç°å¾ˆæœ‰æ„æ€ï¼Œä¸æ·±ç©¶äº†ï¼Œä»ç±»å…³ç³»å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥è¿™ä¹ˆå‡ ç§æ–¹å¼å‘é€notificationsï¼šPagerdutyã€Hipchat ã€Slack ã€Mailã€ Reminder 12345678910111213141516171819202122232425@Configuration public static class NotifierConfig &#123; @Bean @Primary public RemindingNotifier remindingNotifier() &#123; RemindingNotifier notifier = new RemindingNotifier(filteringNotifier(loggerNotifier())); notifier.setReminderPeriod(TimeUnit.SECONDS.toMillis(10)); return notifier; &#125; @Scheduled(fixedRate = 1_000L) public void remind() &#123; remindingNotifier().sendReminders(); &#125; @Bean public FilteringNotifier filteringNotifier(Notifier delegate) &#123; return new FilteringNotifier(delegate); &#125; @Bean public LoggingNotifier loggerNotifier() &#123; return new LoggingNotifier(); &#125; &#125; çŸ­ä¿¡æœåŠ¡ä¸‹çº¿é€šçŸ¥ç»§æ‰¿AbstractStatusChangeNotifierï¼Œå°†çŸ­ä¿¡æœåŠ¡æ³¨å†Œåˆ°spring boot adminä¸­ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758@Slf4jpublic class StatusChangeNotifier extends AbstractStatusChangeNotifier &#123; private RabbitTemplate rabbitTemplate; private MonitorPropertiesConfig monitorMobilePropertiesConfig; public StatusChangeNotifier(MonitorPropertiesConfig monitorMobilePropertiesConfig, RabbitTemplate rabbitTemplate) &#123; this.rabbitTemplate = rabbitTemplate; this.monitorMobilePropertiesConfig = monitorMobilePropertiesConfig; &#125; /** * é€šçŸ¥é€»è¾‘ * * @param event äº‹ä»¶ * @throws Exception å¼‚å¸¸ */ @Override protected void doNotify(ClientApplicationEvent event) &#123; if (event instanceof ClientApplicationStatusChangedEvent) &#123; log.info("Application &#123;&#125; (&#123;&#125;) is &#123;&#125;", event.getApplication().getName(), event.getApplication().getId(), ((ClientApplicationStatusChangedEvent) event).getTo().getStatus()); String text = String.format("åº”ç”¨:%s æœåŠ¡ID:%s çŠ¶æ€æ”¹å˜ä¸ºï¼š%sï¼Œæ—¶é—´ï¼š%s" , event.getApplication().getName() , event.getApplication().getId() , ((ClientApplicationStatusChangedEvent) event).getTo().getStatus() , DateUtil.date(event.getTimestamp()).toString()); JSONObject contextJson = new JSONObject(); contextJson.put("name", event.getApplication().getName()); contextJson.put("seid", event.getApplication().getId()); contextJson.put("time", DateUtil.date(event.getTimestamp()).toString()); //å¼€å¯çŸ­ä¿¡é€šçŸ¥ if (monitorMobilePropertiesConfig.getMobile().getEnabled()) &#123; log.info("å¼€å§‹çŸ­ä¿¡é€šçŸ¥ï¼Œå†…å®¹ï¼š&#123;&#125;", text); rabbitTemplate.convertAndSend(MqQueueConstant.MOBILE_SERVICE_STATUS_CHANGE, new MobileMsgTemplate( CollUtil.join(monitorMobilePropertiesConfig.getMobile().getMobiles(), ","), contextJson.toJSONString(), CommonConstant.ALIYUN_SMS, EnumSmsChannelTemplate.SERVICE_STATUS_CHANGE.getSignName(), EnumSmsChannelTemplate.SERVICE_STATUS_CHANGE.getTemplate() )); &#125; if (monitorMobilePropertiesConfig.getDingTalk().getEnabled()) &#123; log.info("å¼€å§‹é’‰é’‰é€šçŸ¥ï¼Œå†…å®¹ï¼š&#123;&#125;", text); rabbitTemplate.convertAndSend(MqQueueConstant.DINGTALK_SERVICE_STATUS_CHANGE, text); &#125; &#125; else &#123; log.info("Application &#123;&#125; (&#123;&#125;) &#123;&#125;", event.getApplication().getName(), event.getApplication().getId(), event.getType()); &#125; &#125;&#125; zipkin é“¾è·¯è¿½è¸ªç”±äºzipkinæ˜¯ä¾µå…¥å¼ï¼Œå› æ­¤è¿™éƒ¨åˆ†ç»„ä»¶æ²¡æœ‰ä»£ç ï¼Œåªæœ‰ç›¸å…³ä¾èµ–ã€‚ä¸‹é¢åˆ†äº«ä¸€ä¸‹ä½œè€…çš„yaml DB1234567891011121314151617181920server: port: 5003# datasoureé»˜è®¤ä½¿ç”¨JDBCspring: datasource: driver-class-name: com.mysql.jdbc.Driver username: root password: ENC(gc16brBHPNq27HsjaULgKGq00Rz6ZUji) url: jdbc:mysql://127.0.0.1:3309/pig?characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=falsezipkin: collector: rabbitmq: addresses: 127.0.0.1:5682 password: lengleng username: pig queue: zipkin storage: type: mysql ELK12345678910111213141516171819202122232425262728293031323334353637server: port: 5002zipkin: collector: rabbitmq: addresses: 127.0.0.1:5682 password: lengleng username: pig queue: zipkin storage: type: elasticsearch elasticsearch: hosts: 127.0.0.1:9200 cluster: elasticsearch index: zipkin max-requests: 64 index-shards: 5 index-replicas: 1 ç»­1sæ—¶é—´å…¨ç‰‡ç»“æŸï¼Œè§‰å¾—æˆ‘å†™çš„ä¸é”™ï¼Ÿæƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿèµ¶å¿«æ‰“å¼€æˆ‘çš„ğŸ‘‰ä¸ªäººåšå®¢ ğŸ‘ˆå§ï¼ è°¢è°¢ä½ é‚£ä¹ˆå¯çˆ±ï¼Œè¿˜ä¸€ç›´å…³æ³¨ç€æˆ‘~â¤ğŸ˜]]></content>
      <tags>
        <tag>æºç </tag>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>å­¦å¥½åˆ†å¸ƒå¼æ¶æ„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¼€æºé¡¹ç›®Cloud-Adminåˆ†æä¸å­¦ä¹ ]]></title>
    <url>%2F2018%2F12%2F10%2F%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AECloud-Admin%E5%88%86%E6%9E%90%E4%B8%8E%E5%AD%A6%E4%B9%A0%2F</url>
    <content type="text"><![CDATA[å‰ä¸€æ®µæ—¶é—´åœ¨â€œæ„Ÿæ€§è®¤è¯†JWTâ€ä¸€åšæ–‡ä¸­åˆ†äº«äº†ï¼Œå¾ˆç«çš„å¼€æºé¡¹ç›®Cloud-Adminä¸­é‰´æƒä¸­å¿ƒå’Œç½‘å…³çš„å®ç°ã€‚ä»Šå¤©å†æ¥çœ‹çœ‹å…¶ä»–å„ä¸ªéƒ¨åˆ†æºç  æç¤ºè€è§„çŸ©ï¼Œæ”¾å¼€æºé¡¹ç›®åœ°å€ï¼šhttps://gitee.com/minull/ace-security ç›®å½•ç»“æ„ æ¶æ„ä¸‹é¢æ˜¯å®˜æ–¹æä¾›çš„æ¶æ„æ¨¡å‹ã€‚ é¡¹ç›®çš„è¿è¡Œæ­¥éª¤ å…ˆå¯åŠ¨rabbitmqã€redisã€mysqlä»¥åŠconsulæ³¨å†Œä¸­å¿ƒ è¿è¡Œæ•°æ®åº“è„šæœ¬ï¼šä¾æ¬¡è¿è¡Œæ•°æ®åº“ï¼šace-admin/db/init.sqlã€ace-auth-server/db/init.sqlã€ace-trace ä¿®æ”¹é…ç½®æ•°æ®åº“é…ç½®ï¼šace-admin/src/main/resources/application.ymlã€ace-gate/src/main/resources/application.yml æŒ‰é¡ºåºè¿è¡Œmainç±»ï¼šCenterBootstrapï¼ˆace-centerï¼‰ã€AuthBootstrapï¼ˆace-auth-serverï¼‰ã€AdminBootstrapï¼ˆace-adminï¼‰ã€GatewayServerBootstrapï¼ˆace-gateway-v2ï¼‰ Adminæ¨¡å—æ•°æ®åº“è®¾è®¡å…ˆçœ‹çœ‹æ•°æ®åº“è®¾è®¡ï¼Œadminæ¨¡å—è´Ÿè´£æ‰€æœ‰æƒé™çš„ç®¡ç†ã€‚ç¬¬ä¸€å¼ è¡¨base_elementï¼Œå®šä¹‰äº†å„ä¸ªèµ„æºçš„codeï¼Œç±»å‹ï¼Œuriï¼Œæ¯ä¸€ä¸ªç‰¹å®šèµ„æºå¯¹åº”ä¸€ç§è¯·æ±‚è·¯å¾„ï¼Œå¦‚å›¾ğŸ‘‡ ç¬¬äºŒå¼ ï¼Œbase_groupå®šä¹‰äº†è§’è‰²å’Œè¯·æ±‚è·¯å¾„çš„å…³ç³»ã€‚ğŸ‘‡ ç¬¬ä¸‰å¼ ï¼Œbase_group_typeå®šä¹‰äº†ç±»å‹ğŸ‘‡ ç¬¬å››å¼ ï¼Œbase_menuå®šä¹‰äº†èœå•ğŸ‘‡ ç¬¬äº”å¼ ï¼Œè®°å½•äº†ç½‘å…³æ—¥å¿—ç›¸å…³ä¿¡æ¯ ç¬¬å…­å¼ ï¼Œç”¨æˆ·è¡¨ ä¸šåŠ¡é€»è¾‘æ¥å£è¿™éƒ¨åˆ†ä½œè€…å†™çš„æœ‰äº›ä¹±ï¼Œå°†å¾ˆå¤šä¸šåŠ¡é€»è¾‘çš„æœ‰å…³ä»£ç æ”¾åˆ°æ¥å£å±‚äº†ï¼ˆåæ§½ï¼‰ã€‚è¿™éƒ¨åˆ†ä»£ç æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå°±æ˜¯æ ¹æ®ä¸Šé¢çš„æ•°æ®åº“CRUDã€‚æ¥å£çš„è·¯å¾„åˆ†ä¸º 123456789/api/user/validate/element/**"/gateLog/**"/group/**"/groupType/**"/menu/**"/user/**"/api/permissions"/api/user/un/**" è¿™å‡ ç±»ï¼Œå¹¶ä¸”èµ°æ¯ä¸€å±‚éƒ½ä¼šèµ°é‰´æƒä¸­å¿ƒæ¥é‰´åˆ«ï¼Œå…·ä½“é€»è¾‘æ˜¯ä½¿ç”¨springbootçš„addInterceptors()æ–¹æ³•æ·»åŠ ä¸¤å±‚æ‹¦æˆªå™¨ç»„æˆä¸€ä¸ªæ‹¦æˆªå™¨é“¾ï¼Œå¦‚ä¸‹ğŸ‘‡ 1234567@Override public void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(getServiceAuthRestInterceptor()). addPathPatterns(getIncludePathPatterns()).addPathPatterns("/api/user/validate"); registry.addInterceptor(getUserAuthRestInterceptor()). addPathPatterns(getIncludePathPatterns()); &#125; ç¬¬ä¸€å±‚æ‹¦æˆªå™¨æ˜¯é‰´æƒä¸­å¿ƒçš„ServiceAuthRestInterceptoræ‹¦æˆªå™¨ï¼Œåˆ¤æ–­è®¿é—®çš„å®¢æˆ·ç«¯æ˜¯å¦æœ‰æƒé™è®¿é—®ï¼› 1234567891011121314151617181920212223//ç¬¬ä¸€å±‚æ‹¦æˆªå™¨ @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; HandlerMethod handlerMethod = (HandlerMethod) handler; // é…ç½®è¯¥æ³¨è§£ï¼Œè¯´æ˜ä¸è¿›è¡ŒæœåŠ¡æ‹¦æˆª IgnoreClientToken annotation = handlerMethod.getBeanType().getAnnotation(IgnoreClientToken.class); if (annotation == null) &#123; annotation = handlerMethod.getMethodAnnotation(IgnoreClientToken.class); &#125; if(annotation!=null) &#123; return super.preHandle(request, response, handler); &#125; String token = request.getHeader(serviceAuthConfig.getTokenHeader()); IJWTInfo infoFromToken = serviceAuthUtil.getInfoFromToken(token); String uniqueName = infoFromToken.getUniqueName(); for(String client:serviceAuthUtil.getAllowedClient())&#123; if(client.equals(uniqueName))&#123; return super.preHandle(request, response, handler); &#125; &#125; throw new ClientForbiddenException("Client is Forbidden!"); &#125; ç¬¬äºŒå±‚æ‹¦æˆªå™¨æ˜¯é‰´æƒä¸­å¿ƒçš„UserAuthRestInterceptoræ‹¦æˆªå™¨ï¼Œæ‹¦æˆªéæ³•ç”¨æˆ·ã€‚ 123456789101112131415161718192021222324252627@Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; HandlerMethod handlerMethod = (HandlerMethod) handler; // é…ç½®è¯¥æ³¨è§£ï¼Œè¯´æ˜ä¸è¿›è¡Œç”¨æˆ·æ‹¦æˆª IgnoreUserToken annotation = handlerMethod.getBeanType().getAnnotation(IgnoreUserToken.class); if (annotation == null) &#123; annotation = handlerMethod.getMethodAnnotation(IgnoreUserToken.class); &#125; if (annotation != null) &#123; return super.preHandle(request, response, handler); &#125; String token = request.getHeader(userAuthConfig.getTokenHeader()); if (StringUtils.isEmpty(token)) &#123; if (request.getCookies() != null) &#123; for (Cookie cookie : request.getCookies()) &#123; if (cookie.getName().equals(userAuthConfig.getTokenHeader())) &#123; token = cookie.getValue(); &#125; &#125; &#125; &#125; IJWTInfo infoFromToken = userAuthUtil.getInfoFromToken(token); BaseContextHandler.setUsername(infoFromToken.getUniqueName()); BaseContextHandler.setName(infoFromToken.getName()); BaseContextHandler.setUserID(infoFromToken.getId()); return super.preHandle(request, response, handler); &#125; ç¼“å­˜ä¸­å¿ƒåœ¨ä¸Šé¢çš„adminæ¨¡å—ä¸­ï¼Œä½œè€…åœ¨useræ¥å£ä¸Šï¼Œä½¿ç”¨äº†è‡ªå®šä¹‰çš„ç¼“å­˜æ³¨è§£@Cacheï¼Œç”¨æ¥ä¿å­˜ç”¨æˆ·çš„æƒé™ä¿¡æ¯ï¼Œå‡å°æ•°æ®åº“çš„è®¿é—®å‹åŠ›ğŸ‘‡ 123456789101112131415161718192021222324@RestController@RequestMapping("api")public class UserRest &#123; @Autowired private PermissionService permissionService; @Cache(key="permission") @RequestMapping(value = "/permissions", method = RequestMethod.GET) public @ResponseBody List&lt;PermissionInfo&gt; getAllPermission()&#123; return permissionService.getAllPermission(); &#125; @Cache(key="permission:u&#123;1&#125;") @RequestMapping(value = "/user/un/&#123;username&#125;/permissions", method = RequestMethod.GET) public @ResponseBody List&lt;PermissionInfo&gt; getPermissionByUsername(@PathVariable("username") String username)&#123; return permissionService.getPermissionByUsername(username); &#125; @RequestMapping(value = "/user/validate", method = RequestMethod.POST) public @ResponseBody UserInfo validate(@RequestBody Map&lt;String,String&gt; body)&#123; return permissionService.validate(body.get("username"),body.get("password")); &#125;&#125; ä¸‹é¢æˆ‘ä»¬å°±åˆ†æä¸€ä¸‹ç¼“å­˜ä¸­å¿ƒçš„è®¾è®¡ã€‚ ç›®å½•ç»“æ„ ç¼“å­˜ä¸­å¿ƒæ˜¯ä½œè€…é€šè¿‡mavenæ–¹å¼æ·»åŠ çš„ï¼Œå¹¶æ²¡æœ‰é€šè¿‡ç›´æ¥é¡¹ç›®ä»£ç å±•ç°ã€‚å› æ­¤æˆ‘ä½¿ç”¨ideaçš„åç¼–ç å·¥å…·è¿›è¡Œåˆ†æ å…¥å£å…¥å£ä¸ºEnableAceCacheï¼Œå¼€å¯è¿™ä¸ªå°±å¯ä»¥è‡ªåŠ¨é…ç½®ç¼“å­˜ç›¸å…³äº‹é¡¹ ç¼“å­˜å®ä½“å…ˆçœ‹ç¼“å­˜å®ä½“ï¼Œä½œè€…å®šä¹‰äº†keyï¼Œæè¿°ä¿¡æ¯descï¼Œä»¥åŠè¿‡æœŸæ—¶é—´ 123456789public class CacheBean &#123; private String key = ""; private String desc = ""; @JsonFormat( timezone = "GMT+8", pattern = "yyyy-MM-dd HH:mm:ss" ) private Date expireTime; ..................&#125; é…ç½®ç±»ä¸€å…±æœ‰ä¸¤ä¸ªé…ç½® RedisConfigå…ˆçœ‹RedisConfigï¼Œä½¿ç”¨@PostConstructæ³¨è§£ï¼Œæ„æ€æ˜¯ä¼šåœ¨æœåŠ¡å™¨åŠ è½½Servletçš„æ—¶å€™ï¼Œå°†æœåŠ¡ç«¯ymlä¸­æœ‰å…³redisçš„é…ç½®åŠ è½½åˆ°JedisPoolä¸­ï¼Œè¿™ä¸ªæ–¹æ³•åªä¼šè¢«æœåŠ¡å™¨è°ƒç”¨ä¸€æ¬¡ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677@Configurationpublic class RedisConfig &#123; @Autowired private Environment env; private JedisPool pool; private String maxActive; private String maxIdle; private String maxWait; private String host; private String password; private String timeout; private String database; private String port; private String enable; private String sysName; public RedisConfig() &#123; &#125; @PostConstruct public void init() &#123; PropertiesLoaderUtils prop = new PropertiesLoaderUtils(new String[]&#123;"application.properties"&#125;); this.host = prop.getProperty("redis.host"); if (StringUtils.isBlank(this.host)) &#123; this.host = this.env.getProperty("redis.host"); this.maxActive = this.env.getProperty("redis.pool.maxActive"); this.maxIdle = this.env.getProperty("redis.pool.maxIdle"); this.maxWait = this.env.getProperty("redis.pool.maxWait"); this.password = this.env.getProperty("redis.password"); this.timeout = this.env.getProperty("redis.timeout"); this.database = this.env.getProperty("redis.database"); this.port = this.env.getProperty("redis.port"); this.sysName = this.env.getProperty("redis.sysName"); this.enable = this.env.getProperty("redis.enable"); &#125; else &#123; this.maxActive = prop.getProperty("redis.pool.maxActive"); this.maxIdle = prop.getProperty("redis.pool.maxIdle"); this.maxWait = prop.getProperty("redis.pool.maxWait"); this.password = prop.getProperty("redis.password"); this.timeout = prop.getProperty("redis.timeout"); this.database = prop.getProperty("redis.database"); this.port = prop.getProperty("redis.port"); this.sysName = prop.getProperty("redis.sysName"); this.enable = prop.getProperty("redis.enable"); &#125; &#125; @Bean public JedisPoolConfig constructJedisPoolConfig() &#123; JedisPoolConfig config = new JedisPoolConfig(); config.setMaxTotal(Integer.parseInt(this.maxActive)); config.setMaxIdle(Integer.parseInt(this.maxIdle)); config.setMaxWaitMillis((long)Integer.parseInt(this.maxWait)); config.setTestOnBorrow(true); return config; &#125; @Bean( name = &#123;"pool"&#125; ) public JedisPool constructJedisPool() &#123; String ip = this.host; int port = Integer.parseInt(this.port); String password = this.password; int timeout = Integer.parseInt(this.timeout); int database = Integer.parseInt(this.database); if (null == this.pool) &#123; if (StringUtils.isBlank(password)) &#123; this.pool = new JedisPool(this.constructJedisPoolConfig(), ip, port, timeout); &#125; else &#123; this.pool = new JedisPool(this.constructJedisPoolConfig(), ip, port, timeout, password, database); &#125; &#125; return this.pool; &#125; CacheWebConfigç¬¬äºŒä¸ªé…ç½®ï¼Œå°±æ˜¯ä½¿ç”¨springbootæ‹¦æˆªå™¨ï¼Œå°†ä½œè€…è‡ªå·±å†™çš„ç¼“å­˜ç®¡ç†ä¸­å¿ƒè§†å›¾ç•Œé¢å±•ç¤ºå‡ºæ¥ï¼ˆè¿™ä¸ªæ“ä½œå¤ªç¥å¥‡äº†ï¼Œç¬¬ä¸€æ¬¡çœ‹åˆ°ï¼‰ğŸ‘‡ 1234public void addResourceHandlers(ResourceHandlerRegistry registry) &#123; registry.addResourceHandler(new String[]&#123;"/static/cache/**"&#125;).addResourceLocations(new String[]&#123;"classpath:/META-INF/static/"&#125;); super.addResourceHandlers(registry); &#125; ä½¿ç”¨ç¼“å­˜RedisServiceImplå’ŒCacheRedisRedisServiceImplä½¿ç”¨äº†JedisPoolé‚£å‡ ä¸ªæ–¹æ³•å®ç°äº†å¢åˆ æ”¹æŸ¥æ“ä½œï¼Œä»£ç çœç•¥ã€‚ CacheRedisåˆ™RedisServiceImplæ˜¯åŠ å…¥ä¸€äº›å¢åˆ æ”¹æŸ¥é€»è¾‘ï¼Œè­¬å¦‚ä»€ä¹ˆæ˜¯ä»€ä¹ˆè®¾ç½®ç¼“å­˜ã€‚ åˆ‡é¢åŠ å…¥ç¼“å­˜æ ¸å¿ƒæ–¹æ³•æ ¸å¿ƒæ–¹æ³•interceptorå¦‚ä¸‹ï¼Œä½¿ç”¨ProceedingJoinPointæ‹¿åˆ°è¢«@Cacheæ ‡è®°çš„çš„æ–¹æ³•ä¸­çš„å‚æ•°ï¼Œç”¨getKeyï¼ˆï¼‰æ–¹æ³•æ‹¿åˆ°å…·ä½“ç¼“å­˜çš„keyï¼Œä½¿ç”¨CacheRedisçš„get()æ–¹æ³•æŸ¥æ‰¾å¯¹åº”çš„keyï¼Œå¦‚æœkeyæ‰¾ä¸åˆ°åˆ™ç”¨CacheRedisçš„set()æ–¹æ³•æ·»åŠ æ–°çš„ç¼“å­˜ã€‚ 123456789101112131415161718192021222324252627@Around("aspect()&amp;&amp;@annotation(anno)") public Object interceptor(ProceedingJoinPoint invocation, Cache anno) throws Throwable &#123; MethodSignature signature = (MethodSignature)invocation.getSignature(); Method method = signature.getMethod(); Object result = null; Class&lt;?&gt;[] parameterTypes = method.getParameterTypes(); Object[] arguments = invocation.getArgs(); String key = ""; String value = ""; try &#123; key = this.getKey(anno, parameterTypes, arguments); value = this.cacheAPI.get(key); Type returnType = method.getGenericReturnType(); result = this.getResult(anno, result, value, returnType); &#125; catch (Exception var14) &#123; this.log.error("è·å–ç¼“å­˜å¤±è´¥ï¼š" + key, var14); &#125; finally &#123; if (result == null) &#123; result = invocation.proceed(); if (StringUtils.isNotBlank(key)) &#123; this.cacheAPI.set(key, result, anno.expire()); &#125; &#125; &#125; return result; &#125; å–å¾—keygetKeyï¼ˆï¼‰æ–¹æ³•çš„é€»è¾‘ä¸ºï¼Œåˆ¤æ–­keyç”Ÿæˆå™¨æ˜¯å¦æ˜¯é»˜è®¤ç”Ÿæˆå™¨ï¼ˆå¯ä»¥ä½¿ç”¨å¤šç§ç”Ÿæˆå™¨ï¼‰ï¼Œç„¶åæ ¹æ®é»˜è®¤ç”Ÿæˆå™¨çš„è§„åˆ™ç”Ÿæˆä¸€ä¸ªkeyã€‚ 123456789101112131415private String getKey(Cache anno, Class&lt;?&gt;[] parameterTypes, Object[] arguments) throws InstantiationException, IllegalAccessException &#123; String generatorClsName = anno.generator().getName(); IKeyGenerator keyGenerator = null; if (anno.generator().equals(DefaultKeyGenerator.class)) &#123; keyGenerator = this.keyParser; &#125; else if (this.generatorMap.contains(generatorClsName)) &#123; keyGenerator = (IKeyGenerator)this.generatorMap.get(generatorClsName); &#125; else &#123; keyGenerator = (IKeyGenerator)anno.generator().newInstance(); this.generatorMap.put(generatorClsName, keyGenerator); &#125; String key = keyGenerator.getKey(anno.key(), anno.scope(), parameterTypes, arguments); return key; &#125; keyç”Ÿæˆå™¨é»˜è®¤keyç”Ÿæˆå™¨çš„ä»£ç å¦‚ä¸‹ï¼ˆç”Ÿæˆè§„åˆ™æˆ‘çœ‹ä¸æ‡‚ğŸ˜­ï¼‰ï¼Œ 12345678910111213141516171819202122232425262728293031323334353637public String buildKey(String key, CacheScope scope, Class&lt;?&gt;[] parameterTypes, Object[] arguments) &#123; boolean isFirst = true; if (key.indexOf("&#123;") &gt; 0) &#123; key = key.replace("&#123;", ":&#123;"); Pattern pattern = Pattern.compile("\\d+\\.?[\\w]*"); Matcher matcher = pattern.matcher(key); while(matcher.find()) &#123; String tmp = matcher.group(); String[] express = matcher.group().split("\\."); String i = express[0]; int index = Integer.parseInt(i) - 1; Object value = arguments[index]; if (parameterTypes[index].isAssignableFrom(List.class)) &#123; List result = (List)arguments[index]; value = result.get(0); &#125; if (value == null || value.equals("null")) &#123; value = ""; &#125; if (express.length &gt; 1) &#123; String field = express[1]; value = ReflectionUtils.getFieldValue(value, field); &#125; if (isFirst) &#123; key = key.replace("&#123;" + tmp + "&#125;", value.toString()); &#125; else &#123; key = key.replace("&#123;" + tmp + "&#125;", "_" + value.toString()); &#125; &#125; &#125; return key; &#125; keyè§£æå› ä¸ºä½œè€…çš„keyç”Ÿæˆå™¨æŠ–äº†å¾ˆå¤šæœºçµï¼Œå› æ­¤ï¼Œæ‹¿åˆ°keyä»¥åï¼Œè¦å°†ç”Ÿæˆkeyå’Œvalueä¹‹å‰çš„æ•°å€¼æ‰¾åˆ°æ‰èƒ½è¿›è¡Œæ¯”å¯¹ï¼Œä¸‹é¢æ—¶è§£ækeyçš„ä»£ç ğŸ‘‡å¤§æ¦‚é€»è¾‘æ˜¯æ ¹æ®ä¸åŒçš„valueç±»å‹è¿”å›json 12345678910111213141516public Object parse(String value, Type type, Class... origins) &#123; Object result = null; if (type instanceof ParameterizedType) &#123; ParameterizedType parameterizedType = (ParameterizedType)type; Type rawType = parameterizedType.getRawType(); if (((Class)rawType).isAssignableFrom(List.class)) &#123; result = JSON.parseArray(value, (Class)parameterizedType.getActualTypeArguments()[0]); &#125; &#125; else if (origins == null) &#123; result = JSON.parseObject(value, (Class)type); &#125; else &#123; result = JSON.parseObject(value, origins[0]); &#125; return result; &#125; åˆ‡é¢æ¸…é™¤ç¼“å­˜å¤§æ¦‚æ„æ€å’Œä¸Šé¢å·®ä¸å¤šï¼Œåªè¦æœåŠ¡ç«¯ä¸ŠåŠ å…¥@CacheClearæ³¨è§£å°±å¯ä»¥æ¸…é™¤å¯¹åº”ç¼“å­˜ã€‚ 1234567891011121314151617181920212223242526@Around("aspect()&amp;&amp;@annotation(anno)") public Object interceptor(ProceedingJoinPoint invocation, CacheClear anno) throws Throwable &#123; MethodSignature signature = (MethodSignature)invocation.getSignature(); Method method = signature.getMethod(); Class&lt;?&gt;[] parameterTypes = method.getParameterTypes(); Object[] arguments = invocation.getArgs(); String key = ""; if (StringUtils.isNotBlank(anno.key())) &#123; key = this.getKey(anno, anno.key(), CacheScope.application, parameterTypes, arguments); this.cacheAPI.remove(key); &#125; else if (StringUtils.isNotBlank(anno.pre())) &#123; key = this.getKey(anno, anno.pre(), CacheScope.application, parameterTypes, arguments); this.cacheAPI.removeByPre(key); &#125; else if (anno.keys().length &gt; 1) &#123; String[] arr$ = anno.keys(); int len$ = arr$.length; for(int i$ = 0; i$ &lt; len$; ++i$) &#123; String tmp = arr$[i$]; tmp = this.getKey(anno, tmp, CacheScope.application, parameterTypes, arguments); this.cacheAPI.removeByPre(tmp); &#125; &#125; return invocation.proceed(); &#125;]]></content>
      <tags>
        <tag>æºç </tag>
        <tag>æŠ€æœ¯</tag>
        <tag>å­¦å¥½åˆ†å¸ƒå¼æ¶æ„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¾®æœåŠ¡æ ¸å¿ƒæ¶æ„æ¢³ç†]]></title>
    <url>%2F2018%2F12%2F08%2F%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A0%B8%E5%BF%83%E6%9E%B6%E6%9E%84%E6%A2%B3%E7%90%86%2F</url>
    <content type="text"><![CDATA[åœ¨å…¬å¸å­¦ä¹ äº†æ¥è¿‘ä¸€ä¸ªæœˆã€‚ ä¸€ä¸ªæœˆå†…ï¼Œä»0å¼€å§‹å¼€å§‹æ¥è§¦åˆ†å¸ƒå¼å¾®æœåŠ¡æ¶æ„ï¼Œç»™äº†æˆ‘ä¸å°çš„æ”¶è·ã€‚ä»Šå¤©ï¼Œæˆ‘æ¥ä»å¤´åˆ°å°¾æ¢³ç†ä¸€ä¸‹ï¼Œæœ‰å…³å¾®æœåŠ¡æ¶æ„çš„æ ¸å¿ƒå†…å®¹ï¼ˆå…¨æ˜¯å¹²è´§ï¼‰ã€‚ ä¸‹æ–‡ï¼Œä½ å°†çœ‹åˆ°ä¸šç•Œä¸»æµå¾®æœåŠ¡æ¡†æ¶çš„æ ¸å¿ƒåŸç†ï¼ŒåŒ…æ‹¬æœåŠ¡å‘ç°ï¼Œç½‘å…³ï¼Œé…ç½®ä¸­å¿ƒï¼Œç›‘æ§ç­‰ç»„ä»¶ï¼ŒåŠŸèƒ½å’Œæ¶æ„åŸç†çš„ç®€å•ä»‹ç»ã€‚æ„Ÿè°¢é˜…è¯»ï¼ğŸ˜‹ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ã€‚ğŸ˜ Helloï¼ŒMicroservicesä»€ä¹ˆæ˜¯å¾®æœåŠ¡å¾®æœåŠ¡Microservicesä¹‹çˆ¶ï¼Œé©¬ä¸.ç¦å‹’ï¼Œå¯¹å¾®æœåŠ¡å¤§æ¦‚çš„æ¦‚è¿°å¦‚ä¸‹ï¼š å°±ç›®å‰è€Œè¨€ï¼Œå¯¹äºå¾®æœåŠ¡ä¸šç•Œå¹¶æ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„ã€æ ‡å‡†çš„å®šä¹‰ï¼ˆWhile there is no precise definition of this architectural style ) ã€‚ä½†é€šåœ¨å…¶å¸¸è€Œè¨€ï¼Œå¾®æœåŠ¡æ¶æ„æ˜¯ä¸€ç§æ¶æ„æ¨¡å¼æˆ–è€…è¯´æ˜¯ä¸€ç§æ¶æ„é£æ ¼ï¼Œå®ƒæå€¡å°†å•ä¸€åº”ç”¨ç¨‹åºåˆ’åˆ†æˆä¸€ç»„å°çš„æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡è¿è¡Œç‹¬ç«‹çš„è‡ªå·±çš„è¿›ç¨‹ä¸­ï¼ŒæœåŠ¡ä¹‹é—´äº’ç›¸åè°ƒã€äº’ç›¸é…åˆï¼Œä¸ºç”¨æˆ·æä¾›æœ€ç»ˆä»·å€¼ã€‚æœåŠ¡ä¹‹é—´é‡‡ç”¨è½»é‡çº§çš„é€šä¿¡æœºåˆ¶äº’ç›¸æ²Ÿé€šï¼ˆé€šå¸¸æ˜¯åŸºäº HTTP çš„ RESTful API ) ã€‚æ¯ä¸ªæœåŠ¡éƒ½å›´ç»•ç€å…·ä½“ä¸šåŠ¡è¿›è¡Œæ„å»ºï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«ç‹¬ç«‹åœ°éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€ç±»ç”Ÿäº§ç¯å¢ƒç­‰ã€‚å¦å¤–ï¼Œåº”å°½é‡é¿å…ç»Ÿä¸€çš„ã€é›†ä¸­å¼çš„æœåŠ¡ç®¡ç†æœºåˆ¶ï¼Œå¯¹å…·ä½“çš„ä¸€ä¸ªæœåŠ¡è€Œè¨€ï¼Œåº”æ ¹æ®ä¸šåŠ¡ä¸Šä¸‹æ–‡ï¼Œé€‰æ‹©åˆé€‚çš„è¯­è¨€ã€å·¥å…·å¯¹å…¶è¿›è¡Œæ„å»ºï¼Œå¯ä»¥æœ‰ä¸€ä¸ªéå¸¸è½»é‡çº§çš„é›†ä¸­å¼ç®¡ç†æ¥åè°ƒè¿™äº›æœåŠ¡ã€‚å¯ä»¥ä½¿ç”¨ä¸åŒçš„è¯­è¨€æ¥ç¼–å†™æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ•°æ®å­˜å‚¨ã€‚ æ ¹æ®é©¬ä¸.ç¦å‹’çš„æè¿°ï¼Œæˆ‘æ€»ç»“äº†ä¸€ä¸‹å‡ ç‚¹ï¼š ï¼ˆå­—å·®ï¼Œå‹¿å«Œï¼‰ å°æœåŠ¡å°æœåŠ¡ï¼Œæ²¡æœ‰ç‰¹å®šçš„æ ‡å‡†æˆ–è€…è§„èŒƒï¼Œä½†ä»–åœ¨æ€»ä½“è§„èŒƒä¸Šä¸€å®šæ˜¯å°çš„ã€‚ è¿›ç¨‹ç‹¬ç«‹æ¯ä¸€ç»„æœåŠ¡éƒ½æ˜¯ç‹¬ç«‹è¿è¡Œçš„ï¼Œå¯èƒ½æˆ‘è¿™ä¸ªæœåŠ¡è¿è¡Œåœ¨tomcatå®¹å™¨ï¼Œè€Œå¦ä¸€ä¸ªæœåŠ¡è¿è¡Œåœ¨jettyä¸Šã€‚å¯ä»¥é€šè¿‡è¿›ç¨‹æ–¹å¼ï¼Œä¸æ–­çš„æ¨ªå‘æ‰©å±•æ•´ä¸ªæœåŠ¡ã€‚ é€šä¿¡è¿‡å»çš„åè®®éƒ½æ˜¯å¾ˆé‡çš„ï¼Œå°±åƒESBï¼Œå°±åƒSOAPï¼Œè½»é€šä¿¡ï¼Œç€æ„å‘³ç€ç›¸æ¯”è¿‡å»æ›´æ™ºèƒ½æ›´è½»é‡çš„æœåŠ¡ç›¸äº’è°ƒç”¨ï¼Œå°±æ‰€è°“smart endpoints and dumb pipesï¼Œè¿™äº›endpointéƒ½æ˜¯è§£è€¦çš„ï¼Œå®Œæˆä¸€ä¸ªä¸šåŠ¡é€šä¿¡è°ƒç”¨ä¸²èµ·è¿™äº›micro serviceå°±åƒæ˜¯linuxç³»ç»Ÿä¸­é€šè¿‡ç®¡é“ä¸²èµ·ä¸€ç³»åˆ—å‘½ä»¤ä¸šåŠ¡ã€‚ è¿‡å»çš„ä¸šåŠ¡ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šè€ƒè™‘å„ç§å„æ ·çš„ä¾èµ–å…³ç³»ï¼Œè€ƒè™‘ç³»ç»Ÿè€¦åˆå¸¦æ¥çš„é—®é¢˜ã€‚å¾®æœåŠ¡ï¼Œå¯ä»¥è®©å¼€å‘è€…æ›´ä¸“æ³¨äºä¸šåŠ¡çš„é€»è¾‘å¼€å‘ã€‚ éƒ¨ç½²ä¸æ­¢ä¸šåŠ¡è¦ç‹¬ç«‹ï¼Œéƒ¨ç½²ä¹Ÿè¦ç‹¬ç«‹ã€‚ä¸è¿‡è¿™ä¹Ÿæ„å‘³ç€ï¼Œä¼ ç»Ÿçš„å¼€å‘æµç¨‹ä¼šå‡ºç°ä¸€å®šç¨‹åº¦çš„æ”¹å˜ï¼Œå¼€å‘çš„é€‚åˆä¹Ÿè¦æœ‰ä¸€å®šçš„è¿ç»´æŒ‡è´£ ç®¡ç†ä¼ ç»Ÿçš„ä¼ä¸šçº§SOAæœåŠ¡å¾€å¾€å¾ˆå¤§ï¼Œä¸æ˜“äºç®¡ç†ï¼Œè€¦åˆæ€§é«˜ï¼Œå›¢é˜Ÿå¼€å‘æˆæœ¬æ¯”è¾ƒå¤§ã€‚å¾®æœåŠ¡ï¼Œå¯ä»¥è®©å›¢é˜Ÿå„æ€å…¶æ”¿çš„é€‰æ‹©æŠ€æœ¯å®ç°ï¼Œä¸åŒçš„serviceå¯ä»¥æ ¹æ®å„è‡ªçš„éœ€è¦é€‰æ‹©ä¸åŒçš„æŠ€æœ¯æ ˆæ¥å®ç°å…¶ä¸šåŠ¡é€»è¾‘ã€‚ å¾®æœåŠ¡çš„åˆ©ä¸å¼Šä¸ºä»€ä¹ˆç”¨å¾®æœåŠ¡å‘¢ï¼Ÿå› ä¸ºå¥½ç©ï¼Ÿ ä¸æ˜¯çš„ã€‚ä¸‹é¢æ˜¯æˆ‘ä»ç½‘ç»œä¸Šæ‰¾åˆ°è¯´çš„æ¯”è¾ƒå…¨çš„ä¼˜ç‚¹ï¼š ä¼˜ç‚¹æ¯ä¸ªæœåŠ¡è¶³å¤Ÿå†…èšï¼Œè¶³å¤Ÿå°ï¼Œä»£ç å®¹æ˜“ç†è§£è¿™æ ·èƒ½èšç„¦ä¸€ä¸ªæŒ‡å®šçš„ä¸šåŠ¡åŠŸèƒ½æˆ–ä¸šåŠ¡éœ€æ±‚ å¼€å‘ç®€å•ã€å¼€å‘æ•ˆç‡æé«˜ï¼Œä¸€ä¸ªæœåŠ¡å¯èƒ½å°±æ˜¯ä¸“ä¸€çš„åªå¹²ä¸€ä»¶äº‹ã€‚ å¾®æœåŠ¡èƒ½å¤Ÿè¢«å°å›¢é˜Ÿå•ç‹¬å¼€å‘ï¼Œè¿™ä¸ªå°å›¢é˜Ÿæ˜¯ 2 åˆ° 5 äººçš„å¼€å‘äººå‘˜ç»„æˆã€‚ å¾®æœåŠ¡æ˜¯æ¾è—•åˆçš„ï¼Œæ˜¯æœ‰åŠŸèƒ½æ„ä¹‰çš„æœåŠ¡ï¼Œæ— è®ºæ˜¯åœ¨å¼€å‘é˜¶æ®µæˆ–éƒ¨ç½²é˜¶æ®µéƒ½æ˜¯ç‹¬ç«‹çš„ã€‚ å¾®æœåŠ¡èƒ½ä½¿ç”¨ä¸åŒçš„è¯­è¨€å¼€å‘ã€‚ æ˜“äºå’Œç¬¬ä¸‰æ–¹é›†æˆï¼Œå¾®æœåŠ¡å…è®¸å®¹æ˜“ä¸”çµæ´»çš„æ–¹å¼é›†æˆè‡ªåŠ¨éƒ¨ç½²ï¼Œé€šè¿‡æŒç»­é›†æˆå·¥å…·ï¼Œå¦‚Jenkins,Hudson,bambooã€‚ å¾®æœåŠ¡æ˜“äºè¢«ä¸€ä¸ªå¼€å‘äººå‘˜ç†è§£ï¼Œä¿®æ”¹å’Œç»´æŠ¤ï¼Œè¿™æ ·å°å›¢é˜Ÿèƒ½å¤Ÿæ›´å…³æ³¨è‡ªå·±çš„å·¥ä½œæˆæœã€‚æ— éœ€- - é€šè¿‡åˆä½œæ‰èƒ½ä½“ç°ä»·å€¼ã€‚å¾®æœåŠ¡å…è®¸ä½ åˆ©ç”¨èåˆæœ€æ–°æŠ€æœ¯ã€‚ å¾®æœåŠ¡åªæ˜¯ä¸šåŠ¡é€»è¾‘çš„ä»£ç ï¼Œä¸ä¼šå’Œ HTML,CSSæˆ–å…¶ä»–ç•Œé¢ç»„ä»¶æ··åˆã€‚ æ¯ä¸ªå¾®æœåŠ¡éƒ½æœ‰è‡ªå·±çš„å­˜å‚¨èƒ½åŠ›ï¼Œå¯ä»¥æœ‰è‡ªå·±çš„æ•°æ®åº“ã€‚ä¹Ÿå¯ä»¥æœ‰ç»Ÿä¸€æ•°æ®åº“ã€‚ æ€»çš„æ¥è¯´ï¼Œå¾®æœåŠ¡çš„ä¼˜åŠ¿ï¼Œå°±æ˜¯åœ¨äºï¼Œé¢å¯¹å¤§çš„ç³»ç»Ÿï¼Œå¯ä»¥æœ‰æ•ˆçš„å‡å°‘å¤æ‚ç¨‹åº¦ï¼Œä½¿æœåŠ¡æ¶æ„çš„é€»è¾‘æ›´æ¸…æ™°æ˜äº†ã€‚ ä½†æ˜¯è¿™æ ·ä¹Ÿä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ï¼Œå°±è­¬å¦‚åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„æ•°æ®ä¸€è‡´æ€§ï¼Œæµ‹è¯•çš„å¤æ‚æ€§ï¼Œè¿ç»´çš„å¤æ‚æ€§ã€‚ ä»€ä¹ˆç»„ç»‡é€‚åˆä½¿ç”¨å¾®æœåŠ¡ï¼Ÿå¾®æœåŠ¡å¸¦äº†ç§ç§ä¼˜ç‚¹ï¼Œç§ç§å¼Šç«¯ï¼Œé‚£ä¹ˆä»€ä¹ˆç»„ç»‡é€‚åˆä½¿ç”¨å¾®æœåŠ¡ï¼Ÿ å¢¨è²å®šå¾‹ï¼ˆè®¾è®¡ç³»ç»Ÿï¼‰å’Œåº·å¨å®šå¾‹ï¼ˆç³»ç»Ÿåˆ’åˆ†ï¼‰åº·å¨å®šå¾‹ï¼Œæ˜¯ä¸€ä¸ªäº”åå¤šå¹´å‰å°±è¢«æå‡ºæ¥çš„å¾®æœåŠ¡æ¦‚å¿µã€‚åœ¨åº·å¨çš„è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæœ€æœ‰åçš„ä¸€å¥è¯å°±æ˜¯ï¼š Organizations which design systems are constrained to produce designs which are copies of the communication structures of these organizations. - Melvin Conway(1967) ä¸­æ–‡ç›´è¯‘å¤§æ¦‚çš„æ„æ€å°±æ˜¯ï¼šè®¾è®¡ç³»ç»Ÿçš„ç»„ç»‡ï¼Œå…¶äº§ç”Ÿçš„è®¾è®¡ç­‰åŒäºç»„ç»‡ä¹‹å†…ã€ç»„ç»‡ä¹‹é—´çš„æ²Ÿé€šç»“æ„ã€‚çœ‹çœ‹ä¸‹é¢çš„å›¾ç‰‡ï¼ˆæ¥æºäºäº’è”ç½‘ï¼Œä¾µåˆ ï¼‰ï¼Œå†æƒ³æƒ³Appleçš„äº§å“ã€å¾®è½¯çš„äº§å“è®¾è®¡ï¼Œå°±èƒ½å½¢è±¡ç”ŸåŠ¨çš„ç†è§£è¿™å¥è¯ã€‚ æ„Ÿå…´è¶£çš„å„ä½å¯ä»¥ç ”ç©¶ä¸€ä¸‹ æ¶æ„æ¼”åŒ–æ¶æ„æ˜¯ä¸æ–­æ¼”åŒ–å‡ºæ¥çš„ï¼Œå¾®æœåŠ¡ä¹Ÿæ˜¯è¿™æ ·ï¼Œå½“ä»å„å¤§ç§‘æŠ€å…¬å¸ï¼Œè§„æ¨¡å¤§åˆ°ä¸€å®šç¨‹åº¦ï¼Œå®Œå…¨éœ€è¦æ¼”åŒ–æˆæ›´è¿›ä¸€æ­¥ç®¡ç†çš„æŠ€æœ¯æ¶æ„ä½“ç³»ã€‚ ï¼ˆå­—å·®ï¼Œå‹¿å«Œï¼‰ ä¼ ç»Ÿçš„å›¢é˜Ÿï¼Œéƒ½æ˜¯é¢å‘è¿‡ç¨‹åŒ–çš„ï¼Œäº§å“æƒ³å®Œäº†å»æ‰¾ç­–åˆ’ï¼Œç­–åˆ’å®Œäº†æ‰¾å¼€å‘ï¼Œæ¥ç€é¡ºç€ä¸€æ­¥ä¸€æ­¥æ‰¾ã€‚æˆ‘ä»¬åšæŠ€æœ¯éƒ½æ˜¯ä¸ºäº†äº§å“çš„ï¼Œä¸€æ—¦è¿‡ç¨‹å‡ºæ¥äº†ä»€ä¹ˆé—®é¢˜ï¼Œå›æº¯å¯»æ‰¾é—®é¢˜ä¼šéå¸¸è€—æ—¶ã€‚ ï¼ˆå­—å·®ï¼Œå‹¿å«Œï¼‰ ä½¿ç”¨äº†å¾®æœåŠ¡æ¶æ„ä½“ç³»ï¼Œå›¢é˜Ÿç»„ç»‡æ–¹å¼éœ€è¦è½¬å˜æˆè·¨èŒèƒ½å›¢é˜Ÿï¼Œå³æ¯ä¸ªå›¢é˜Ÿéƒ½æœ‰äº§å“ä¸“å®¶ï¼Œç­–åˆ’ä¸“å®¶ï¼Œå¼€å‘ä¸“å®¶ï¼Œè¿ç»´ä¸“å®¶ï¼Œä»–ä»¬ä½¿ç”¨APIæ–¹å¼å‘å¸ƒä»–ä»¬çš„åŠŸèƒ½ï¼Œè€Œå¹³å°ä½¿ç”¨ä»–ä»¬çš„åŠŸèƒ½å‘å¸ƒäº§å“ å¾®æœåŠ¡æŠ€æœ¯æ¶æ„ä½“ç³»ä¸‹é¢æˆ‘åˆ†äº«ä¸€ä¸‹å¤§éƒ¨åˆ†å…¬å¸éƒ½ä½¿ç”¨çš„å¾®æœåŠ¡æŠ€æœ¯æ¶æ„ä½“ç³»ã€‚ ï¼ˆå›¾å·®ï¼Œå‹¿å«Œï¼‰ æœåŠ¡å‘ç°ä¸»æµçš„æœåŠ¡å‘ç°ï¼Œåˆ†ä¸ºä¸‰ç§ ç¬¬ä¸€ç§ï¼Œå¼€å‘äººå‘˜å¼€å‘äº†ç¨‹åºä»¥åï¼Œä¼šæ‰¾è¿ç»´é…ä¸€ä¸ªåŸŸåï¼ŒæœåŠ¡çš„è¯é€šè¿‡dnså°±èƒ½æ‰¾åˆ°æˆ‘ä»¬å¯¹åº”çš„æœåŠ¡ ç¼ºç‚¹æ˜¯ï¼Œç”±äºæœåŠ¡æ²¡æœ‰è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œå¯¹è´Ÿè½½å‡è¡¡æœåŠ¡ï¼Œå¯èƒ½ä¼šæœ‰ç›¸å½“å¤§çš„æ€§èƒ½é—®é¢˜ã€‚ ç¬¬äºŒç§ï¼Œæ˜¯ç›®å‰æ™®éçš„åšæ³•ã€‚å¯ä»¥å‚è€ƒæˆ‘ä¸Šç¯‡åšå®¢åˆ†æçš„zuulç½‘å…³ï¼Œæ¯ä¸€ä¸ªæœåŠ¡éƒ½é€šè¿‡æœåŠ¡ç«¯å†…ç½®çš„åŠŸèƒ½æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒï¼ŒæœåŠ¡æ¶ˆè´¹è€…ä¸æ–­è½®è¯¢æ³¨å†Œä¸­å¿ƒå‘ç°å¯¹åº”çš„æœåŠ¡ï¼Œä½¿ç”¨å†…ç½®è´Ÿè½½å‡è¡¡è°ƒç”¨æœåŠ¡ã€‚ ç¼ºç‚¹æ˜¯ï¼Œå¯¹å¤šè¯­è¨€ç¯å¢ƒä¸æ˜¯å¾ˆå¥½ï¼Œä½ éœ€è¦å•ç‹¬ç»™æ¶ˆè´¹è€…çš„å®¢æˆ·ç«¯å¼€å‘æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚å½“ç„¶äº†ï¼Œè¿™ä¸ªæ–¹æ³•é€šå¸¸éƒ½æ˜¯ç”¨åœ¨spring cloudä¸Šçš„ã€‚ ç¬¬ä¸‰ç§ï¼Œæ˜¯å°†å®¢æˆ·ç«¯å’Œè´Ÿè½½å‡è¡¡æ”¾åœ¨åŒä¸€ä¸ªä¸»æœºï¼Œè€Œä¸æ˜¯åŒä¸€ä¸ªè¿›ç¨‹å†…ã€‚ è¿™ç§æ–¹æ³•ç›¸å¯¹ç¬¬ä¸€ç§ç¬¬äºŒç§æ–¹æ³•æ¥è¯´ï¼Œæ”¹å–„äº†ä»–ä»¬çš„ç¼ºç‚¹ï¼Œä½†æ˜¯ä¼šæå¤§å¢åŠ è¿ç»´æˆæœ¬ã€‚ ç½‘å…³å¾®æœåŠ¡çš„ç½‘å…³æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä»¬å¯ä»¥è”ç³»ç”Ÿæ´»å®é™…æƒ³ä¸€ä¸‹ã€‚æ¯ä¸€ä¸ªå¤§çš„å…¬å¸ï¼Œéƒ½ä¼šæœ‰ä¸€åå±äºè‡ªå·±çš„å»ºç­‘åŒºï¼Œè€Œè¿™å»ºç­‘åŒºå†…ï¼Œéƒ½æœ‰ä¸å°‘çš„é—¨å«ã€‚å¦‚æœæœ‰å¤–æ¥äººå‘˜è¿›å…¥å…¬å¸ï¼Œä¼šå…ˆå’Œé—¨å«æ‰“å¥½æ‹›å‘¼ï¼Œæ‰èƒ½è¿›å»ã€‚ å°†ç”Ÿæ´»å®é™…è”ç³»åˆ°å¾®æœåŠ¡ä¸Šï¼Œå°±ä¸éš¾ç†è§£ç½‘å…³çš„æ„æ€äº†ã€‚ ç½‘å…³æœ‰ä»€ä¹ˆç”¨ åå‘è·¯ç”±ï¼šå¾ˆå¤šæ—¶å€™ï¼Œå…¬å¸ä¸æƒ³è®©å¤–éƒ¨äººå‘˜çœ‹åˆ°æˆ‘ä»¬å…¬å¸çš„å†…éƒ¨ï¼Œå°±éœ€è¦ç½‘å…³æ¥è¿›è¡Œåå‘è·¯ç”±ã€‚å³å°†å¤–éƒ¨è¯·æ±‚è½¬æ¢æˆå†…éƒ¨å…·ä½“æœåŠ¡æ¡ç”¨ å®‰å…¨è®¤è¯ï¼šç½‘ç»œä¸­ä¼šæœ‰å¾ˆå¤šæ¶æ„è®¿é—®ï¼Œè­¬å¦‚çˆ¬è™«ï¼Œè­¬å¦‚é»‘å®¢æ”»å‡»ï¼Œç½‘å…³ç»´æŠ¤å®‰å…¨åŠŸèƒ½ã€‚ é™æµç†”æ–­ï¼šå‚è€ƒæˆ‘å­¦å¥½åˆ†å¸ƒå¼zookepperçš„åšå®¢ï¼Œå½“è¯·æ±‚å¾ˆå¤šæœåŠ¡ä¸å ªé‡è´Ÿï¼Œä¼šè®©æˆ‘ä»¬çš„æœåŠ¡è‡ªåŠ¨å…³é—­ï¼Œå¯¼è‡´ä¸èƒ½ç”¨æœåŠ¡ã€‚é™æµç†”æ–­å¯ä»¥æœ‰æ•ˆçš„é¿å…è¿™ç±»é—®é¢˜ æ—¥å¿—ç›‘æ§ï¼šæ‰€æœ‰çš„å¤–é¢çš„è¯·æ±‚éƒ½ä¼šç»è¿‡ç½‘å…³ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ç½‘å…³æ¥è®°å½•æ—¥å¿—ä¿¡æ¯ ç°åº¦å‘å¸ƒï¼Œè“ç»¿éƒ¨ç½²ã€‚æ˜¯æŒ‡èƒ½å¤Ÿå¹³æ»‘è¿‡æ¸¡çš„ä¸€ç§å‘å¸ƒæ–¹å¼ã€‚åœ¨å…¶ä¸Šå¯ä»¥è¿›è¡ŒA/B testingï¼Œå³è®©ä¸€éƒ¨åˆ†ç”¨æˆ·ç»§ç»­ç”¨äº§å“ç‰¹æ€§Aï¼Œä¸€éƒ¨åˆ†ç”¨æˆ·å¼€å§‹ç”¨äº§å“ç‰¹æ€§Bï¼Œå¦‚æœç”¨æˆ·å¯¹Bæ²¡æœ‰ä»€ä¹ˆåå¯¹æ„è§ï¼Œé‚£ä¹ˆé€æ­¥æ‰©å¤§èŒƒå›´ï¼ŒæŠŠæ‰€æœ‰ç”¨æˆ·éƒ½è¿ç§»åˆ°Bä¸Šé¢æ¥ã€‚ å¼€æºç½‘å…³Zuulæ¶æ„ zuulç½‘å…³æ ¸å¿ƒå…¶å®æ˜¯ä¸€ä¸ªservletï¼Œæ‰€æœ‰è¯·æ±‚éƒ½ä¼šç»è¿‡zuul servletä¼ åˆ°zuulFilter Runnerï¼Œç„¶ååˆ†å‘åˆ°ä¸‰ç§è¿‡æ»¤å™¨ã€‚ å…ˆè¯´è¯´æ¶æ„å›¾å·¦åŠéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ä½¿ç”¨Groovyå®ç°çš„å‰ç½®è·¯ç”±è¿‡æ»¤å™¨ï¼Œè·¯ç”±è¿‡æ»¤å™¨ï¼Œåç½®è·¯ç”±è¿‡æ»¤å™¨ã€‚ ä¸€èˆ¬è¯·æ±‚éƒ½ä¼šå…ˆç»è¿‡å‰ç½®è·¯ç”±è¿‡æ»¤å™¨å¤„ç†ï¼Œä¸€èˆ¬çš„è‡ªå®šä¹‰javaå°è£…é€»è¾‘ä¹Ÿä¼šåœ¨è¿™é‡Œå®ç°ã€‚ è·¯ç”±è¿‡æ»¤å™¨ï¼Œå®ç°çš„æ˜¯æ‰¾åˆ°å¯¹åº”çš„å¾®æœåŠ¡è¿›è¡Œè°ƒç”¨ã€‚ è°ƒç”¨å®Œäº†ï¼Œå“åº”å›æ¥ï¼Œä¼šç»è¿‡åç½®è·¯ç”±è¿‡æ»¤å™¨ï¼Œé€šè¿‡åç½®è·¯ç”±è¿‡æ»¤å™¨æˆ‘ä»¬å¯ä»¥å°è£…æ—¥å¿—å®¡è®¡çš„å¤„ç†ã€‚ å¯ä»¥è¯´zuulç½‘å…³æœ€å¤§çš„ç‰¹è‰²å°±æ˜¯å®ƒä¸‰å±‚è¿‡æ»¤å™¨ã€‚ æ¶æ„å›¾å³åŠéƒ¨åˆ†ï¼Œæ˜¯zuulç½‘å…³è®¾è®¡çš„è‡ªå®šä¹‰è¿‡æ»¤å™¨åŠ è½½æœºåˆ¶ã€‚ç½‘å…³å†…éƒ¨ä¼šæœ‰ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ï¼Œè‡ªåŠ¨çš„å°†è¿‡æ»¤å™¨è„šæœ¬å‘å¸ƒåˆ°zuulç½‘å…³è¯»å–åŠ è½½è¿è¡Œã€‚ é…ç½®ä¸­å¿ƒä»¥å‰ï¼Œå¼€å‘äººå‘˜æŠŠé…ç½®æ–‡ä»¶æ”¾åœ¨å¼€å‘æ–‡ä»¶é‡Œé¢ï¼Œè¿™æ ·ä¼šæœ‰å¾ˆå¤šéšæ‚£ã€‚è­¬å¦‚ï¼Œé…ç½®è§„èŒƒä¸åŒï¼Œæ— æ³•è¿½æº¯é…ç½®äººå‘˜ã€‚ä¸€æ—¦éœ€è¦å¤§è§„æ¨¡æ”¹åŠ¨é…ç½®ï¼Œæ”¹åŠ¨æ—¶é—´ä¼šå¾ˆé•¿ï¼Œæ— æ³•è¿½æº¯é…ç½®äººå‘˜ï¼Œä»è€Œå½±å“æ•´ä¸ªäº§å“ï¼Œåæœæ˜¯æˆ‘ä»¬æ‰¿æ‹…ä¸èµ·çš„ã€‚ å› æ­¤å°±æœ‰é…ç½®ä¸­å¿ƒè¿™ä¸ªå–½~ ç°åœ¨çš„å¼€æºä¸­å¿ƒæœ‰ç™¾åº¦é…ç½®ä¸­å¿ƒ Disconfï¼Œspring cloud configï¼ŒApolloï¼Œä»Šå¤©é‡ç‚¹è¯´è¯´ç°åœ¨åº”ç”¨è´¨é‡ä¸é”™çš„é…ç½®ä¸­å¿ƒé˜¿æ³¢ç½—ã€‚ æºç¨‹å¼€æºçš„Apolloå¼€æºåœ°å€ğŸ‘‰ï¼šhttps://github.com/ctripcorp/apollo apolloçš„é…ç½®ä¸­å¿ƒè§„æ¨¡æ¯”è¾ƒå¤§ï¼Œæœ¬åœ°åº”ç”¨ä¼šæœ‰å“åº”çš„é…ç½®ä¸­å¿ƒå®¢æˆ·ç«¯ï¼Œå¯ä»¥å®šæ—¶åŒæ­¥é…ç½®ä¸­å¿ƒé‡Œçš„é…ç½®ã€‚å¦‚æœé…ç½®ä¸­å¿ƒæ€ æœºï¼Œä¼šä½¿ç”¨ç¼“å­˜æ¥è¿›è¡Œé…ç½®ã€‚ é€šè®¯æ–¹å¼å…³äºé€šè®¯æ–¹å¼ï¼Œä¸€èˆ¬å¸‚é¢ä¹Ÿå°±æ˜¯ä¸¤ç§è¿œç¨‹è°ƒç”¨æ–¹å¼ï¼Œæˆ‘æ•´ç†äº†ä¸€ä¸ªè¡¨æ ¼ï¼š RPC REST è€¦åˆæ€§ å¼ºè€¦åˆ æ¾æ•£è€¦åˆ æ¶ˆæ¯åè®® TCP HTTP é€šè®¯åè®® äºŒè¿›åˆ¶ æ–‡æœ¬XMLï¼ŒJson æ€§èƒ½ é«˜ ä½äºRPC æ¥å£å¥‘çº¦IDL thrift,protobuf,IdL Swagger å®¢æˆ·ç«¯ å¼ºç±»å‹å®¢æˆ·ç«¯ï¼Œä¸€èˆ¬è‡ªåŠ¨ç”Ÿæˆ ä¸€èˆ¬HTTPå¯è®¿é—®ï¼Œç”Ÿæˆå¼ºç±»å‹å®¢æˆ·ç«¯ï¼Œå¤šè¯­è¨€æ”¯æŒå¥½ æ¡ˆä¾‹ Dubboï¼ŒDubbox,motan,tars,grpc,thrift spring boot,tax-rs,dropwizard å¼€å‘è€…å‹å¥½ å®¢æˆ·ç«¯æ¯”è¾ƒæ–¹é¢ï¼ŒäºŒè¿›åˆ¶æ¶ˆæ¯ä¸èƒ½è¯» å¯è¯»æ¶ˆæ¯ å¯¹å¤–å¼€æ”¾ ä¸€èˆ¬éœ€è¦è½¬æˆREST/æ–‡æœ¬åè®® å¯ç›´æ¥å¯¹å¤–å¼€å‘ ç›‘æ§é¢„è­¦ç›‘æ§é¢„è­¦å¯¹äºå¾®æœåŠ¡å¾ˆé‡è¦ï¼Œä¸€ä¸ªå¯é çš„ç›‘æ§é¢„è­¦ä½“ç³»å¯¹å¾®æœåŠ¡è¿è¡Œè‡³å…³é‡è¦ã€‚ä¸€èˆ¬ç›‘æ§åˆ†ä¸ºå¦‚ä¸‹å±‚æ¬¡ï¼š ä»åŸºç¡€è®¾æ–½åˆ°ç”¨æˆ·ç«¯ï¼Œå±‚å±‚æœ‰ç›‘æ§ï¼Œå…¨æ–¹ä½ï¼Œå¤šè§’åº¦ï¼Œæ¯ä¸€ä¸ªå±‚é¢éƒ½å¾ˆé‡è¦ã€‚æ€»ä½“æ¥è¯´ï¼Œå¾®æœåŠ¡å¯åˆ†5ä¸ªç›‘æ§ç‚¹ï¼šæ—¥å¿—ç›‘æ§ï¼ŒMetricsç›‘æ§ï¼Œå¥åº·æ£€æŸ¥ï¼Œè°ƒç”¨é“¾æ£€æŸ¥ï¼Œå‘Šè­¦ç³»ç»Ÿ ç›‘æ§æ¶æ„ä¸‹é¢çš„å›¾æ˜¯å¤§éƒ¨åˆ†å…¬å¸çš„ä¸€ç§ç›‘æ§æ¶æ„å›¾ã€‚æ¯ä¸€ä¸ªæœåŠ¡éƒ½æœ‰ä¸€ä¸ªagentï¼Œagentæ”¶é›†åˆ°å…³é”®ä¿¡æ¯ï¼Œä¼šä¼ åˆ°ä¸€äº›MQä¸­ï¼Œä¸ºäº†è§£è€¦ã€‚åŒæ—¶å°†æ—¥å¿—ä¼ å…¥ELKï¼Œå°†Metricsä¼ å…¥InfluxDBæ—¶é—´åºåˆ—åº“ã€‚è€Œåƒnagiosï¼Œå¯ä»¥å®šæœŸå‘agentå‘èµ·ä¿¡æ¯æ£€æŸ¥å¾®æœåŠ¡ã€‚ è°ƒç”¨é“¾ç›‘æ§APMå¾ˆå¤šå…¬å¸éƒ½æœ‰è°ƒç”¨é“¾ç›‘æ§ï¼Œå°±è­¬å¦‚é˜¿é‡Œæœ‰é¹°çœ¼ç›‘æ§ï¼Œç‚¹è¯„çš„Catï¼Œå¤§éƒ¨åˆ†è°ƒç”¨é“¾ç›‘æ§ï¼ˆæ²¡é”™ï¼Œæˆ‘æŒ‡çš„Zipkinï¼‰æ¶æ„æ˜¯è¿™æ ·çš„ğŸ‘‡ å½“è¯·æ±‚è¿›å…¥Webå®¹å™¨çš„æ—¶å€™ï¼Œä¼šç»è¿‡åˆ›å»ºTracerï¼Œè¿æ¥spansï¼ˆæ¨¡æ‹Ÿæ½œåœ¨çš„åˆ†å¸ƒå¼å·¥ä½œçš„å»¶è¿Ÿï¼Œè¯¥æ¨¡å—è¿˜åŒ…å«åœ¨ç³»ç»Ÿç½‘ç»œé—´ä¼ é€’è·Ÿè¸ªä¸Šä¸‹æ–‡ä¿¡æ¯çš„å·¥å…·åŒ…ï¼Œå¦‚é€šè¿‡http headersï¼‰ã€‚Spansæœ‰ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œå…¶ä¸­åŒ…å«traceræ ‡è¯†ç¬¦ï¼Œå°†å…¶æ”¾åœ¨è¡¨ç¤ºåˆ†å¸ƒå¼æ“ä½œçš„æ ‘çš„æ­£ç¡®ä½ç½®ã€‚å½“æˆ‘ä»¬æŠŠå›¾ä¸­çš„å„ç§spanæ”¾åˆ°åç«¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„æœåŠ¡è°ƒç”¨é“¾ä¼šåŠ¨æ€çš„ç”Ÿæˆè°ƒç”¨é“¾ã€‚ ä¸‹é¢æ˜¯ä¸€äº›å¸‚åœºä¸Šç”¨çš„æ¯”è¾ƒå¤šçš„è°ƒç”¨é“¾ç›‘æ§ï¼š 1ã€Pinpointgithubåœ°å€ï¼šGitHub - naver/pinpoint: Pinpoint is an open source APM (Application Performance Management) tool for large-scale distributed systems written in Java.å¯¹javaé¢†åŸŸçš„æ€§èƒ½åˆ†ææœ‰å…´è¶£çš„æœ‹å‹éƒ½åº”è¯¥çœ‹çœ‹è¿™ä¸ªå¼€æºé¡¹ç›®ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªéŸ©å›½å›¢é˜Ÿå¼€æºå‡ºæ¥çš„ï¼Œé€šè¿‡JavaAgentçš„æœºåˆ¶æ¥åšå­—èŠ‚ç ä»£ç æ¤å…¥ï¼Œå®ç°åŠ å…¥traceidå’ŒæŠ“å–æ€§èƒ½æ•°æ®çš„ç›®çš„ã€‚NewRelicã€Oneapmä¹‹ç±»çš„å·¥å…·åœ¨javaå¹³å°ä¸Šçš„æ€§èƒ½åˆ†æä¹Ÿæ˜¯ç±»ä¼¼çš„æœºåˆ¶ã€‚ 2ã€SkyWalkinggithubåœ°å€ï¼šwu-sheng/sky-walkingè¿™æ˜¯å›½å†…ä¸€ä½å«å´æ™Ÿçš„å…„å¼Ÿå¼€æºçš„ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¯¹JAVAåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºé›†ç¾¤çš„ä¸šåŠ¡è¿è¡Œæƒ…å†µè¿›è¡Œè¿½è¸ªã€å‘Šè­¦å’Œåˆ†æçš„ç³»ç»Ÿï¼Œåœ¨githubä¸Šä¹Ÿæœ‰400å¤šé¢—æ˜Ÿäº†ã€‚åŠŸèƒ½ç›¸å¯¹pinpointè¿˜æ˜¯ç¨å¼±ä¸€äº›ï¼Œæ’ä»¶è¿˜æ²¡é‚£ä¹ˆä¸°å¯Œï¼Œä¸è¿‡ä¹Ÿå¾ˆéš¾å¾—äº†ã€‚ 3ã€Zipkinå®˜ç½‘ï¼šOpenZipkin Â· A distributed tracing systemgithubåœ°å€ï¼šGitHub - openzipkin/zipkin: Zipkin is a distributed tracing systemè¿™ä¸ªæ˜¯twitterå¼€æºå‡ºæ¥çš„ï¼Œä¹Ÿæ˜¯å‚è€ƒDapperçš„ä½“ç³»æ¥åšçš„ã€‚ Zipkinçš„javaåº”ç”¨ç«¯æ˜¯é€šè¿‡ä¸€ä¸ªå«Braveçš„ç»„ä»¶æ¥å®ç°å¯¹åº”ç”¨å†…éƒ¨çš„æ€§èƒ½åˆ†ææ•°æ®é‡‡é›†ã€‚Braveçš„githubåœ°å€ï¼šhttps://github.com/openzipkin/braveè¿™ä¸ªç»„ä»¶é€šè¿‡å®ç°ä¸€ç³»åˆ—çš„javaæ‹¦æˆªå™¨ï¼Œæ¥åšåˆ°å¯¹http/servletè¯·æ±‚ã€æ•°æ®åº“è®¿é—®çš„è°ƒç”¨è¿‡ç¨‹è·Ÿè¸ªã€‚ç„¶åé€šè¿‡åœ¨springä¹‹ç±»çš„é…ç½®æ–‡ä»¶é‡ŒåŠ å…¥è¿™äº›æ‹¦æˆªå™¨ï¼Œå®Œæˆå¯¹javaåº”ç”¨çš„æ€§èƒ½æ•°æ®é‡‡é›†ã€‚ 4ã€CATgithubåœ°å€ï¼šGitHub - dianping/cat: Central Application Trackingè¿™ä¸ªæ˜¯å¤§ä¼—ç‚¹è¯„å¼€æºå‡ºæ¥çš„ï¼Œå®ç°çš„åŠŸèƒ½ä¹Ÿè¿˜æ˜¯è›®ä¸°å¯Œçš„ï¼Œå›½å†…ä¹Ÿæœ‰ä¸€äº›å…¬å¸åœ¨ç”¨äº†ã€‚ä¸è¿‡ä»–å®ç°è·Ÿè¸ªçš„æ‰‹æ®µï¼Œæ˜¯è¦åœ¨ä»£ç é‡Œç¡¬ç¼–ç å†™ä¸€äº›â€œåŸ‹ç‚¹â€ï¼Œä¹Ÿå°±æ˜¯ä¾µå…¥å¼çš„ã€‚è¿™æ ·åšæœ‰åˆ©æœ‰å¼Šï¼Œå¥½å¤„æ˜¯å¯ä»¥åœ¨è‡ªå·±éœ€è¦çš„åœ°æ–¹åŠ åŸ‹ç‚¹ï¼Œæ¯”è¾ƒæœ‰é’ˆå¯¹æ€§ï¼›åå¤„æ˜¯å¿…é¡»æ”¹åŠ¨ç°æœ‰ç³»ç»Ÿï¼Œå¾ˆå¤šå¼€å‘å›¢é˜Ÿä¸æ„¿æ„ã€‚ 5ã€Xhprof/Xhguiè¿™ä¸¤ä¸ªå·¥å…·çš„ç»„åˆï¼Œæ˜¯é’ˆå¯¹PHPåº”ç”¨æä¾›APMèƒ½åŠ›çš„å·¥å…·ï¼Œä¹Ÿæ˜¯éä¾µå…¥å¼çš„ã€‚Xhprof githubåœ°å€ï¼šGitHub - preinheimer/xhprof: XHGUI is a GUI for the XHProf PHP extension, using a database backend, and pretty graphs to make it easy to use and interpret.Xhgui githubåœ°å€ï¼šGitHub - perftools/xhgui: A graphical interface for XHProf data built on MongoDBæˆ‘å¯¹PHPä¸ç†Ÿï¼Œä¸è¿‡ç½‘ä¸Šä»‹ç»è¿™ä¸¤ä¸ªå·¥å…·çš„èµ„æ–™è¿˜æ˜¯è›®å¤šçš„ã€‚ ç†”æ–­ã€éš”ç¦»ã€é™æµã€é™çº§é¢å¯¹å·¨å¤§çš„çªå‘æµé‡ä¸‹ï¼Œå¤§å‹å…¬å¸ä¸€èˆ¬ä¼šé‡‡ç”¨ä¸€ç³»åˆ—çš„ç†”æ–­ï¼ˆç³»ç»Ÿè‡ªåŠ¨å°†æœåŠ¡å…³é—­é˜²æ­¢è®©å‡ºç°çš„é—®é¢˜æœ€å¤§åŒ–ï¼‰ã€éš”ç¦»ï¼ˆå°†æœåŠ¡å’ŒæœåŠ¡éš”ç¦»ï¼Œé˜²æ­¢ä¸€ä¸ªæœåŠ¡æŒ‚äº†å…¶ä»–æœåŠ¡ä¸èƒ½è®¿é—®ï¼‰ã€é™æµï¼ˆå•ä½æ—¶é—´å†…ä¹‹å…è®¸ä¸€å®šæ•°é‡ç”¨æˆ·è®¿é—®ï¼‰ã€é™çº§ï¼ˆå½“æ•´ä¸ªå¾®æœåŠ¡æ¶æ„æ•´ä½“çš„è´Ÿè½½è¶…å‡ºäº†é¢„è®¾çš„ä¸Šé™é˜ˆå€¼æˆ–å³å°†åˆ°æ¥çš„æµé‡é¢„è®¡å°†ä¼šè¶…è¿‡é¢„è®¾çš„é˜ˆå€¼æ—¶ï¼Œä¸ºäº†ä¿è¯é‡è¦æˆ–åŸºæœ¬çš„æœåŠ¡èƒ½æ­£å¸¸è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€äº› ä¸é‡è¦æˆ– ä¸ç´§æ€¥ çš„æœåŠ¡æˆ–ä»»åŠ¡è¿›è¡ŒæœåŠ¡çš„ å»¶è¿Ÿä½¿ç”¨ æˆ– æš‚åœä½¿ç”¨ï¼‰æªæ–½ã€‚ ä¸‹é¢ä»‹ç»ä¸€ä¸‹hystrixçš„è¿è¡Œæµç¨‹ï¼ˆæ²¡æ‰¾åˆ°æ¶æ„å›¾ä¸å¥½æ„æ€ï¼‰ï¼š æ¯ä¸€ä¸ªå¾®æœåŠ¡è°ƒç”¨æ—¶ï¼Œéƒ½ä¼šä½¿ç”¨hystrixçš„commandæ–¹å¼ï¼ˆä¸Šå›¾çš„å·¦ä¸Šè§’é‚£ä¸ªï¼‰ï¼Œç„¶åä½¿ç”¨commandåŒæ­¥çš„ï¼Œæˆ–è€…æ˜¯å“åº”å¼çš„ï¼Œæˆ–è€…æ˜¯å¼‚æ­¥çš„ï¼Œåˆ¤æ–­ç”µè·¯æ˜¯å¦ç†”æ–­ï¼ˆé¡ºç€å›¾ä»å·¦å¾€å³çœ‹ï¼‰ï¼Œ å¦‚æœæ–­è·¯åˆ™èµ°é™çº§fallbackï¼› å¦‚æœè¿™ä¸ªçº¿é—­åˆç€ï¼Œä½†æ˜¯çº¿ç¨‹èµ„æºæ²¡äº†ï¼Œé˜Ÿåˆ—æ»¡äº†ï¼Œåˆ™èµ°é™æµæªæ–½ï¼ˆçœ‹å›¾çš„ç¬¬5æ­¥ï¼‰ï¼› å¦‚æœèµ°å®Œäº†ï¼Œæ‰§è¡ŒæˆåŠŸäº†ï¼Œåˆ™èµ°run()æ–¹æ³•ï¼Œè·å–responseï¼Œä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹å¦‚æœå‡ºé”™äº†ï¼Œåˆ™ç»§ç»­èµ°é™çº§fallback. åŒæ—¶ï¼Œçœ‹å›¾æœ€ä¸Šé¢æœ‰ä¸€ä¸ªåç¼€æ˜¯healthçš„ï¼Œè¿™æ˜¯ä¸€ä¸ªè®¡ç®—æ•´ä¸ªé“¾è·¯æ˜¯å¦å¥åº·çš„ç»„ä»¶ï¼Œæ¯ä¸€æ­¥æ“ä½œéƒ½è¢«å®ƒè®°å½•ç€ã€‚ å®¹å™¨ä¸æœåŠ¡ç¼–æ’å¼•æ“ä»ç‰©ç†æœºåˆ°è™šæ‹Ÿæœºï¼Œä»è™šæ‹Ÿæœºåˆ°å®¹å™¨ï¼›ä»ç‰©ç†é›†ç¾¤åˆ°open stackï¼Œopen stackåˆ°kubernetesï¼›ç§‘æŠ€ä¸æ–­çš„å˜åŒ–ï¼Œæˆ‘ä»¬çš„è®¤çŸ¥ä¹Ÿæ²¡åˆ·æ–°ã€‚ æˆ‘ä»¬ä»å®¹å™¨å¼€å§‹è¯´èµ·ï¼Œå®ƒé¦–å…ˆæ˜¯ä¸€ä¸ªç›¸å¯¹ç‹¬ç«‹çš„è¿è¡Œç¯å¢ƒï¼Œåœ¨è¿™ä¸€ç‚¹æœ‰ç‚¹ç±»ä¼¼äºè™šæ‹Ÿæœºï¼Œä½†æ˜¯ä¸åƒè™šæ‹Ÿæœºé‚£æ ·å½»åº•ã€‚ è™šæ‹Ÿæœºä¼šå°†è™šæ‹Ÿç¡¬ä»¶ã€å†…æ ¸ï¼ˆå³æ“ä½œç³»ç»Ÿï¼‰ä»¥åŠç”¨æˆ·ç©ºé—´æ‰“åŒ…åœ¨æ–°è™šæ‹Ÿæœºå½“ä¸­ï¼Œè™šæ‹Ÿæœºèƒ½å¤Ÿåˆ©ç”¨â€œè™šæ‹Ÿæœºç®¡ç†ç¨‹åºâ€è¿è¡Œåœ¨ç‰©ç†è®¾å¤‡ä¹‹ä¸Šã€‚è™šæ‹Ÿæœºä¾èµ–äºhypervisorï¼Œå…¶é€šå¸¸è¢«å®‰è£…åœ¨â€œè£¸é‡‘å±â€ç³»ç»Ÿç¡¬ä»¶ä¹‹ä¸Šï¼Œè¿™å¯¼è‡´hypervisoråœ¨æŸäº›æ–¹é¢è¢«è®¤ä¸ºæ˜¯ä¸€ç§æ“ä½œç³»ç»Ÿã€‚ä¸€æ—¦ hypervisorå®‰è£…å®Œæˆï¼Œ å°±å¯ä»¥ä»ç³»ç»Ÿå¯ç”¨è®¡ç®—èµ„æºå½“ä¸­åˆ†é…è™šæ‹Ÿæœºå®ä¾‹äº†ï¼Œæ¯å°è™šæ‹Ÿæœºéƒ½èƒ½å¤Ÿè·å¾—å”¯ä¸€çš„æ“ä½œç³»ç»Ÿå’Œè´Ÿè½½(åº”ç”¨ç¨‹åº)ã€‚ç®€è¨€ä¹‹ï¼Œè™šæ‹Ÿæœºå…ˆéœ€è¦è™šæ‹Ÿä¸€ä¸ªç‰©ç†ç¯å¢ƒï¼Œç„¶åæ„å»ºä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œå†æ­å»ºä¸€å±‚Runtimeï¼Œç„¶åä¾›åº”ç”¨ç¨‹åºè¿è¡Œã€‚ å¯¹äºå®¹å™¨ç¯å¢ƒæ¥è¯´ï¼Œä¸éœ€è¦å®‰è£…ä¸»æœºæ“ä½œç³»ç»Ÿï¼Œç›´æ¥å°†å®¹å™¨å±‚(æ¯”å¦‚LXCæˆ–libcontainer)å®‰è£…åœ¨ä¸»æœºæ“ä½œç³»ç»Ÿ(é€šå¸¸æ˜¯Linuxå˜ç§)ä¹‹ä¸Šã€‚åœ¨å®‰è£…å®Œå®¹å™¨å±‚ä¹‹åï¼Œå°±å¯ä»¥ä»ç³»ç»Ÿå¯ç”¨è®¡ç®—èµ„æºå½“ä¸­åˆ†é…å®¹å™¨å®ä¾‹äº†ï¼Œå¹¶ä¸”ä¼ä¸šåº”ç”¨å¯ä»¥è¢«éƒ¨ç½²åœ¨å®¹å™¨å½“ä¸­ã€‚ä½†æ˜¯ï¼Œæ¯ä¸ªå®¹å™¨åŒ–åº”ç”¨éƒ½ä¼šå…±äº«ç›¸åŒçš„æ“ä½œç³»ç»Ÿ(å•ä¸ªä¸»æœºæ“ä½œç³»ç»Ÿ)ã€‚å®¹å™¨å¯ä»¥çœ‹æˆä¸€ä¸ªè£…å¥½äº†ä¸€ç»„ç‰¹å®šåº”ç”¨çš„è™šæ‹Ÿæœºï¼Œå®ƒç›´æ¥åˆ©ç”¨äº†å®¿ä¸»æœºçš„å†…æ ¸ï¼ŒæŠ½è±¡å±‚æ¯”è™šæ‹Ÿæœºæ›´å°‘ï¼Œæ›´åŠ è½»é‡åŒ–ï¼Œå¯åŠ¨é€Ÿåº¦æå¿«ã€‚ ç›¸æ¯”äºè™šæ‹Ÿæœºï¼Œå®¹å™¨æ‹¥æœ‰æ›´é«˜çš„èµ„æºä½¿ç”¨æ•ˆç‡ï¼Œå› ä¸ºå®ƒå¹¶ä¸éœ€è¦ä¸ºæ¯ä¸ªåº”ç”¨åˆ†é…å•ç‹¬çš„æ“ä½œç³»ç»Ÿâ€”â€”å®ä¾‹è§„æ¨¡æ›´å°ã€åˆ›å»ºå’Œè¿ç§»é€Ÿåº¦ä¹Ÿæ›´å¿«ã€‚è¿™æ„å‘³ç›¸æ¯”äºè™šæ‹Ÿæœºï¼Œå•ä¸ªæ“ä½œç³»ç»Ÿèƒ½å¤Ÿæ‰¿è½½æ›´å¤šçš„å®¹å™¨ã€‚äº‘æä¾›å•†ååˆ†çƒ­è¡·äºå®¹å™¨æŠ€æœ¯ï¼Œå› ä¸ºåœ¨ç›¸åŒçš„ç¡¬ä»¶è®¾å¤‡å½“ä¸­ï¼Œå¯ä»¥éƒ¨ç½²æ•°é‡æ›´å¤šçš„å®¹å™¨å®ä¾‹ã€‚æ­¤å¤–ï¼Œå®¹å™¨æ˜“äºè¿ç§»ï¼Œä½†æ˜¯åªèƒ½è¢«è¿ç§»åˆ°å…·æœ‰å…¼å®¹æ“ä½œç³»ç»Ÿå†…æ ¸çš„å…¶ä»–æœåŠ¡å™¨å½“ä¸­ï¼Œè¿™æ ·å°±ä¼šç»™è¿ç§»é€‰æ‹©å¸¦æ¥é™åˆ¶ã€‚å› ä¸ºå®¹å™¨ä¸åƒè™šæ‹Ÿæœºé‚£æ ·åŒæ ·å¯¹å†…æ ¸æˆ–è€…è™šæ‹Ÿç¡¬ä»¶è¿›è¡Œæ‰“åŒ…ï¼Œæ‰€ä»¥æ¯å¥—å®¹å™¨éƒ½æ‹¥æœ‰è‡ªå·±çš„éš”ç¦»åŒ–ç”¨æˆ·ç©ºé—´ï¼Œä»è€Œä½¿å¾—å¤šå¥—å®¹å™¨èƒ½å¤Ÿè¿è¡Œåœ¨åŒä¸€ä¸»æœºç³»ç»Ÿä¹‹ä¸Šã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¨éƒ¨æ“ä½œç³»ç»Ÿå±‚çº§çš„æ¶æ„éƒ½å¯å®ç°è·¨å®¹å™¨å…±äº«ï¼ŒæƒŸä¸€éœ€è¦ç‹¬ç«‹æ„å»ºçš„å°±æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ä¸åº“ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œå®¹å™¨æ‰æ‹¥æœ‰æä¸ºå‡ºè‰²çš„è½»é‡åŒ–ç‰¹æ€§ã€‚ æˆ‘ä»¬æœ€å¸¸ç”¨çš„å®¹å™¨æ˜¯daockerï¼Œç½‘å€å¦‚ä¸‹ğŸ‘‰https://www.docker.com/ å®¹å™¨ç¼–æ’è¿‡å»è™šæ‹Ÿæœºå¯ä»¥é€šè¿‡äº‘å¹³å°open stackç®¡ç†è™šæ‹ŸåŒ–ï¼Œå®¹å™¨æ—¶ä»£å¦‚ä½•ç®¡ç†å®¹å™¨å‘¢ï¼Ÿè¿™å°±è¦çœ‹çœ‹å®¹å™¨ç¼–æ’å¼•æ“äº†ã€‚ Apache mesosmesosæ˜¯åŸºäºmasterï¼Œslaveæ¶æ„ï¼Œæ¡†æ¶å†³å®šå¦‚ä½•åˆ©ç”¨èµ„æºï¼Œmasterè´Ÿè´£ç®¡ç†æœºå™¨ï¼Œslaveä¼šå®šæœŸçš„å°†æœºå™¨æƒ…å†µæŠ¥å‘Šç»™masterï¼Œmasterå†å°†ä¿¡æ¯ç»™æ¡†æ¶ã€‚masteræ˜¯é«˜å¯ç”¨çš„ï¼Œå› ä¸ºzkï¼Œä¹Ÿæœ‰leaderçš„å­˜åœ¨ã€‚ä¸‹é¢æ˜¯æ¶æ„å›¾ğŸ‘‡ kuberneteskubernetesæ˜¯æœ€è¿‘ååˆ†ç«çƒ­çš„å¼€æºå®¹å™¨ç¼–æ’å¼•æ“ï¼Œå…·ä½“å¯ä»¥å‚è€ƒkubernetesä¸­æ–‡æ–‡æ¡£ Kubernetesè®¾è®¡ç†å¿µå’ŒåŠŸèƒ½å…¶å®å°±æ˜¯ä¸€ä¸ªç±»ä¼¼Linuxçš„åˆ†å±‚æ¶æ„ï¼Œå…ˆè¯´è¯´æ¯ä¸€ä¸ªKubernetesèŠ‚ç‚¹å†…éƒ¨ï¼Œkubeletç®¡ç†å…¨å±€å…¨å±€podï¼Œè€Œæ¯ä¸€ä¸ªpodæ‰¿è½½ç€ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ï¼Œkube-proxyè´Ÿè´£ç½‘ç»œä»£ç†å’Œè´Ÿè½½å‡è¡¡ ã€‚ KubernetesèŠ‚ç‚¹å¤–éƒ¨ï¼Œåˆ™æ˜¯å¯¹åº”çš„æ§åˆ¶ç®¡ç†æœåŠ¡å™¨ï¼Œè´Ÿè´£ç»Ÿä¸€ç®¡ç†å„ä¸ªèŠ‚ç‚¹è°ƒåº¦åˆ†é…ä¸è¿è¡Œã€‚ æœåŠ¡ç½‘æ ¼åŒ–ã€‚ã€‚ã€‚å¾…æ›´æ–° èµ„æ–™ä¸æ–‡çŒ®é©¬ä¸.ç¦å‹’å¯¹å¾®æœåŠ¡çš„æè¿° å¾®æœåŠ¡æ¶æ„çš„ç†è®ºåŸºç¡€ - åº·å¨å®šå¾‹ è°ƒç”¨é“¾é€‰å‹ä¹‹Zipkinï¼ŒPinpointï¼ŒSkyWalkingï¼ŒCAT ç»“æŸæ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿ è¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼Œéšåçœ‹å¿ƒæƒ…å¯èƒ½ä¼šåœ¨CSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹ï¼Œå’±ä»¬ä¸¤ä¸ªæƒ³ä¸ªå·ç ï¼Œ ä¹°ä¸ªå½©ç¥¨ï¼Œå…ˆæŒ£ä»–ä¸ªå‡ ç™¾ä¸‡ğŸ˜]]></content>
      <tags>
        <tag>æŠ€æœ¯</tag>
        <tag>å­¦å¥½åˆ†å¸ƒå¼æ¶æ„</tag>
        <tag>æ¶æ„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œ]]></title>
    <url>%2F2018%2F12%2F07%2F%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4Java%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C%2F</url>
    <content type="text"><![CDATA[åˆ†æä¸€ä¸‹å¹¿æ³›æµä¼ çš„é˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œï¼Œå½“ä½œåœ¨çº¿æ–‡æ¡£ï¼Œè½¬ä¾µåˆ ã€‚ã€‚]]></content>
      <tags>
        <tag>java</tag>
        <tag>åˆ†äº«</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é˜…è¯»é˜¿é‡Œå¼€å‘æ‰‹å†Œå‘ç°çš„ConcurrentModificationExceptionå¼‚å¸¸]]></title>
    <url>%2F2018%2F12%2F06%2FConcurrentModificationException%E5%BC%82%E5%B8%B8%2F</url>
    <content type="text"><![CDATA[ä»Šå¤©é˜…è¯»é˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œ(ç»ˆæç‰ˆ).pdfï¼Œå¶ç„¶å‘ç°ä¸€æ¡å¼ºåˆ¶è§„èŒƒï¼š ã€å¼ºåˆ¶ã€‘ä¸è¦åœ¨ foreach å¾ªç¯é‡Œè¿›è¡Œå…ƒç´ çš„ remove/add æ“ä½œã€‚remove å…ƒç´ è¯·ä½¿ç”¨ Iteratoræ–¹å¼ï¼Œå¦‚æœå¹¶å‘æ“ä½œï¼Œéœ€è¦å¯¹ Iterator å¯¹è±¡åŠ é”ã€‚ è¿™å¼•å‘äº†æˆ‘çš„æ³¨æ„åŠ›ã€‚ æŒ‰ç…§ä»–è¯´çš„åšäº†ä¸€éï¼Œæœç„¶æœ‰è¿™ä¸ªé—®é¢˜ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¢ç´¢ä¸€ä¸‹ï¼Œåˆ°åº•ä¸ºä»€ä¹ˆä¼šå‡ºè¿™ä¸ªé—®é¢˜å§ï¼ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®https://blog.tengshe789.tech/ å®éªŒä»£ç ä¸‹é¢æ˜¯æ¨èä½¿ç”¨çš„Iteratoræ–¹å¼æ¥remove/addæ“ä½œ 12345678910public static List&lt;String&gt; test1(List&lt;String&gt; list)&#123; Iterator&lt;String&gt; iterator = list.iterator(); while (iterator.hasNext()) &#123; String item = iterator.next(); if (item.equals(NUM2)) &#123; iterator.remove(); &#125; &#125; return list; &#125; ä¸æ¨èä½¿ç”¨çš„æ–¹æ³•ï¼š 12345678public static List&lt;String&gt; test2(List&lt;String&gt; list)&#123; for (String item : list) &#123; if (NUM2.equals(item)) &#123; list.remove(item); &#125; &#125; return list; &#125; æˆ‘çš„mainæ–¹æ³•ï¼š 1234567891011121314public static final String NUM1 = "1"; public static final String NUM2 = "2"; public static void main(String[] args) &#123; List&lt;String&gt; list = new ArrayList&lt;String&gt;(); list.add("1"); list.add("2"); test2(list); list.forEach(item -&gt; &#123; System.out.println("ç»“æœæ˜¯ " + item); &#125;); &#125; å®éªŒç»“æœæœç„¶ï¼Œå°†åˆ¤æ–­æ¡ä»¶è®¾ç½®æˆNUM2æ—¶ï¼Œå°±å‡ºå¼‚å¸¸äº†ï¼Œå¯æ˜¯è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ ä¸€æ¢ç©¶ç«Ÿæˆ‘ä»¬ä»å‡ºé”™æ—¥å¿—ä¸­æŸ¥æ‰¾ç­”æ¡ˆã€‚ 123456789101112@SuppressWarnings("unchecked") public E next() &#123; checkForComodification(); int i = cursor; if (i &gt;= size) throw new NoSuchElementException(); Object[] elementData = ArrayList.this.elementData; if (i &gt;= elementData.length) throw new ConcurrentModificationException(); cursor = i + 1; return (E) elementData[lastRet = i]; &#125; æ¥åˆ°foreachä¸­èµ°çš„next()ï¼Œç¬¬ä¸€æ­¥éœ€è¦èµ°checkForComodification() 1234final void checkForComodification() &#123; if (modCount != expectedModCount) throw new ConcurrentModificationException(); &#125; è¿™è¾¹åˆå‡ºç°ä¸€ä¸ªæˆå‘˜å˜é‡modCountï¼Œæˆ‘ä»¬é¡ºç€æ¥æ‰¾æ‰¾çœ‹ã€‚ 123456789101112131415161718192021222324252627/** * The number of times this list has been &lt;i&gt;structurally modified&lt;/i&gt;. * Structural modifications are those that change the size of the * list, or otherwise perturb it in such a fashion that iterations in * progress may yield incorrect results. * * &lt;p&gt;This field is used by the iterator and list iterator implementation * returned by the &#123;@code iterator&#125; and &#123;@code listIterator&#125; methods. * If the value of this field changes unexpectedly, the iterator (or list * iterator) will throw a &#123;@code ConcurrentModificationException&#125; in * response to the &#123;@code next&#125;, &#123;@code remove&#125;, &#123;@code previous&#125;, * &#123;@code set&#125; or &#123;@code add&#125; operations. This provides * &lt;i&gt;fail-fast&lt;/i&gt; behavior, rather than non-deterministic behavior in * the face of concurrent modification during iteration. * * &lt;p&gt;&lt;b&gt;Use of this field by subclasses is optional.&lt;/b&gt; If a subclass * wishes to provide fail-fast iterators (and list iterators), then it * merely has to increment this field in its &#123;@code add(int, E)&#125; and * &#123;@code remove(int)&#125; methods (and any other methods that it overrides * that result in structural modifications to the list). A single call to * &#123;@code add(int, E)&#125; or &#123;@code remove(int)&#125; must add no more than * one to this field, or the iterators (and list iterators) will throw * bogus &#123;@code ConcurrentModificationExceptions&#125;. If an implementation * does not wish to provide fail-fast iterators, this field may be * ignored. */ protected transient int transient = 0; å“¦ï¼Œç¼˜æ¥ä¹³æ­¤ï¼Œlistæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œå› æ­¤å¦‚æœåœ¨ä½¿ç”¨è¿­ä»£å™¨çš„è¿‡ç¨‹ä¸­æœ‰å…¶ä»–çº¿ç¨‹ä¿®æ”¹äº†listï¼Œé‚£ä¹ˆå°†æŠ›å‡ºConcurrentModificationExceptionï¼Œè¿™å°±æ˜¯æ‰€è°“fail-fastç­–ç•¥(è§jdkæ³¨é‡Š)ã€‚ modCountå®ƒä»£è¡¨è¯¥Listå¯¹è±¡è¢«ä¿®æ”¹çš„æ¬¡æ•°ï¼Œæ¯å¯¹Listå¯¹è±¡ä¿®æ”¹ä¸€æ¬¡ï¼ŒmodCountéƒ½ä¼šåŠ Iteratorç±»é‡Œæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡expectedModCountï¼Œå®ƒçš„å€¼ä¸ºåˆ›å»ºIteratorå¯¹è±¡çš„æ—¶å€™Listçš„modCountå€¼ã€‚ç”¨æ­¤å˜é‡æ¥æ£€éªŒåœ¨è¿­ä»£è¿‡ç¨‹ä¸­Listå¯¹è±¡æ˜¯å¦è¢«ä¿®æ”¹äº†ï¼Œå¦‚æœè¢«ä¿®æ”¹äº†åˆ™æŠ›å‡ºjava.util.ConcurrentModificationExceptionå¼‚å¸¸ã€‚åœ¨æ¯æ¬¡è°ƒç”¨Iteratorå¯¹è±¡çš„next()æ–¹æ³•çš„æ—¶å€™éƒ½ä¼šè°ƒç”¨checkForComodification()æ–¹æ³•è¿›è¡Œä¸€æ¬¡æ£€éªŒï¼ŒcheckForComodification()æ–¹æ³•ä¸­åšçš„å·¥ä½œå°±æ˜¯æ¯”è¾ƒexpectedModCountå’ŒmodCountçš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœä¸ç›¸ç­‰ï¼Œå°±è®¤ä¸ºè¿˜æœ‰å…¶ä»–å¯¹è±¡æ­£åœ¨å¯¹å½“å‰çš„Listè¿›è¡Œæ“ä½œï¼Œé‚£ä¸ªå°±ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ã€‚ ç½‘ä¸ŠæŸ¥æ‰¾çš„å…³äºIteratorçš„å·¥ä½œæœºåˆ¶ã€‚Iteratoræ˜¯å·¥ä½œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ä¸­ï¼Œå¹¶ä¸”æ‹¥æœ‰ä¸€ä¸ª mutexé”ï¼Œå°±æ˜¯è¯´Iteratoråœ¨å·¥ä½œçš„æ—¶å€™ï¼Œæ˜¯ä¸å…è®¸è¢«è¿­ä»£çš„å¯¹è±¡è¢«æ”¹å˜çš„ã€‚è€ŒListç­‰æ˜¯åŠ¨æ€çš„ï¼Œå¯å˜å¯¹è±¡æ•°é‡çš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯Iteratoråˆ™æ˜¯å•å‘ä¸å¯å˜ï¼Œåªèƒ½é¡ºåºè¯»å–ï¼Œä¸èƒ½é€†åºæ“ä½œçš„æ•°æ®ç»“æ„ï¼Œå½“ IteratoræŒ‡å‘çš„åŸå§‹æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒIteratorè‡ªå·±å°±è¿·å¤±äº†æ–¹å‘ã€‚ ç»­1sæ—¶é—´å…¨ç‰‡ç»“æŸï¼Œè§‰å¾—æˆ‘å†™çš„ä¸é”™ï¼Ÿæƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿèµ¶å¿«æ‰“å¼€æˆ‘çš„ğŸ‘‰ä¸ªäººåšå®¢ ğŸ‘ˆå§ï¼ è°¢è°¢ä½ é‚£ä¹ˆå¯çˆ±ï¼Œè¿˜ä¸€ç›´å…³æ³¨ç€æˆ‘~â¤ğŸ˜]]></content>
      <tags>
        <tag>æŠ€æœ¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆ†å¸ƒå¼ç³»ç»Ÿ--æ„Ÿæ€§è®¤è¯†JWT]]></title>
    <url>%2F2018%2F12%2F02%2F%E6%84%9F%E6%80%A7%E8%AE%A4%E8%AF%86JWT%2F</url>
    <content type="text"><![CDATA[å¥½ä¹…æ²¡å†™åšå®¢äº†ï¼Œå› ä¸ºæœ€è¿‘å…¬å¸è¦æ±‚æˆ‘å­¦spring cloudï¼Œæ—©ç‚¹å°†ä»¥å‰è½¯ä»¶è¿ç§»åˆ°æ–°çš„æ¶æ„ä¸Šã€‚æ‰€ä»¥æˆ‘é‚£ä¸ªæ‹¼å‘½çš„å­¦å‘ï¼Œæ€»æ˜¯å›¾å¿«ï¼Œå¾ˆå¤šå…³é”®çš„ç¬”è®°æ²¡æœ‰åšå¥½è®°å½•ï¼Œç°åœ¨åˆé—å¿˜äº†å¾ˆå¤šå…³é”®çš„æŠ€æœ¯ç‚¹ï¼Œæå…¶ç½ªæ¶ï¼ ç°åœ¨æƒ³ä¸€æƒ³ï¼Œè¿˜æ˜¯è¸è¸å®å®çš„èµ°æ¯”è¾ƒå¥½ã€‚è¿™ä¸ï¼Œä»Šå¤©æˆ‘å†’äº†ä¸ªæ³¡ï¼Œæ¥è¡¥ä¸€è¡¥å‰é¢æˆ‘æ‰€å­¦æ‰€å¿˜çš„çŸ¥è¯†ç‚¹ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ã€‚ å¸¸è§çš„è®¤è¯æœºåˆ¶ä»Šå¤©æˆ‘ä¹ˆèŠä¸€èŠJWTã€‚ å…³äºJWTï¼Œç›¸ä¿¡å¾ˆå¤šäººéƒ½å·²ç»çœ‹è¿‡ç”¨è¿‡ï¼Œä»–æ˜¯åŸºäºjsonæ•°æ®ç»“æ„çš„è®¤è¯è§„èŒƒï¼Œç®€å•çš„è¯´å°±æ˜¯éªŒè¯ç”¨æˆ·ç™»æ²¡ç™»é™†çš„ç©æ„ã€‚è¿™æ—¶å€™ä½ å¯èƒ½å›æƒ³ï¼Œå“å“Ÿï¼Œä¸æ˜¯åˆé‚£ä¸ªsessionä¹ˆï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿç”¨redisåšåˆ†å¸ƒå¼sessionï¼Œé‚£è¿™ä¸ªjwtæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ è¯·å¬æˆ‘æ…¢æ…¢è¯‰è¯´è¿™å†å²ï¼ æœ€åŸå§‹çš„åŠæ³•â€“HTTP BASIC AUTHHTTP BASIC authï¼Œåˆ«çœ‹å®ƒåå­—é‚£ä¹ˆé•¿é‚£ä¹ˆç”Ÿï¼Œä½ å°±è®¤ä¸ºè¿™ä¸ªç©æ„å¾ˆé«˜å¤§ä¸Šã€‚å…¶å®åŸç†å¾ˆç®€å•ï¼Œç®€å•çš„è¯´å°±æ˜¯æ¯æ¬¡è¯·æ±‚APIçš„æ—¶å€™ï¼Œéƒ½ä¼šæŠŠç”¨æˆ·åå’Œå¯†ç é€šè¿‡restful APIä¼ ç»™æœåŠ¡ç«¯ã€‚è¿™æ ·å°±å¯ä»¥å®ç°ä¸€ä¸ªæ— çŠ¶æ€æ€æƒ³ï¼Œå³æ¯æ¬¡HTTPè¯·æ±‚å’Œä»¥å‰éƒ½æ²¡æœ‰å•¥å…³ç³»ï¼Œåªæ˜¯è·å–ç›®æ ‡URIï¼Œå¾—åˆ°ç›®æ ‡å†…å®¹ä¹‹åï¼Œè¿™æ¬¡è¿æ¥å°±è¢«æ€æ­»ï¼Œæ²¡æœ‰ä»»ä½•ç—•è¿¹ã€‚ä½ å¯åˆ«ä¸€å¬æ— çŠ¶æ€ï¼Œæ­£æ˜¯ç°åœ¨çš„çƒ­é—¨æ€æƒ³ï¼Œå°±è§‰å¾—å¾ˆå‰å®³ã€‚å…¶å®ä»–çš„ç¼ºç‚¹è¿˜æ˜¯åˆçš„ï¼Œæˆ‘ä»¬é€šè¿‡httpè¯·æ±‚å‘é€ç»™æœåŠ¡ç«¯çš„æ—¶å€™ï¼Œå¾ˆæœ‰å¯èƒ½å°†æˆ‘ä»¬çš„ç”¨æˆ·åå¯†ç ç›´æ¥æš´æ¼ç»™ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ï¼Œé£é™©ç‰¹åˆ«å¤§ï¼Œå› æ­¤ç”Ÿäº§ç¯å¢ƒä¸‹ç”¨è¿™ä¸ªæ–¹æ³•å¾ˆå°‘ã€‚ Sessionå’Œcookiesessionå’Œcookieè€ç”Ÿå¸¸è°ˆäº†ã€‚å¼€å§‹æ—¶ï¼Œéƒ½ä¼šåœ¨æœåŠ¡ç«¯å…¨å±€åˆ›å»ºsessionå¯¹è±¡ï¼Œsessionå¯¹è±¡ä¿å­˜ç€å„ç§å…³é”®ä¿¡æ¯ï¼ŒåŒæ—¶å‘å®¢æˆ·ç«¯å‘é€ä¸€ç»„sessionIdï¼Œæˆä¸ºä¸€ä¸ªcookieå¯¹è±¡ä¿å­˜åœ¨æµè§ˆå™¨ä¸­ã€‚ å½“è®¤è¯æ—¶ï¼Œcookieçš„æ•°æ®ä¼šä¼ å…¥æœåŠ¡ç«¯ä¸sessionè¿›è¡ŒåŒ¹é…ï¼Œè¿›è€Œè¿›è¡Œæ•°æ®è®¤è¯ã€‚ æ­¤æ—¶ï¼Œå®ç°çš„æ˜¯ä¸€ä¸ªæœ‰çŠ¶æ€çš„æ€æƒ³ï¼Œå³è¯¥æœåŠ¡çš„å®ä¾‹å¯ä»¥å°†ä¸€éƒ¨åˆ†æ•°æ®éšæ—¶è¿›è¡Œå¤‡ä»½ï¼Œå¹¶ä¸”åœ¨åˆ›å»ºä¸€ä¸ªæ–°çš„æœ‰çŠ¶æ€æœåŠ¡æ—¶ï¼Œå¯ä»¥é€šè¿‡å¤‡ä»½æ¢å¤è¿™äº›æ•°æ®ï¼Œä»¥è¾¾åˆ°æ•°æ®æŒä¹…åŒ–çš„ç›®çš„ã€‚ ç¼ºç‚¹è¿™ç§è®¤è¯æ–¹æ³•åŸºæœ¬æ˜¯ç°åœ¨è½¯ä»¶æœ€å¸¸ç”¨çš„æ–¹æ³•äº†ï¼Œå®ƒæœ‰ä¸€äº›è‡ªå·±çš„ç¼ºç‚¹ï¼š å®‰å…¨æ€§ã€‚cookiesçš„å®‰å…¨æ€§ä¸å¥½ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è·å–æœ¬åœ°cookiesè¿›è¡Œæ¬ºéª—æˆ–è€…åˆ©ç”¨cookiesè¿›è¡ŒCSRFæ”»å‡»ã€‚ è·¨åŸŸé—®é¢˜ã€‚ä½¿ç”¨cookiesæ—¶ï¼Œåœ¨å¤šä¸ªåŸŸåä¸‹ï¼Œä¼šå­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚ æœ‰çŠ¶æ€ã€‚sessionåœ¨ä¸€å®šçš„æ—¶é—´é‡Œï¼Œéœ€è¦å­˜æ”¾åœ¨æœåŠ¡ç«¯ï¼Œå› æ­¤å½“æ‹¥æœ‰å¤§é‡ç”¨æˆ·æ—¶ï¼Œä¹Ÿä¼šå¤§å¹…åº¦é™ä½æœåŠ¡ç«¯çš„æ€§èƒ½ã€‚ çŠ¶æ€é—®é¢˜ã€‚å½“æœ‰å¤šå°æœºå™¨æ—¶ï¼Œå¦‚ä½•å…±äº«sessionä¹Ÿä¼šæ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·ç¬¬ä¸€ä¸ªè®¿é—®çš„æ—¶å€™æ˜¯æœåŠ¡å™¨Aï¼Œè€Œç¬¬äºŒä¸ªè¯·æ±‚è¢«è½¬å‘ç»™äº†æœåŠ¡å™¨Bï¼Œé‚£æœåŠ¡å™¨Bå¦‚ä½•å¾—çŸ¥å…¶çŠ¶æ€ã€‚ ç§»åŠ¨æ‰‹æœºé—®é¢˜ã€‚ç°åœ¨çš„æ™ºèƒ½æ‰‹æœºï¼ŒåŒ…æ‹¬å®‰å“ï¼ŒåŸç”Ÿä¸æ”¯æŒcookieï¼Œè¦ä½¿ç”¨cookieæŒºéº»çƒ¦ã€‚ Tokenè®¤è¯ï¼ˆä½¿ç”¨jwtè§„èŒƒï¼‰token å³ä½¿æ˜¯åœ¨è®¡ç®—æœºé¢†åŸŸä¸­ä¹Ÿæœ‰ä¸åŒçš„å®šä¹‰ï¼Œè¿™é‡Œæˆ‘ä»¬è¯´çš„tokenï¼Œæ˜¯æŒ‡ è®¿é—®èµ„æºçš„å‡­æ® ã€‚ä½¿ç”¨åŸºäº Token çš„èº«ä»½éªŒè¯æ–¹æ³•ï¼Œåœ¨æœåŠ¡ç«¯ä¸éœ€è¦å­˜å‚¨ç”¨æˆ·çš„ç™»å½•è®°å½•ã€‚å¤§æ¦‚çš„æµç¨‹æ˜¯ è¿™æ ·çš„ï¼š å®¢æˆ·ç«¯ä½¿ç”¨ç”¨æˆ·åè·Ÿå¯†ç è¯·æ±‚ç™»å½• æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚ï¼Œå»éªŒè¯ç”¨æˆ·åä¸å¯†ç  éªŒè¯æˆåŠŸåï¼ŒæœåŠ¡ç«¯ä¼šç­¾å‘ä¸€ä¸ª Tokenï¼Œå†æŠŠè¿™ä¸ª Token å‘é€ç»™å®¢æˆ·ç«¯ å®¢æˆ·ç«¯æ”¶åˆ° Token ä»¥åå¯ä»¥æŠŠå®ƒå­˜å‚¨èµ·æ¥ï¼Œæ¯”å¦‚æ”¾åœ¨ Cookie é‡Œ å®¢æˆ·ç«¯æ¯æ¬¡å‘æœåŠ¡ç«¯è¯·æ±‚èµ„æºçš„æ—¶å€™éœ€è¦å¸¦ç€æœåŠ¡ç«¯ç­¾å‘çš„ Token æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚ï¼Œç„¶åå»éªŒè¯å®¢æˆ·ç«¯è¯·æ±‚é‡Œé¢å¸¦ç€çš„ Tokenï¼Œå¦‚æœéªŒè¯æˆåŠŸï¼Œå°±å‘å®¢æˆ·ç«¯è¿”å›è¯·æ±‚çš„æ•°æ® Tokenæœºåˆ¶ï¼Œæˆ‘è®¤ä¸ºå…¶æœ¬è´¨æ€æƒ³å°±æ˜¯å°†sessionä¸­çš„ä¿¡æ¯ç®€åŒ–å¾ˆå¤šï¼Œå½“ä½œcookieç”¨ï¼Œä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯çš„â€œsessionâ€ã€‚ å¥½å¤„é‚£Tokenæœºåˆ¶ç›¸å¯¹äºCookieæœºåˆ¶åˆæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ æ”¯æŒè·¨åŸŸè®¿é—®: Cookieæ˜¯ä¸å…è®¸å®åŸŸè®¿é—®çš„ï¼Œè¿™ä¸€ç‚¹å¯¹Tokenæœºåˆ¶æ˜¯ä¸å­˜åœ¨çš„ï¼Œå‰æ æ˜¯ä¼ è¾“çš„ç”¨æˆ·è®¤è¯ä¿¡æ¯é€šè¿‡HTTPå¤´ä¼ è¾“. æ— çŠ¶æ€:Tokenæœºåˆ¶æœ¬è´¨æ˜¯æ ¡éªŒ, ä»–å¾—åˆ°çš„ä¼šè¯çŠ¶æ€å®Œå…¨æ¥è‡ªäºå®¢æˆ·ç«¯, Tokenæœºåˆ¶åœ¨æœåŠ¡ç«¯ä¸éœ€è¦å­˜å‚¨sessionä¿¡æ¯ï¼Œå› ä¸º Token è‡ªèº«åŒ…å«äº†æ‰€æœ‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ï¼Œåªéœ€è¦åœ¨å®¢æˆ·ç«¯çš„cookieæˆ–æœ¬åœ°ä»‹è´¨å­˜å‚¨çŠ¶æ€ä¿¡æ¯. æ›´é€‚ç”¨CDN: å¯ä»¥é€šè¿‡å†…å®¹åˆ†å‘ç½‘ç»œè¯·æ±‚ä½ æœåŠ¡ç«¯çš„æ‰€æœ‰èµ„æ–™ï¼ˆå¦‚ï¼šjavascriptï¼Œ HTML,å›¾ç‰‡ç­‰ï¼‰ï¼Œè€Œä½ çš„æœåŠ¡ç«¯åªè¦æä¾›APIå³å¯. å»è€¦: ä¸éœ€è¦ç»‘å®šåˆ°ä¸€ä¸ªç‰¹å®šçš„èº«ä»½éªŒè¯æ–¹æ¡ˆã€‚Tokenå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ç”Ÿæˆï¼Œåªè¦åœ¨ ä½ çš„APIè¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä½ å¯ä»¥è¿›è¡ŒTokenç”Ÿæˆè°ƒç”¨å³å¯. æ›´é€‚ç”¨äºç§»åŠ¨åº”ç”¨: å½“ä½ çš„å®¢æˆ·ç«¯æ˜¯ä¸€ä¸ªåŸç”Ÿå¹³å°ï¼ˆiOS, Androidï¼ŒWindows 8ç­‰ï¼‰ æ—¶ï¼ŒCookieæ˜¯ä¸è¢«æ”¯æŒçš„ï¼ˆä½ éœ€è¦é€šè¿‡Cookieå®¹å™¨è¿›è¡Œå¤„ç†ï¼‰ï¼Œè¿™æ—¶é‡‡ç”¨Tokenè®¤ è¯æœºåˆ¶å°±ä¼šç®€å•å¾—å¤šã€‚ CSRF:å› ä¸ºä¸å†ä¾èµ–äºCookieï¼Œæ‰€ä»¥ä½ å°±ä¸éœ€è¦è€ƒè™‘å¯¹CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰çš„é˜² èŒƒã€‚ æ€§èƒ½: ä¸€æ¬¡ç½‘ç»œå¾€è¿”æ—¶é—´ï¼ˆé€šè¿‡æ•°æ®åº“æŸ¥è¯¢sessionä¿¡æ¯ï¼‰æ€»æ¯”åšä¸€æ¬¡HMACSHA256 è®¡ç®— çš„TokenéªŒè¯å’Œè§£æè¦è´¹æ—¶å¾—å¤š. ä¸éœ€è¦ä¸ºç™»å½•é¡µé¢åšç‰¹æ®Šå¤„ç†: å¦‚æœä½ ä½¿ç”¨Protractor åšåŠŸèƒ½æµ‹è¯•çš„æ—¶å€™ï¼Œä¸å†éœ€è¦ ä¸ºç™»å½•é¡µé¢åšç‰¹æ®Šå¤„ç†. åŸºäºæ ‡å‡†åŒ–:ä½ çš„APIå¯ä»¥é‡‡ç”¨æ ‡å‡†åŒ–çš„ JSON Web Token (JWT). è¿™ä¸ªæ ‡å‡†å·²ç»å­˜åœ¨ å¤šä¸ªåç«¯åº“ï¼ˆ.NET, Ruby, Java,Python, PHPï¼‰å’Œå¤šå®¶å…¬å¸çš„æ”¯æŒï¼ˆå¦‚ï¼š Firebase,Google, Microsoftï¼‰ ç¼ºé™·åœ¨å“ªï¼Ÿè¯´äº†é‚£ä¹ˆå¤štokenè®¤è¯çš„å¥½å¤„ï¼Œä½†ä»–å…¶å®å¹¶æ²¡æœ‰æƒ³è±¡çš„é‚£ä¹ˆç¥ï¼Œtoken ä¹Ÿå¹¶ä¸æ˜¯æ²¡æœ‰é—®é¢˜ã€‚ å å¸¦å®½ æ­£å¸¸æƒ…å†µä¸‹è¦æ¯” session_id æ›´å¤§ï¼Œéœ€è¦æ¶ˆè€—æ›´å¤šæµé‡ï¼ŒæŒ¤å æ›´å¤šå¸¦å®½ï¼Œå‡å¦‚ä½ çš„ç½‘ç«™æ¯æœˆæœ‰ 10 ä¸‡æ¬¡çš„æµè§ˆå™¨ï¼Œå°±æ„å‘³ç€è¦å¤šå¼€é”€å‡ åå…†çš„æµé‡ã€‚å¬èµ·æ¥å¹¶ä¸å¤šï¼Œä½†æ—¥ç§¯æœˆç´¯ä¹Ÿæ˜¯ä¸å°ä¸€ç¬”å¼€é”€ã€‚å®é™…ä¸Šï¼Œè®¸å¤šäººä¼šåœ¨ JWT ä¸­å­˜å‚¨çš„ä¿¡æ¯ä¼šæ›´å¤šã€‚ æ— è®ºå¦‚ä½•ä½ éœ€è¦æ“ä½œæ•°æ®åº“ åœ¨ç½‘ç«™ä¸Šä½¿ç”¨ JWTï¼Œå¯¹äºç”¨æˆ·åŠ è½½çš„å‡ ä¹æ‰€æœ‰é¡µé¢ï¼Œéƒ½éœ€è¦ä»ç¼“å­˜/æ•°æ®åº“ä¸­åŠ è½½ç”¨æˆ·ä¿¡æ¯ï¼Œå¦‚æœå¯¹äºé«˜æµé‡çš„æœåŠ¡ï¼Œä½ ç¡®å®šè¿™ä¸ªæ“ä½œåˆé€‚ä¹ˆï¼Ÿå¦‚æœä½¿ç”¨redisè¿›è¡Œç¼“å­˜ï¼Œé‚£ä¹ˆæ•ˆç‡ä¸Šä¹Ÿå¹¶ä¸èƒ½æ¯” session æ›´é«˜æ•ˆ æ— æ³•åœ¨æœåŠ¡ç«¯æ³¨é”€ï¼Œé‚£ä¹ˆä¹…å¾ˆéš¾è§£å†³åŠ«æŒé—®é¢˜ æ€§èƒ½é—®é¢˜ JWT çš„å–ç‚¹ä¹‹ä¸€å°±æ˜¯åŠ å¯†ç­¾åï¼Œç”±äºè¿™ä¸ªç‰¹æ€§ï¼Œæ¥æ”¶æ–¹å¾—ä»¥éªŒè¯ JWT æ˜¯å¦æœ‰æ•ˆä¸”è¢«ä¿¡ä»»ã€‚ä½†æ˜¯å¤§å¤šæ•° Web èº«ä»½è®¤è¯åº”ç”¨ä¸­ï¼ŒJWT éƒ½ä¼šè¢«å­˜å‚¨åˆ° Cookie ä¸­ï¼Œè¿™å°±æ˜¯è¯´ä½ æœ‰äº†ä¸¤ä¸ªå±‚é¢çš„ç­¾åã€‚å¬ç€ä¼¼ä¹å¾ˆç‰›é€¼ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•ä¼˜åŠ¿ï¼Œä¸ºæ­¤ï¼Œä½ éœ€è¦èŠ±è´¹ä¸¤å€çš„ CPU å¼€é”€æ¥éªŒè¯ç­¾åã€‚å¯¹äºæœ‰ç€ä¸¥æ ¼æ€§èƒ½è¦æ±‚çš„ Web åº”ç”¨ï¼Œè¿™å¹¶ä¸ç†æƒ³ï¼Œå°¤å…¶å¯¹äºå•çº¿ç¨‹ç¯å¢ƒã€‚ JWTç°åœ¨æˆ‘ä»¬æ¥è¯´è¯´ä»Šå¤©çš„ä¸»è§’ï¼ŒJWT JSON Web Tokenï¼ˆJWTï¼‰æ˜¯ä¸€ä¸ªéå¸¸è½»å·§çš„è§„èŒƒã€‚è¿™ä¸ªè§„èŒƒå…è®¸æˆ‘ä»¬ä½¿ç”¨JWTåœ¨ç”¨ æˆ·å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ é€’å®‰å…¨å¯é çš„ä¿¡æ¯ ç»„æˆä¸€ä¸ªJWTå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå¤´éƒ¨ã€è½½è·ä¸ç­¾åã€‚ å¤´éƒ¨(header)å¤´éƒ¨ç”¨äºæè¿°å…³äºè¯¥JWTçš„æœ€åŸºæœ¬çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å…¶ç±»å‹ä»¥åŠç­¾åæ‰€ç”¨çš„ç®—æ³•ç­‰ã€‚è¿™ä¹Ÿå¯ä»¥ è¢«è¡¨ç¤ºæˆä¸€ä¸ªJSONå¯¹è±¡ã€‚ 1234&#123; "typ":"JWT", "alg":"HS256"&#125; è¿™å°±æ˜¯å¤´éƒ¨çš„æ˜æ–‡å†…å®¹ï¼Œç¬¬ä¸€éƒ¨åˆ†è¯´æ˜ä»–æ˜¯ä¸€ä¸ªjwtï¼Œç¬¬äºŒéƒ¨åˆ†åˆ™æŒ‡å‡ºç­¾åç®—æ³•ç”¨çš„æ˜¯HS256ç®—æ³•ã€‚ ç„¶åå°†è¿™ä¸ªå¤´éƒ¨è¿›è¡ŒBASE64ç¼–ç ï¼Œç¼–ç åå½¢æˆå¤´éƒ¨ï¼š 1eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9 è½½è·(payload)è½½è·å°±æ˜¯å­˜æ”¾æœ‰æ•ˆä¿¡æ¯çš„åœ°æ–¹,æœ‰æ•ˆä¿¡æ¯åŒ…å«ä¸‰ä¸ªéƒ¨åˆ†: ï¼ˆ1ï¼‰æ ‡å‡†ä¸­æ³¨å†Œçš„å£°æ˜ï¼ˆå»ºè®®ä½†ä¸å¼ºåˆ¶ä½¿ç”¨ï¼‰ iss: jwtç­¾å‘è€… sub: jwtæ‰€é¢å‘çš„ç”¨æˆ· aud: æ¥æ”¶jwtçš„ä¸€æ–¹ exp: jwtçš„è¿‡æœŸæ—¶é—´ï¼Œè¿™ä¸ªè¿‡æœŸæ—¶é—´å¿…é¡»è¦å¤§äºç­¾å‘æ—¶é—´ nbf: å®šä¹‰åœ¨ä»€ä¹ˆæ—¶é—´ä¹‹å‰ï¼Œè¯¥jwtéƒ½æ˜¯ä¸å¯ç”¨çš„. iat: jwtçš„ç­¾å‘æ—¶é—´ jti: jwtçš„å”¯ä¸€èº«ä»½æ ‡è¯†ï¼Œä¸»è¦ç”¨æ¥ä½œä¸ºä¸€æ¬¡æ€§token,ä»è€Œå›é¿é‡æ”¾æ”»å‡»ã€‚ ï¼ˆ2ï¼‰å…¬å…±çš„å£°æ˜å…¬å…±çš„å£°æ˜å¯ä»¥æ·»åŠ ä»»ä½•çš„ä¿¡æ¯ï¼Œä¸€èˆ¬æ·»åŠ ç”¨æˆ·çš„ç›¸å…³ä¿¡æ¯æˆ–å…¶ä»–ä¸šåŠ¡éœ€è¦çš„å¿…è¦ä¿¡æ¯. ä½†ä¸å»ºè®®æ·»åŠ æ•æ„Ÿä¿¡æ¯ï¼Œå› ä¸ºè¯¥éƒ¨åˆ†åœ¨å®¢æˆ·ç«¯å¯è§£å¯†. ï¼ˆ3ï¼‰ç§æœ‰çš„å£°æ˜ ç§æœ‰å£°æ˜æ˜¯æä¾›è€…å’Œæ¶ˆè´¹è€…æ‰€å…±åŒå®šä¹‰çš„å£°æ˜ï¼Œä¸€èˆ¬ä¸å»ºè®®å­˜æ”¾æ•æ„Ÿä¿¡æ¯ï¼Œå› ä¸ºbase64 æ˜¯å¯¹ç§°è§£å¯†çš„ï¼Œæ„å‘³ç€è¯¥éƒ¨åˆ†ä¿¡æ¯å¯ä»¥å½’ç±»ä¸ºæ˜æ–‡ä¿¡æ¯ã€‚ 12345&#123; "sub":"1234567890", "name":"tengshe789", "admin": true&#125; ä¸Šé¢å°±æ˜¯ä¸€ä¸ªç®€å•çš„è½½è·çš„æ˜æ–‡ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨base64åŠ å¯†ï¼š 1eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9 ç­¾è¯ï¼ˆsignatureï¼‰jwtçš„ç¬¬ä¸‰éƒ¨åˆ†æ˜¯ä¸€ä¸ªç­¾è¯ä¿¡æ¯ï¼Œè¿™ä¸ªç­¾è¯ä¿¡æ¯ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š header (base64åçš„) payload (base64åçš„) secret è¿™ä¸ªéƒ¨åˆ†éœ€è¦base64åŠ å¯†åçš„headerå’Œbase64åŠ å¯†åçš„payloadä½¿ç”¨.è¿æ¥ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œç„¶åé€šè¿‡headerä¸­å£°æ˜çš„åŠ å¯†æ–¹å¼è¿›è¡ŒåŠ ç›secretç»„åˆåŠ å¯†ï¼Œç„¶åå°±æ„æˆäº†jwtçš„ç¬¬ ä¸‰éƒ¨åˆ†ã€‚ 1TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ åˆæˆ1eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6I kpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7Hg Q å®ç°JWTç°åœ¨ä¸€èˆ¬å®ç°jwtï¼Œéƒ½ä½¿ç”¨Apache çš„å¼€æºé¡¹ç›®JJWTï¼ˆä¸€ä¸ªæä¾›ç«¯åˆ°ç«¯çš„JWTåˆ›å»ºå’ŒéªŒè¯çš„Javaåº“ï¼‰ã€‚ ä¾èµ–123456&lt;!-- https://mvnrepository.com/artifact/io.jsonwebtoken/jjwt --&gt;&lt;dependency&gt; &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt; &lt;artifactId&gt;jjwt&lt;/artifactId&gt; &lt;version&gt;0.7.0&lt;/version&gt;&lt;/dependency&gt; åˆ›å»ºtokençš„demo1234567891011public class CreateJWT &#123; public static void main(String[] args) throws Exception&#123; JwtBuilder builder = Jwts.builder().setId("123") .setSubject("jwtæ‰€é¢å‘çš„ç”¨æˆ·") .setIssuedAt(new Date()) .signWith(SignatureAlgorithm.HS256,"tengshe789"); String s = builder.compact(); System.out.println(s); //eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiIxMjMiLCJzdWIiOiJqd3TmiYDpnaLlkJHnmoTnlKjmiLciLCJpYXQiOjE1NDM3NTk0MjJ9.1sIlEynqqZmA4PbKI6GgiP3ljk_aiypcsUxSN6-ATIA &#125;&#125; ç»“æœå¦‚å›¾ï¼š ï¼ˆæ³¨æ„ï¼Œjjwtä¸æ”¯æŒjdk11ï¼Œ0.9.1ä»¥åçš„jjwtå¿…é¡»å®ç°signWith()æ–¹æ³•æ‰èƒ½å®ç°ï¼‰ è§£æTokençš„demo123456789101112public class ParseJWT &#123; public static void main(String[] args) &#123; String token = "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiIxMjMiLCJzdWIiOiJqd3TmiYDpnaLlkJHnmoTnlKjmiLciLCJpYXQiOjE1NDM3NTk0MjJ9.1sIlEynqqZmA4PbKI6GgiP3ljk_aiypcsUxSN6-ATIA"; Claims claims = Jwts.parser().setSigningKey("tengshe789").parseClaimsJws(token).getBody(); System.out.println("id"+claims.getId()); System.out.println("Subject"+claims.getSubject()); System.out.println("IssuedAt"+claims.getIssuedAt()); &#125;&#125; ç»“æœå¦‚å›¾ï¼š ç”Ÿäº§ä¸­çš„JWTåœ¨ä¼ä¸šçº§ç³»ç»Ÿä¸­ï¼Œé€šå¸¸å†…éƒ¨ä¼šæœ‰éå¸¸å¤šçš„å·¥å…·å¹³å°ä¾›å¤§å®¶ä½¿ç”¨ï¼Œæ¯”å¦‚äººåŠ›èµ„æºï¼Œä»£ç ç®¡ç†ï¼Œæ—¥å¿—ç›‘æ§ï¼Œé¢„ç®—ç”³è¯·ç­‰ç­‰ã€‚å¦‚æœæ¯ä¸€ä¸ªå¹³å°éƒ½å®ç°è‡ªå·±çš„ç”¨æˆ·ä½“ç³»çš„è¯æ— ç–‘æ˜¯å·¨å¤§çš„æµªè´¹ï¼Œæ‰€ä»¥å…¬å¸å†…éƒ¨ä¼šæœ‰ä¸€å¥—å…¬ç”¨çš„ç”¨æˆ·ä½“ç³»ï¼Œç”¨æˆ·åªè¦ç™»é™†ä¹‹åï¼Œå°±èƒ½å¤Ÿè®¿é—®æ‰€æœ‰çš„ç³»ç»Ÿã€‚ è¿™å°±æ˜¯ å•ç‚¹ç™»å½•ï¼ˆSSO: Single Sign-Onï¼‰ SSO æ˜¯ä¸€ç±»è§£å†³æ–¹æ¡ˆçš„ç»Ÿç§°ï¼Œè€Œåœ¨å…·ä½“çš„å®æ–½æ–¹é¢ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§ç­–ç•¥å¯ä¾›é€‰æ‹©ï¼š SAML 2.0 OAuth 2.0 æ¬²æ‰¬å…ˆæŠ‘ï¼Œå…ˆè¯´è¯´å‡ ä¸ªé‡è¦çš„çŸ¥è¯†ç‚¹ã€‚ Authentication VS Authorisation Authentication: èº«ä»½é‰´åˆ«ï¼Œé‰´æƒï¼Œä»¥ä¸‹ç®€ç§°è®¤è¯ è®¤è¯ çš„ä½œç”¨åœ¨äºè®¤å¯ä½ æœ‰æƒé™è®¿é—®ç³»ç»Ÿï¼Œç”¨äºé‰´åˆ«è®¿é—®è€…æ˜¯å¦æ˜¯åˆæ³•ç”¨æˆ·ã€‚è´Ÿè´£è®¤è¯çš„æœåŠ¡é€šå¸¸ç§°ä¸º Authorization Server æˆ–è€… Identity Providerï¼Œä»¥ä¸‹ç®€ç§° IdP Authorisation: æˆæƒ æˆæƒ ç”¨äºå†³å®šä½ æœ‰è®¿é—®å“ªäº›èµ„æºçš„æƒé™ã€‚å¤§å¤šæ•°äººä¸ä¼šåŒºåˆ†è¿™ä¸¤è€…çš„åŒºåˆ«ï¼Œå› ä¸ºç«™åœ¨ç”¨æˆ·çš„ç«‹åœºä¸Šã€‚è€Œä½œä¸ºç³»ç»Ÿçš„è®¾è®¡è€…æ¥è¯´ï¼Œè¿™ä¸¤è€…æ˜¯æœ‰å·®åˆ«çš„ï¼Œè¿™æ˜¯ä¸åŒçš„ä¸¤ä¸ªå·¥ä½œèŒè´£ï¼Œæˆ‘ä»¬å¯ä»¥åªéœ€è¦è®¤è¯åŠŸèƒ½ï¼Œè€Œä¸éœ€è¦æˆæƒåŠŸèƒ½ï¼Œç”šè‡³ä¸éœ€è¦è‡ªå·±å®ç°è®¤è¯åŠŸèƒ½ï¼Œè€Œå€ŸåŠ© Google çš„è®¤è¯ç³»ç»Ÿï¼Œå³ç”¨æˆ·å¯ä»¥ç”¨ Google çš„è´¦å·è¿›è¡Œç™»é™†ã€‚è´Ÿè´£æä¾›èµ„æºï¼ˆAPIè°ƒç”¨ï¼‰çš„æœåŠ¡ç§°ä¸º Resource Server æˆ–è€… Service Providerï¼Œä»¥ä¸‹ç®€ç§° SP SMAL 2.0 OAuthï¼ˆJWTï¼‰OAuthï¼ˆå¼€æ”¾æˆæƒï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾çš„æˆæƒæ ‡å‡†ï¼Œå…è®¸ç”¨æˆ·è®©ç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®è¯¥ç”¨æˆ·åœ¨ æŸä¸€webæœåŠ¡ä¸Šå­˜å‚¨çš„ç§å¯†çš„èµ„æºï¼ˆå¦‚ç…§ç‰‡ï¼Œè§†é¢‘ï¼Œè”ç³»äººåˆ—è¡¨ï¼‰ï¼Œè€Œæ— éœ€å°†ç”¨æˆ·åå’Œå¯†ç æä¾›ç»™ç¬¬ä¸‰æ–¹åº”ç”¨ã€‚ æµç¨‹å¯ä»¥å‚è€ƒå¦‚ä¸‹ï¼š ç®€å•çš„æ¥è¯´ï¼Œå°±æ˜¯ä½ è¦è®¿é—®ä¸€ä¸ªåº”ç”¨æœåŠ¡ï¼Œå…ˆæ‰¾å®ƒè¦ä¸€ä¸ªrequest tokenï¼ˆè¯·æ±‚ä»¤ç‰Œï¼‰ï¼Œå†æŠŠè¿™ä¸ªrequest tokenå‘åˆ°ç¬¬ä¸‰æ–¹è®¤è¯æœåŠ¡å™¨ï¼Œæ­¤æ—¶ç¬¬ä¸‰æ–¹è®¤è¯æœåŠ¡å™¨ä¼šç»™ä½ ä¸€ä¸ªaceess tokenï¼ˆé€šè¡Œä»¤ç‰Œï¼‰, æœ‰äº†aceess tokenä½ å°±å¯ä»¥ä½¿ç”¨ä½ çš„åº”ç”¨æœåŠ¡äº†ã€‚ æ³¨æ„å›¾ä¸­ç¬¬4æ­¥å…‘æ¢ access token çš„è¿‡ç¨‹ä¸­ï¼Œå¾ˆå¤šç¬¬ä¸‰æ–¹ç³»ç»Ÿï¼Œå¦‚Google ï¼Œå¹¶ä¸ä¼šä»…ä»…è¿”å› access tokenï¼Œè¿˜ä¼šè¿”å›é¢å¤–çš„ä¿¡æ¯ï¼Œè¿™å…¶ä¸­å’Œä¹‹åæ›´æ–°ç›¸å…³çš„å°±æ˜¯ refresh tokenã€‚ä¸€æ—¦ access tokenè¿‡æœŸï¼Œä½ å°±å¯ä»¥é€šè¿‡ refresh token å†æ¬¡è¯·æ±‚ access tokenã€‚ å½“ç„¶äº†ï¼Œæµç¨‹æ˜¯æ ¹æ®ä½ çš„è¯·æ±‚æ–¹å¼å’Œè®¿é—®çš„èµ„æºç±»å‹è€Œå®šçš„ï¼Œä¸šåŠ¡å¾ˆå¤šä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œæˆ‘è¿™æ˜¯ç®€å•çš„èŠèŠã€‚ ç°åœ¨è¿™ç§æ–¹æ³•æ¯”è¾ƒå¸¸è§ï¼Œå¸¸è§çš„è­¬å¦‚ä½¿ç”¨QQå¿«é€Ÿç™»é™†ï¼Œç”¨çš„åŸºæœ¬çš„éƒ½æ˜¯è¿™ç§æ–¹æ³•ã€‚ å¼€æºé¡¹ç›®æˆ‘ä»¬ç”¨ä¸€ä¸ªå¾ˆç«çš„å¼€æºé¡¹ç›®Cloud-Adminä¸ºæ —å­ï¼Œæ¥åˆ†æä¸€ä¸‹jwtçš„åº”ç”¨ã€‚ Cloud-Adminæ˜¯åŸºäºSpring Cloudå¾®æœåŠ¡åŒ–å¼€å‘å¹³å°ï¼Œå…·æœ‰ç»Ÿä¸€æˆæƒã€è®¤è¯åå°ç®¡ç†ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«å…·å¤‡ç”¨æˆ·ç®¡ç†ã€èµ„æºæƒé™ç®¡ç†ã€ç½‘å…³APIç®¡ç†ç­‰å¤šä¸ªæ¨¡å—ï¼Œæ”¯æŒå¤šä¸šåŠ¡ç³»ç»Ÿå¹¶è¡Œå¼€å‘ã€‚ ç›®å½•ç»“æ„ é‰´æƒä¸­å¿ƒåŠŸèƒ½åœ¨ace-authä¸ace-gateä¸‹ã€‚ æ¨¡å‹ä¸‹é¢æ˜¯å®˜æ–¹æä¾›çš„æ¶æ„æ¨¡å‹ã€‚ å¯ä»¥çœ‹åˆ°ï¼ŒAuthServeråœ¨æ¶æ„çš„ä¸­å¿ƒç¯èŠ‚ï¼Œè¦è®¿é—®æœåŠ¡ï¼Œå¿…é¡»éœ€è¦é‰´æƒä¸­å¿ƒçš„JWTé‰´æƒã€‚ é‰´æƒä¸­å¿ƒæœåŠ¡ç«¯ä»£ç è§£è¯»å®ä½“ç±»å…ˆçœ‹å®ä½“ç±»ï¼Œè¿™é‡Œé‰´æƒä¸­å¿ƒå®šä¹‰äº†ä¸€ç»„å®¢æˆ·ç«¯å®ä½“ï¼Œå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849@Table(name = "auth_client")@Getter@Setterpublic class Client &#123; @Id private Integer id; private String code; private String secret; private String name; private String locked = "0"; private String description; @Column(name = "crt_time") private Date crtTime; @Column(name = "crt_user") private String crtUser; @Column(name = "crt_name") private String crtName; @Column(name = "crt_host") private String crtHost; @Column(name = "upd_time") private Date updTime; @Column(name = "upd_user") private String updUser; @Column(name = "upd_name") private String updName; @Column(name = "upd_host") private String updHost; private String attr1; private String attr2; private String attr3; private String attr4; private String attr5; private String attr6; private String attr7; private String attr8; å¯¹åº”æ•°æ®åº“ï¼š 12345678910111213141516171819202122232425CREATE TABLE `auth_client` ( `id` int(11) NOT NULL AUTO_INCREMENT, `code` varchar(255) DEFAULT NULL COMMENT 'æœåŠ¡ç¼–ç ', `secret` varchar(255) DEFAULT NULL COMMENT 'æœåŠ¡å¯†é’¥', `name` varchar(255) DEFAULT NULL COMMENT 'æœåŠ¡å', `locked` char(1) DEFAULT NULL COMMENT 'æ˜¯å¦é”å®š', `description` varchar(255) DEFAULT NULL COMMENT 'æè¿°', `crt_time` datetime DEFAULT NULL COMMENT 'åˆ›å»ºæ—¶é—´', `crt_user` varchar(255) DEFAULT NULL COMMENT 'åˆ›å»ºäºº', `crt_name` varchar(255) DEFAULT NULL COMMENT 'åˆ›å»ºäººå§“å', `crt_host` varchar(255) DEFAULT NULL COMMENT 'åˆ›å»ºä¸»æœº', `upd_time` datetime DEFAULT NULL COMMENT 'æ›´æ–°æ—¶é—´', `upd_user` varchar(255) DEFAULT NULL COMMENT 'æ›´æ–°äºº', `upd_name` varchar(255) DEFAULT NULL COMMENT 'æ›´æ–°å§“å', `upd_host` varchar(255) DEFAULT NULL COMMENT 'æ›´æ–°ä¸»æœº', `attr1` varchar(255) DEFAULT NULL, `attr2` varchar(255) DEFAULT NULL, `attr3` varchar(255) DEFAULT NULL, `attr4` varchar(255) DEFAULT NULL, `attr5` varchar(255) DEFAULT NULL, `attr6` varchar(255) DEFAULT NULL, `attr7` varchar(255) DEFAULT NULL, `attr8` varchar(255) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB AUTO_INCREMENT=14 DEFAULT CHARSET=utf8mb4; è¿™äº›æ˜¯æ¯ç»„å¾®æœåŠ¡å®¢æˆ·ç«¯çš„ä¿¡æ¯ ç¬¬äºŒä¸ªå®ä½“ç±»ï¼Œå°±æ˜¯å®¢æˆ·ç«¯_æœåŠ¡çš„å®ä½“ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”ç€é‚£äº›å¾®æœåŠ¡å®¢æˆ·ç«¯èƒ½è°ƒç”¨å“ªäº›å¾®æœåŠ¡å®¢æˆ·ç«¯ï¼š å¤§æ¦‚å¯¹åº”çš„å°±æ˜¯å¾®æœåŠ¡é—´è°ƒç”¨æƒé™å…³ç³»ã€‚ 123456789101112131415161718192021222324@Table(name = "auth_client_service")public class ClientService &#123; @Id private Integer id; @Column(name = "service_id") private String serviceId; @Column(name = "client_id") private String clientId; private String description; @Column(name = "crt_time") private Date crtTime; @Column(name = "crt_user") private String crtUser; @Column(name = "crt_name") private String crtName; @Column(name = "crt_host") private String crtHost;&#125; æ¥å£å±‚æˆ‘ä»¬è·³ç€çœ‹ï¼Œå…ˆçœ‹æ¥å£å±‚ 1234567891011121314151617181920212223242526272829303132@RestController@RequestMapping("jwt")@Slf4jpublic class AuthController &#123; @Value("$&#123;jwt.token-header&#125;") private String tokenHeader; @Autowired private AuthService authService; @RequestMapping(value = "token", method = RequestMethod.POST) public ObjectRestResponse&lt;String&gt; createAuthenticationToken( @RequestBody JwtAuthenticationRequest authenticationRequest) throws Exception &#123; log.info(authenticationRequest.getUsername()+" require logging..."); final String token = authService.login(authenticationRequest); return new ObjectRestResponse&lt;&gt;().data(token); &#125; @RequestMapping(value = "refresh", method = RequestMethod.GET) public ObjectRestResponse&lt;String&gt; refreshAndGetAuthenticationToken( HttpServletRequest request) throws Exception &#123; String token = request.getHeader(tokenHeader); String refreshedToken = authService.refresh(token); return new ObjectRestResponse&lt;&gt;().data(refreshedToken); &#125; @RequestMapping(value = "verify", method = RequestMethod.GET) public ObjectRestResponse&lt;?&gt; verify(String token) throws Exception &#123; authService.validate(token); return new ObjectRestResponse&lt;&gt;(); &#125;&#125; è¿™é‡Œæ”¾å‡ºäº†ä¸‰ä¸ªæ¥å£ å…ˆè¯´ç¬¬ä¸€ä¸ªæ¥å£ï¼Œåˆ›å»ºtokenã€‚ å…·ä½“é€»è¾‘å¦‚ä¸‹ï¼šæ¯ä¸€ä¸ªç”¨æˆ·ç™»é™†è¿›æ¥æ—¶ï¼Œéƒ½ä¼šè¿›å…¥è¿™ä¸ªç¯èŠ‚ã€‚æ ¹æ®requestä¸­ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œåˆ©ç”¨feignå®¢æˆ·ç«¯çš„æ‹¦æˆªå™¨æ‹¦æˆªrequestï¼Œç„¶åä½¿ç”¨ä½œè€…å†™çš„JwtTokenUtilé‡Œé¢çš„å„ç§æ–¹æ³•å–å‡ºtokenä¸­çš„keyå’Œå¯†é’¥ï¼ŒéªŒè¯tokenæ˜¯å¦æ­£ç¡®ï¼Œæ­£ç¡®åˆ™ç”¨authService.login(authenticationRequest);çš„æ–¹æ³•è¿”å›å‡ºå»ä¸€ä¸ªæ–°çš„tokenã€‚ 1234567public String login(JwtAuthenticationRequest authenticationRequest) throws Exception &#123; UserInfo info = userService.validate(authenticationRequest); if (!StringUtils.isEmpty(info.getId())) &#123; return jwtTokenUtil.generateToken(new JWTInfo(info.getUsername(), info.getId() + "", info.getName())); &#125; throw new UserInvalidException("ç”¨æˆ·ä¸å­˜åœ¨æˆ–è´¦æˆ·å¯†ç é”™è¯¯!"); &#125; ä¸‹å›¾æ˜¯è¯¦ç»†é€»è¾‘å›¾ï¼š é‰´æƒä¸­å¿ƒå®¢æˆ·ç«¯ä»£ç å…¥å£ä½œè€…å†™äº†ä¸ªæ³¨è§£çš„å…¥å£ï¼Œä½¿ç”¨@EnableAceAuthClientå³è‡ªåŠ¨å¼€å¯å¾®æœåŠ¡(å®¢æˆ·ç«¯)çš„é‰´æƒç®¡ç† 1234567@Target(ElementType.TYPE)@Retention(RetentionPolicy.RUNTIME)@Import(AutoConfiguration.class)@Documented@Inheritedpublic @interface EnableAceAuthClient &#123;&#125; é…ç½®æ¥ç€æ²¿ç€æ³¨è§£çš„å…¥å£çœ‹ 123456789101112@Configuration@ComponentScan(&#123;"com.github.wxiaoqi.security.auth.client","com.github.wxiaoqi.security.auth.common.event"&#125;)public class AutoConfiguration &#123; @Bean ServiceAuthConfig getServiceAuthConfig()&#123; return new ServiceAuthConfig(); &#125; @Bean UserAuthConfig getUserAuthConfig()&#123; return new UserAuthConfig(); &#125;&#125; æ³¨è§£ä¼šè‡ªåŠ¨çš„å°†å®¢æˆ·ç«¯çš„ç”¨æˆ·tokenå’ŒæœåŠ¡tokençš„å…³é”®ä¿¡æ¯åŠ è½½åˆ°beanä¸­ feiginæ‹¦æˆªå™¨ä½œè€…é‡å†™äº†okhttp3æ‹¦æˆªå™¨çš„æ–¹æ³•ï¼Œæ¯ä¸€æ¬¡å¾®æœåŠ¡å®¢æˆ·ç«¯è¯·æ±‚çš„tokenéƒ½ä¼šè¢«æ‹¦æˆªä¸‹æ¥ï¼ŒéªŒè¯æœåŠ¡è°ƒç”¨æœåŠ¡çš„tokenå’Œç”¨æˆ·è°ƒç”¨æœåŠ¡çš„tokenæ˜¯å¦è¿‡æœŸï¼Œè¿‡æœŸåˆ™è¿”å›æ–°çš„token 123456789101112131415161718192021222324252627282930@Override public Response intercept(Chain chain) throws IOException &#123; Request newRequest = null; if (chain.request().url().toString().contains("client/token")) &#123; newRequest = chain.request() .newBuilder() .header(userAuthConfig.getTokenHeader(), BaseContextHandler.getToken()) .build(); &#125; else &#123; newRequest = chain.request() .newBuilder() .header(userAuthConfig.getTokenHeader(), BaseContextHandler.getToken()) .header(serviceAuthConfig.getTokenHeader(), serviceAuthUtil.getClientToken()) .build(); &#125; Response response = chain.proceed(newRequest); if (HttpStatus.FORBIDDEN.value() == response.code()) &#123; if (response.body().string().contains(String.valueOf(CommonConstants.EX_CLIENT_INVALID_CODE))) &#123; log.info("Client Token Expire,Retry to request..."); serviceAuthUtil.refreshClientToken(); newRequest = chain.request() .newBuilder() .header(userAuthConfig.getTokenHeader(), BaseContextHandler.getToken()) .header(serviceAuthConfig.getTokenHeader(), serviceAuthUtil.getClientToken()) .build(); response = chain.proceed(newRequest); &#125; &#125; return response; &#125; springå®¹å™¨çš„æ‹¦æˆªå™¨ç¬¬äºŒé“æ‹¦æˆªå™¨æ˜¯æ¥è‡ªspringå®¹å™¨çš„ï¼Œç¬¬ä¸€é“feignæ‹¦æˆªå™¨åªæ˜¯éªŒè¯äº†ä¸¤ä¸ªtokenæ˜¯å¦è¿‡æœŸï¼Œä½†tokençœŸå®çš„æƒé™å´æ²¡éªŒè¯ã€‚æ¥ä¸‹æ¥å°±è¦éªŒè¯ä¸¤ä¸ªtokençš„æƒé™é—®é¢˜äº†ã€‚ æœåŠ¡è°ƒç”¨æƒé™ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122@Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; HandlerMethod handlerMethod = (HandlerMethod) handler; // é…ç½®è¯¥æ³¨è§£ï¼Œè¯´æ˜ä¸è¿›è¡ŒæœåŠ¡æ‹¦æˆª IgnoreClientToken annotation = handlerMethod.getBeanType().getAnnotation(IgnoreClientToken.class); if (annotation == null) &#123; annotation = handlerMethod.getMethodAnnotation(IgnoreClientToken.class); &#125; if(annotation!=null) &#123; return super.preHandle(request, response, handler); &#125; String token = request.getHeader(serviceAuthConfig.getTokenHeader()); IJWTInfo infoFromToken = serviceAuthUtil.getInfoFromToken(token); String uniqueName = infoFromToken.getUniqueName(); for(String client:serviceAuthUtil.getAllowedClient())&#123; if(client.equals(uniqueName))&#123; return super.preHandle(request, response, handler); &#125; &#125; throw new ClientForbiddenException("Client is Forbidden!"); &#125; ç”¨æˆ·æƒé™ï¼š 123456789101112131415161718192021222324252627282930313233@Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; HandlerMethod handlerMethod = (HandlerMethod) handler; // é…ç½®è¯¥æ³¨è§£ï¼Œè¯´æ˜ä¸è¿›è¡Œç”¨æˆ·æ‹¦æˆª IgnoreUserToken annotation = handlerMethod.getBeanType().getAnnotation(IgnoreUserToken.class); if (annotation == null) &#123; annotation = handlerMethod.getMethodAnnotation(IgnoreUserToken.class); &#125; if (annotation != null) &#123; return super.preHandle(request, response, handler); &#125; String token = request.getHeader(userAuthConfig.getTokenHeader()); if (StringUtils.isEmpty(token)) &#123; if (request.getCookies() != null) &#123; for (Cookie cookie : request.getCookies()) &#123; if (cookie.getName().equals(userAuthConfig.getTokenHeader())) &#123; token = cookie.getValue(); &#125; &#125; &#125; &#125; IJWTInfo infoFromToken = userAuthUtil.getInfoFromToken(token); BaseContextHandler.setUsername(infoFromToken.getUniqueName()); BaseContextHandler.setName(infoFromToken.getName()); BaseContextHandler.setUserID(infoFromToken.getId()); return super.preHandle(request, response, handler); &#125; @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception &#123; BaseContextHandler.remove(); super.afterCompletion(request, response, handler, ex); &#125; spring cloud gatewayç½‘å…³ä»£ç è¯¥æ¡†æ¶ä¸­æ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šèµ°ç½‘å…³æœåŠ¡ï¼ˆace-gatev2ï¼‰ï¼Œé€šè¿‡ç½‘å…³ï¼Œæ¥éªŒè¯tokenæ˜¯å¦è¿‡æœŸå¼‚å¸¸ï¼ŒéªŒè¯tokenæ˜¯å¦ä¸å­˜åœ¨ï¼ŒéªŒè¯tokenæ˜¯å¦æœ‰æƒé™è¿›è¡ŒæœåŠ¡ã€‚ ä¸‹é¢æ˜¯æ ¸å¿ƒä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546@Override public Mono&lt;Void&gt; filter(ServerWebExchange serverWebExchange, GatewayFilterChain gatewayFilterChain) &#123; log.info("check token and user permission...."); LinkedHashSet requiredAttribute = serverWebExchange.getRequiredAttribute(ServerWebExchangeUtils.GATEWAY_ORIGINAL_REQUEST_URL_ATTR); ServerHttpRequest request = serverWebExchange.getRequest(); String requestUri = request.getPath().pathWithinApplication().value(); if (requiredAttribute != null) &#123; Iterator&lt;URI&gt; iterator = requiredAttribute.iterator(); while (iterator.hasNext())&#123; URI next = iterator.next(); if(next.getPath().startsWith(GATE_WAY_PREFIX))&#123; requestUri = next.getPath().substring(GATE_WAY_PREFIX.length()); &#125; &#125; &#125; final String method = request.getMethod().toString(); BaseContextHandler.setToken(null); ServerHttpRequest.Builder mutate = request.mutate(); // ä¸è¿›è¡Œæ‹¦æˆªçš„åœ°å€ if (isStartWith(requestUri)) &#123; ServerHttpRequest build = mutate.build(); return gatewayFilterChain.filter(serverWebExchange.mutate().request(build).build()); &#125; IJWTInfo user = null; try &#123; user = getJWTUser(request, mutate); &#125; catch (Exception e) &#123; log.error("ç”¨æˆ·Tokenè¿‡æœŸå¼‚å¸¸", e); return getVoidMono(serverWebExchange, new TokenForbiddenResponse("User Token Forbidden or Expired!")); &#125; List&lt;PermissionInfo&gt; permissionIfs = userService.getAllPermissionInfo(); // åˆ¤æ–­èµ„æºæ˜¯å¦å¯ç”¨æƒé™çº¦æŸ Stream&lt;PermissionInfo&gt; stream = getPermissionIfs(requestUri, method, permissionIfs); List&lt;PermissionInfo&gt; result = stream.collect(Collectors.toList()); PermissionInfo[] permissions = result.toArray(new PermissionInfo[]&#123;&#125;); if (permissions.length &gt; 0) &#123; if (checkUserPermission(permissions, serverWebExchange, user)) &#123; return getVoidMono(serverWebExchange, new TokenForbiddenResponse("User Forbidden!Does not has Permission!")); &#125; &#125; // ç”³è¯·å®¢æˆ·ç«¯å¯†é’¥å¤´ mutate.header(serviceAuthConfig.getTokenHeader(), serviceAuthUtil.getClientToken()); ServerHttpRequest build = mutate.build(); return gatewayFilterChain.filter(serverWebExchange.mutate().request(build).build()); &#125; cloud adminæ€»ç»“æ€»çš„æ¥è¯´ï¼Œé‰´æƒå’Œç½‘å…³æ¨¡å—å°±è¯´å®Œäº†ã€‚ä½œè€…ä»£ç æ„æ€æå…¶ç²¾å¦™ï¼Œä½¿ç”¨åœ¨å¤§å‹çš„æƒé™ç³»ç»Ÿä¸­ï¼Œå¯ä»¥å·§å¦™çš„å‡å°‘è€¦åˆæ€§ï¼Œè®©æœåŠ¡é‰´æƒç²’åº¦ç»†åŒ–ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚ ç»“æŸæ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼Œéšåçœ‹å¿ƒæƒ…å¯èƒ½ä¼šåœ¨CSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹ï¼Œå’±ä»¬ä¸¤ä¸ªæƒ³ä¸ªå·ç ï¼Œ ä¹°ä¸ªå½©ç¥¨ï¼Œå…ˆæŒ£ä»–ä¸ªå‡ ç™¾ä¸‡ğŸ˜]]></content>
      <tags>
        <tag>æºç </tag>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>å­¦å¥½åˆ†å¸ƒå¼æ¶æ„</tag>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…‰é²œä¸‹çš„china]]></title>
    <url>%2F2018%2F11%2F03%2F%E5%88%86%E4%BA%AB%E5%BE%AE%E5%8D%9A%2F</url>
    <content type="text"><![CDATA[çœ‹åˆ°ä¸€ç¯‡å¾®åšæ–‡ç« ï¼Œåˆ†äº«ä¸€ä¸‹ã€‚ ä¸ºä»€ä¹ˆåˆ†äº«è¿™ç¯‡æ–‡ç« å‘¢ï¼Ÿ å…¶å®ç°åœ¨ï¼Œæˆ‘å¯¹ç°åœ¨çš„ç¯å¢ƒè¿˜æ˜¯æŠ±æœ‰ä¸€ç‚¹æ‚²è§‚æ€åº¦çš„ã€‚ä»Šå¤©å’Œåå¹´å‰çš„ä»Šå¤©ä¸ä¸€æ ·ï¼Œåå¹´å‰ï¼Œæˆ‘å°å­¦6å¹´çº§ï¼ŒåŒ—äº¬å¥¥è¿ä¼šï¼Œçº¢æ­Œæ´‹æº¢ï¼Œæ¬¢å£°ç¬‘è¯­ï¼Œé‚£æ—¶å€™ï¼Œè°·æ­Œæ²¡æœ‰é€€å‡ºä¸­å›½ï¼ŒFacebookè¿˜èƒ½ç»§ç»­ç™»é™†ï¼ŒGFWæ ¹æœ¬ä¸å­˜åœ¨ã€‚é‚£æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å‘è¾¾ï¼Œä½†æ˜¯æˆ‘ä»¬æ¯å®¶å®‰å±…ä¹ä¸šã€‚ éšåæ±¶å·å¤§åœ°éœ‡ï¼Œæ²¡ä¸ªä¸­å›½äººä¼—å¿—æˆåŸï¼Œæˆ‘ä»¬æ²¡é’±ï¼Œä½†æ˜¯æˆ‘ä»¬æœ‰ç‰©èµ„ã€‚æ¯ä¸ªäººéƒ½ä¼šè‡ªåŠ¨çŒ®å‡ºè‡ªå·±çš„ä¸€ç‰‡å¿ƒæ„ã€‚å¤§è¡—ä¸Šå¤§å®¶ä¼™è‡ªå‘å‘ä¸Šçš„è¸Šè·ƒæŠ¥åå¿—æ„¿è€…ï¼Œå…¨ä¸­å›½äººæ°‘ä¼—å¿—æˆåŸã€‚é‚£æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å‘è¾¾ï¼Œä½†æ˜¯æˆ‘ä»¬è‡ªç”±å›¢ç»“ã€‚ å†åæ¥ï¼Œé‡‘èå±æœºï¼Œä¸¾ä¸–è§æ¡ï¼Œæˆ‘ä»¬æ‹¥æœ‰ä¼˜è‰¯çš„ç¤¾ä¼šåˆ¶åº¦ï¼Œæˆ‘ä»¬ä¹Ÿé­å—ç€ä¸€ç³»åˆ—çš„æŸå¤±ï¼Œä½†æ˜¯è¿œä¸å¦‚å…¶ä»–å›½å®¶é‚£ä¹ˆå¼ºçƒˆã€‚åœ¨è¿™æœŸé—´ï¼Œæˆ‘ä»¬ä¸å…‰è‡ªæˆ‘æ”¹é©ï¼Œè€Œä¸”è¿˜æ´åŠ©æ•´ä¸ªä¸–ç•Œã€‚é‚£æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å‘è¾¾ï¼Œä½†æ˜¯æˆ‘ä»¬åˆ¶åº¦å…ˆè¿›ã€‚ ç°åœ¨å‘¢ï¼Ÿ æˆ‘é•¿å¤§äº†ï¼Œæˆå¹´äº†ã€‚21å²ï¼Œä¸€ä¸ªå€¼å¾—å¨“å¨“é“æ¥çš„å¹´é¾„ï¼Œä¸€ä¸ªéœ€è¦æ‹…èµ·è´£ä»»çš„å¹´é¾„ï¼Œä¸€ä¸ªåˆå…¥ç¤¾ä¼šçš„å¹´é¾„ã€‚ä¸€ä¸ªç”·äººï¼Œåˆæ˜¯ä¸€ä¸ªå®¶æ—çš„ç‹¬ç”Ÿå­ï¼Œéœ€è¦å…»è€ï¼Œéœ€è¦æ‰¾åª³å¦‡ï¼Œéœ€è¦å®ç°è‡ªæˆ‘è´£ä»»ä¸ä¹‰åŠ¡çš„å¹´é¾„ã€‚ å¯æ˜¯åœ¨ç°åœ¨çš„ç¯å¢ƒä¸‹ï¼Œæˆ¿ä»·æ¶¨äº†ï¼Œæˆ¿ä»·ï¼ˆé’å²›ï¼‰ä»åå¹´å‰çš„4000ç¿»åˆ°ç°åœ¨çš„30000ï¼›å°±ä¸šå°‘äº†ï¼Œå°±ä¸šç”Ÿ/å½“å±Šåº”å±Šç”Ÿ çš„æ¯”ä¾‹ä¸€å¹´æ¯”ä¸€å¹´å°‘ï¼›ç¨æ”¶é«˜äº†ï¼Œé«˜æ–°äº§ä¸šç¨åŠ¡ä¸¥é‡ï¼Œæ¶ˆè´¹äº§å“ä¸€èˆ¬äººæ¶ˆè´¹ä¸èµ·æ¥ï¼›GFWæ¥äº†ï¼Œä¸–ç•Œä¹Ÿå˜å°äº†ï¼Œç”šè‡³æˆ‘ä»¬ç”Ÿè€Œä¸ºäºº-è¯´è¯çš„æƒåŠ›ï¼Œéƒ½è¢«å‰Šå¼±äº†ã€‚ å¥½å¤±æœ›ã€‚ ä¸å…‰æ˜¯æˆ‘ï¼Œè‚¯å®šä¹Ÿæœ‰å¾ˆå¤šå’Œæˆ‘ä¸€ä¸ªå¹´é¾„çš„äººï¼Œæ‰¿å—ç€å’Œæˆ‘ä¸€æ ·çš„å›°æ‰°ã€‚æ†‹åœ¨å¿ƒé‡Œå¥½éš¾å—å•Šï¼Œæƒ³è¯´ï¼æƒ³è¯´ï¼æƒ³æŠŠå®ƒåƒç—˜ç—˜ä¸€æ ·æŒ¤å‡ºæ¥ï¼Œä¸è¦è®©ä»–å˜å¤§ï¼Œä¸è¦è®©ä»–å˜é»„ã€‚ å¯æ˜¯ï¼Œå·²ç»å¾ˆå°‘æœ‰äººè¯´è¯äº†ã€‚å…³äºæ”¿æ²»ï¼Œå…³äºä¸­å›½å·¦å€¾ï¼Œå¾ˆå°‘æœ‰äººå‡ºæ¥è¯´è¯äº†ã€‚è¯´äº†ï¼Œå°±æ˜¯ä¸æ‡‚äº‹ï¼›è¯´äº†ï¼Œå°±æ˜¯ä¸å°Šè€ï¼›è¯´äº†ï¼Œå°±æ˜¯ä¸çˆ±å›½ã€‚ è§£å†³é—®é¢˜çš„æœ€å¥½æ–¹æ³•å°±æ˜¯è§£å†³è¯´å‡ºé—®é¢˜çš„äººã€‚ æˆ‘ä¸æ•¢è¯´ï¼Œæˆ‘æœ‰çˆ¶æ¯ï¼Œæˆ‘æœ‰çˆ±äººï¼Œè¯´è¯çš„ä»£ä»·å¤ªå¤§äº†ï¼Œæˆ‘æ‰¿å—ä¸èµ·ã€‚ çˆ¶æ¯è®©æˆ‘åšå…¬åŠ¡å‘˜ï¼Œæˆ‘è§‰å¾—å¾ˆä¸é”™ï¼Œå› ä¸ºæˆ‘è§‰å¾—æ€»æœ‰å’Œæˆ‘ä¸€æ ·çš„äººï¼Œçƒ­çˆ±è¿™ç‰‡åœŸåœ°ï¼Œè¿™çˆ±è¿™ä¸ªå›½å®¶ï¼Œå´åˆçœ‹è§è¿™ä¸–ç•ŒçŸ›ç›¾ä¸å…¬å¹³çš„ç°è±¡ã€‚ ä½†æˆ‘æ”¾å¼ƒäº†ã€‚ç†ç”±ï¼Œå°±æ˜¯é‚£æ ·ã€‚ æˆ‘å¾ˆç¬¨ï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©å­¦è®¡ç®—æœºï¼Œå®‰å®‰å¿ƒå¿ƒçš„åšä¸€ä¸ªæŠ€æœ¯äººå‘˜ï¼Œå®‰å®‰å¿ƒå¿ƒçš„è·Ÿç€äººæ°‘ç¾¤ä¼—èµ°ï¼Œåšå†³æ‹¥æŠ¤å…šçš„æ­£ç¡®é¢†å¯¼ã€‚åšä¸€ä¸ªä¹Œé¾Ÿï¼Œåšä¸€ä¸ªä¹¦å‘†å­ï¼Œæ…¢æ…¢ç§¯å¾·ï¼Œæ²¡å‡†ï¼Œä¸‹è¾ˆå­æˆ‘å°±ä¼šå¯Œè£•äº†å‘¢ï¼ å½“æˆ‘æ²‰é»˜çš„æ—¶å€™ï¼Œæˆ‘è§‰å¾—å¾ˆå……å®ï¼Œå½“æˆ‘å¼€å£è¯´è¯ï¼Œå°±æ„Ÿåˆ°äº†ç©ºè™šã€‚ â€“é²è¿…]]></content>
      <tags>
        <tag>æ—¥å¸¸</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç§‹æ‹›å¤±è´¥äº†ï¼Œè¿˜æ˜¯è¦ç»§ç»­]]></title>
    <url>%2F2018%2F11%2F03%2F%E5%8A%A0%E6%B2%B92%2F</url>
    <content type="text"><![CDATA[åœ¨æµå—æœ¬åœ°æŠ•äº†å‡ ä»½ç®€å†ï¼Œæ”¶åˆ°äº†äº”å…­ä»½offerï¼Œæ„Ÿè§‰é™¤äº†ä¸€å®¶å°å…¬å¸ä»¥å¤–ä»¥å¤–ï¼Œéƒ½ä¸æ˜¯å¾ˆæ»¡æ„ã€‚å®˜åƒšä½œé£ï¼ŒæŠ€æœ¯å°é—­ï¼Œå¹²æ´»ç´¯ï¼Œä¸å°Šé‡åº”è˜è€…ï¼Œä»€ä¹ˆéƒ½æœ‰ã€‚ äººç”Ÿå¥½è¿·èŒ«ï¼Œåšäººå¥½ç´¯å•Šã€‚ ä»Šå¤©å¥³æœ‹å‹é€¼æˆ‘ï¼Œé—®æˆ‘æ„å‘åŸå¸‚ï¼Œå¥¹æ€§å­æ€¥ï¼Œå¥¹æƒ³æ ¹æ®æˆ‘é€‰çš„å·¥ä½œåœ°ç‚¹æ‰¾å·¥ä½œã€‚å¯æ˜¯æˆ‘å¤ªå¼±å°äº†ï¼Œæˆ‘æ‰¾ä¸åˆ°å·¥ä½œï¼Œå¥½çƒ¦ã€‚å¥½æƒ†æ€…ã€‚å¥¹å’Œæˆ‘è¯´æˆ‘ä»¬å¯èƒ½è¦åˆ†æ‰‹äº†ï¼Œå·¥ä½œåœ°ç‚¹ä¸åŒï¼Œä¸¤æ–¹ä¸ä¼šåœ¨ä¸€èµ·çš„ã€‚æˆ‘å¾ˆéš¾å—ï¼Œå¯ç°å®å°±æ˜¯è¿™æ ·ï¼Œèœæ˜¯åŸç½ªï¼Œè€Œæˆ‘æ°å¥½å°±å¾ˆèœã€‚ å¥¹æ˜¯ä¸ªå¾ˆæ‡’çš„äººï¼Œä¹Ÿæ˜¯ä¸ªç»å¸¸ç„¦è™‘çš„äººã€‚ä»Šå¹´ç§‹æ‹›ï¼Œå¥¹åªå»äº†ä¸€ä¸ªé¢è¯•ï¼Œç»“æœè¿‡äº†ï¼Œå·¥ä½œåœ°ç‚¹åœ¨é’å²›å³å¢¨ï¼Œä¸€ä¸ªä¸æ˜¯å¾ˆå‘è¾¾çš„åœ°æ–¹ï¼Œå’Œæˆ‘è€å®¶åœ¨ä¸€ä¸ªå¸‚ï¼Œä½†æ˜¯è·ç¦»éå¸¸è¿œï¼Œå·¥èµ„4Kï¼Œå¤–è´¸ä¸“å‘˜ã€‚æˆ‘ä¸çœ‹å¥½å¥¹çš„å·¥ä½œï¼Œä¸»è¦æ˜¯åœ°ç‚¹ä¸å¥½ï¼Œä¸æ˜¯å¸‚åŒºï¼Œæˆ‘è®©ä»–æ”¾å¼ƒï¼Œå¯å¥¹ä¸ç”˜å¿ƒï¼Œè¯´æ€ªæˆ‘æ²¡å®šä¸‹æ¥åœ°ç‚¹ï¼Œæˆ‘ä¸é è°±ã€‚æˆ‘ä»¬åµäº†å¾ˆå¤šæ¬¡ï¼Œæ²¡æœ‰ç»“æœã€‚ è¶…çº§æƒ³è½¬è¡Œ~ æœ‰æ—¶å€™çœŸçš„è§‰å¾—ï¼Œè®¡ç®—æœºæ–¹é¢æˆ‘æœ‰çˆ±å¥½ï¼Œä½†æ˜¯å´æ²¡æœ‰è¿™ä¸ªèƒ½åŠ›ã€‚ å¦‚æœæˆ‘åšç®¡ç†ï¼Œç»“æœä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿå¦‚æœæˆ‘åšè¥é”€ï¼Œç»“æœä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿå¦‚æœæˆ‘åšæ•™ä¹¦ï¼Œç»“æœä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿæˆ‘ä¸çŸ¥é“ï¼Œä½†æˆ‘è®¤ä¸ºæˆ‘ä¼šåšçš„å¾ˆå¥½ï¼Œåœ¨æˆ–è€…ï¼Œä¼šéå¸¸ä¸ç”˜å¿ƒå§ã€‚ ä¸ç®¡å¦‚ä½•ï¼Œè¿˜æ˜¯æ…¢æ…¢çš„æ´»ç€å§ã€‚å°±åƒæˆ‘çˆ¶æ¯æœ€å¼€å§‹çš„æ„¿æœ›ï¼Œè®©æˆ‘å®‰å®‰ç¨³ç¨³çš„æ´»ç€ï¼Œæœ€å¥½è¡£é£Ÿæ— å¿§ï¼Œä¹Ÿä¸è¦åšä¸ªå¯Œäººï¼Œå—äººå«‰å¦’ï¼Œåšä¸ªå°å°çš„å‹¤åŠ³çš„èš‚èšå°±å¥½ã€‚ è¿™ä¸ªæœˆä¸­æ—¬æˆ‘è¦å»å®ä¹ äº†ï¼Œå»é‚£å®¶ï¼Œä¸€å¼€å§‹ç»™æˆ‘é¢è¯•å¾ˆå’Œè”¼åˆæ„Ÿè§‰å¾ˆæœ‰æ·±åº¦çš„é¢è¯•å®˜æ‰€åœ¨çš„å…¬å¸ã€‚ç”Ÿæ´»è¿˜åœ¨ç»§ç»­ï¼Œæˆ‘è¿˜æ˜¯ä¼šæ…¢æ…¢æ´»ç€ï¼Œä½†æ˜¯æˆ‘æ°¸è¿œä¸ä¼šåœæ­¢æˆ‘å¯¹è‡ªå·±çš„è¿½æ±‚ï¼ ä¼˜ç§€çš„äººä¸åœ¨äºé¡ºå¢ƒå¦‚ä½•è¿‡æ´»ï¼Œè€Œæ˜¯åœ¨é€†å¢ƒæ´»å‡ºç²¾å½©ã€‚éš¾ç†¬çš„æ—¥å­æ€»ä¼šå‡ºç°ï¼Œè¿‡å»äº†å°±æ˜¯è¿‡å»ï¼Œæ›´åŠ åšéŸ§ã€‚ é¸¡æ±¤ç‚¹åˆ°ä¸ºæ­¢ï¼Œè¦å¼€å§‹åƒé¥­äº†ï¼Œç§‹æ‹›åªæ˜¯å·¥ä½œç”Ÿæ¶¯çš„å¼€å§‹ï¼Œèµ·è·‘çº¿è½æˆ·çš„äº‹ä¸æ˜¯æ²¡ç»å†è¿‡ï¼Œç°åœ¨å¼€å§‹åŠªåŠ›ï¼Œæœ€å·®ä¸è¿‡ä¸‹ä¸€ç«™æ˜¥æ‹›ï¼Œæ²¡å†æ€•çš„ã€‚ Nothing to lose,everything will be !]]></content>
      <tags>
        <tag>æ—¥å¸¸</tag>
        <tag>ç”Ÿæ´»</tag>
        <tag>åæ§½</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æŠ€æœ¯å­¦ä¹ è·¯çº¿å›¾]]></title>
    <url>%2F2018%2F11%2F01%2F%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF%E5%9B%BE%2F</url>
    <content type="text"><![CDATA[åˆ†äº«ä¸€ä¸‹å­¦ä¹ æŠ€æœ¯çš„æ€ç»´è„‘å›¾ï¼Œä¸»è¦æ˜¯æ¶æ„å¸ˆå›¾è°±ï¼ŒjavaçŸ¥è¯†å›¾è°±ï¼Œå‰ç«¯æŠ€æœ¯å­¦ä¹ å¯¼å›¾ï¼Œå¤§æ•°æ®ä¸äº‘è®¡ç®—æŠ€èƒ½ï¼ŒDevOpsç›¸å…³å›¾è°±ï¼Œç•™ä½œä¸ªäººå¤‡ä»½ç”¨ã€‚ç´ æå…¨éƒ¨æœé›†äºç½‘ç»œï¼Œä¾µåˆ ï¼ æ¶æ„å¸ˆå›¾è°± javaçŸ¥è¯†å›¾è°±javaæ¡†æ¶å›¾è°± Javaå¹¶å‘çŸ¥è¯†å›¾è°± å‰ç«¯æŠ€æœ¯å­¦ä¹ å¯¼å›¾ å¤§æ•°æ®ä¸äº‘è®¡ç®—æŠ€èƒ½ iosæŠ€èƒ½ DevOpsç›¸å…³å›¾è°±]]></content>
      <tags>
        <tag>æŠ€æœ¯</tag>
        <tag>åˆ†äº«</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æœªæ¥ã®ç›®æ¨™]]></title>
    <url>%2F2018%2F10%2F27%2F%E6%9C%AA%E6%9D%A5%E3%81%AE%E7%9B%AE%E6%A8%99%2F</url>
    <content type="text"><![CDATA[å¾ˆå¤šæ—¶å€™ï¼Œç”Ÿæ´»å¹¶ä¸å¦‚æ„ï¼›å¾ˆå¤šæ—¶å€™ï¼Œç†æƒ³å¹¶ä¸èƒ½å®ç°ï¼›è·¯å¾ˆé•¿ï¼Œèº«ä½“å¾ˆç´¯ï¼Œå¯è¿˜æ˜¯ä¸€ç›´è¦èµ°ä¸‹å»ã€‚ å§‹æˆ‘æ˜¯ä¸€ä¸ªä¸€ä¸ªæ™®æ™®é€šé€šçš„åŒéå­¦æ ¡çš„å¤§å­¦ç”Ÿï¼Œæ¥è‡ªå±±ä¸œçš„äºŒåçº¿å°åŸå¸‚ï¼Œå®¶å¢ƒä¸€èˆ¬ï¼Œç”Ÿæ´»å¾ˆå®‰é€¸ã€‚å¯èƒ½å°æ—¶å€™å—åˆ°çš„ç†é™¶æ¯”è¾ƒå¤šå§ï¼Œå®¶é‡Œäººæ¯”è¾ƒæŠ¤çŠŠï¼Œæ¥è§¦çš„äº‹æƒ…ä¹Ÿå¾ˆå°‘ã€‚å¹³æ—¶æ²¡å•¥ä¹ æƒ¯ï¼Œæœ€å¤§çš„çˆ±å¥½æ˜¯æ£é¼“è®¡ç®—æœºã€‚ å¦ˆå¦ˆçš„çœ¼ç•Œå¾ˆå¹¿ï¼Œæˆ‘å°æ—¶å€™ä¸‰å¹´çº§ï¼Œå¦ˆå¦ˆæ•™äº†flashåŠ¨ç”»ï¼Œåˆä¸­å‚»äº†å§å”§çš„çš„ç©å›½å¤–æ¸¸æˆï¼Œå› æ­¤è‹±è¯­è¿˜ç®—å¯ä»¥ï¼Œé«˜ä¸­è‡ªå·±å­¦diyç”µè„‘ï¼Œææœºå™¨ã€‚ ä¸€æ­¥ä¸€æ­¥çš„æˆé•¿ï¼Œåˆ°äº†å¿«ä¸Šå¤§å­¦çš„å¹´çºªï¼Œè‡ªå·±å•¥ä¹Ÿä¸çŸ¥é“ï¼Œåªé ç€çˆ¶æ¯ã€‚çˆ¶æ¯å¾ˆçˆ±æˆ‘ï¼Œç»™æˆ‘é€‰äº†ä¸€ä¸ªç½‘ç»œå·¥ç¨‹ä¸“ä¸šã€‚è¿›äº†å¤§å­¦ï¼Œä»€ä¹ˆéƒ½å˜äº†ï¼Œäººå˜äº†ï¼Œæ¥¼å˜äº†ï¼Œä¸–ç•Œå˜äº†ã€‚è¿™é‡Œçš„äººæ¸©æ–‡å°”é›…ï¼Œè¿™é‡Œçš„äººè¡£ç€æ•´é½ï¼Œæˆ‘åŠ¨å¿ƒäº†ï¼Œç”Ÿæ´»åœ¨è¿™é‡Œå¥½å¹¸ç¦ã€‚ æˆ‘åœ¨æ…¢æ…¢æ‡‚äº‹ã€‚ ç¬¬ä¸€å¹´ï¼Œæˆ‘å»äº†å­¦ç”Ÿä¼šï¼Œæˆ‘å»äº†ä¸€å®¶ä¸–ç•Œ500å¼ºå®ä¹ ï¼ŒåŒæ—¶è¿˜æ‰¾äº†ä¸€ä»½ä¿®ç”µè„‘çš„å…¼èŒï¼Œåˆå¯¹ä¸€ä¸ªå¥³å­©äº§ç”Ÿäº†å¥½æ„Ÿã€‚ ç¬¬äºŒå¹´ï¼Œæ…¢æ…¢çš„æ‘¸ç´¢ï¼Œæˆ‘ç»§ç»­æˆ‘çš„è€è·¯ã€‚æˆ‘è®¤ä¸ºæˆ‘è‡ªå·±åšçš„å†³å®šï¼Œå¾ˆå®Œå–„ï¼Œå¾ˆå¥½ï¼Œæˆ‘æ²‰æµ¸åœ¨å…¶ä¸­ã€‚ ç¬¬ä¸‰å¹´ï¼Œæ‹çˆ±ä½™æ¸©é™ä¸‹æ¥äº†ï¼Œç°å®ä¹Ÿæ¥äº†ã€‚é’æ˜¥æœŸçš„çƒ¦æ¼æ¥è¸µè€Œè‡³ï¼Œâ€œæˆ‘åœ¨å“ªï¼Ÿæˆ‘ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿâ€ï¼Œæˆ‘æ€»æ˜¯åœ¨è‡ªå·±æ¢ç´¢ï¼Œæˆ‘æ€»æ˜¯æ¯”åˆ«äººæ™šå‘è‚²å¾ˆå¤šã€‚ æœ‰è¿™æ ·ä¸€ä¸ªæ•…äº‹ï¼Œä¸€åè®°è€…çœ‹è§å†œæ‘çš„ä¸€ä¸ªæ­£åœ¨æ”¾ç¾Šçš„å°å­©ï¼Œé—®ä»–â€œä½ çš„ç†æƒ³æ˜¯ä»€ä¹ˆï¼Ÿâ€å°å­©å›ç­”è¯´ï¼šâ€œæ”¾ç¾Šï¼â€â€œç¾Šå„¿å–‚å¤§äº†å¹²ä»€ä¹ˆï¼Ÿâ€â€œå–é’±ï¼â€â€œæœ‰äº†å–ç¾Šå„¿çš„é’±å¹²ä»€ä¹ˆï¼Ÿâ€â€œå¨¶è€å©†ï¼â€â€œå¨¶è€å©†å¹²ä»€ä¹ˆï¼Ÿâ€â€œç”Ÿå°å­©ï¼â€â€œç”Ÿå°å­©æ¥å¹²ä»€ä¹ˆï¼Ÿâ€â€œæ”¾ç¾Šï¼â€â€¦â€¦ æ”¾ç¾Šçš„å°å­©å¯¹ä¸–ç•Œçš„ç†è§£ä¹Ÿå°±æ˜¯ï¼šæ”¾ç¾ŠæŒ£é’±å¨¶è€å©†ç”Ÿå°å­©å†æ”¾ç¾Šã€‚å¯¹å¤–é¢ä¸–ç•Œçš„äº†è§£å¯èƒ½è¶‹å‘äºäº†é›¶ï¼Œåœ¨ä»–çš„ä¸–ç•Œé‡Œï¼Œè¿™å°±æ˜¯ç¾å¥½çš„ä¸€åˆ‡ï¼Œå¹¸ç¦çš„ç”Ÿæ´»ã€‚å¯¹ä¸–ç•Œè®¤è¯†çš„å±€é™æ€§ä¼šå¯¼è‡´æ€ç»´çš„å±€é™æ€§ï¼Œæ€ç»´çš„å±€é™æ€§ä¼šå¯¼è‡´ç›®æ ‡çš„å±€é™æ€§ï¼Œç›®æ ‡çš„å±€é™æ€§æœ€ç»ˆå¯¼è‡´è¡Œä¸ºçš„å±€é™æ€§ï¼Œä»è€Œå½±å“äººç”Ÿä¸­çš„å„ç§é€‰æ‹©ã€‚ æˆ‘ï¼Œä¼šæ”¾ç¾Šï¼Œä½†æ˜¯æˆ‘ä¸æƒ³ä¸€ç›´æ”¾ç¾Šã€‚æˆ‘éœ€è¦åŠªåŠ›ï¼Œæˆ‘éœ€è¦ä¸Šè¿›ï¼Œæˆ‘æƒ³èµšé’±ï¼Œæˆ‘æƒ³ç»™æˆ‘çˆ±çš„äººæœ€å¥½çš„ã€‚ æ‰€ä»¥ï¼Œæˆ‘æƒ³åšç¨‹åºå‘˜ã€‚ èµ°æˆ‘åšè¿‡å¾ˆå¤šäº‹æƒ…ï¼Œå¾ˆå¤šæ²¡æœ‰ç›®æ ‡ã€‚å¯åšç¨‹åºå‘˜ï¼Œæ²¡æœ‰ç›®æ ‡æ˜¯ä¸è¡Œçš„ã€‚ç°åœ¨æ˜¯2018å¹´äº†ï¼Œæˆ‘é¢ä¸´ç€éå¸¸å·¨å¤§çš„ç«äº‰å‹åŠ›ã€‚è¿™ä¸€å¹´ï¼Œæ­£å¥½èµ¶ä¸Šäº†90åçš„æœ«ç­æ½®ï¼Œå…¨å›½å­¦æ ¡éƒ½å·²ç»æ‰©å®¹å®Œæ¯•ï¼Œæ•°ä¸èƒœæ•°çš„ï¼Œæ¯”æˆ‘ä¼˜ç§€çš„211ï¼Œ985å¤§å­¦ç”Ÿç ”ç©¶ç”Ÿï¼Œç–¯ç‹‚çš„æŒ¤å…¥äººæ‰å¸‚åœºã€‚å¯æ˜¯ï¼Œä»Šå¹´çš„äººæ‰ä¾›æ±‚å´è¿œä¸å¦‚å»å¹´å‰å¹´ã€‚æˆ‘ï¼Œè§‰å¾—æˆ‘å¤±ä¸šäº†ã€‚ æˆ‘ä¸ç”˜å¿ƒï¼Œæˆ‘æŠ•äº†å¾ˆå¤šå¾ˆå¤šé¢è¯•ï¼Œæœ‰çš„é•¿è¾ˆå¯¹æˆ‘å¤§å¼å¤§å«ï¼Œè¯´æˆ‘è¿™æ ·æ˜¯ä¸å¯èƒ½æ‰¾åˆ°å·¥ä½œçš„ï¼Œæœ‰çš„é•¿è¾ˆè¿çœ‹éƒ½ä¸çœ‹ï¼Œåªæ˜¯å†·æ¼ çš„è¯´å£°â€œä½ èµ°å§â€ã€‚ æœ›å°½ä¸–ä¿—å¸¸æ€ï¼Œå”¯æœ‰æå‡è‡ªå·±æ‰æ˜¯æ ¹æœ¬ã€‚ æ‰€ä»¥æˆ‘æƒ³åŠªåŠ›ï¼Œæˆ‘æƒ³æˆä¸ºæˆ‘è‡ªå·±ã€‚ å­¦ä¹ ç›®æ ‡åœ¨è¿™é‡Œæˆ‘å®šä¸‹ç›®æ ‡ï¼Œä¸‰å¹´å†…ï¼Œéœ€è¦å­¦ä¼šæˆ–è€…ç²¾é€šä»¥ä¸‹çŸ¥è¯†ï¼š æ•°æ®ç»“æ„ é˜Ÿåˆ— é›†åˆ é“¾è¡¨ã€æ•°ç»„ å­—å…¸ã€å…³è”æ•°ç»„ æ ˆ æ ‘ äºŒå‰æ ‘ å®Œå…¨äºŒå‰æ ‘ å¹³è¡¡äºŒå‰æ ‘ äºŒå‰æŸ¥æ‰¾æ ‘ï¼ˆBSTï¼‰ Bï¼ŒB+ï¼ŒB - [x]æ ‘ çº¢é»‘æ ‘ LSM æ ‘ å¸¸ç”¨ç®—æ³• æ’åºã€æŸ¥æ‰¾ç®—æ³• é€‰æ‹©æ’åº å†’æ³¡æ’åº æ’å…¥æ’åº å¿«é€Ÿæ’åº å½’å¹¶æ’åº æ¡¶æ’åº è®¡æ•°æ’åº å¸Œå°”æ’åº åŸºæ•°æ’åº è®¡æ•°æ’åº äºŒåˆ†æŸ¥æ‰¾ å½’å¹¶æ’åº Java ä¸­çš„æ’åºæ•°æ®ç»“æ„ï¼ˆarraylistï¼‰ å¸ƒéš†è¿‡æ»¤å™¨ å­—ç¬¦ä¸²æ¯”è¾ƒ KMP ç®—æ³• æ·±åº¦ä¼˜å…ˆã€å¹¿åº¦ä¼˜å…ˆ è´ªå¿ƒç®—æ³• å›æº¯ç®—æ³• å‰ªæç®—æ³• åŠ¨æ€è§„åˆ’ æœ´ç´ è´å¶æ–¯ æœ€å°ç”Ÿæˆæ ‘ç®—æ³• æœ€çŸ­è·¯å¾„ç®—æ³• å¹¶å‘ç¼–ç¨‹ Java å¹¶å‘ å¤šçº¿ç¨‹ çº¿ç¨‹å®‰å…¨ ä¸€è‡´æ€§ã€äº‹åŠ¡ ACID äº‹åŠ¡çš„éš”ç¦»çº§åˆ« MVCC é” Javaä¸­çš„é”å’ŒåŒæ­¥ç±» å…¬å¹³é” &amp; éå…¬å¹³é” æ‚²è§‚é” ä¹è§‚é” &amp; CAS ABA é—®é¢˜ CopyOnWriteå®¹å™¨ RingBuffer å¯é‡å…¥é” &amp; ä¸å¯é‡å…¥é” äº’æ–¥é” &amp; å…±äº«é” æ­»é” æ“ä½œç³»ç»Ÿ è®¡ç®—æœºåŸç† CPU å†…å­˜ è¿›ç¨‹çº¿ç¨‹åç¨‹ Linux è®¾è®¡æ¨¡å¼ 23ç§å¸¸è§è®¾è®¡æ¨¡å¼ MVC IOC AOP è®¾è®¡æ¨¡å¼çš„å…­å¤§åŸåˆ™ å¾®æœåŠ¡æ€æƒ³ åº·å¨å®šå¾‹ è¿ç»´ å¸¸è§„ç›‘æ§ APM ç»Ÿè®¡åˆ†æ æŒç»­é›†æˆ(CI/CD) ç¯å¢ƒåˆ†ç¦» Jenkins è‡ªåŠ¨åŒ–è¿ç»´ è¿ç»´ ; ç»Ÿè®¡ ; æŠ€æœ¯æ”¯æŒ Jenkins ç¯å¢ƒåˆ†ç¦» è‡ªåŠ¨åŒ–è¿ç»´ Ansible puppet chef æµ‹è¯• TDD ç†è®º å•å…ƒæµ‹è¯• å‹åŠ›æµ‹è¯• å…¨é“¾è·¯å‹æµ‹ A/B ã€ç°åº¦ã€è“ç»¿æµ‹è¯• è™šæ‹ŸåŒ– KVM Xen OpenVZ å®¹å™¨æŠ€æœ¯ Docker äº‘æŠ€æœ¯ OpenStack DevOps æ–‡æ¡£ç®¡ç† ä¸­é—´ä»¶ Web Server Nginx OpenResty Tengine Apache Httpd Tomcat æ¶æ„åŸç† è°ƒä¼˜æ–¹æ¡ˆ Jetty ç¼“å­˜ æœ¬åœ°ç¼“å­˜ å®¢æˆ·ç«¯ç¼“å­˜ æœåŠ¡ç«¯ç¼“å­˜ Webç¼“å­˜ Memcached Redis æ¶æ„ å›æ”¶ç­–ç•¥ Tair æ¶ˆæ¯é˜Ÿåˆ— æ¶ˆæ¯æ€»çº¿ æ¶ˆæ¯çš„é¡ºåº RabbitMQ RocketMQ ActiveMQ Kafka Redis æ¶ˆæ¯æ¨é€ ZeroMQ å®šæ—¶è°ƒåº¦ å•æœºå®šæ—¶è°ƒåº¦ åˆ†å¸ƒå¼å®šæ—¶è°ƒåº¦ RPC Dubbo Thrift gRPC æ•°æ®åº“ä¸­é—´ä»¶ Sharding Jdbc æ—¥å¿—ç³»ç»Ÿ æ—¥å¿—æœé›† é…ç½®ä¸­å¿ƒ API ç½‘å…³ ç½‘ç»œ åè®® OSI ä¸ƒå±‚åè®® TCP/IP HTTP HTTP2.0 HTTPS ç½‘ç»œæ¨¡å‹ Epoll Java NIO kqueue è¿æ¥å’ŒçŸ­è¿æ¥ æ¡†æ¶ é›¶æ‹·è´ï¼ˆZero-copyï¼‰ åºåˆ—åŒ–(äºŒè¿›åˆ¶åè®®) Hessian Protobuf æ•°æ®åº“ åŸºç¡€ç†è®º æ•°æ®åº“è®¾è®¡çš„ä¸‰å¤§èŒƒå¼ MySQL åŸç† InnoDB ä¼˜åŒ– ç´¢å¼• èšé›†ç´¢å¼•, éèšé›†ç´¢å¼• å¤åˆç´¢å¼• è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•(AHI) explain NoSQL MongoDB Hbase æœç´¢å¼•æ“ æœç´¢å¼•æ“åŸç† Lucene Elasticsearch Solr sphinx æ€§èƒ½ æ€§èƒ½ä¼˜åŒ–æ–¹æ³•è®º å®¹é‡è¯„ä¼° CDN ç½‘ç»œ è¿æ¥æ±  æ€§èƒ½è°ƒä¼˜ å¤§æ•°æ® æµå¼è®¡ç®— Storm Flink Kafka Stream åº”ç”¨åœºæ™¯ Hadoop HDFS MapReduce Yarn Spark å®‰å…¨ web å®‰å…¨ XSS CSRF SQL æ³¨å…¥ Hash Dos è„šæœ¬æ³¨å…¥ æ¼æ´æ‰«æå·¥å…· éªŒè¯ç  DDoS é˜²èŒƒ ç”¨æˆ·éšç§ä¿¡æ¯ä¿æŠ¤ åºåˆ—åŒ–æ¼æ´ åŠ å¯†è§£å¯† å¯¹ç§°åŠ å¯† å“ˆå¸Œç®—æ³• éå¯¹ç§°åŠ å¯† æœåŠ¡å™¨å®‰å…¨ æ•°æ®å®‰å…¨ æ•°æ®å¤‡ä»½ ç½‘ç»œéš”ç¦» å†…å¤–ç½‘åˆ†ç¦» ç™»å½•è·³æ¿æœº æˆæƒã€è®¤è¯ RBAC OAuth2.0 åŒå› ç´ è®¤è¯ï¼ˆ2FAï¼‰ å•ç‚¹ç™»å½•(SSO) å¸¸ç”¨å¼€æºæ¡†æ¶ å¼€æºåè®® æ—¥å¿—æ¡†æ¶ Log4jã€Log4j2 Logback ORM ç½‘ç»œæ¡†æ¶ Web æ¡†æ¶ Spring å®¶æ— å·¥å…·æ¡†æ¶ åˆ†å¸ƒå¼è®¾è®¡ æ‰©å±•æ€§è®¾è®¡ ç¨³å®šæ€§ &amp; é«˜å¯ç”¨ ç¡¬ä»¶è´Ÿè½½å‡è¡¡ è½¯ä»¶è´Ÿè½½å‡è¡¡ é™æµ åº”ç”¨å±‚å®¹ç¾ è·¨æœºæˆ¿å®¹ç¾ å®¹ç¾æ¼”ç»ƒæµç¨‹ å¹³æ»‘å¯åŠ¨ æ•°æ®åº“æ‰©å±• è¯»å†™åˆ†ç¦»æ¨¡å¼ åˆ†ç‰‡æ¨¡å¼ æœåŠ¡æ²»ç† æœåŠ¡æ³¨å†Œä¸å‘ç° æœåŠ¡è·¯ç”±æ§åˆ¶ åˆ†å¸ƒå¼ä¸€è‡´ CAP ä¸ BASE ç†è®º åˆ†å¸ƒå¼é” åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³• PAXOS Zab Raft Gossip ä¸¤é˜¶æ®µæäº¤ã€å¤šé˜¶æ®µæäº¤ å¹‚ç­‰ åˆ†å¸ƒå¼ä¸€è‡´æ–¹æ¡ˆ åˆ†å¸ƒå¼ Leader èŠ‚ç‚¹é€‰ä¸¾ TCC(Try/Confirm/Cancel) æŸ”æ€§äº‹åŠ¡ åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ å”¯ä¸€ID ç”Ÿæˆ å…¨å±€å”¯ä¸€ID ä¸€è‡´æ€§Hashç®—æ³• è®¾è®¡æ€æƒ³ &amp; å¼€å‘æ¨¡å¼ DDD(Domain-driven Design - é¢†åŸŸé©±åŠ¨è®¾è®¡) å‘½ä»¤æŸ¥è¯¢èŒè´£åˆ†ç¦»(CQRS) è´«è¡€ï¼Œå……è¡€æ¨¡å‹ Actor æ¨¡å¼ å“åº”å¼ç¼–ç¨‹ Reactor RxJava Vert.x DODAF2.0 Serverless Service Mesh é¡¹ç›®ç®¡ç† æ¶æ„è¯„å®¡ é‡æ„ ä»£ç è§„èŒƒ ä»£ç  Review RUP çœ‹æ¿ç®¡ç† SCRUM æ•æ·å¼€å‘ æé™ç¼–ç¨‹ï¼ˆXPï¼‰ ç»“å¯¹ç¼–ç¨‹ PDCA å¾ªç¯è´¨é‡ç®¡ç† FMEAç®¡ç†æ¨¡å¼ é€šç”¨ä¸šåŠ¡æœ¯è¯­ æŠ€æœ¯è¶‹åŠ¿ æ”¿ç­–ã€æ³•è§„ æ³•å¾‹ ä¸¥æ ¼éµå®ˆåˆ‘æ³•253æ³•æ¡ æ¶æ„å¸ˆç´ è´¨ å›¢é˜Ÿç®¡ç† æ‹›è˜ç»“æŸæœ‰ç›®æ ‡ï¼Œå°±æœ‰åŠ¨åŠ›ã€‚æœªæ¥ï¼Œæˆ‘æœŸæœ›ç€ä½ ï¼]]></content>
      <tags>
        <tag>ç”Ÿæ´»</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®ºå¦‚ä½•åœ¨è®ºæ–‡ä¸­ä¼˜ç¾çš„é»è´´ä»£ç ]]></title>
    <url>%2F2018%2F10%2F27%2F%E8%AE%BA%E5%A6%82%E4%BD%95%E5%9C%A8%E8%AE%BA%E6%96%87%E4%B8%AD%E4%BC%98%E7%BE%8E%E7%9A%84%E9%BB%8F%E8%B4%B4%E4%BB%A3%E7%A0%81%2F</url>
    <content type="text"><![CDATA[åˆæ˜¯ä¸€å¹´è®ºæ–‡å­£ï¼Œå­¦ç”Ÿå…šè¡¨ç¤ºé¸­æ¢¨å±±å¤§ã€‚ è¿™ä¸ï¼Œå¤åˆ¶ç²˜è´´ä¸€ä¸ªé¡¹ç›®é‡Œçš„ä»£ç ï¼Œæå¾—æ•´ä¸ªç»“æ„ä¹±ä¸ƒå…«ç³Ÿçš„ï¼è¿™è¯¥å¦‚ä½•æ˜¯å¥½å‘¢ï¼Ÿ ä»Šå¤©ï¼Œæˆ‘æ¥åˆ†äº«ä¸€ä¸ªç½‘ç«™ï¼Œå¯ä»¥ä¼˜é›…çš„å°†æˆ‘çš„ä»£ç å¤åˆ¶åˆ°WORDä¸Š~ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ å·¥å…·æ–¹æ³•1ï¼šæ‰“å¼€è¿™ä¸ªç½‘é¡µPlanetB æ–¹æ³•2ï¼šè°·æ­Œæœç´¢syntax highlight code in word documentsï¼Œæ£€ç´¢ç»“æœçš„ç¬¬ä¸€ä¸ªã€‚å½“ç„¶äº†ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•è¿”å›çš„æ˜¯åŒä¸€ä¸ªç½‘ç«™ã€‚ æ­¥éª¤ å°†ä½ éœ€è¦æ’å…¥åœ¨wordä¸­çš„ä»£ç å®Œæ•´çš„å¤åˆ¶åˆ°è¯¥ç½‘ç«™æç¤ºçš„æ–‡æœ¬æ¡†å†…ï¼Œé€‰æ‹©ä½ çš„ä»£ç ç±»å‹ï¼Œå¦‚Java,C++,HTMLç­‰ï¼Œå¹¶ç‚¹å‡»Show Highlightedã€‚å¦‚ä¸‹å›¾ï¼š è¯¥ç½‘é¡µä¼šè‡ªåŠ¨å°†è¯¥ä»£ç ç”Ÿæˆåˆ°ä¸€ä¸ªæ–°çš„é¡µé¢ï¼Œæ­¤æ—¶ctrl+Aå…¨é€‰ï¼Œåctrl+cå¤åˆ¶åˆ°wordä¸­ç²˜è´´å°±å¥½ã€‚å¦‚ä¸‹å›¾ï¼š æ€»ç»“æ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯æ•ˆæœå¾ˆå¥½ï¼Ÿå„ä½çœ‹è§‚è€çˆ·ï¼Œå–œæ¬¢å°±ç‚¹ä¸ªèµå§ï¼]]></content>
      <tags>
        <tag>çªé—¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸‡ç‰©åŸºäºSpringï¼ˆä¸€ï¼‰]]></title>
    <url>%2F2018%2F10%2F07%2F%E4%B8%87%E7%89%A9%E5%9F%BA%E4%BA%8ESpring%2F</url>
    <content type="text"><![CDATA[å‰é¢æ–‡ç« æåˆ°äº†ï¼ŒSpringbootæ˜¯åŸºäºspringä¸ºåŸºç¡€æ‰©å±•å‡ºæ¥çš„ä¸€ä¸ªå¿«é€’æ¡†æ¶ã€‚æ·±å…¥ç†è§£springbootå°±éœ€è¦ç†è§£springçš„ç›¸å…³åŸç†ã€‚æ‰€ä»¥æˆ‘ä»¬å°±å¼€å§‹å§ï¼ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢https://blog.tengshe789.tech/ï¼ˆğŸ˜˜ Springçš„æ¦‚è¿°Springæ˜¯ä¸€ä¸ªå¼€æºçš„è½»é‡çº§JavaSEï¼ˆJavaæ ‡å‡†ç‰ˆæœ¬ï¼‰/ JavaEEï¼ˆJavaä¼ä¸šç‰ˆæœ¬ï¼‰å¼€å‘åº”ç”¨æ¡†æ¶ï¼Œå…¶ç›®çš„æ˜¯ç”¨äºç®€åŒ–ä¼ä¸šçº§åº”ç”¨ç¨‹åºå¼€å‘ã€‚ åº”ç”¨ç¨‹åºæ˜¯ç”±ä¸€ç»„ç›¸äº’åä½œçš„å¯¹è±¡ç»„æˆã€‚è€Œåœ¨ä¼ ç»Ÿåº”ç”¨ç¨‹åºå¼€å‘ä¸­ï¼Œä¸€ä¸ªå®Œæ•´çš„åº”ç”¨æ˜¯ç”±ä¸€ç»„ç›¸äº’åä½œçš„å¯¹è±¡ç»„æˆã€‚æ‰€ä»¥å¼€å‘ä¸€ä¸ªåº”ç”¨é™¤äº†è¦å¼€å‘ä¸šåŠ¡é€»è¾‘ä¹‹å¤–ï¼Œæœ€å¤šçš„æ˜¯å…³æ³¨å¦‚ä½•ä½¿è¿™äº›å¯¹è±¡åä½œæ¥å®Œæˆæ‰€éœ€åŠŸèƒ½ï¼Œè€Œä¸”è¦ä½è€¦åˆã€é«˜å†…èšã€‚ ä¸šåŠ¡é€»è¾‘å¼€å‘æ˜¯ä¸å¯é¿å…çš„ï¼Œé‚£å¦‚æœæœ‰ä¸ªæ¡†æ¶å‡ºæ¥å¸®æˆ‘ä»¬æ¥åˆ›å»ºå¯¹è±¡åŠç®¡ç†è¿™äº›å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚å¯èƒ½æœ‰äººè¯´äº†ï¼Œæ¯”å¦‚â€œæŠ½è±¡å·¥å‚ã€å·¥å‚æ–¹æ³•è®¾è®¡æ¨¡å¼â€ä¸ä¹Ÿå¯ä»¥å¸®æˆ‘ä»¬åˆ›å»ºå¯¹è±¡ï¼Œâ€œç”Ÿæˆå™¨æ¨¡å¼â€å¸®æˆ‘ä»¬å¤„ç†å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»ï¼Œä¸ä¹Ÿèƒ½å®Œæˆè¿™äº›åŠŸèƒ½å—ï¼Ÿå¯æ˜¯è¿™äº›åˆéœ€è¦æˆ‘ä»¬åˆ›å»ºå¦ä¸€äº›å·¥å‚ç±»ã€ç”Ÿæˆå™¨ç±»ï¼Œæˆ‘ä»¬åˆè¦è€Œå¤–ç®¡ç†è¿™äº›ç±»ï¼Œå¢åŠ äº†æˆ‘ä»¬çš„è´Ÿæ‹…ï¼Œå¦‚æœèƒ½æœ‰ç§é€šè¿‡é…ç½®æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡ï¼Œç®¡ç†å¯¹è±¡ä¹‹é—´ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬ä¸éœ€è¦é€šè¿‡å·¥å‚å’Œç”Ÿæˆå™¨æ¥åˆ›å»ºåŠç®¡ç†å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œè¿™æ ·æˆ‘ä»¬æ˜¯ä¸æ˜¯å‡å°‘äº†è®¸å¤šå·¥ä½œï¼ŒåŠ é€Ÿäº†å¼€å‘ï¼Œèƒ½èŠ‚çœå‡ºå¾ˆå¤šæ—¶é—´æ¥å¹²å…¶ä»–äº‹ã€‚ Springæ¡†æ¶åˆšå‡ºæ¥æ—¶ä¸»è¦å°±æ˜¯æ¥å®Œæˆè¿™ä¸ªåŠŸèƒ½ã€‚ Springæ¡†æ¶é™¤äº†å¸®æˆ‘ä»¬ç®¡ç†å¯¹è±¡åŠå…¶ä¾èµ–å…³ç³»ï¼Œè¿˜æä¾›åƒé€šç”¨æ—¥å¿—è®°å½•ã€æ€§èƒ½ç»Ÿè®¡ã€å®‰å…¨æ§åˆ¶ã€å¼‚å¸¸å¤„ç†ç­‰é¢å‘åˆ‡é¢çš„èƒ½åŠ›ï¼Œè¿˜èƒ½å¸®æˆ‘ä»¬ç®¡ç†æœ€å¤´ç–¼çš„æ•°æ®åº“äº‹åŠ¡ï¼Œæœ¬èº«æä¾›äº†ä¸€å¥—ç®€å•çš„JDBCè®¿é—®å®ç°ï¼Œæä¾›ä¸ç¬¬ä¸‰æ–¹æ•°æ®è®¿é—®æ¡†æ¶é›†æˆï¼Œå¦‚JPAï¼ˆé»˜è®¤ä½¿ç”¨Hibernateï¼‰ï¼Œä¸å„ç§JavaEEæŠ€æœ¯æ•´åˆï¼ˆå¦‚JavaMailã€ä»»åŠ¡è°ƒåº¦ç­‰ç­‰ï¼‰ï¼Œæä¾›ä¸€å¥—è‡ªå·±çš„webå±‚æ¡†æ¶SpringMVCã€Webflexï¼Œè€Œä¸”è¿˜èƒ½éå¸¸ç®€å•çš„ä¸ç¬¬ä¸‰æ–¹Webæ¡†æ¶é›†æˆã€‚ ä»è¿™é‡Œå¯ä»¥è®¤ä¸ºSpringæ˜¯ä¸€ä¸ªè¶…çº§ç²˜åˆå¹³å°ï¼Œé™¤äº†è‡ªå·±æä¾›åŠŸèƒ½å¤–ï¼Œè¿˜æä¾›ç²˜åˆå…¶ä»–æŠ€æœ¯å’Œæ¡†æ¶çš„èƒ½åŠ›ï¼Œä»è€Œä½¿æˆ‘ä»¬å¯ä»¥æ›´è‡ªç”±çš„é€‰æ‹©åˆ°åº•ä½¿ç”¨ä»€ä¹ˆæŠ€æœ¯è¿›è¡Œå¼€å‘ã€‚è€Œä¸”ä¸ç®¡æ˜¯JAVASEï¼ˆC/Sæ¶æ„ï¼‰åº”ç”¨ç¨‹åºè¿˜æ˜¯JAVAEEï¼ˆB/Sæ¶æ„ï¼‰åº”ç”¨ç¨‹åºéƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ªå¹³å°è¿›è¡Œå¼€å‘ã€‚è®©æˆ‘ä»¬æ¥æ·±å…¥çœ‹ä¸€ä¸‹Springåˆ°åº•èƒ½å¸®æˆ‘ä»¬åšäº›ä»€ä¹ˆï¼Ÿ å†å²çš„å¼€å§‹1996ï¼ŒJavaè¿˜åªæ˜¯ä¸€ä¸ªæ–°å…´çš„ã€åˆå‡ºèŒ…åºçš„ç¼–ç¨‹è¯­è¨€ã€‚äººä»¬ä¹‹æ‰€ä»¥å…³æ³¨å¥¹ä»…ä»…æ˜¯å› ä¸ºï¼Œå¯ä»¥ä½¿ç”¨Javaçš„Appletæ¥å¼€å‘Webåº”ç”¨ã€‚ä½†è¿™äº›å¼€å‘è€…å¾ˆå¿«å°±å‘ç°è¿™ä¸ªæ–°å…´çš„è¯­è¨€è¿˜èƒ½åšæ›´å¤šçš„äº‹æƒ…ã€‚ä¸ä¹‹å‰çš„æ‰€æœ‰è¯­è¨€ä¸åŒï¼ŒJavaè®©æ¨¡å—åŒ–æ„å»ºå¤æ‚çš„ç³»ç»Ÿæˆä¸ºå¯èƒ½ï¼ˆå½“æ—¶çš„è½¯ä»¶è¡Œä¸šè™½ç„¶åœ¨ä¸šåŠ¡ä¸Šçªé£çŒ›è¿›ï¼Œä½†å½“æ—¶å¼€å‘ç”¨çš„æ˜¯ä¼ ç»Ÿçš„é¢å‘è¿‡ç¨‹å¼€å‘æ€æƒ³ï¼Œè½¯ä»¶çš„å¼€å‘æ•ˆç‡ä¸€ç›´è¸Ÿè¹°ä¸å‰ã€‚ä¼´éšç€ä¸šåŠ¡å¤æ‚æ€§çš„ä¸æ–­åŠ æ·±ï¼Œå¼€å‘ä¹Ÿå˜å¾—è¶Šå‘å›°éš¾ã€‚å…¶å®ï¼Œå½“æ—¶ä¹Ÿæ˜¯é¢å‘å¯¹è±¡æ€æƒ³é£é€Ÿå‘å±•çš„æ—¶æœŸï¼Œå¥¹åœ¨80å¹´ä»£æœ«è¢«æå‡ºï¼Œæˆç†Ÿäº90å¹´ä»£ï¼Œç°ä»Šå¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€éƒ½æ˜¯é¢å‘å¯¹è±¡çš„ï¼Œå½“ç„¶è¿™æ˜¯åè¯äº†ï¼‰ã€‚ä»–ä»¬ä¸ºAppletè€Œæ¥ï¼Œä¸ºç»„ä»¶åŒ–è€Œç•™ã€‚è¿™ä¾¿æ˜¯æœ€æ—©çš„Javaã€‚ åŒæ ·åœ¨è¿™ä¸€å¹´çš„12æœˆï¼ŒSunå…¬å¸å‘å¸ƒäº†å½“æ—¶è¿˜åä¸è§ç»ä¼ ä½†åæ¥äººå°½çš†çŸ¥çš„JavaBean1.00-Aè§„èŒƒã€‚æ—©æœŸçš„JavaBeanè§„èŒƒé’ˆå¯¹äºJavaï¼Œå¥¹å®šä¹‰äº†è½¯ä»¶ç»„ä»¶æ¨¡å‹ã€‚è¿™ä¸ªè§„èŒƒè§„å®šäº†ä¸€æ•´å¥—ç¼–ç ç­–ç•¥ï¼Œä½¿ç®€å•çš„Javaå¯¹è±¡ä¸ä»…å¯ä»¥è¢«é‡ç”¨ï¼Œè€Œä¸”è¿˜å¯ä»¥è½»æ¾åœ°æ„å»ºæ›´ä¸ºå¤æ‚çš„åº”ç”¨ã€‚å°½ç®¡JavaBeanæœ€åˆæ˜¯ä¸ºé‡ç”¨åº”ç”¨ç»„ä»¶è€Œè®¾è®¡çš„ï¼Œä½†å½“æ—¶ä»–ä»¬å´æ˜¯ä¸»è¦ç”¨ä½œæ„å»ºçª—ä½“æ§ä»¶ï¼Œæ¯•ç«Ÿåœ¨PCæ—¶ä»£é‚£æ‰æ˜¯ä¸»æµã€‚ä½†ç›¸æ¯”äºå½“æ—¶æ­£å¦‚æ—¥ä¸­å¤©çš„Delphiã€VBå’ŒC++ï¼Œä»–çœ‹èµ·æ¥è¿˜æ˜¯å¤ªç®€æ˜“äº†ï¼Œä»¥è‡³äºæ— æ³•èƒœä»»ä»»ä½•â€å®é™…çš„â€å·¥ä½œã€‚ å¤æ‚çš„åº”ç”¨é€šå¸¸éœ€è¦è¯¸å¦‚äº‹ç‰©ã€å®‰å…¨ã€åˆ†å¸ƒå¼ç­‰æœåŠ¡çš„æ”¯æŒï¼Œä½†JavaBeanå¹¶æœªç›´æ¥æä¾›ã€‚æ‰€ä»¥åˆ°äº†1998å¹´3æœˆï¼ŒSunå‘å¸ƒäº†EJB1.0è§„èŒƒï¼Œè¯¥è§„èŒƒæŠŠJavaç»„ä»¶çš„è®¾è®¡ç†å¿µå»¶ä¼¸åˆ°äº†æœåŠ¡å™¨ç«¯ï¼Œå¹¶æä¾›äº†è®¸å¤šå¿…é¡»çš„ä¼ä¸šçº§æœåŠ¡ï¼Œä½†ä»–ä¹Ÿä¸å†åƒæ—©æœŸçš„JavaBeané‚£ä¹ˆç®€å•äº†ã€‚å®é™…ä¸Šï¼Œé™¤äº†åå­—ï¼ŒEJBBeanå·²ç»å’ŒJavaBeanæ²¡æœ‰ä»»ä½•å…³ç³»äº†ã€‚ å°½ç®¡ç°å®ä¸­æœ‰å¾ˆå¤šç³»ç»Ÿæ˜¯åŸºäºEJBæ„å»ºçš„ï¼Œä½†EJBä»æ¥æ²¡æœ‰å®ç°å®ƒæœ€åˆçš„è®¾æƒ³ï¼šç®€åŒ–å¼€å‘ã€‚EJBçš„å£°æ˜å¼ç¼–ç¨‹æ¨¡å‹çš„ç¡®ç®€åŒ–äº†å¾ˆå¤šåŸºç¡€æ¶æ„å±‚é¢çš„å¼€å‘ï¼Œä¾‹å¦‚äº‹åŠ¡å’Œå®‰å…¨ï¼›ä½†å¦ä¸€æ–¹é¢EJBåœ¨éƒ¨ç½²æè¿°ç¬¦å’Œé…å¥—ä»£ç å®ç°ç­‰æ–¹é¢å˜å¾—å¼‚å¸¸å¤æ‚ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå¾ˆå¤šå¼€å‘è€…å¯¹EJBå·²ç»ä¸å†æŠ±æœ‰å¹»æƒ³ï¼Œå¼€å§‹å¯»æ±‚æ›´ç®€æ´çš„æ–¹æ³•ã€‚ ç°åœ¨Javaç»„ä»¶å¼€å‘ç†å¿µé‡æ–°å›å½’æ­£è½¨ã€‚æ–°çš„ç¼–ç¨‹æŠ€æœ¯AOPå’ŒDIçš„ä¸æ–­å‡ºç°ï¼Œä»–ä»¬ä¸ºJavaBeanæä¾›äº†ä¹‹å‰EJBæ‰èƒ½æ‹¥æœ‰çš„å¼ºå¤§åŠŸèƒ½ã€‚è¿™äº›æŠ€æœ¯ä¸ºPOJOæä¾›äº†ç±»ä¼¼EJBçš„å£°æ˜å¼ç¼–ç¨‹æ¨¡å‹ï¼Œè€Œæ²¡æœ‰å¼•å…¥ä»»ä½•EJBçš„å¤æ‚æ€§ã€‚å½“ç®€å•çš„JavaBeanè¶³ä»¥èƒœä»»æ—¶ï¼Œäººä»¬ä¾¿ä¸æ„¿ç¼–å†™ç¬¨é‡çš„EJBç»„ä»¶äº†ã€‚ å®¢è§‚åœ°è®²ï¼ŒEJBçš„å‘å±•ç”šè‡³ä¿ƒè¿›äº†åŸºäºPOJOçš„ç¼–ç¨‹æ¨¡å‹ã€‚å¼•å…¥æ–°çš„ç†å¿µï¼Œæœ€æ–°çš„EJBè§„èŒƒç›¸æ¯”ä¹‹å‰çš„è§„èŒƒæœ‰äº†å‰æ‰€æœªæœ‰çš„ç®€åŒ–ï¼Œä½†å¯¹å¾ˆå¤šå¼€å‘è€…è€Œè¨€ï¼Œè¿™ä¸€åˆ‡çš„ä¸€åˆ‡éƒ½æ¥å¾—å¤ªè¿Ÿäº†ã€‚åˆ°äº†EJB3è§„èŒƒå‘å¸ƒæ—¶ï¼Œå…¶ä»–åŸºäºPOJOçš„å¼€å‘æ¶æ„å·²ç»æˆä¸ºäº‹å®çš„æ ‡å‡†äº†ï¼Œè€ŒSpringæ¡†æ¶ä¹Ÿæ˜¯åœ¨è¿™æ ·çš„å¤§ç¯å¢ƒä¸‹å‡ºç°çš„ã€‚ Springè®¾è®¡çš„åˆè¡·Springæ˜¯ä¸ºè§£å†³ä¼ä¸šçº§åº”ç”¨å¼€å‘çš„å¤æ‚æ€§è€Œè®¾è®¡ï¼Œå¥¹å¯ä»¥åšå¾ˆå¤šäº‹ã€‚ä½†å½’æ ¹åˆ°åº•æ”¯æ’‘Springçš„ä»…ä»…æ˜¯å°‘è®¸çš„åŸºæœ¬ç†å¿µï¼Œè€Œæ‰€æœ‰åœ°è¿™äº›çš„åŸºæœ¬ç†å¿µéƒ½èƒ½å¯ä»¥è¿½æº¯åˆ°ä¸€ä¸ªæœ€æ ¹æœ¬çš„ä½¿å‘½ï¼šç®€åŒ–å¼€å‘ã€‚è¿™æ˜¯ä¸€ä¸ªéƒ‘é‡çš„æ‰¿è¯ºï¼Œå…¶å®è®¸å¤šæ¡†æ¶éƒ½å£°ç§°åœ¨æŸäº›æ–¹é¢åšäº†ç®€åŒ–ã€‚ è€ŒSpringåˆ™ç«‹å¿—äºå…¨æ–¹é¢çš„ç®€åŒ–Javaå¼€å‘ã€‚å¯¹æ­¤ï¼Œå¥¹ä¸»è¦é‡‡å–äº†4ä¸ªå…³é”®ç­–ç•¥ï¼š 1ï¼ŒåŸºäºPOJOçš„è½»é‡çº§å’Œæœ€å°ä¾µå…¥æ€§ç¼–ç¨‹ï¼› 2ï¼Œé€šè¿‡ä¾èµ–æ³¨å…¥å’Œé¢å‘æ¥å£æ¾è€¦åˆï¼› 3ï¼ŒåŸºäºåˆ‡é¢è¿›è¡Œå£°æ˜å¼ç¼–ç¨‹ï¼› 4ï¼Œé€šè¿‡åˆ‡é¢å’Œæ¨¡æ¿å‡å°‘æ ·æ¿å¼ä»£ç ï¼› è€Œä»–ä¸»è¦æ˜¯é€šè¿‡ï¼šé¢å‘Beanã€ä¾èµ–æ³¨å…¥ä»¥åŠé¢å‘åˆ‡é¢è¿™ä¸‰ç§æ–¹å¼æ¥è¾¾æˆçš„ã€‚ BOPç¼–ç¨‹ä¼Šå§‹Springæ˜¯é¢å‘Beançš„ç¼–ç¨‹ï¼ˆBeanOrientedProgramming,BOPï¼‰ï¼ŒBeanåœ¨Springä¸­æ‰æ˜¯çœŸæ­£çš„ä¸»è§’ã€‚Beanåœ¨Springä¸­ä½œç”¨å°±åƒObjectå¯¹OOPçš„æ„ä¹‰ä¸€æ ·ï¼ŒSpringä¸­æ²¡æœ‰Beanä¹Ÿå°±æ²¡æœ‰Springå­˜åœ¨çš„æ„ä¹‰ã€‚Springæä¾›äº†IOCå®¹å™¨é€šè¿‡é…ç½®æ–‡ä»¶æˆ–è€…æ³¨è§£çš„æ–¹å¼æ¥ç®¡ç†å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚ æ§åˆ¶åè½¬(å…¶ä¸­æœ€å¸¸è§çš„æ–¹å¼å«åšä¾èµ–æ³¨å…¥ï¼ˆDependencyInjectionï¼ŒDIï¼‰ï¼Œè¿˜æœ‰ä¸€ç§æ–¹å¼å«â€œä¾èµ–æŸ¥æ‰¾â€ï¼ˆDependencyLookupï¼ŒDLï¼‰ï¼Œå¥¹åœ¨C++ã€Javaã€PHPä»¥åŠ.NETä¸­éƒ½è¿ç”¨ã€‚åœ¨æœ€æ—©çš„Springä¸­æ˜¯åŒ…å«æœ‰ä¾èµ–æ³¨å…¥æ–¹æ³•å’Œä¾èµ–æŸ¥è¯¢çš„ï¼Œä½†å› ä¸ºä¾èµ–æŸ¥è¯¢ä½¿ç”¨é¢‘ç‡è¿‡ä½ï¼Œä¸ä¹…å°±è¢«Springç§»é™¤äº†ï¼Œæ‰€ä»¥åœ¨Springä¸­æ§åˆ¶åè½¬ä¹Ÿè¢«ç§°ä½œä¾èµ–æ³¨å…¥)ï¼Œå¥¹çš„åŸºæœ¬æ¦‚å¿µæ˜¯ï¼šä¸åˆ›å»ºå¯¹è±¡ï¼Œä½†æ˜¯æè¿°åˆ›å»ºå®ƒä»¬çš„æ–¹å¼ã€‚åœ¨ä»£ç ä¸­ä¸ç›´æ¥ä¸å¯¹è±¡å’ŒæœåŠ¡è¿æ¥ï¼Œä½†åœ¨é…ç½®æ–‡ä»¶ä¸­æè¿°å“ªä¸€ä¸ªç»„ä»¶éœ€è¦å“ªä¸€é¡¹æœåŠ¡ã€‚å®¹å™¨ï¼ˆåœ¨Springæ¡†æ¶ä¸­æ˜¯IOCå®¹å™¨ï¼‰è´Ÿè´£å°†è¿™äº›è”ç³»åœ¨ä¸€èµ·ã€‚ åœ¨å…¸å‹çš„IOCåœºæ™¯ä¸­ï¼Œå®¹å™¨åˆ›å»ºäº†æ‰€æœ‰å¯¹è±¡ï¼Œå¹¶è®¾ç½®å¿…è¦çš„å±æ€§å°†å®ƒä»¬è¿æ¥åœ¨ä¸€èµ·ï¼Œå†³å®šä»€ä¹ˆæ—¶é—´è°ƒç”¨æ–¹æ³•ã€‚ ä¾èµ–æ³¨å…¥DIçš„åŸºæœ¬æ¦‚å¿µSpringè®¾è®¡çš„æ ¸å¿ƒorg.springframework.beansåŒ…ï¼ˆæ¶æ„æ ¸å¿ƒæ˜¯org.springframework.coreåŒ…ï¼‰ï¼Œå®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯ä¸JavaBeanç»„ä»¶ä¸€èµ·ä½¿ç”¨ã€‚è¿™ä¸ªåŒ…é€šå¸¸ä¸æ˜¯ç”±ç”¨æˆ·ç›´æ¥ä½¿ç”¨ï¼Œè€Œæ˜¯ç”±æœåŠ¡å™¨å°†å…¶ç”¨ä½œå…¶ä»–å¤šæ•°åŠŸèƒ½çš„åº•å±‚ä¸­ä»‹ã€‚ä¸‹ä¸€ä¸ªæœ€é«˜çº§æŠ½è±¡æ˜¯BeanFactoryæ¥å£ï¼Œå®ƒæ˜¯å·¥å‚è®¾è®¡æ¨¡å¼çš„å®ç°ï¼Œå…è®¸é€šè¿‡åç§°åˆ›å»ºå’Œæ£€ç´¢å¯¹è±¡ã€‚BeanFactoryä¹Ÿå¯ä»¥ç®¡ç†å¯¹è±¡ä¹‹é—´çš„å…³ç³»ã€‚ BeanFactoryæ”¯æŒä¸¤ä¸ªå¯¹è±¡æ¨¡å‹ã€‚ 1ï¼Œå•ä¾‹ï¼šæ¨¡å‹æä¾›äº†å…·æœ‰ç‰¹å®šåç§°çš„å¯¹è±¡çš„å…±äº«å®ä¾‹ï¼Œå¯ä»¥åœ¨æŸ¥è¯¢æ—¶å¯¹å…¶è¿›è¡Œæ£€ç´¢ã€‚Singletonæ˜¯é»˜è®¤çš„ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„å¯¹è±¡æ¨¡å‹ã€‚å¯¹äºæ— çŠ¶æ€æœåŠ¡å¯¹è±¡å¾ˆç†æƒ³ã€‚ 2ï¼ŒåŸå‹ï¼šæ¨¡å‹ç¡®ä¿æ¯æ¬¡æ£€ç´¢éƒ½ä¼šåˆ›å»ºå•ç‹¬çš„å¯¹è±¡ã€‚åœ¨æ¯ä¸ªç”¨æˆ·éƒ½éœ€è¦è‡ªå·±çš„å¯¹è±¡æ—¶ï¼ŒåŸå‹æ¨¡å‹æœ€é€‚åˆã€‚ Beanå·¥å‚çš„æ¦‚å¿µæ˜¯Springä½œä¸ºIOCå®¹å™¨çš„åŸºç¡€ã€‚IOCåˆ™å°†å¤„ç†äº‹æƒ…çš„è´£ä»»ä»åº”ç”¨ç¨‹åºä»£ç è½¬ç§»åˆ°æ¡†æ¶ã€‚ AOPç¼–ç¨‹ç†å¿µé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå³AOPï¼Œæ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œå®ƒå…è®¸ç¨‹åºå‘˜å¯¹æ¨ªåˆ‡å…³æ³¨ç‚¹æˆ–æ¨ªåˆ‡å…¸å‹çš„èŒè´£åˆ†ç•Œçº¿çš„è¡Œä¸ºï¼ˆä¾‹å¦‚æ—¥å¿—å’Œäº‹åŠ¡ç®¡ç†ï¼‰è¿›è¡Œæ¨¡å—åŒ–ã€‚AOPçš„æ ¸å¿ƒæ„é€ æ˜¯æ–¹é¢ï¼ˆåˆ‡é¢ï¼‰ï¼Œå®ƒå°†é‚£äº›å½±å“å¤šä¸ªç±»çš„è¡Œä¸ºå°è£…åˆ°å¯é‡ç”¨çš„æ¨¡å—ä¸­ã€‚ AOPå’ŒIOCæ˜¯è¡¥å……æ€§çš„æŠ€æœ¯ï¼Œå®ƒä»¬éƒ½è¿ç”¨æ¨¡å—åŒ–æ–¹å¼è§£å†³ä¼ä¸šåº”ç”¨ç¨‹åºå¼€å‘ä¸­çš„å¤æ‚é—®é¢˜ã€‚åœ¨å…¸å‹çš„é¢å‘å¯¹è±¡å¼€å‘æ–¹å¼ä¸­ï¼Œå¯èƒ½è¦å°†æ—¥å¿—è®°å½•è¯­å¥æ”¾åœ¨æ‰€æœ‰æ–¹æ³•å’ŒJavaç±»ä¸­æ‰èƒ½å®ç°æ—¥å¿—åŠŸèƒ½ã€‚åœ¨AOPæ–¹å¼ä¸­ï¼Œå¯ä»¥åè¿‡æ¥å°†æ—¥å¿—æœåŠ¡æ¨¡å—åŒ–ï¼Œå¹¶ä»¥å£°æ˜çš„æ–¹å¼å°†å®ƒä»¬åº”ç”¨åˆ°éœ€è¦æ—¥å¿—çš„ç»„ä»¶ä¸Šã€‚å½“ç„¶ï¼Œä¼˜åŠ¿å°±æ˜¯Javaç±»ä¸éœ€è¦çŸ¥é“æ—¥å¿—æœåŠ¡çš„å­˜åœ¨ï¼Œä¹Ÿä¸éœ€è¦è€ƒè™‘ç›¸å…³çš„ä»£ç ã€‚æ‰€ä»¥ï¼Œç”¨SpringAOPç¼–å†™çš„åº”ç”¨ç¨‹åºä»£ç æ˜¯æ¾æ•£è€¦åˆçš„ã€‚ AOPçš„åŠŸèƒ½å®Œå…¨é›†æˆåˆ°äº†Springäº‹åŠ¡ç®¡ç†ã€æ—¥å¿—å’Œå…¶ä»–å„ç§ç‰¹æ€§çš„ä¸Šä¸‹æ–‡ä¸­ã€‚ AOPç¼–ç¨‹çš„å¸¸ç”¨åœºæ™¯æœ‰ï¼šAuthenticationæƒé™è®¤è¯ã€Loggingæ—¥å¿—ã€TransctionsManageräº‹åŠ¡ã€LazyLoadingæ‡’åŠ è½½ã€ContextProcessä¸Šä¸‹æ–‡å¤„ç†ã€ErrorHandleré”™è¯¯è·Ÿè¸ªï¼ˆå¼‚å¸¸æ•è·æœºåˆ¶ï¼‰ã€Cacheç¼“å­˜ã€‚ ç¼–ç¨‹æ€æƒ³æ€»ç»“ Springæ€æƒ³ åº”ç”¨åœºæ™¯ï¼ˆç‰¹ç‚¹ï¼‰ ä¸€å¥è¯å½’çº³ AOP AspectOrientedProgramming(é¢å‘åˆ‡é¢ç¼–ç¨‹) æ‰¾å‡ºå¤šä¸ªç±»ä¸­æœ‰ä¸€å®šè§„å¾‹çš„ä»£ç ï¼Œå¼€å‘æ—¶æ‹†å¼€ï¼Œè¿è¡Œæ—¶å†åˆå¹¶ã€‚ é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå³é¢å‘è§„åˆ™ç¼–ç¨‹ã€‚ è§£è€¦ï¼Œä¸“äººåšä¸“äº‹ã€‚ OOP ObjectOrientedProgrammingï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰ å½’çº³æ€»ç»“ç”Ÿæ´»ä¸­ä¸€åˆ‡äº‹ç‰©ã€‚ å°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€‚ BOP BeanOrientedProgrammingï¼ˆé¢å‘Beanç¼–ç¨‹ï¼‰ é¢å‘Beanï¼ˆæ™®é€šçš„javaç±»ï¼‰è®¾è®¡ç¨‹åºã€‚ ä¸€åˆ‡ä»Beanå¼€å§‹ã€‚ IOC InversionofControlï¼ˆæ§åˆ¶åè½¬ï¼‰ å°†newå¯¹è±¡çš„åŠ¨ä½œäº¤ç»™Springç®¡ç†ï¼Œå¹¶ç”±Springä¿å­˜å·²åˆ›å»ºçš„å¯¹è±¡ï¼ˆIOCå®¹å™¨ï¼‰ã€‚ è½¬äº¤æ§åˆ¶æƒï¼ˆå³æ§åˆ¶æƒåè½¬ï¼‰ã€‚ DI/DL DependencyInjectionï¼ˆä¾èµ–æ³¨å…¥ï¼‰æˆ–è€…DependencyLookupï¼ˆä¾èµ–æŸ¥æ‰¾ï¼‰ ä¾èµ–æ³¨å…¥ã€ä¾èµ–æŸ¥æ‰¾ï¼ŒSpringä¸ä»…ä¿å­˜è‡ªå·±åˆ›å»ºçš„å¯¹è±¡ï¼Œè€Œä¸”ä¿å­˜å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„å…³ç³»ã€‚ æ³¨å…¥å³èµ‹å€¼ï¼Œä¸»è¦ä¸‰ç§æ–¹å¼æ„é€ æ–¹æ³•ã€setæ–¹æ³•ã€ç›´æ¥èµ‹å€¼ã€‚ å…ˆç†æ¸…å…³ç³»å†èµ‹å€¼ã€‚ Springæ¶æ„è®¾è®¡Springæ€»å…±å¤§çº¦æœ‰20ä¸ªæ¨¡å—ï¼Œç”±1300å¤šä¸ªä¸åŒçš„æ–‡ä»¶æ„æˆã€‚è€Œè¿™äº›ç»„ä»¶è¢«åˆ†åˆ«æ•´åˆåœ¨æ ¸å¿ƒå®¹å™¨ï¼ˆCoreContainerï¼‰ã€AOPï¼ˆAspectOrientedProgrammingï¼‰å’Œè®¾å¤‡æ”¯æŒï¼ˆInstrmentationï¼‰ã€æ•°æ®è®¿é—®åŠé›†æˆï¼ˆDataAccess/Integerationï¼‰ã€Webã€æŠ¥æ–‡å‘é€ï¼ˆMessagingï¼‰ã€Testï¼Œ6ä¸ªæ¨¡å—é›†åˆä¸­ã€‚ä»¥ä¸‹æ˜¯springæ€»ä½“æ¶æ„å›¾å’ŒSpring5çš„æ¨¡å—ç»“æ„å›¾ï¼š ç»„æˆSpringæ¡†æ¶çš„æ¯ä¸ªæ¨¡å—é›†åˆæˆ–è€…æ¨¡å—éƒ½å¯ä»¥å•ç‹¬å­˜åœ¨ï¼Œä¹Ÿå¯ä»¥ä¸€ä¸ªæˆ–å¤šä¸ªæ¨¡å—è”åˆå®ç°ã€‚æ¯ä¸ªæ¨¡å—çš„ç»„æˆå’ŒåŠŸèƒ½å¦‚ä¸‹ï¼š 1.æ ¸å¿ƒå®¹å™¨ï¼šç”±spring-beansã€spring-coreã€spring-contextå’Œspring-expressionï¼ˆSpringExpressionLanguage,SpELï¼‰4ä¸ªæ¨¡å—ç»„æˆã€‚ spring-beanså’Œspring-coreæ¨¡å—æ˜¯Springæ¡†æ¶çš„æ ¸å¿ƒæ¨¡å—ï¼ŒåŒ…å«äº†æ§åˆ¶åè½¬ï¼ˆInversionofControl,IOCï¼‰å’Œä¾èµ–æ³¨å…¥ï¼ˆDependencyInjection,DIï¼‰ã€‚BeanFactoryæ¥å£æ˜¯Springæ¡†æ¶ä¸­çš„æ ¸å¿ƒæ¥å£ï¼Œå®ƒæ˜¯å·¥å‚æ¨¡å¼çš„å…·ä½“å®ç°ã€‚BeanFactoryä½¿ç”¨æ§åˆ¶åè½¬å¯¹åº”ç”¨ç¨‹åºçš„é…ç½®å’Œä¾èµ–æ€§è§„èŒƒä¸å®é™…çš„åº”ç”¨ç¨‹åºä»£ç è¿›è¡Œäº†åˆ†ç¦»ã€‚ä½†BeanFactoryå®¹å™¨å®ä¾‹åŒ–åå¹¶ä¸ä¼šè‡ªåŠ¨å®ä¾‹åŒ–Beanï¼Œåªæœ‰å½“Beanè¢«ä½¿ç”¨æ—¶BeanFactoryå®¹å™¨æ‰ä¼šå¯¹è¯¥Beanè¿›è¡Œå®ä¾‹åŒ–ä¸ä¾èµ–å…³ç³»çš„è£…é…ã€‚ spring-contextæ¨¡å—æ„æ¶äºæ ¸å¿ƒæ¨¡å—ä¹‹ä¸Šï¼Œä»–æ‰©å±•äº†BeanFactoryï¼Œä¸ºå¥¹æ·»åŠ äº†Beanç”Ÿå‘½å‘¨æœŸæ§åˆ¶ã€æ¡†æ¶äº‹ä»¶ä½“ç³»ä»¥åŠèµ„æºåŠ è½½é€æ˜åŒ–ç­‰åŠŸèƒ½ã€‚æ­¤å¤–è¯¥æ¨¡å—è¿˜æä¾›äº†è®¸å¤šä¼ä¸šçº§æ”¯æŒï¼Œå¦‚é‚®ä»¶è®¿é—®ã€è¿œç¨‹è®¿é—®ã€ä»»åŠ¡è°ƒåº¦ç­‰ï¼ŒApplicationContextæ˜¯è¯¥æ¨¡å—çš„æ ¸å¿ƒæ¥å£ï¼Œå¥¹æ˜¯BeanFactoryçš„è¶…ç±»ï¼Œä¸BeanFactoryä¸åŒï¼ŒApplicationContextå®¹å™¨å®ä¾‹åŒ–åä¼šè‡ªåŠ¨å¯¹æ‰€æœ‰çš„å•å®ä¾‹Beanè¿›è¡Œå®ä¾‹åŒ–ä¸ä¾èµ–å…³ç³»çš„è£…é…ï¼Œä½¿ä¹‹å¤„äºå¾…ç”¨çŠ¶æ€ã€‚ spring-expressionæ¨¡å—æ˜¯ç»Ÿä¸€è¡¨è¾¾å¼è¯­è¨€ï¼ˆELï¼‰çš„æ‰©å±•æ¨¡å—ï¼Œå¯ä»¥æŸ¥è¯¢ã€ç®¡ç†è¿è¡Œä¸­çš„å¯¹è±¡ï¼ŒåŒæ—¶ä¹Ÿæ–¹ä¾¿çš„å¯ä»¥è°ƒç”¨å¯¹è±¡æ–¹æ³•ã€æ“ä½œæ•°ç»„ã€é›†åˆç­‰ã€‚å®ƒçš„è¯­æ³•ç±»ä¼¼äºä¼ ç»ŸELï¼Œä½†æä¾›äº†é¢å¤–çš„åŠŸèƒ½ï¼Œæœ€å‡ºè‰²çš„è¦æ•°å‡½æ•°è°ƒç”¨å’Œç®€å•å­—ç¬¦ä¸²çš„æ¨¡æ¿å‡½æ•°ã€‚è¿™ç§è¯­è¨€çš„ç‰¹æ€§æ˜¯åŸºäºSpringäº§å“çš„éœ€æ±‚è€Œè®¾è®¡ï¼Œä»–å¯ä»¥éå¸¸æ–¹ä¾¿åœ°åŒSpringIOCè¿›è¡Œäº¤äº’ã€‚ 2.AOPå’Œè®¾å¤‡æ”¯æŒï¼šç”±spring-aopã€spring-aspectså’Œspring-instrument3ä¸ªæ¨¡å—ç»„æˆã€‚ spring-aopæ˜¯Springçš„å¦ä¸€ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œæ˜¯AOPä¸»è¦çš„å®ç°æ¨¡å—ã€‚ä½œä¸ºç»§OOPåï¼Œå¯¹ç¨‹åºå‘˜å½±å“æœ€å¤§çš„ç¼–ç¨‹æ€æƒ³ä¹‹ä¸€ï¼ŒAOPæå¤§åœ°å¼€æ‹“äº†äººä»¬å¯¹äºç¼–ç¨‹çš„æ€è·¯ã€‚åœ¨Springä¸­ï¼Œä»–æ˜¯ä»¥JVMçš„åŠ¨æ€ä»£ç†æŠ€æœ¯ä¸ºåŸºç¡€ï¼Œç„¶åè®¾è®¡å‡ºäº†ä¸€ç³»åˆ—çš„AOPæ¨ªåˆ‡å®ç°ï¼Œæ¯”å¦‚å‰ç½®é€šçŸ¥ã€è¿”å›é€šçŸ¥ã€å¼‚å¸¸é€šçŸ¥ç­‰ï¼ŒåŒæ—¶ï¼ŒPointcutæ¥å£æ¥åŒ¹é…åˆ‡å…¥ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨ç°æœ‰çš„åˆ‡å…¥ç‚¹æ¥è®¾è®¡æ¨ªåˆ‡é¢ï¼Œä¹Ÿå¯ä»¥æ‰©å±•ç›¸å…³æ–¹æ³•æ ¹æ®éœ€æ±‚è¿›è¡Œåˆ‡å…¥ã€‚ spring-aspectsæ¨¡å—é›†æˆè‡ªAspectJæ¡†æ¶ï¼Œä¸»è¦æ˜¯ä¸ºSpringAOPæä¾›å¤šç§AOPå®ç°æ–¹æ³•ã€‚ spring-instrumentæ¨¡å—æ˜¯åŸºäºJAVASEä¸­çš„â€java.lang.instrumentâ€è¿›è¡Œè®¾è®¡çš„ï¼Œåº”è¯¥ç®—æ˜¯AOPçš„ä¸€ä¸ªæ”¯æ´æ¨¡å—ï¼Œä¸»è¦ä½œç”¨æ˜¯åœ¨JVMå¯ç”¨æ—¶ï¼Œç”Ÿæˆä¸€ä¸ªä»£ç†ç±»ï¼Œç¨‹åºå‘˜é€šè¿‡ä»£ç†ç±»åœ¨è¿è¡Œæ—¶ä¿®æ”¹ç±»çš„å­—èŠ‚ï¼Œä»è€Œæ”¹å˜ä¸€ä¸ªç±»çš„åŠŸèƒ½ï¼Œå®ç°AOPçš„åŠŸèƒ½ã€‚åœ¨åˆ†ç±»é‡Œï¼Œæˆ‘æŠŠä»–åˆ†åœ¨äº†AOPæ¨¡å—ä¸‹ï¼Œåœ¨Springå®˜æ–¹æ–‡æ¡£é‡Œå¯¹è¿™ä¸ªåœ°æ–¹ä¹Ÿæœ‰ç‚¹å«ç³Šä¸æ¸…ï¼Œè¿™é‡Œæ˜¯çº¯ä¸ªäººè§‚ç‚¹ã€‚ 3.æ•°æ®è®¿é—®åŠé›†æˆï¼šç”±spring-jdbcã€spring-txã€spring-ormã€spring-jmså’Œspring-oxm5ä¸ªæ¨¡å—ç»„æˆã€‚ spring-jdbcæ¨¡å—æ˜¯Springæä¾›çš„JDBCæŠ½è±¡æ¡†æ¶çš„ä¸»è¦å®ç°æ¨¡å—ï¼Œç”¨äºç®€åŒ–SpringJDBCã€‚ä¸»è¦æ˜¯æä¾›JDBCæ¨¡æ¿æ–¹å¼ã€å…³ç³»æ•°æ®åº“å¯¹è±¡åŒ–æ–¹å¼ã€SimpleJdbcæ–¹å¼ã€äº‹åŠ¡ç®¡ç†æ¥ç®€åŒ–JDBCç¼–ç¨‹ï¼Œä¸»è¦å®ç°ç±»æ˜¯JdbcTemplateã€SimpleJdbcTemplateä»¥åŠNamedParameterJdbcTemplateã€‚ spring-txæ¨¡å—æ˜¯SpringJDBCäº‹åŠ¡æ§åˆ¶å®ç°æ¨¡å—ã€‚ä½¿ç”¨Springæ¡†æ¶ï¼Œå®ƒå¯¹äº‹åŠ¡åšäº†å¾ˆå¥½çš„å°è£…ï¼Œé€šè¿‡å®ƒçš„AOPé…ç½®ï¼Œå¯ä»¥çµæ´»çš„é…ç½®åœ¨ä»»ä½•ä¸€å±‚ï¼›ä½†æ˜¯åœ¨å¾ˆå¤šçš„éœ€æ±‚å’Œåº”ç”¨ï¼Œç›´æ¥ä½¿ç”¨JDBCäº‹åŠ¡æ§åˆ¶è¿˜æ˜¯æœ‰å…¶ä¼˜åŠ¿çš„ã€‚å…¶å®ï¼Œäº‹åŠ¡æ˜¯ä»¥ä¸šåŠ¡é€»è¾‘ä¸ºåŸºç¡€çš„ï¼›ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡åº”è¯¥å¯¹åº”ä¸šåŠ¡å±‚é‡Œçš„ä¸€ä¸ªæ–¹æ³•ï¼›å¦‚æœä¸šåŠ¡æ“ä½œå¤±è´¥ï¼Œåˆ™æ•´ä¸ªäº‹åŠ¡å›æ»šï¼›æ‰€ä»¥ï¼Œäº‹åŠ¡æ§åˆ¶æ˜¯ç»å¯¹åº”è¯¥æ”¾åœ¨ä¸šåŠ¡å±‚çš„ï¼›ä½†æ˜¯ï¼ŒæŒä¹…å±‚çš„è®¾è®¡åˆ™åº”è¯¥éµå¾ªä¸€ä¸ªå¾ˆé‡è¦çš„åŸåˆ™ï¼šä¿è¯æ“ä½œçš„åŸå­æ€§ï¼Œå³æŒä¹…å±‚é‡Œçš„æ¯ä¸ªæ–¹æ³•éƒ½åº”è¯¥æ˜¯ä¸å¯ä»¥åˆ†å‰²çš„ã€‚æ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨SpringJDBCäº‹åŠ¡æ§åˆ¶æ—¶ï¼Œåº”è¯¥æ³¨æ„å…¶ç‰¹æ®Šæ€§ã€‚ spring-ormæ¨¡å—æ˜¯ORMæ¡†æ¶æ”¯æŒæ¨¡å—ï¼Œä¸»è¦é›†æˆHibernate,JavaPersistenceAPI(JPA)å’ŒJavaDataObjects(JDO)ç”¨äºèµ„æºç®¡ç†ã€æ•°æ®è®¿é—®å¯¹è±¡(DAO)çš„å®ç°å’Œäº‹åŠ¡ç­–ç•¥ã€‚ spring-jmsæ¨¡å—ï¼ˆJavaMessagingServiceï¼‰èƒ½å¤Ÿå‘é€å’Œæ¥å—ä¿¡æ¯ï¼Œè‡ªSpringFramework4.1ä»¥åï¼Œä»–è¿˜æä¾›äº†å¯¹spring-messagingæ¨¡å—çš„æ”¯æ’‘ã€‚ spring-oxmæ¨¡å—ä¸»è¦æä¾›ä¸€ä¸ªæŠ½è±¡å±‚ä»¥æ”¯æ’‘OXMï¼ˆOXMæ˜¯Object-to-XML-Mappingçš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ä¸ªO/M-mapperï¼Œå°†javaå¯¹è±¡æ˜ å°„æˆXMLæ•°æ®ï¼Œæˆ–è€…å°†XMLæ•°æ®æ˜ å°„æˆjavaå¯¹è±¡ï¼‰ï¼Œä¾‹å¦‚ï¼šJAXB,Castor,XMLBeans,JiBXå’ŒXStreamç­‰ã€‚ 4.Webï¼šç”±spring-webã€spring-webmvcã€spring-websocketå’Œspring-webflux4ä¸ªæ¨¡å—ç»„æˆã€‚ spring-webæ¨¡å—ä¸ºSpringæä¾›äº†æœ€åŸºç¡€Webæ”¯æŒï¼Œä¸»è¦å»ºç«‹äºæ ¸å¿ƒå®¹å™¨ä¹‹ä¸Šï¼Œé€šè¿‡Servletæˆ–è€…Listenersæ¥åˆå§‹åŒ–IOCå®¹å™¨ï¼Œä¹ŸåŒ…å«ä¸€äº›ä¸Webç›¸å…³çš„æ”¯æŒã€‚ spring-webmvcæ¨¡å—ä¼—æ‰€å‘¨çŸ¥æ˜¯ä¸€ä¸ªçš„Web-Servletæ¨¡å—ï¼Œå®ç°äº†SpringMVCï¼ˆmodel-view-Controllerï¼‰çš„Webåº”ç”¨ã€‚ spring-websocketæ¨¡å—ä¸»è¦æ˜¯ä¸Webå‰ç«¯çš„å…¨åŒå·¥é€šè®¯çš„åè®®ã€‚ï¼ˆèµ„æ–™ç¼ºä¹ï¼Œè¿™æ˜¯ä¸ªäººç†è§£ï¼‰ spring-webfluxæ˜¯ä¸€ä¸ªæ–°çš„éå µå¡å‡½æ•°å¼ReactiveWebæ¡†æ¶ï¼Œå¯ä»¥ç”¨æ¥å»ºç«‹å¼‚æ­¥çš„ï¼Œéé˜»å¡ï¼Œäº‹ä»¶é©±åŠ¨çš„æœåŠ¡ï¼Œå¹¶ä¸”æ‰©å±•æ€§éå¸¸å¥½ã€‚ 5.æŠ¥æ–‡å‘é€ï¼šå³spring-messagingæ¨¡å—ã€‚ spring-messagingæ˜¯ä»Spring4å¼€å§‹æ–°åŠ å…¥çš„ä¸€ä¸ªæ¨¡å—ï¼Œä¸»è¦èŒè´£æ˜¯ä¸ºSpringæ¡†æ¶é›†æˆä¸€äº›åŸºç¡€çš„æŠ¥æ–‡ä¼ é€åº”ç”¨ã€‚ 6.Testï¼šå³spring-testæ¨¡å—ã€‚ spring-testæ¨¡å—ä¸»è¦ä¸ºæµ‹è¯•æä¾›æ”¯æŒçš„ï¼Œæ¯•ç«Ÿåœ¨ä¸éœ€è¦å‘å¸ƒï¼ˆç¨‹åºï¼‰åˆ°ä½ çš„åº”ç”¨æœåŠ¡å™¨æˆ–è€…è¿æ¥åˆ°å…¶ä»–ä¼ä¸šè®¾æ–½çš„æƒ…å†µä¸‹èƒ½å¤Ÿæ‰§è¡Œä¸€äº›é›†æˆæµ‹è¯•æˆ–è€…å…¶ä»–æµ‹è¯•å¯¹äºä»»ä½•ä¼ä¸šéƒ½æ˜¯éå¸¸é‡è¦çš„ã€‚ Spirngå„æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»è¯¥å›¾æ˜¯Spring5çš„åŒ…ç»“æ„ï¼Œå¯ä»¥ä»ä¸­æ¸…æ¥šçœ‹å‡ºSpringå„ä¸ªæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚ æœªå®Œå¾…ç»­è¿™æ˜¯9æœˆä»½å†™çš„ï¼Œå¤§éƒ¨åˆ†æ˜¯å¤åˆ¶çš„ï¼Œå› ä¸ºé¢è¯•æ²¡æœ‰å†™å®Œï¼Œæ‰€ä»¥æœªå®Œå¾…ç»­å§ï¼ æ¥ä¸‹æ¥å’±ä»¬ä»‹ç»Springçš„è¿™ä¸ªåšå®¢ï¼Œæ˜¯ä»spring-coreå¼€å§‹ï¼Œå…¶æ¬¡æ˜¯spring-beanså’Œspring-aopï¼Œéšåæ˜¯spring-contextï¼Œå†å…¶æ¬¡æ˜¯spring-txå’Œspring-ormï¼Œæœ€åæ˜¯spring-webå’Œå…¶ä»–éƒ¨åˆ†ã€‚ æ„Ÿè°¢è§‚çœ‹ å‚è€ƒèµ„æ–™å¤§éƒ¨åˆ†æ¥è‡ªå’•æ³¡å­¦é™¢TOMè€å¸ˆçš„ææ–™]]></content>
      <tags>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¹¶å‘åŸºç¡€-ç¼“å­˜ã€å†…å­˜ä¸JVM]]></title>
    <url>%2F2018%2F09%2F30%2FJava%E4%B8%8E%E5%86%85%E5%AD%98%2F</url>
    <content type="text"><![CDATA[åˆæ˜¯ä¸€å¹´ç§‹æ‹›å­£ï¼Œå“å‘€å¦ˆå‘€æˆ‘è¢«è™çš„æƒ¨æ¥~è¿™ä¸ï¼Œå‰å‡ é˜µå¤±è¸ªæ²¡æ›´æ–°åšå®¢ï¼Œå…¶å®æ˜¯æˆ‘å·å·æŠŠæ—¶é—´ç”¨åœ¨å¤ä¹ è¯¾æœ¬äº†ï¼ˆé›¾ åšæŒåœ¨ç¤¾åŒºåˆ†äº«åšå®¢ä¹Ÿå¾ˆä¹…äº†ï¼Œç”±äºè¿‡å»çš„æ–‡ç« æœ‰å¾ˆå¤šç–æ¼ä¹‹å¤„ï¼Œå¾ˆå¤šå¤§ä½¬éƒ½åœ¨è¯„è®ºæŒ‡å‡ºæˆ‘çš„è¿‡é”™ï¼Œæˆ‘å¾ˆå¼€å¿ƒä¹Ÿå¾ˆå¤±æœ›ï¼Œå¼€å¿ƒçš„æ˜¯æœ‰å¤§å®¶å¸®æˆ‘æŒ‡å‡ºé”™è¯¯ï¼Œå¤±æœ›çš„é„™äººå­¦è¯†æµ…è–„æ€»æ²¡æ³•åšåˆ°å®Œç¾ã€‚æ€»ä¹‹ï¼Œæ¬¢è¿è¯„è®ºåŒºå„ç§pr~ å¥½ï¼Œå›åˆ°æ­£é¢˜ã€‚å¤ä¹ çš„æ—¶å€™ï¼Œæ— æ„é—´çœ‹åˆ°javaè™šæ‹Ÿæœºçš„æœ‰å…³çŸ¥è¯†ç‚¹ï¼Œæˆ‘äº§ç”Ÿäº†éå¸¸æµ“åšçš„å…´è¶£ï¼Œä»Šå¤©æˆ‘æ¥ç»“åˆè®¡ç®—æœºå†…å­˜æ¨¡å‹çš„ç›¸å…³çŸ¥è¯†ï¼Œä¸Javaå†…å­˜æ¨¡å‹ã€Javaå¯¹è±¡æ¨¡å‹ã€JVMå†…å­˜ç»“æ„ç­‰ç›¸å…³çš„çŸ¥è¯†ä¸²è”èµ·æ¥ï¼Œæœ¬ç¯‡æ–‡ç« å…±1.5Wå­—ï¼Œåˆ†äº«ç»™å¤§å®¶ï¼Œæ„Ÿè°¢é˜…è¯»ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢https://blog.tengshe789.tech/ï¼ˆğŸ˜˜ è®¡ç®—æœºå†…å­˜ç›¸ä¿¡æ¯ä¸ªäººéƒ½æœ‰ä¸€å°ç”µè„‘ï¼Œä¹Ÿæœ‰diyç”µè„‘çš„ç»å†ã€‚ç°åœ¨ä¸€å°åŠŸèƒ½å¼ºå¤§çš„diyç”µè„‘å¤§æ¦‚3kå°±èƒ½ç»„è£…èµ·æ¥ï¼Œä¸€ä¸ªi5-8400 çš„cpu 869å…ƒï¼ŒDDR4 å†…å­˜ 1200å—é’±ï¼Œb360ä¸»æ¿300å…ƒ æ•£çƒ­å™¨50å…ƒ æœºæ¢°ç¡¬ç›˜200å…ƒ 350wç”µæº300å…ƒ æœºç®±100å…ƒ ï¼Œæ²¡é”™ï¼Œåªè¦3kå°±èƒ½æ‹¿åˆ°ä¸€ä¸ªæ€§èƒ½å¼ºå¤§çš„6C6Tç”µè„‘ã€‚ è¦è¯´ä¸€å°PCä¸­æœ€é‡è¦çš„éƒ¨ä»¶æ˜¯ä»€ä¹ˆï¼Ÿå¤§å®¶çœ‹ä»·æ ¼ä¹Ÿä¼šçœ‹æ˜ç™½ï¼Œæ˜¯cpuå’Œå†…å­˜ï¼Œä¸‹é¢æˆ‘æ¥ä»‹ç»ä¸€ä¸‹cpuå’Œå†…å­˜ä¹‹é—´çš„å…³ç³»ã€‚ cpuä¸å†…å­˜ç¼“å­˜çš„åƒä¸ä¸‡ç¼•cpuç›¸å…³æœ¯è¯­é¦–å…ˆè¯´æ˜ä¸€ä¸‹ç›¸å…³çš„cpuæœ¯è¯­ï¼š socketï¼šcpuæ’åœ¨ä¸»æ¿ä¸Šé‚£ä¸ªæ§½ä¸cpuç§°ä½œä¸€ä¸ªsocketã€‚ Dieï¼šæ ¸å¿ƒï¼ˆDieï¼‰åˆç§°ä¸ºå†…æ ¸ï¼Œæ˜¯cpuçš„ç‰©ç†ç»„æˆéƒ¨åˆ†ä¹‹ä¸€ã€‚cpuä¹Ÿä¼šåˆ†ä¸ºå¤šdie cpuä¸å•die cpuï¼Œè­¬å¦‚æˆ‘ä»¬ç°åœ¨å¼ºå¤§çš„AMD TR-2990WXå°±æ˜¯4die cpuï¼Œæ¯ä¸ªdieé‡Œé¢æœ‰8ä¸ªæ ¸å¿ƒï¼ˆcoreï¼‰ coreï¼šä¹Ÿå°±æ˜¯ç‰©ç†æ ¸å¿ƒäº†ã€‚coreè¿™ä¸ªè¯æ˜¯è‹±ç‰¹å°”èµ·çš„ï¼Œèµ·åˆæ˜¯ä¸ºäº†ä¸ç«äº‰å¯¹æ‰‹AMDåŒºåˆ«å¼€ï¼Œåé¢ç”¨çš„å¤šäº†ä¹Ÿæ·¡äº†ã€‚ threadï¼šå°±æ˜¯ç¡¬ä»¶çº¿ç¨‹æ•°ã€‚ä¸€ä¸ªç¨‹åºæ‰§è¡Œå¯èƒ½éœ€è¦å¤šä¸ªçº¿ç¨‹ä¸€èµ·è¿›è¡Œ~è€Œç°åœ¨ä¹Ÿå°±æ¯”è¾ƒå¼ºå¤§çš„è¶…çº¿ç¨‹æŠ€æœ¯ï¼Œè¿‡å»çš„cpuå¾€å¾€ä¸€ä¸ªcpuæ ¸å¿ƒåªæ”¯æŒä¸€ä¸ªçº¿ç¨‹ï¼Œç°åœ¨ä¸€äº›å¼ºå¤§çš„cpuä¸­ï¼Œå°±è­¬å¦‚IBM çš„POWER 9 ï¼Œæ”¯æŒ8æ ¸å¿ƒ32ä¸ªçº¿ç¨‹ï¼ˆå¹³å‡ä¸€ä¸ªæ ¸å¿ƒ4ä¸ªçº¿ç¨‹ï¼‰ï¼Œç†è®ºæ€§èƒ½éå¸¸å¼ºå¤§ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œä»¥æ˜æ˜Ÿcpu AMD TR-2990WXä½œä¸ºæ —å­ï¼Œè¿™ä¸ªcpuä½¿ç”¨ä¸€ä¸ªsocketï¼Œä¸€ä¸ªsocketé‡Œé¢æœ‰4ä¸ªdieï¼Œæ€»å…±32ä¸ªç‰©ç†æ ¸å¿ƒ64ä¸ªçº¿ç¨‹ cpuç¼“å­˜æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œcpuå°†è¦å¤„ç†çš„æ•°æ®ä¼šæ”¾åˆ°å†…å­˜ä¸­ä¿å­˜ï¼Œå¯æ˜¯ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Œå°†å†…å­˜ç¼“å­˜ç¡¬ç›˜è¡Œä¸è¡Œå‘¢ï¼Ÿ ç­”æ¡ˆå½“ç„¶æ˜¯ä¸è¡Œçš„ã€‚cpuçš„å¤„ç†é€Ÿåº¦å¾ˆå¼ºå¤§ï¼Œå†…å­˜çš„é€Ÿåº¦è™½ç„¶éå¸¸å¿«é€Ÿä½†æ˜¯æ ¹æœ¬è·Ÿä¸ä¸Šcpuçš„æ­¥ä¼ï¼Œæ‰€ä»¥ï¼Œå°±å‡ºç°çš„ç¼“å­˜ã€‚ä¸æ¥è‡ªDRAMå®¶æ—çš„å†…å­˜ä¸åŒï¼Œç¼“å­˜SRAMä¸å†…å­˜æœ€å¤§çš„ç‰¹ç‚¹æ˜¯ï¼Œç‰¹åˆ«å¿«ï¼Œå®¹é‡å°ï¼Œç»“æ„å¤æ‚ï¼Œæˆæœ¬ä¹Ÿé«˜ã€‚ é€ æˆå†…å­˜å’Œç¼“å­˜æ€§èƒ½å·®å¼‚ï¼Œä¸»è¦æœ‰ä»¥ä¸‹åŸå› ï¼š DRAMå‚¨å­˜ä¸€ä½æ•°æ®åªéœ€è¦ä¸€ä¸ªç”µå®¹åŠ ä¸Šä¸€ä¸ªæ™¶ä½“ç®¡ï¼Œè€ŒSRAMéœ€è¦6ä¸ªæ™¶ä½“ç®¡ã€‚ç”±äºDRAMä¿å­˜æ•°æ®å…¶å®æ˜¯åœ¨ç”µå®¹é‡Œé¢çš„ï¼Œç”µå®¹éœ€è¦å……æ”¾ç”µæ‰èƒ½è¿›è¡Œè¯»å†™æ“ä½œï¼Œè¿™å°±å¯¼è‡´å…¶è¯»å†™æ•°æ®å°±æœ‰æ¯”è¾ƒå¤§çš„å»¶è¿Ÿé—®é¢˜ã€‚ å­˜å‚¨å¯ä»¥çœ‹é”™ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œæ¯ä¸ªå­˜å‚¨å•å…ƒéƒ½æœ‰å…¶è¡Œåœ°å€åˆ—åœ°å€ã€‚SRAMçš„å®¹é‡å¾ˆå°ï¼Œå…¶å­˜å‚¨å•å…ƒæ¯”è¾ƒçŸ­ï¼ˆè¡Œåˆ—çŸ­ï¼‰ï¼Œå¯ä»¥ä¸€æ¬¡æ€§ä¼ è¾“åˆ°SRAMä¸­ï¼›è€ŒDRAMï¼Œéœ€è¦åˆ†åˆ«ä¼ é€è¡Œåˆ—åœ°å€ã€‚ SRAMçš„é¢‘ç‡å’Œcpué¢‘ç‡æ¯”è¾ƒæ¥è¿‘ï¼›è€ŒDRAMçš„é¢‘ç‡å’Œcpuå·®è·æ¯”è¾ƒå¤§ã€‚ è¿‘ä»£çš„ç¼“å­˜é€šå¸¸è¢«é›†æˆåˆ°cpuå½“ä¸­ï¼Œä¸ºäº†é€‚åº”æ€§èƒ½ä¸æˆæœ¬çš„éœ€è¦ï¼Œç°å®ä¸­çš„ç¼“å­˜å¾€å¾€ä½¿ç”¨é‡‘å­—å¡”å‹å¤šçº§ç¼“å­˜æ¶æ„ã€‚ä¹Ÿå°±æ˜¯å½“CPUè¦è¯»å–ä¸€ä¸ªæ•°æ®æ—¶ï¼Œé¦–å…ˆä»ä¸€çº§ç¼“å­˜ä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å†ä»äºŒçº§ç¼“å­˜ä¸­æŸ¥æ‰¾ï¼Œå¦‚æœè¿˜æ˜¯æ²¡æœ‰å°±ä»ä¸‰çº§ç¼“å­˜æˆ–å†…å­˜ä¸­æŸ¥æ‰¾ã€‚ ä¸‹é¢æ˜¯è‹±ç‰¹å°”æœ€è¿‘ä»¥æ¥ç”¨çš„åˆä»£skylakeæ¶æ„ å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªä¸ªæ ¸å¿ƒæœ‰ä¸“å±çš„L1ï¼ŒL2ç¼“å­˜ï¼Œä»–ä»¬å…±äº«ä¸€ä¸ªL3ç¼“å­˜ã€‚å¦‚æœcpuå¦‚æœè¦è®¿é—®å†…å­˜ä¸­çš„æ•°æ®ï¼Œå¿…é¡»è¦ç»è¿‡L1,L2,L3,LLCï¼ˆæˆ–è€…L4ï¼‰å››å±‚ç¼“å­˜ã€‚ ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜æœ€å¼€å§‹çš„cpuï¼Œå…¶å®åªæ˜¯ä¸€ä¸ªæ ¸å¿ƒä¸€ä¸ªçº¿ç¨‹çš„ï¼Œå½“æ—¶æ ¹æœ¬ä¸éœ€è¦è€ƒè™‘ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ï¼Œå•çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯cpuæ ¸å¿ƒçš„ç¼“å­˜åªè¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®ã€‚ç¼“å­˜ç‹¬å ï¼Œä¸ä¼šå‡ºç°è®¿é—®å†²çªç­‰é—®é¢˜ã€‚ åæ¥è¶…çº¿ç¨‹æŠ€æœ¯æ¥åˆ°æˆ‘ä»¬è§†é‡ï¼Œâ€˜â€™å•æ ¸CPUå¤šçº¿ç¨‹â€™â€™ï¼Œä¹Ÿå°±æ˜¯è¿›ç¨‹ä¸­çš„å¤šä¸ªçº¿ç¨‹ä¼šåŒæ—¶è®¿é—®è¿›ç¨‹ä¸­çš„å…±äº«æ•°æ®ï¼ŒCPUå°†æŸå—å†…å­˜åŠ è½½åˆ°ç¼“å­˜åï¼Œä¸åŒçº¿ç¨‹åœ¨è®¿é—®ç›¸åŒçš„ç‰©ç†åœ°å€çš„æ—¶å€™ï¼Œéƒ½ä¼šæ˜ å°„åˆ°ç›¸åŒçš„ç¼“å­˜ä½ç½®ï¼Œè¿™æ ·å³ä½¿å‘ç”Ÿçº¿ç¨‹çš„åˆ‡æ¢ï¼Œç¼“å­˜ä»ç„¶ä¸ä¼šå¤±æ•ˆã€‚ä½†ç”±äºä»»ä½•æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œï¼Œå› æ­¤ä¸ä¼šå‡ºç°ç¼“å­˜è®¿é—®å†²çªã€‚ æ—¶ä»£ä¸æ–­å‘å±•ï¼Œâ€œå¤šæ ¸CPUå¤šçº¿ç¨‹â€æ¥äº†ï¼Œå³å¤šä¸ªçº¿ç¨‹è®¿é—®è¿›ç¨‹ä¸­çš„æŸä¸ªå…±äº«å†…å­˜ï¼Œä¸”è¿™å¤šä¸ªçº¿ç¨‹åˆ†åˆ«åœ¨ä¸åŒçš„æ ¸å¿ƒä¸Šæ‰§è¡Œï¼Œåˆ™æ¯ä¸ªæ ¸å¿ƒéƒ½ä¼šåœ¨å„è‡ªçš„caeheä¸­ä¿ç•™ä¸€ä»½å…±äº«å†…å­˜çš„ç¼“å†²ã€‚ç”±äºå¤šæ ¸æ˜¯å¯ä»¥å¹¶è¡Œçš„ï¼Œå¯èƒ½ä¼šå‡ºç°å¤šä¸ªçº¿ç¨‹åŒæ—¶å†™å„è‡ªçš„ç¼“å­˜çš„æƒ…å†µï¼Œè€Œå„è‡ªçš„cacheä¹‹é—´çš„æ•°æ®å°±æœ‰å¯èƒ½ä¸åŒã€‚ è¿™å°±æ˜¯æˆ‘ä»¬è¯´çš„ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ã€‚ ç›®å‰å…¬è®¤æœ€å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯è‹±ç‰¹å°”çš„MESIåè®®ï¼Œä¸‹é¢æˆ‘ä»¬ç€é‡ä»‹ç»ã€‚ MESIåè®®é¦–å…ˆè¯´è¯´I/Oæ“ä½œçš„å•ä½é—®é¢˜ï¼Œå¤§éƒ¨åˆ†äººéƒ½çŸ¥é“ï¼Œåœ¨å†…å­˜ä¸­æ“ä½œI/Oä¸æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œè€Œæ˜¯ä»¥â€œå—â€ä¸ºå•ä½ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ å…¶å®è¿™æ˜¯å› ä¸ºI/Oæ“ä½œçš„æ•°æ®è®¿é—®æœ‰ç©ºé—´è¿ç»­æ€§ç‰¹å¾ï¼Œå³éœ€è¦è®¿é—®å†…å­˜ç©ºé—´å¾ˆå¤šæ•°æ®ï¼Œä½†æ˜¯I/Oæ“ä½œæ¯”è¾ƒæ…¢ï¼Œè¯»ä¸€ä¸ªå­—èŠ‚å’Œè¯»Nä¸ªå­—èŠ‚çš„æ—¶é—´åŸºæœ¬ç›¸åŒã€‚ æœºæ™ºçš„intelå°±è§„å®šäº†ï¼Œcpuç¼“å­˜ä¸­æœ€å°çš„å­˜å‚¨å•å…ƒæ˜¯ç¼“å­˜è¡Œcache lineï¼Œåœ¨x86çš„cpuä¸­ï¼Œä¸€ä¸ªcache lineå‚¨å­˜64å­—èŠ‚ï¼Œæ¯ä¸€çº§çš„ç¼“å­˜éƒ½ä¼šè¢«åˆ’åˆ†æˆè®¸å¤šç»„cache lineã€‚ ç¼“å­˜å·¥ä½œåŸç†è¯·çœ‹ğŸ‘‰ç»´åŸºç™¾ç§‘ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹MESIè§„èŒƒï¼Œè¿™å…¶å®æ˜¯ç”¨å››ç§ç¼“å­˜è¡ŒçŠ¶æ€å‘½åçš„ï¼Œæˆ‘ä»¬å®šä¹‰äº†CPUä¸­æ¯ä¸ªç¼“å­˜è¡Œä½¿ç”¨4ç§çŠ¶æ€è¿›è¡Œæ ‡è®°ï¼ˆä½¿ç”¨é¢å¤–çš„ä¸¤ä½(bit)è¡¨ç¤º)ï¼Œåˆ†åˆ«æ˜¯: M: è¢«ä¿®æ”¹ï¼ˆModified) è¯¥ç¼“å­˜è¡Œåªè¢«ç¼“å­˜åœ¨è¯¥CPUçš„ç¼“å­˜ä¸­ï¼Œå¹¶ä¸”æ˜¯è¢«ä¿®æ”¹è¿‡çš„ï¼ˆdirty),å³ä¸ä¸»å­˜ä¸­çš„æ•°æ®ä¸ä¸€è‡´ï¼Œè¯¥ç¼“å­˜è¡Œä¸­çš„å†…å­˜éœ€è¦åœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´ç‚¹ï¼ˆå…è®¸å…¶å®ƒCPUè¯»å–è¯·ä¸»å­˜ä¸­ç›¸åº”å†…å­˜ä¹‹å‰ï¼‰å†™å›ï¼ˆwrite backï¼‰ä¸»å­˜ã€‚å½“è¢«å†™å›ä¸»å­˜ä¹‹åï¼Œè¯¥ç¼“å­˜è¡Œçš„çŠ¶æ€ä¼šå˜æˆç‹¬äº«ï¼ˆexclusive)çŠ¶æ€ã€‚ E: ç‹¬äº«çš„ï¼ˆExclusive) è¯¥ç¼“å­˜è¡Œåªè¢«ç¼“å­˜åœ¨è¯¥CPUçš„ç¼“å­˜ä¸­ï¼Œå®ƒæ˜¯æœªè¢«ä¿®æ”¹è¿‡çš„ï¼ˆclean)ï¼Œä¸ä¸»å­˜ä¸­æ•°æ®ä¸€è‡´ã€‚è¯¥çŠ¶æ€å¯ä»¥åœ¨ä»»ä½•æ—¶åˆ»å½“æœ‰å…¶å®ƒCPUè¯»å–è¯¥å†…å­˜æ—¶å˜æˆå…±äº«çŠ¶æ€ï¼ˆshared)ã€‚åŒæ ·åœ°ï¼Œå½“CPUä¿®æ”¹è¯¥ç¼“å­˜è¡Œä¸­å†…å®¹æ—¶ï¼Œè¯¥çŠ¶æ€å¯ä»¥å˜æˆModifiedçŠ¶æ€ã€‚ S: å…±äº«çš„ï¼ˆShared) è¯¥çŠ¶æ€æ„å‘³ç€è¯¥ç¼“å­˜è¡Œå¯èƒ½è¢«å¤šä¸ªCPUç¼“å­˜ï¼Œå¹¶ä¸”å„ä¸ªç¼“å­˜ä¸­çš„æ•°æ®ä¸ä¸»å­˜æ•°æ®ä¸€è‡´ï¼ˆclean)ï¼Œå½“æœ‰ä¸€ä¸ªCPUä¿®æ”¹è¯¥ç¼“å­˜è¡Œä¸­ï¼Œå…¶å®ƒCPUä¸­è¯¥ç¼“å­˜è¡Œå¯ä»¥è¢«ä½œåºŸï¼ˆå˜æˆæ— æ•ˆçŠ¶æ€ï¼ˆInvalidï¼‰ï¼‰ã€‚ I: æ— æ•ˆçš„ï¼ˆInvalidï¼‰ è¯¥ç¼“å­˜æ˜¯æ— æ•ˆçš„ï¼ˆå¯èƒ½æœ‰å…¶å®ƒCPUä¿®æ”¹äº†è¯¥ç¼“å­˜è¡Œï¼‰ã€‚ ç„¶è€Œï¼Œåªæ˜¯æœ‰è¿™å››ç§çŠ¶æ€ä¹Ÿä¼šå¸¦æ¥ä¸€å®šçš„é—®é¢˜ã€‚ä¸‹é¢å¼•ç”¨ä¸€ä¸‹oracleçš„æ–‡æ¡£ã€‚ åŒæ—¶æ›´æ–°æ¥è‡ªä¸åŒå¤„ç†å™¨çš„ç›¸åŒç¼“å­˜ä»£ç è¡Œä¸­çš„å•ä¸ªå…ƒç´ ä¼šä½¿æ•´ä¸ªç¼“å­˜ä»£ç è¡Œæ— æ•ˆï¼Œå³ä½¿è¿™äº›æ›´æ–°åœ¨é€»è¾‘ä¸Šæ˜¯å½¼æ­¤ç‹¬ç«‹çš„ã€‚æ¯æ¬¡å¯¹ç¼“å­˜ä»£ç è¡Œçš„å•ä¸ªå…ƒç´ è¿›è¡Œæ›´æ–°æ—¶ï¼Œéƒ½ä¼šå°†æ­¤ä»£ç è¡Œæ ‡è®°ä¸ºæ— æ•ˆã€‚å…¶ä»–è®¿é—®åŒä¸€ä»£ç è¡Œä¸­ä¸åŒå…ƒç´ çš„å¤„ç†å™¨å°†çœ‹åˆ°è¯¥ä»£ç è¡Œå·²æ ‡è®°ä¸ºæ— æ•ˆã€‚å³ä½¿æ‰€è®¿é—®çš„å…ƒç´ æœªè¢«ä¿®æ”¹ï¼Œä¹Ÿä¼šå¼ºåˆ¶å®ƒä»¬ä»å†…å­˜æˆ–å…¶ä»–ä½ç½®è·å–è¯¥ä»£ç è¡Œçš„è¾ƒæ–°å‰¯æœ¬ã€‚è¿™æ˜¯å› ä¸ºåŸºäºç¼“å­˜ä»£ç è¡Œä¿æŒç¼“å­˜ä¸€è‡´æ€§ï¼Œè€Œä¸æ˜¯é’ˆå¯¹å•ä¸ªå…ƒç´ çš„ã€‚å› æ­¤ï¼Œäº’è¿é€šä¿¡å’Œå¼€é”€æ–¹é¢éƒ½å°†æœ‰æ‰€å¢é•¿ã€‚å¹¶ä¸”ï¼Œæ­£åœ¨è¿›è¡Œç¼“å­˜ä»£ç è¡Œæ›´æ–°çš„æ—¶å€™ï¼Œç¦æ­¢è®¿é—®è¯¥ä»£ç è¡Œä¸­çš„å…ƒç´ ã€‚ MESIåè®®ï¼Œå¯ä»¥ä¿è¯ç¼“å­˜çš„ä¸€è‡´æ€§ï¼Œä½†æ˜¯æ— æ³•ä¿è¯å®æ—¶æ€§ã€‚è¿™ç§æƒ…å†µç§°ä¸ºä¼ªå…±äº«ã€‚ ä¼ªå…±äº«é—®é¢˜ä¼ªå…±äº«é—®é¢˜å…¶å®åœ¨Javaä¸­æ˜¯çœŸå®å­˜åœ¨çš„ä¸€ä¸ªé—®é¢˜ã€‚å‡è®¾æœ‰å¦‚ä¸‹æ‰€ç¤ºçš„java class 12345class MyObiect&#123; long a; long b; long c;&#125; æŒ‰ç…§javaè§„èŒƒï¼ŒMyObiectå¯¹è±¡æ˜¯åœ¨å †ç©ºé—´ä¸­åˆ†é…çš„ï¼Œaã€bã€cè¿™ä¸‰ä¸ªå˜é‡åœ¨å†…å­˜ç©ºé—´ä¸­æ˜¯è¿‘é‚»ï¼Œåˆ†åˆ«å 8å­—èŠ‚ï¼Œé•¿åº¦ä¹‹å’Œä¸º24å­—èŠ‚ã€‚è€Œæˆ‘ä»¬çš„x86çš„ç¼“å­˜è¡Œæ˜¯64å­—èŠ‚ï¼Œè¿™ä¸‰ä¸ªå˜é‡å®Œå…¨æœ‰å¯èƒ½ä¼šåœ¨ä¸€ä¸ªç¼“å­˜è¡Œä¸­ï¼Œå¹¶ä¸”è¢«ä¸¤ä¸ªä¸åŒçš„cpuæ ¸å¿ƒå…±äº«ï¼ æ ¹æ®MESIåè®®ï¼Œå¦‚æœä¸åŒç‰©ç†æ ¸å¿ƒcpuä¸­çš„çº¿ç¨‹1å’Œçº¿ç¨‹2è¦äº’æ–¥çš„å¯¹è¿™å‡ ä¸ªå˜é‡è¿›è¡Œæ“ä½œï¼Œå¾ˆæœ‰å¯èƒ½è¦äº’ç›¸æŠ¢å èµ„æºï¼Œå¯¼è‡´åŸæ¥çš„å¹¶è¡Œå˜æˆä¸²è¡Œï¼Œå¤§å¤§é™ä½äº†ç³»ç»Ÿçš„å¹¶å‘æ€§ï¼Œè¿™å°±æ˜¯ç¼“å­˜çš„ä¼ªå…±äº«ã€‚ è§£å†³ä¼ªå…±äº«å…¶å®è§£å†³ä¼ªå…±äº«å¾ˆç®€å•ï¼Œåªéœ€è¦å°†è¿™å‡ ä¸ªå˜é‡åˆ†åˆ«æ”¾åˆ°ä¸åŒçš„ç¼“å­˜è¡Œå³å¯ã€‚åœ¨java8ä¸­ï¼Œå°±å·²ç»æä¾›äº†æ™®é€‚æ€§çš„è§£å†³æ–¹æ¡ˆï¼Œå³é‡‡ç”¨@Contendedæ³¨è§£æ¥ä¿è¯å¯¹è±¡ä¸­çš„å˜é‡æˆ–è€…å±æ€§ä¸åœ¨ä¸€ä¸ªç¼“å­˜è¡Œä¸­~ 123456@Contendedclass VolatileObiect&#123; volatile long a = 1L; volatile long b = 2L; volatile long c = 3L;&#125; å†…å­˜ä¸ä¸€è‡´æ€§é—®é¢˜ä¸Šé¢æˆ‘è¯´äº†MESIåè®®åœ¨å¤šæ ¸å¿ƒcpuä¸­è§£å†³ç¼“å­˜ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œä¸‹é¢æˆ‘ä»¬è¯´è¯´cpuçš„å†…å­˜ä¸ä¸€è‡´æ€§é—®é¢˜ã€‚ ä¸‰ç§cpuæ¶æ„é¦–å…ˆï¼Œè¦äº†è§£ä¸‰ä¸ªåè¯ï¼š SMP(Symmetric Multi-Processor) SMP ,å¯¹ç§°å¤šå¤„ç†ç³»ç»Ÿå†…æœ‰è®¸å¤šç´§è€¦åˆå¤šå¤„ç†å™¨ï¼Œåœ¨è¿™æ ·çš„ç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰çš„CPUå…±äº«å…¨éƒ¨èµ„æºï¼Œå¦‚æ€»çº¿ï¼Œå†…å­˜å’ŒI/Oç³»ç»Ÿç­‰ï¼Œæ“ä½œç³»ç»Ÿæˆ–ç®¡ç†æ•°æ®åº“çš„å¤æœ¬åªæœ‰ä¸€ä¸ªï¼Œè¿™ç§ç³»ç»Ÿæœ‰ä¸€ä¸ªæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å…±äº«æ‰€æœ‰èµ„æºã€‚å¤šä¸ªCPUä¹‹é—´æ²¡æœ‰åŒºåˆ«ï¼Œå¹³ç­‰åœ°è®¿é—®å†…å­˜ã€å¤–è®¾ã€ä¸€ä¸ªæ“ä½œç³»ç»Ÿã€‚æ“ä½œç³»ç»Ÿç®¡ç†ç€ä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ¯ä¸ªå¤„ç†å™¨ä¾æ¬¡å¤„ç†é˜Ÿåˆ—ä¸­çš„è¿›ç¨‹ã€‚å¦‚æœä¸¤ä¸ªå¤„ç†å™¨åŒæ—¶è¯·æ±‚è®¿é—®ä¸€ä¸ªèµ„æºï¼ˆä¾‹å¦‚åŒä¸€æ®µå†…å­˜åœ°å€ï¼‰ï¼Œç”±ç¡¬ä»¶ã€è½¯ä»¶çš„é”æœºåˆ¶å»è§£å†³èµ„æºäº‰ç”¨é—®é¢˜ã€‚ æ‰€è°“å¯¹ç§°å¤šå¤„ç†å™¨ç»“æ„ï¼Œæ˜¯æŒ‡æœåŠ¡å™¨ä¸­å¤šä¸ª CPU å¯¹ç§°å·¥ä½œï¼Œæ— ä¸»æ¬¡æˆ–ä»å±å…³ç³»ã€‚å„ CPU å…±äº«ç›¸åŒçš„ç‰©ç†å†…å­˜ï¼Œæ¯ä¸ª CPU è®¿é—®å†…å­˜ä¸­çš„ä»»ä½•åœ°å€æ‰€éœ€æ—¶é—´æ˜¯ç›¸åŒçš„ï¼Œå› æ­¤ SMP ä¹Ÿè¢«ç§°ä¸ºä¸€è‡´å­˜å‚¨å™¨è®¿é—®ç»“æ„ (UMA ï¼š Uniform Memory Access) ã€‚å¯¹ SMP æœåŠ¡å™¨è¿›è¡Œæ‰©å±•çš„æ–¹å¼åŒ…æ‹¬å¢åŠ å†…å­˜ã€ä½¿ç”¨æ›´å¿«çš„ CPU ã€å¢åŠ  CPU ã€æ‰©å…… I/O( æ§½å£æ•°ä¸æ€»çº¿æ•° ) ä»¥åŠæ·»åŠ æ›´å¤šçš„å¤–éƒ¨è®¾å¤‡ ( é€šå¸¸æ˜¯ç£ç›˜å­˜å‚¨ ) ã€‚ SMP æœåŠ¡å™¨çš„ä¸»è¦ç‰¹å¾æ˜¯å…±äº«ï¼Œç³»ç»Ÿä¸­æ‰€æœ‰èµ„æº (CPU ã€å†…å­˜ã€ I/O ç­‰ ) éƒ½æ˜¯å…±äº«çš„ã€‚ä¹Ÿæ­£æ˜¯ç”±äºè¿™ç§ç‰¹å¾ï¼Œå¯¼è‡´äº† SMP æœåŠ¡å™¨çš„ä¸»è¦é—®é¢˜ï¼Œé‚£å°±æ˜¯å®ƒçš„æ‰©å±•èƒ½åŠ›éå¸¸æœ‰é™ã€‚å¯¹äº SMP æœåŠ¡å™¨è€Œè¨€ï¼Œæ¯ä¸€ä¸ªå…±äº«çš„ç¯èŠ‚éƒ½å¯èƒ½é€ æˆ SMP æœåŠ¡å™¨æ‰©å±•æ—¶çš„ç“¶é¢ˆï¼Œè€Œæœ€å—é™åˆ¶çš„åˆ™æ˜¯å†…å­˜ã€‚ç”±äºæ¯ä¸ª CPU å¿…é¡»é€šè¿‡ç›¸åŒçš„å†…å­˜æ€»çº¿è®¿é—®ç›¸åŒçš„å†…å­˜èµ„æºï¼Œå› æ­¤éšç€ CPU æ•°é‡çš„å¢åŠ ï¼Œå†…å­˜è®¿é—®å†²çªå°†è¿…é€Ÿå¢åŠ ï¼Œæœ€ç»ˆä¼šé€ æˆ CPU èµ„æºçš„æµªè´¹ï¼Œä½¿ CPU æ€§èƒ½çš„æœ‰æ•ˆæ€§å¤§å¤§é™ä½ã€‚å®éªŒè¯æ˜ï¼Œ SMP æœåŠ¡å™¨ CPU åˆ©ç”¨ç‡æœ€å¥½çš„æƒ…å†µæ˜¯ 2 è‡³ 4 ä¸ª CPU ã€‚ NUMA(Non-Uniform Memory Access) ç”±äº SMP åœ¨æ‰©å±•èƒ½åŠ›ä¸Šçš„é™åˆ¶ï¼Œäººä»¬å¼€å§‹æ¢ç©¶å¦‚ä½•è¿›è¡Œæœ‰æ•ˆåœ°æ‰©å±•ä»è€Œæ„å»ºå¤§å‹ç³»ç»Ÿçš„æŠ€æœ¯ï¼Œ NUMA å°±æ˜¯è¿™ç§åŠªåŠ›ä¸‹çš„ç»“æœä¹‹ä¸€ã€‚åˆ©ç”¨ NUMA æŠ€æœ¯ï¼Œå¯ä»¥æŠŠå‡ åä¸ª CPU( ç”šè‡³ä¸Šç™¾ä¸ª CPU) ç»„åˆåœ¨ä¸€ä¸ªæœåŠ¡å™¨å†…ã€‚å…¶NUMA æœåŠ¡å™¨ CPU æ¨¡å—ç»“æ„å¦‚å›¾æ‰€ç¤ºï¼š NUMA æœåŠ¡å™¨çš„åŸºæœ¬ç‰¹å¾æ˜¯å…·æœ‰å¤šä¸ª CPU æ¨¡å—ï¼Œæ¯ä¸ª CPU æ¨¡å—ç”±å¤šä¸ª CPU( å¦‚ 4 ä¸ª ) ç»„æˆï¼Œå¹¶ä¸”å…·æœ‰ç‹¬ç«‹çš„æœ¬åœ°å†…å­˜ã€ I/O æ§½å£ç­‰ã€‚ç”±äºå…¶èŠ‚ç‚¹ä¹‹é—´å¯ä»¥é€šè¿‡äº’è”æ¨¡å— ( å¦‚ç§°ä¸º Crossbar Switch) è¿›è¡Œè¿æ¥å’Œä¿¡æ¯äº¤äº’ï¼Œå› æ­¤æ¯ä¸ª CPU å¯ä»¥è®¿é—®æ•´ä¸ªç³»ç»Ÿçš„å†…å­˜ ( è¿™æ˜¯ NUMA ç³»ç»Ÿä¸ MPP ç³»ç»Ÿçš„é‡è¦å·®åˆ« ) ã€‚æ˜¾ç„¶ï¼Œè®¿é—®æœ¬åœ°å†…å­˜çš„é€Ÿåº¦å°†è¿œè¿œé«˜äºè®¿é—®è¿œåœ°å†…å­˜ ( ç³»ç»Ÿå†…å…¶å®ƒèŠ‚ç‚¹çš„å†…å­˜ ) çš„é€Ÿåº¦ï¼Œè¿™ä¹Ÿæ˜¯éä¸€è‡´å­˜å‚¨è®¿é—® NUMA çš„ç”±æ¥ã€‚ç”±äºè¿™ä¸ªç‰¹ç‚¹ï¼Œä¸ºäº†æ›´å¥½åœ°å‘æŒ¥ç³»ç»Ÿæ€§èƒ½ï¼Œå¼€å‘åº”ç”¨ç¨‹åºæ—¶éœ€è¦å°½é‡å‡å°‘ä¸åŒ CPU æ¨¡å—ä¹‹é—´çš„ä¿¡æ¯äº¤äº’ã€‚ åˆ©ç”¨ NUMA æŠ€æœ¯ï¼Œå¯ä»¥è¾ƒå¥½åœ°è§£å†³åŸæ¥ SMP ç³»ç»Ÿçš„æ‰©å±•é—®é¢˜ï¼Œåœ¨ä¸€ä¸ªç‰©ç†æœåŠ¡å™¨å†…å¯ä»¥æ”¯æŒä¸Šç™¾ä¸ª CPU ã€‚æ¯”è¾ƒå…¸å‹çš„ NUMA æœåŠ¡å™¨çš„ä¾‹å­åŒ…æ‹¬ HP çš„ Superdome ã€ SUN15K ã€ IBMp690 ç­‰ã€‚ ä½† NUMA æŠ€æœ¯åŒæ ·æœ‰ä¸€å®šç¼ºé™·ï¼Œç”±äºè®¿é—®è¿œåœ°å†…å­˜çš„å»¶æ—¶è¿œè¿œè¶…è¿‡æœ¬åœ°å†…å­˜ï¼Œå› æ­¤å½“ CPU æ•°é‡å¢åŠ æ—¶ï¼Œç³»ç»Ÿæ€§èƒ½æ— æ³•çº¿æ€§å¢åŠ ã€‚å¦‚ HP å…¬å¸å‘å¸ƒ Superdome æœåŠ¡å™¨æ—¶ï¼Œæ›¾å…¬å¸ƒäº†å®ƒä¸ HP å…¶å®ƒ UNIX æœåŠ¡å™¨çš„ç›¸å¯¹æ€§èƒ½å€¼ï¼Œç»“æœå‘ç°ï¼Œ 64 è·¯ CPU çš„ Superdome (NUMA ç»“æ„ ) çš„ç›¸å¯¹æ€§èƒ½å€¼æ˜¯ 20 ï¼Œè€Œ 8 è·¯ N4000( å…±äº«çš„ SMP ç»“æ„ ) çš„ç›¸å¯¹æ€§èƒ½å€¼æ˜¯ 6.3 ã€‚ä»è¿™ä¸ªç»“æœå¯ä»¥çœ‹åˆ°ï¼Œ 8 å€æ•°é‡çš„ CPU æ¢æ¥çš„åªæ˜¯ 3 å€æ€§èƒ½çš„æå‡ã€‚ MPP(Massive Parallel Processing) å’Œ NUMA ä¸åŒï¼Œ MPP æä¾›äº†å¦å¤–ä¸€ç§è¿›è¡Œç³»ç»Ÿæ‰©å±•çš„æ–¹å¼ï¼Œå®ƒç”±å¤šä¸ª SMP æœåŠ¡å™¨é€šè¿‡ä¸€å®šçš„èŠ‚ç‚¹äº’è”ç½‘ç»œè¿›è¡Œè¿æ¥ï¼ŒååŒå·¥ä½œï¼Œå®Œæˆç›¸åŒçš„ä»»åŠ¡ï¼Œä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ç³»ç»Ÿã€‚å…¶åŸºæœ¬ç‰¹å¾æ˜¯ç”±å¤šä¸ª SMP æœåŠ¡å™¨ ( æ¯ä¸ª SMP æœåŠ¡å™¨ç§°èŠ‚ç‚¹ ) é€šè¿‡èŠ‚ç‚¹äº’è”ç½‘ç»œè¿æ¥è€Œæˆï¼Œæ¯ä¸ªèŠ‚ç‚¹åªè®¿é—®è‡ªå·±çš„æœ¬åœ°èµ„æº ( å†…å­˜ã€å­˜å‚¨ç­‰ ) ï¼Œæ˜¯ä¸€ç§å®Œå…¨æ— å…±äº« (Share Nothing) ç»“æ„ï¼Œå› è€Œæ‰©å±•èƒ½åŠ›æœ€å¥½ï¼Œç†è®ºä¸Šå…¶æ‰©å±•æ— é™åˆ¶ï¼Œç›®å‰çš„æŠ€æœ¯å¯å®ç° 512 ä¸ªèŠ‚ç‚¹äº’è”ï¼Œæ•°åƒä¸ª CPU ã€‚ç›®å‰ä¸šç•Œå¯¹èŠ‚ç‚¹äº’è”ç½‘ç»œæš‚æ— æ ‡å‡†ï¼Œå¦‚ NCR çš„ Bynet ï¼Œ IBM çš„ SPSwitch ï¼Œå®ƒä»¬éƒ½é‡‡ç”¨äº†ä¸åŒçš„å†…éƒ¨å®ç°æœºåˆ¶ã€‚ä½†èŠ‚ç‚¹äº’è”ç½‘ä»…ä¾› MPP æœåŠ¡å™¨å†…éƒ¨ä½¿ç”¨ï¼Œå¯¹ç”¨æˆ·è€Œè¨€æ˜¯é€æ˜çš„ã€‚ åœ¨ MPP ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ª SMP èŠ‚ç‚¹ä¹Ÿå¯ä»¥è¿è¡Œè‡ªå·±çš„æ“ä½œç³»ç»Ÿã€æ•°æ®åº“ç­‰ã€‚ä½†å’Œ NUMA ä¸åŒçš„æ˜¯ï¼Œå®ƒä¸å­˜åœ¨å¼‚åœ°å†…å­˜è®¿é—®çš„é—®é¢˜ã€‚æ¢è¨€ä¹‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹å†…çš„ CPU ä¸èƒ½è®¿é—®å¦ä¸€ä¸ªèŠ‚ç‚¹çš„å†…å­˜ã€‚èŠ‚ç‚¹ä¹‹é—´çš„ä¿¡æ¯äº¤äº’æ˜¯é€šè¿‡èŠ‚ç‚¹äº’è”ç½‘ç»œå®ç°çš„ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸€èˆ¬ç§°ä¸ºæ•°æ®é‡åˆ†é… (Data Redistribution) ã€‚ ä½†æ˜¯ MPP æœåŠ¡å™¨éœ€è¦ä¸€ç§å¤æ‚çš„æœºåˆ¶æ¥è°ƒåº¦å’Œå¹³è¡¡å„ä¸ªèŠ‚ç‚¹çš„è´Ÿè½½å’Œå¹¶è¡Œå¤„ç†è¿‡ç¨‹ã€‚ç›®å‰ä¸€äº›åŸºäº MPP æŠ€æœ¯çš„æœåŠ¡å™¨å¾€å¾€é€šè¿‡ç³»ç»Ÿçº§è½¯ä»¶ ( å¦‚æ•°æ®åº“ ) æ¥å±è”½è¿™ç§å¤æ‚æ€§ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œ NCR çš„ Teradata å°±æ˜¯åŸºäº MPP æŠ€æœ¯çš„ä¸€ä¸ªå…³ç³»æ•°æ®åº“è½¯ä»¶ï¼ŒåŸºäºæ­¤æ•°æ®åº“æ¥å¼€å‘åº”ç”¨æ—¶ï¼Œä¸ç®¡åå°æœåŠ¡å™¨ç”±å¤šå°‘ä¸ªèŠ‚ç‚¹ç»„æˆï¼Œå¼€å‘äººå‘˜æ‰€é¢å¯¹çš„éƒ½æ˜¯åŒä¸€ä¸ªæ•°æ®åº“ç³»ç»Ÿï¼Œè€Œä¸éœ€è¦è€ƒè™‘å¦‚ä½•è°ƒåº¦å…¶ä¸­æŸå‡ ä¸ªèŠ‚ç‚¹çš„è´Ÿè½½ã€‚ MPP (Massively Parallel Processing)ï¼Œå¤§è§„æ¨¡å¹¶è¡Œå¤„ç†ç³»ç»Ÿï¼Œè¿™æ ·çš„ç³»ç»Ÿæ˜¯ç”±è®¸å¤šæ¾è€¦åˆçš„å¤„ç†å•å…ƒç»„æˆçš„ï¼Œè¦æ³¨æ„çš„æ˜¯è¿™é‡ŒæŒ‡çš„æ˜¯å¤„ç†å•å…ƒè€Œä¸æ˜¯å¤„ç†å™¨ã€‚æ¯ä¸ªå•å…ƒå†…çš„CPUéƒ½æœ‰è‡ªå·±ç§æœ‰çš„èµ„æºï¼Œå¦‚æ€»çº¿ï¼Œå†…å­˜ï¼Œç¡¬ç›˜ç­‰ã€‚åœ¨æ¯ä¸ªå•å…ƒå†…éƒ½æœ‰æ“ä½œç³»ç»Ÿå’Œç®¡ç†æ•°æ®åº“çš„å®ä¾‹å¤æœ¬ã€‚è¿™ç§ç»“æ„æœ€å¤§çš„ç‰¹ç‚¹åœ¨äºä¸å…±äº«èµ„æºã€‚ NUMAç»“æ„ä¸‹çš„ç¼“å­˜ä¸€è‡´æ€§è¦çŸ¥é“ï¼ŒMESIåè®®è§£å†³çš„æ˜¯ä¼ ç»ŸSMPç»“æ„ä¸‹ç¼“å­˜çš„ä¸€è‡´æ€§ï¼Œä¸ºäº†åœ¨NUMAæ¶æ„ä¹Ÿå®ç°ç¼“å­˜ä¸€è‡´æ€§ï¼Œintelå¼•å…¥äº†MESIçš„ä¸€ä¸ªæ‹“å±•åè®®â€“MESIFï¼Œä½†æ˜¯ç›®å‰å¹¶æ²¡æœ‰ä»€ä¹ˆèµ„æ–™ï¼Œä¹Ÿæ²¡æ³•ç ”ç©¶ï¼Œæ›´å¤šæ¶ˆæ¯è¯·æŸ¥é˜…intelçš„wikiã€‚ Javaå†…å­˜æ¨¡å‹èµ·å› æˆ‘ä»¬å†™ç¨‹åºï¼Œä¸ºä»€ä¹ˆè¦è€ƒè™‘å†…å­˜æ¨¡å‹å‘¢ï¼Œæˆ‘ä»¬å‰é¢è¯´äº†ï¼Œç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ã€å†…å­˜ä¸€è‡´é—®é¢˜æ˜¯ç¡¬ä»¶çš„ä¸æ–­å‡çº§å¯¼è‡´çš„ã€‚è§£å†³é—®é¢˜ï¼Œæœ€ç®€å•ç›´æ¥çš„åšæ³•å°±æ˜¯åºŸé™¤CPUç¼“å­˜ï¼Œè®©CPUç›´æ¥å’Œä¸»å­˜äº¤äº’ã€‚ä½†æ˜¯ï¼Œè¿™ä¹ˆåšè™½ç„¶å¯ä»¥ä¿è¯å¤šçº¿ç¨‹ä¸‹çš„å¹¶å‘é—®é¢˜ã€‚ä½†æ˜¯ï¼Œè¿™å°±æœ‰ç‚¹æ—¶ä»£å€’é€€äº†ã€‚ æ‰€ä»¥ï¼Œä¸ºäº†ä¿è¯å¹¶å‘ç¼–ç¨‹ä¸­å¯ä»¥æ»¡è¶³åŸå­æ€§ã€å¯è§æ€§åŠæœ‰åºæ€§ã€‚æœ‰ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œé‚£å°±æ˜¯â€”â€”å†…å­˜æ¨¡å‹ã€‚ å³ä¸ºäº†ä¿è¯å…±äº«å†…å­˜çš„æ­£ç¡®æ€§ï¼ˆå¯è§æ€§ã€æœ‰åºæ€§ã€åŸå­æ€§ï¼‰ï¼Œéœ€è¦å†…å­˜æ¨¡å‹æ¥å®šä¹‰äº†å…±äº«å†…å­˜ç³»ç»Ÿä¸­å¤šçº¿ç¨‹ç¨‹åºè¯»å†™æ“ä½œè¡Œä¸ºçš„ç›¸åº”è§„èŒƒ~ JMMJavaå†…å­˜æ¨¡å‹æ˜¯æ ¹æ®è‹±æ–‡Java Memory Modelï¼ˆJMMï¼‰ç¿»è¯‘è¿‡æ¥çš„ã€‚å…¶å®JMMå¹¶ä¸åƒJVMå†…å­˜ç»“æ„ä¸€æ ·æ˜¯çœŸå®å­˜åœ¨çš„ã€‚å®ƒæ˜¯ä¸€ç§ç¬¦åˆå†…å­˜æ¨¡å‹è§„èŒƒçš„ï¼Œå±è”½äº†å„ç§ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„è®¿é—®å·®å¼‚çš„ï¼Œä¿è¯äº†Javaç¨‹åºåœ¨å„ç§å¹³å°ä¸‹å¯¹å†…å­˜çš„è®¿é—®éƒ½èƒ½ä¿è¯æ•ˆæœä¸€è‡´çš„æœºåˆ¶åŠè§„èŒƒã€‚å°±åƒJSR-133: Java Memory Model and Thread Specification ä¸­æè¿°äº†ï¼ŒJMMæ˜¯å’Œå¤šçº¿ç¨‹ç›¸å…³çš„ï¼Œä»–æè¿°äº†ä¸€ç»„è§„åˆ™æˆ–è§„èŒƒï¼Œè¿™ä¸ªè§„èŒƒå®šä¹‰äº†ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„å†™å…¥æ—¶å¯¹å¦ä¸€ä¸ªçº¿ç¨‹æ˜¯å¯è§çš„ã€‚ Javaçš„å¤šçº¿ç¨‹ä¹‹é—´æ˜¯é€šè¿‡å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡çš„ï¼Œè€Œç”±äºé‡‡ç”¨å…±äº«å†…å­˜è¿›è¡Œé€šä¿¡ï¼Œåœ¨é€šä¿¡è¿‡ç¨‹ä¸­ä¼šå­˜åœ¨ä¸€ç³»åˆ—å¦‚å¯è§æ€§ã€åŸå­æ€§ã€é¡ºåºæ€§ç­‰é—®é¢˜ï¼Œè€ŒJMMå°±æ˜¯å›´ç»•ç€å¤šçº¿ç¨‹é€šä¿¡ä»¥åŠä¸å…¶ç›¸å…³çš„ä¸€ç³»åˆ—ç‰¹æ€§è€Œå»ºç«‹çš„æ¨¡å‹ã€‚JMMå®šä¹‰äº†ä¸€äº›è¯­æ³•é›†ï¼Œè¿™äº›è¯­æ³•é›†æ˜ å°„åˆ°Javaè¯­è¨€ä¸­å°±æ˜¯volatileã€synchronizedç­‰å…³é”®å­—ã€‚ åœ¨JMMä¸­ï¼Œæˆ‘ä»¬æŠŠå¤šä¸ªçº¿ç¨‹é—´é€šä¿¡çš„å…±äº«å†…å­˜ç§°ä¹‹ä¸ºä¸»å†…å­˜ï¼Œè€Œåœ¨å¹¶å‘ç¼–ç¨‹ä¸­å¤šä¸ªçº¿ç¨‹éƒ½ç»´æŠ¤äº†ä¸€ä¸ªè‡ªå·±çš„æœ¬åœ°å†…å­˜ï¼ˆè¿™æ˜¯ä¸ªæŠ½è±¡æ¦‚å¿µï¼‰ï¼Œå…¶ä¸­ä¿å­˜çš„æ•°æ®æ˜¯ä¸»å†…å­˜ä¸­çš„æ•°æ®æ‹·è´ã€‚è€ŒJMMä¸»è¦æ˜¯æ§åˆ¶æœ¬åœ°å†…å­˜å’Œä¸»å†…å­˜ä¹‹é—´çš„æ•°æ®äº¤äº’çš„ã€‚ ä¸‹é¢çœ‹çœ‹Javaå†…å­˜æ¨¡å‹æŠ½è±¡å›¾ï¼š åœ¨Javaä¸­ï¼ŒJMMæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œæ­£æ˜¯ç”±äºæœ‰äº†JMMï¼ŒJavaçš„å¹¶å‘ç¼–ç¨‹æ‰èƒ½é¿å…å¾ˆå¤šé—®é¢˜ã€‚ JMMåŒæ­¥å…«ç§æ“ä½œJMMè§„å®šäº†ä¸€ç³»åˆ—æ“ä½œï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„æ“ä½œçš„ä¸€è‡´æ•°æ®çš„ä¸€è‡´ã€‚ ï¼ˆ1ï¼‰lock(é”å®š)ï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼ŒæŠŠä¸€ä¸ªå˜é‡æ ‡è®°ä¸ºä¸€æ¡çº¿ç¨‹ç‹¬å çŠ¶æ€ ï¼ˆ2ï¼‰unlock(è§£é”)ï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼ŒæŠŠä¸€ä¸ªå¤„äºé”å®šçŠ¶æ€çš„å˜é‡é‡Šæ”¾å‡ºæ¥ï¼Œé‡Šæ”¾åçš„å˜é‡æ‰å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹é”å®š ï¼ˆ3ï¼‰read(è¯»å–)ï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼ŒæŠŠä¸€ä¸ªå˜é‡å€¼ä»ä¸»å†…å­˜ä¼ è¾“åˆ°çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåçš„loadåŠ¨ä½œä½¿ç”¨ ï¼ˆ4ï¼‰load(è½½å…¥)ï¼šä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠreadæ“ä½œä»ä¸»å†…å­˜ä¸­å¾—åˆ°çš„å˜é‡å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­ ï¼ˆ5ï¼‰use(ä½¿ç”¨)ï¼šä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡å€¼ä¼ é€’ç»™æ‰§è¡Œå¼•æ“ ï¼ˆ6ï¼‰assign(èµ‹å€¼)ï¼šä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠä¸€ä¸ªä»æ‰§è¡Œå¼•æ“æ¥æ”¶åˆ°çš„å€¼èµ‹ç»™å·¥ä½œå†…å­˜çš„å˜é‡ ï¼ˆ7ï¼‰store(å­˜å‚¨)ï¼šä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåçš„writeçš„æ“ä½œ ï¼ˆ8ï¼‰write(å†™å…¥)ï¼šä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠstoreæ“ä½œä»å·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜çš„å˜é‡ä¸­ æŒ‰ç…§é¡ºåºå¦‚å›¾æ‰€ç¤ºï¼š åŒæ­¥è§„åˆ™åŒæ­¥è§„åˆ™åˆ†æï¼š ä¸å…è®¸ä¸€ä¸ªçº¿ç¨‹æ— åŸå› åœ°ï¼ˆæ²¡æœ‰å‘ç”Ÿè¿‡ä»»ä½•assignæ“ä½œï¼‰æŠŠæ•°æ®ä»å·¥ä½œå†…å­˜åŒæ­¥ä¼šä¸»å†…å­˜ä¸­ ä¸€ä¸ªæ–°çš„å˜é‡åªèƒ½åœ¨ä¸»å†…å­˜ä¸­è¯ç”Ÿï¼Œä¸å…è®¸åœ¨å·¥ä½œå†…å­˜ä¸­ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæœªè¢«åˆå§‹åŒ–ï¼ˆloadæˆ–è€…assignï¼‰çš„å˜é‡ã€‚å³å°±æ˜¯å¯¹ä¸€ä¸ªå˜é‡å®æ–½useå’Œstoreæ“ä½œä¹‹å‰ï¼Œå¿…é¡»å…ˆè‡ªè¡Œassignå’Œloadæ“ä½œã€‚ ä¸€ä¸ªå˜é‡åœ¨åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€æ¡çº¿ç¨‹å¯¹å…¶è¿›è¡Œlockæ“ä½œï¼Œä½†lockæ“ä½œå¯ä»¥è¢«åŒä¸€çº¿ç¨‹é‡å¤æ‰§è¡Œå¤šæ¬¡ï¼Œå¤šæ¬¡æ‰§è¡Œlockåï¼Œåªæœ‰æ‰§è¡Œç›¸åŒæ¬¡æ•°çš„unlockæ“ä½œï¼Œå˜é‡æ‰ä¼šè¢«è§£é”ã€‚lockå’Œunlockå¿…é¡»æˆå¯¹å‡ºç°ã€‚ å¦‚æœå¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œlockæ“ä½œï¼Œå°†ä¼šæ¸…ç©ºå·¥ä½œå†…å­˜ä¸­æ­¤å˜é‡çš„å€¼ï¼Œåœ¨æ‰§è¡Œå¼•æ“ä½¿ç”¨è¿™ä¸ªå˜é‡ä¹‹å‰éœ€è¦é‡æ–°æ‰§è¡Œloadæˆ–assignæ“ä½œåˆå§‹åŒ–å˜é‡çš„å€¼ã€‚ å¦‚æœä¸€ä¸ªå˜é‡äº‹å…ˆæ²¡æœ‰è¢«lockæ“ä½œé”å®šï¼Œåˆ™ä¸å…è®¸å¯¹å®ƒæ‰§è¡Œunlockæ“ä½œï¼›ä¹Ÿä¸å…è®¸å»unlockä¸€ä¸ªè¢«å…¶ä»–çº¿ç¨‹é”å®šçš„å˜é‡ã€‚ å¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œunlockæ“ä½œä¹‹å‰ï¼Œå¿…é¡»å…ˆæŠŠæ­¤å˜é‡åŒæ­¥åˆ°ä¸»å†…å­˜ä¸­ï¼ˆæ‰§è¡Œstoreå’Œwriteæ“ä½œï¼‰ JMMåº”ç”¨äº†è§£Javaå¤šçº¿ç¨‹çš„æœ‹å‹éƒ½çŸ¥é“ï¼Œåœ¨Javaä¸­æä¾›äº†ä¸€ç³»åˆ—å’Œå¹¶å‘å¤„ç†ç›¸å…³çš„å…³é”®å­—ï¼Œæ¯”å¦‚volatileã€synchronizedã€finalã€concurrentåŒ…ç­‰ã€‚å…¶å®è¿™äº›å°±æ˜¯Javaå†…å­˜æ¨¡å‹å°è£…äº†åº•å±‚çš„å®ç°åæä¾›ç»™æˆ‘ä»¬ä½¿ç”¨çš„ä¸€äº›å…³é”®å­—ã€‚ åœ¨å¼€å‘å¤šçº¿ç¨‹çš„ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨synchronizedç­‰å…³é”®å­—æ¥æ§åˆ¶å¹¶å‘ï¼Œä»æ¥å°±ä¸éœ€è¦å…³å¿ƒåº•å±‚çš„ç¼–è¯‘å™¨ä¼˜åŒ–ã€ç¼“å­˜ä¸€è‡´æ€§ç­‰é—®é¢˜ã€‚æ‰€ä»¥ï¼ŒJavaå†…å­˜æ¨¡å‹ï¼Œé™¤äº†å®šä¹‰äº†ä¸€å¥—è§„èŒƒï¼Œè¿˜æä¾›äº†ä¸€ç³»åˆ—åŸè¯­ï¼Œå°è£…äº†åº•å±‚å®ç°åï¼Œä¾›å¼€å‘è€…ç›´æ¥ä½¿ç”¨ã€‚ å¹¶å‘ç¼–ç¨‹è¦è§£å†³åŸå­æ€§ã€æœ‰åºæ€§å’Œå¯è§æ€§çš„é—®é¢˜ï¼Œæˆ‘ä»¬å°±å†æ¥çœ‹ä¸‹ï¼Œåœ¨Javaä¸­ï¼Œåˆ†åˆ«ä½¿ç”¨ä»€ä¹ˆæ–¹å¼æ¥ä¿è¯ã€‚ åŸå­æ€§åŸå­æ€§æ˜¯æŒ‡åœ¨ä¸€ä¸ªæ“ä½œä¸­å°±æ˜¯cpuä¸å¯ä»¥åœ¨ä¸­é€”æš‚åœç„¶åå†è°ƒåº¦ï¼Œæ—¢ä¸è¢«ä¸­æ–­æ“ä½œï¼Œè¦ä¸æ‰§è¡Œå®Œæˆï¼Œè¦ä¸å°±ä¸æ‰§è¡Œã€‚ JMMæä¾›ä¿è¯äº†è®¿é—®åŸºæœ¬æ•°æ®ç±»å‹çš„åŸå­æ€§ï¼ˆå…¶å®åœ¨å†™ä¸€ä¸ªå·¥ä½œå†…å­˜å˜é‡åˆ°ä¸»å†…å­˜æ˜¯åˆ†ä¸»è¦ä¸¤æ­¥ï¼šstoreã€writeï¼‰ï¼Œä½†æ˜¯å®é™…ä¸šåŠ¡å¤„ç†åœºæ™¯å¾€å¾€æ˜¯éœ€è¦æ›´å¤§çš„èŒƒå›´çš„åŸå­æ€§ä¿è¯ã€‚ åœ¨Javaä¸­ï¼Œä¸ºäº†ä¿è¯åŸå­æ€§ï¼Œæä¾›äº†ä¸¤ä¸ªé«˜çº§çš„å­—èŠ‚ç æŒ‡ä»¤monitorenterå’Œmonitorexitï¼Œè€Œè¿™ä¸¤ä¸ªå­—èŠ‚ç ï¼Œåœ¨Javaä¸­å¯¹åº”çš„å…³é”®å­—å°±æ˜¯synchronizedã€‚ å› æ­¤ï¼Œåœ¨Javaä¸­å¯ä»¥ä½¿ç”¨synchronizedæ¥ä¿è¯æ–¹æ³•å’Œä»£ç å—å†…çš„æ“ä½œæ˜¯åŸå­æ€§çš„ã€‚è¿™é‡Œæ¨èä¸€ç¯‡æ–‡ç« æ·±å…¥ç†è§£Javaå¹¶å‘ä¹‹synchronizedå®ç°åŸç†ã€‚ å¯è§æ€§å¯è§æ€§æ˜¯æŒ‡å½“å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå˜é‡æ—¶ï¼Œä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³çœ‹å¾—åˆ°ä¿®æ”¹çš„å€¼ã€‚ Javaå†…å­˜æ¨¡å‹æ˜¯é€šè¿‡åœ¨å˜é‡ä¿®æ”¹åå°†æ–°å€¼åŒæ­¥å›ä¸»å†…å­˜ï¼Œåœ¨å˜é‡è¯»å–å‰ä»ä¸»å†…å­˜åˆ·æ–°å˜é‡å€¼çš„è¿™ç§ä¾èµ–ä¸»å†…å­˜ä½œä¸ºä¼ é€’åª’ä»‹çš„æ–¹å¼æ¥å®ç°çš„ã€‚ Javaä¸­çš„volatileå…³é”®å­—æä¾›äº†ä¸€ä¸ªåŠŸèƒ½ï¼Œé‚£å°±æ˜¯è¢«å…¶ä¿®é¥°çš„å˜é‡åœ¨è¢«ä¿®æ”¹åå¯ä»¥ç«‹å³åŒæ­¥åˆ°ä¸»å†…å­˜ï¼Œè¢«å…¶ä¿®é¥°çš„å˜é‡åœ¨æ¯æ¬¡æ˜¯ç”¨ä¹‹å‰éƒ½ä»ä¸»å†…å­˜åˆ·æ–°ã€‚å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨volatileæ¥ä¿è¯å¤šçº¿ç¨‹æ“ä½œæ—¶å˜é‡çš„å¯è§æ€§ã€‚ é™¤äº†volatileï¼ŒJavaä¸­çš„synchronizedå’Œfinalã€staticä¸‰ä¸ªå…³é”®å­—ä¹Ÿå¯ä»¥å®ç°å¯è§æ€§ã€‚ä¸‹é¢åˆ†äº«ä¸€ä¸‹æˆ‘çš„è¯»ä¹¦ç¬”è®°ï¼š æœ‰åºæ€§æœ‰åºæ€§å³ç¨‹åºæ‰§è¡Œçš„é¡ºåºæŒ‰ç…§ä»£ç çš„å…ˆåé¡ºåºæ‰§è¡Œã€‚ åœ¨Javaä¸­ï¼Œå¯ä»¥ä½¿ç”¨synchronizedå’Œvolatileæ¥ä¿è¯å¤šçº¿ç¨‹ä¹‹é—´æ“ä½œçš„æœ‰åºæ€§ã€‚å®ç°æ–¹å¼æœ‰æ‰€åŒºåˆ«ï¼š volatileå…³é”®å­—ä¼šç¦æ­¢æŒ‡ä»¤é‡æ’ã€‚synchronizedå…³é”®å­—ä¿è¯åŒä¸€æ—¶åˆ»åªå…è®¸ä¸€æ¡çº¿ç¨‹æ“ä½œã€‚ å¥½äº†ï¼Œè¿™é‡Œç®€å•çš„ä»‹ç»å®Œäº†Javaå¹¶å‘ç¼–ç¨‹ä¸­è§£å†³åŸå­æ€§ã€å¯è§æ€§ä»¥åŠæœ‰åºæ€§å¯ä»¥ä½¿ç”¨çš„å…³é”®å­—ã€‚è¯»è€…å¯èƒ½å‘ç°äº†ï¼Œå¥½åƒsynchronizedå…³é”®å­—æ˜¯ä¸‡èƒ½çš„ï¼Œä»–å¯ä»¥åŒæ—¶æ»¡è¶³ä»¥ä¸Šä¸‰ç§ç‰¹æ€§ï¼Œè¿™å…¶å®ä¹Ÿæ˜¯å¾ˆå¤šäººæ»¥ç”¨synchronizedçš„åŸå› ã€‚ ä½†æ˜¯synchronizedæ˜¯æ¯”è¾ƒå½±å“æ€§èƒ½çš„ï¼Œè™½ç„¶ç¼–è¯‘å™¨æä¾›äº†å¾ˆå¤šé”ä¼˜åŒ–æŠ€æœ¯ï¼Œä½†æ˜¯ä¹Ÿä¸å»ºè®®è¿‡åº¦ä½¿ç”¨ã€‚ JVMæˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒJavaä»£ç æ˜¯è¦è¿è¡Œåœ¨è™šæ‹Ÿæœºä¸Šçš„ï¼Œè€Œè™šæ‹Ÿæœºåœ¨æ‰§è¡ŒJavaç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠæ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸï¼Œè¿™äº›åŒºåŸŸéƒ½æœ‰å„è‡ªçš„ç”¨é€”ã€‚ä¸‹é¢æˆ‘ä»¬æ¥è¯´è¯´JVMè¿è¡Œæ—¶å†…å­˜åŒºåŸŸç»“æ„ JVMè¿è¡Œæ—¶å†…å­˜åŒºåŸŸç»“æ„åœ¨ã€ŠJavaè™šæ‹Ÿæœºè§„èŒƒï¼ˆJava SE 8ï¼‰ã€‹ä¸­æè¿°äº†JVMè¿è¡Œæ—¶å†…å­˜åŒºåŸŸç»“æ„å¦‚ä¸‹ï¼š 1.ç¨‹åºè®¡æ•°å™¨ ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰ï¼Œä¹Ÿæœ‰ç§°ä½œä¸ºPCå¯„å­˜å™¨ã€‚æƒ³å¿…å­¦è¿‡æ±‡ç¼–è¯­è¨€çš„æœ‹å‹å¯¹ç¨‹åºè®¡æ•°å™¨è¿™ä¸ªæ¦‚å¿µå¹¶ä¸é™Œç”Ÿï¼Œåœ¨æ±‡ç¼–è¯­è¨€ä¸­ï¼Œç¨‹åºè®¡æ•°å™¨æ˜¯æŒ‡CPUä¸­çš„å¯„å­˜å™¨ï¼Œå®ƒä¿å­˜çš„æ˜¯ç¨‹åºå½“å‰æ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€ï¼ˆä¹Ÿå¯ä»¥è¯´ä¿å­˜ä¸‹ä¸€æ¡æŒ‡ä»¤çš„æ‰€åœ¨å­˜å‚¨å•å…ƒçš„åœ°å€ï¼‰ï¼Œå½“CPUéœ€è¦æ‰§è¡ŒæŒ‡ä»¤æ—¶ï¼Œéœ€è¦ä»ç¨‹åºè®¡æ•°å™¨ä¸­å¾—åˆ°å½“å‰éœ€è¦æ‰§è¡Œçš„æŒ‡ä»¤æ‰€åœ¨å­˜å‚¨å•å…ƒçš„åœ°å€ï¼Œç„¶åæ ¹æ®å¾—åˆ°çš„åœ°å€è·å–åˆ°æŒ‡ä»¤ï¼Œåœ¨å¾—åˆ°æŒ‡ä»¤ä¹‹åï¼Œç¨‹åºè®¡æ•°å™¨ä¾¿è‡ªåŠ¨åŠ 1æˆ–è€…æ ¹æ®è½¬ç§»æŒ‡é’ˆå¾—åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œå¦‚æ­¤å¾ªç¯ï¼Œç›´è‡³æ‰§è¡Œå®Œæ‰€æœ‰çš„æŒ‡ä»¤ã€‚ è™½ç„¶JVMä¸­çš„ç¨‹åºè®¡æ•°å™¨å¹¶ä¸åƒæ±‡ç¼–è¯­è¨€ä¸­çš„ç¨‹åºè®¡æ•°å™¨ä¸€æ ·æ˜¯ç‰©ç†æ¦‚å¿µä¸Šçš„CPUå¯„å­˜å™¨ï¼Œä½†æ˜¯JVMä¸­çš„ç¨‹åºè®¡æ•°å™¨çš„åŠŸèƒ½è·Ÿæ±‡ç¼–è¯­è¨€ä¸­çš„ç¨‹åºè®¡æ•°å™¨çš„åŠŸèƒ½åœ¨é€»è¾‘ä¸Šæ˜¯ç­‰åŒçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯ç”¨æ¥æŒ‡ç¤º æ‰§è¡Œå“ªæ¡æŒ‡ä»¤çš„ã€‚ ç”±äºåœ¨JVMä¸­ï¼Œå¤šçº¿ç¨‹æ˜¯é€šè¿‡çº¿ç¨‹è½®æµåˆ‡æ¢æ¥è·å¾—CPUæ‰§è¡Œæ—¶é—´çš„ï¼Œå› æ­¤ï¼Œåœ¨ä»»ä¸€å…·ä½“æ—¶åˆ»ï¼Œä¸€ä¸ªCPUçš„å†…æ ¸åªä¼šæ‰§è¡Œä¸€æ¡çº¿ç¨‹ä¸­çš„æŒ‡ä»¤ï¼Œå› æ­¤ï¼Œä¸ºäº†èƒ½å¤Ÿä½¿å¾—æ¯ä¸ªçº¿ç¨‹éƒ½åœ¨çº¿ç¨‹åˆ‡æ¢åèƒ½å¤Ÿæ¢å¤åœ¨åˆ‡æ¢ä¹‹å‰çš„ç¨‹åºæ‰§è¡Œä½ç½®ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½éœ€è¦æœ‰è‡ªå·±ç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå¹¶ä¸”ä¸èƒ½äº’ç›¸è¢«å¹²æ‰°ï¼Œå¦åˆ™å°±ä¼šå½±å“åˆ°ç¨‹åºçš„æ­£å¸¸æ‰§è¡Œæ¬¡åºã€‚å› æ­¤ï¼Œå¯ä»¥è¿™ä¹ˆè¯´ï¼Œç¨‹åºè®¡æ•°å™¨æ˜¯æ¯ä¸ªçº¿ç¨‹æ‰€ç§æœ‰çš„ã€‚ åœ¨JVMè§„èŒƒä¸­è§„å®šï¼Œå¦‚æœçº¿ç¨‹æ‰§è¡Œçš„æ˜¯énativeæ–¹æ³•ï¼Œåˆ™ç¨‹åºè®¡æ•°å™¨ä¸­ä¿å­˜çš„æ˜¯å½“å‰éœ€è¦æ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€ï¼›å¦‚æœçº¿ç¨‹æ‰§è¡Œçš„æ˜¯nativeæ–¹æ³•ï¼Œåˆ™ç¨‹åºè®¡æ•°å™¨ä¸­çš„å€¼æ˜¯undefinedã€‚ ç”±äºç¨‹åºè®¡æ•°å™¨ä¸­å­˜å‚¨çš„æ•°æ®æ‰€å ç©ºé—´çš„å¤§å°ä¸ä¼šéšç¨‹åºçš„æ‰§è¡Œè€Œå‘ç”Ÿæ”¹å˜ï¼Œå› æ­¤ï¼Œå¯¹äºç¨‹åºè®¡æ•°å™¨æ˜¯ä¸ä¼šå‘ç”Ÿå†…å­˜æº¢å‡ºç°è±¡(OutOfMemory)çš„ã€‚ 2.Javaæ ˆ Javaæ ˆä¹Ÿç§°ä½œè™šæ‹Ÿæœºæ ˆï¼ˆJava Vitual Machine Stackï¼‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸å¸¸æ‰€è¯´çš„æ ˆï¼Œè·ŸCè¯­è¨€çš„æ•°æ®æ®µä¸­çš„æ ˆç±»ä¼¼ã€‚äº‹å®ä¸Šï¼ŒJavaæ ˆæ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿä¸‹é¢å°±æ¥è§£é‡Šä¸€ä¸‹å…¶ä¸­çš„åŸå› ã€‚ Javaæ ˆä¸­å­˜æ”¾çš„æ˜¯ä¸€ä¸ªä¸ªçš„æ ˆå¸§ï¼Œæ¯ä¸ªæ ˆå¸§å¯¹åº”ä¸€ä¸ªè¢«è°ƒç”¨çš„æ–¹æ³•ï¼Œåœ¨æ ˆå¸§ä¸­åŒ…æ‹¬å±€éƒ¨å˜é‡è¡¨(Local Variables)ã€æ“ä½œæ•°æ ˆ(Operand Stack)ã€æŒ‡å‘å½“å‰æ–¹æ³•æ‰€å±çš„ç±»çš„è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆè¿è¡Œæ—¶å¸¸é‡æ± çš„æ¦‚å¿µåœ¨æ–¹æ³•åŒºéƒ¨åˆ†ä¼šè°ˆåˆ°ï¼‰çš„å¼•ç”¨(Reference to runtime constant pool)ã€æ–¹æ³•è¿”å›åœ°å€(Return Address)å’Œä¸€äº›é¢å¤–çš„é™„åŠ ä¿¡æ¯ã€‚å½“çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œå°±ä¼šéšä¹‹åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„æ ˆå¸§ï¼Œå¹¶å°†å»ºç«‹çš„æ ˆå¸§å‹æ ˆã€‚å½“æ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œä¾¿ä¼šå°†æ ˆå¸§å‡ºæ ˆã€‚å› æ­¤å¯çŸ¥ï¼Œçº¿ç¨‹å½“å‰æ‰§è¡Œçš„æ–¹æ³•æ‰€å¯¹åº”çš„æ ˆå¸§å¿…å®šä½äºJavaæ ˆçš„é¡¶éƒ¨ã€‚è®²åˆ°è¿™é‡Œï¼Œå¤§å®¶å°±åº”è¯¥ä¼šæ˜ç™½ä¸ºä»€ä¹ˆ åœ¨ ä½¿ç”¨ é€’å½’æ–¹æ³•çš„æ—¶å€™å®¹æ˜“å¯¼è‡´æ ˆå†…å­˜æº¢å‡ºçš„ç°è±¡äº†ä»¥åŠä¸ºä»€ä¹ˆæ ˆåŒºçš„ç©ºé—´ä¸ç”¨ç¨‹åºå‘˜å»ç®¡ç†äº†ï¼ˆå½“ç„¶åœ¨Javaä¸­ï¼Œç¨‹åºå‘˜åŸºæœ¬ä¸ç”¨å…³ç³»åˆ°å†…å­˜åˆ†é…å’Œé‡Šæ”¾çš„äº‹æƒ…ï¼Œå› ä¸ºJavaæœ‰è‡ªå·±çš„åƒåœ¾å›æ”¶æœºåˆ¶ï¼‰ï¼Œè¿™éƒ¨åˆ†ç©ºé—´çš„åˆ†é…å’Œé‡Šæ”¾éƒ½æ˜¯ç”±ç³»ç»Ÿè‡ªåŠ¨å®æ–½çš„ã€‚å¯¹äºæ‰€æœ‰çš„ç¨‹åºè®¾è®¡è¯­è¨€æ¥è¯´ï¼Œæ ˆè¿™éƒ¨åˆ†ç©ºé—´å¯¹ç¨‹åºå‘˜æ¥è¯´æ˜¯ä¸é€æ˜çš„ã€‚ä¸‹å›¾è¡¨ç¤ºäº†ä¸€ä¸ªJavaæ ˆçš„æ¨¡å‹ï¼š å±€éƒ¨å˜é‡è¡¨ï¼Œé¡¾åæ€ä¹‰ï¼Œæƒ³å¿…ä¸ç”¨è§£é‡Šå¤§å®¶åº”è¯¥æ˜ç™½å®ƒçš„ä½œç”¨äº†å§ã€‚å°±æ˜¯ç”¨æ¥å­˜å‚¨æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡ï¼ˆåŒ…æ‹¬åœ¨æ–¹æ³•ä¸­å£°æ˜çš„éé™æ€å˜é‡ä»¥åŠå‡½æ•°å½¢å‚ï¼‰ã€‚å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œåˆ™ç›´æ¥å­˜å‚¨å®ƒçš„å€¼ï¼Œå¯¹äºå¼•ç”¨ç±»å‹çš„å˜é‡ï¼Œåˆ™å­˜çš„æ˜¯æŒ‡å‘å¯¹è±¡çš„å¼•ç”¨ã€‚å±€éƒ¨å˜é‡è¡¨çš„å¤§å°åœ¨ç¼–è¯‘å™¨å°±å¯ä»¥ç¡®å®šå…¶å¤§å°äº†ï¼Œå› æ­¤åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´å±€éƒ¨å˜é‡è¡¨çš„å¤§å°æ˜¯ä¸ä¼šæ”¹å˜çš„ã€‚ æ“ä½œæ•°æ ˆï¼Œæƒ³å¿…å­¦è¿‡æ•°æ®ç»“æ„ä¸­çš„æ ˆçš„æœ‹å‹æƒ³å¿…å¯¹è¡¨è¾¾å¼æ±‚å€¼é—®é¢˜ä¸ä¼šé™Œç”Ÿï¼Œæ ˆæœ€å…¸å‹çš„ä¸€ä¸ªåº”ç”¨å°±æ˜¯ç”¨æ¥å¯¹è¡¨è¾¾å¼æ±‚å€¼ã€‚æƒ³æƒ³ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œæ–¹æ³•çš„è¿‡ç¨‹ä¸­ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸æ–­æ‰§è¡Œè¯­å¥çš„è¿‡ç¨‹ï¼Œè€Œå½’æ ¹åˆ°åº•å°±æ˜¯è¿›è¡Œè®¡ç®—çš„è¿‡ç¨‹ã€‚å› æ­¤å¯ä»¥è¿™ä¹ˆè¯´ï¼Œç¨‹åºä¸­çš„æ‰€æœ‰è®¡ç®—è¿‡ç¨‹éƒ½æ˜¯åœ¨å€ŸåŠ©äºæ“ä½œæ•°æ ˆæ¥å®Œæˆçš„ã€‚ æŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± çš„å¼•ç”¨ï¼Œå› ä¸ºåœ¨æ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹ä¸­æœ‰å¯èƒ½éœ€è¦ç”¨åˆ°ç±»ä¸­çš„å¸¸é‡ï¼Œæ‰€ä»¥å¿…é¡»è¦æœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘è¿è¡Œæ—¶å¸¸é‡ã€‚ æ–¹æ³•è¿”å›åœ°å€ï¼Œå½“ä¸€ä¸ªæ–¹æ³•æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œè¦è¿”å›ä¹‹å‰è°ƒç”¨å®ƒçš„åœ°æ–¹ï¼Œå› æ­¤åœ¨æ ˆå¸§ä¸­å¿…é¡»ä¿å­˜ä¸€ä¸ªæ–¹æ³•è¿”å›åœ°å€ã€‚ ç”±äºæ¯ä¸ªçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•å¯èƒ½ä¸åŒï¼Œå› æ­¤æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæœ‰ä¸€ä¸ªè‡ªå·±çš„Javaæ ˆï¼Œäº’ä¸å¹²æ‰°ã€‚ 3.æœ¬åœ°æ–¹æ³•æ ˆ æœ¬åœ°æ–¹æ³•æ ˆä¸Javaæ ˆçš„ä½œç”¨å’ŒåŸç†éå¸¸ç›¸ä¼¼ã€‚åŒºåˆ«åªä¸è¿‡æ˜¯Javaæ ˆæ˜¯ä¸ºæ‰§è¡ŒJavaæ–¹æ³•æœåŠ¡çš„ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™æ˜¯ä¸ºæ‰§è¡Œæœ¬åœ°æ–¹æ³•ï¼ˆNative Methodï¼‰æœåŠ¡çš„ã€‚åœ¨JVMè§„èŒƒä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹æœ¬åœ°æ–¹å‘å±•çš„å…·ä½“å®ç°æ–¹æ³•ä»¥åŠæ•°æ®ç»“æ„ä½œå¼ºåˆ¶è§„å®šï¼Œè™šæ‹Ÿæœºå¯ä»¥è‡ªç”±å®ç°å®ƒã€‚åœ¨HotSoptè™šæ‹Ÿæœºä¸­ç›´æ¥å°±æŠŠæœ¬åœ°æ–¹æ³•æ ˆå’ŒJavaæ ˆåˆäºŒä¸ºä¸€ã€‚ 4.å † åœ¨Cè¯­è¨€ä¸­ï¼Œå †è¿™éƒ¨åˆ†ç©ºé—´æ˜¯å”¯ä¸€ä¸€ä¸ªç¨‹åºå‘˜å¯ä»¥ç®¡ç†çš„å†…å­˜åŒºåŸŸã€‚ç¨‹åºå‘˜å¯ä»¥é€šè¿‡mallocå‡½æ•°å’Œfreeå‡½æ•°åœ¨å †ä¸Šç”³è¯·å’Œé‡Šæ”¾ç©ºé—´ã€‚é‚£ä¹ˆåœ¨Javaä¸­æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ Javaä¸­çš„å †æ˜¯ç”¨æ¥å­˜å‚¨å¯¹è±¡æœ¬èº«çš„ä»¥åŠæ•°ç»„ï¼ˆå½“ç„¶ï¼Œæ•°ç»„å¼•ç”¨æ˜¯å­˜æ”¾åœ¨Javaæ ˆä¸­çš„ï¼‰ã€‚åªä¸è¿‡å’ŒCè¯­è¨€ä¸­çš„ä¸åŒï¼Œåœ¨Javaä¸­ï¼Œç¨‹åºå‘˜åŸºæœ¬ä¸ç”¨å»å…³å¿ƒç©ºé—´é‡Šæ”¾çš„é—®é¢˜ï¼ŒJavaçš„åƒåœ¾å›æ”¶æœºåˆ¶ä¼šè‡ªåŠ¨è¿›è¡Œå¤„ç†ã€‚å› æ­¤è¿™éƒ¨åˆ†ç©ºé—´ä¹Ÿæ˜¯Javaåƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸã€‚å¦å¤–ï¼Œå †æ˜¯è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ï¼Œåœ¨JVMä¸­åªæœ‰ä¸€ä¸ªå †ã€‚ 5.æ–¹æ³•åŒº æ–¹æ³•åŒºåœ¨JVMä¸­ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„åŒºåŸŸï¼Œå®ƒä¸å †ä¸€æ ·ï¼Œæ˜¯è¢«çº¿ç¨‹å…±äº«çš„åŒºåŸŸã€‚åœ¨æ–¹æ³•åŒºä¸­ï¼Œå­˜å‚¨äº†æ¯ä¸ªç±»çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬ç±»çš„åç§°ã€æ–¹æ³•ä¿¡æ¯ã€å­—æ®µä¿¡æ¯ï¼‰ã€é™æ€å˜é‡ã€å¸¸é‡ä»¥åŠç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰ã€‚ åœ¨Classæ–‡ä»¶ä¸­é™¤äº†ç±»çš„å­—æ®µã€æ–¹æ³•ã€æ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜æœ‰ä¸€é¡¹ä¿¡æ¯æ˜¯å¸¸é‡æ± ï¼Œç”¨æ¥å­˜å‚¨ç¼–è¯‘æœŸé—´ç”Ÿæˆçš„å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚ åœ¨æ–¹æ³•åŒºä¸­æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„éƒ¨åˆ†å°±æ˜¯è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œå®ƒæ˜¯æ¯ä¸€ä¸ªç±»æˆ–æ¥å£çš„å¸¸é‡æ± çš„è¿è¡Œæ—¶è¡¨ç¤ºå½¢å¼ï¼Œåœ¨ç±»å’Œæ¥å£è¢«åŠ è½½åˆ°JVMåï¼Œå¯¹åº”çš„è¿è¡Œæ—¶å¸¸é‡æ± å°±è¢«åˆ›å»ºå‡ºæ¥ã€‚å½“ç„¶å¹¶éClassæ–‡ä»¶å¸¸é‡æ± ä¸­çš„å†…å®¹æ‰èƒ½è¿›å…¥è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œåœ¨è¿è¡ŒæœŸé—´ä¹Ÿå¯å°†æ–°çš„å¸¸é‡æ”¾å…¥è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ï¼Œæ¯”å¦‚Stringçš„internæ–¹æ³•ã€‚ åœ¨JVMè§„èŒƒä¸­ï¼Œæ²¡æœ‰å¼ºåˆ¶è¦æ±‚æ–¹æ³•åŒºå¿…é¡»å®ç°åƒåœ¾å›æ”¶ã€‚å¾ˆå¤šäººä¹ æƒ¯å°†æ–¹æ³•åŒºç§°ä¸ºâ€œæ°¸ä¹…ä»£â€ï¼Œæ˜¯å› ä¸ºHotSpotè™šæ‹Ÿæœºä»¥æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒºï¼Œä»è€ŒJVMçš„åƒåœ¾æ”¶é›†å™¨å¯ä»¥åƒç®¡ç†å †åŒºä¸€æ ·ç®¡ç†è¿™éƒ¨åˆ†åŒºåŸŸï¼Œä»è€Œä¸éœ€è¦ä¸“é—¨ä¸ºè¿™éƒ¨åˆ†è®¾è®¡åƒåœ¾å›æ”¶æœºåˆ¶ã€‚ä¸è¿‡è‡ªä»JDK7ä¹‹åï¼ŒHotspotè™šæ‹Ÿæœºä¾¿å°†è¿è¡Œæ—¶å¸¸é‡æ± ä»æ°¸ä¹…ä»£ç§»é™¤äº†ã€‚ Javaå¯¹è±¡æ¨¡å‹çš„å†…å­˜å¸ƒå±€javaæ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œè€ŒJavaå¯¹è±¡åœ¨JVMä¸­çš„å­˜å‚¨ä¹Ÿæ˜¯æœ‰ä¸€å®šçš„ç»“æ„çš„ã€‚è€Œè¿™ä¸ªå…³äºJavaå¯¹è±¡è‡ªèº«çš„å­˜å‚¨æ¨¡å‹ç§°ä¹‹ä¸ºJavaå¯¹è±¡æ¨¡å‹ã€‚ HotSpotè™šæ‹Ÿæœºä¸­ï¼Œè®¾è®¡äº†ä¸€ä¸ªOOP-Klass Modelã€‚OOPï¼ˆOrdinary Object Pointerï¼‰æŒ‡çš„æ˜¯æ™®é€šå¯¹è±¡æŒ‡é’ˆï¼Œè€ŒKlassç”¨æ¥æè¿°å¯¹è±¡å®ä¾‹çš„å…·ä½“ç±»å‹ã€‚ æ¯ä¸€ä¸ªJavaç±»ï¼Œåœ¨è¢«JVMåŠ è½½çš„æ—¶å€™ï¼ŒJVMä¼šç»™è¿™ä¸ªç±»åˆ›å»ºä¸€ä¸ªinstanceKlassï¼Œä¿å­˜åœ¨æ–¹æ³•åŒºï¼Œç”¨æ¥åœ¨JVMå±‚è¡¨ç¤ºè¯¥Javaç±»ã€‚å½“æˆ‘ä»¬åœ¨Javaä»£ç ä¸­ï¼Œä½¿ç”¨newåˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼ŒJVMä¼šåˆ›å»ºä¸€ä¸ªinstanceOopDescå¯¹è±¡ï¼Œå¯¹è±¡åœ¨å†…å­˜ä¸­å­˜å‚¨çš„å¸ƒå±€å¯ä»¥åˆ†ä¸º3å—åŒºåŸŸï¼šå¯¹è±¡å¤´ï¼ˆHeaderï¼‰ã€ å®ä¾‹æ•°æ®ï¼ˆInstance Dataï¼‰å’Œå¯¹é½å¡«å……ï¼ˆPaddingï¼‰ã€‚ å¯¹è±¡å¤´ï¼šæ ‡è®°å­—ï¼ˆ32ä½è™šæ‹Ÿæœº4Bï¼Œ64ä½è™šæ‹Ÿæœº8Bï¼‰ + ç±»å‹æŒ‡é’ˆï¼ˆ32ä½è™šæ‹Ÿæœº4Bï¼Œ64ä½è™šæ‹Ÿæœº8Bï¼‰+ [æ•°ç»„é•¿ï¼ˆå¯¹äºæ•°ç»„å¯¹è±¡æ‰éœ€è¦æ­¤éƒ¨åˆ†ä¿¡æ¯ï¼‰] å®ä¾‹æ•°æ®ï¼šå­˜å‚¨çš„æ˜¯çœŸæ­£æœ‰æ•ˆæ•°æ®ï¼Œå¦‚å„ç§å­—æ®µå†…å®¹ï¼Œå„å­—æ®µçš„åˆ†é…ç­–ç•¥ä¸ºlongs/doublesã€intsã€shorts/charsã€bytes/booleanã€oops(ordinary object pointers)ï¼Œç›¸åŒå®½åº¦çš„å­—æ®µæ€»æ˜¯è¢«åˆ†é…åˆ°ä¸€èµ·ï¼Œä¾¿äºä¹‹åå–æ•°æ®ã€‚çˆ¶ç±»å®šä¹‰çš„å˜é‡ä¼šå‡ºç°åœ¨å­ç±»å®šä¹‰çš„å˜é‡çš„å‰é¢ã€‚ å¯¹é½å¡«å……ï¼šå¯¹äº64ä½è™šæ‹Ÿæœºæ¥è¯´ï¼Œå¯¹è±¡å¤§å°å¿…é¡»æ˜¯8Bçš„æ•´æ•°å€ï¼Œä¸å¤Ÿçš„è¯éœ€è¦å ä½å¡«å…… JVMå†…å­˜åƒåœ¾æ”¶é›†å™¨ä¸ºäº†ç†è§£ç°æœ‰æ”¶é›†å™¨ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€äº›æœ¯è¯­ã€‚æœ€åŸºæœ¬çš„åƒåœ¾æ”¶é›†æ¶‰åŠè¯†åˆ«ä¸å†ä½¿ç”¨çš„å†…å­˜å¹¶ä½¿å…¶å¯é‡ç”¨ã€‚ç°ä»£æ”¶é›†å™¨åœ¨å‡ ä¸ªé˜¶æ®µè¿›è¡Œè¿™ä¸€è¿‡ç¨‹ï¼Œå¯¹äºè¿™äº›é˜¶æ®µæˆ‘ä»¬å¾€å¾€æœ‰å¦‚ä¸‹æè¿°ï¼š å¹¶è¡Œ- åœ¨JVMè¿è¡Œæ—¶ï¼ŒåŒæ—¶å­˜åœ¨åº”ç”¨ç¨‹åºçº¿ç¨‹å’Œåƒåœ¾æ”¶é›†å™¨çº¿ç¨‹ã€‚ å¹¶è¡Œé˜¶æ®µæ˜¯ç”±å¤šä¸ªgcçº¿ç¨‹æ‰§è¡Œï¼Œå³gcå·¥ä½œåœ¨å®ƒä»¬ä¹‹é—´åˆ†é…ã€‚ ä¸æ¶‰åŠGCçº¿ç¨‹æ˜¯å¦éœ€è¦æš‚åœåº”ç”¨ç¨‹åºçº¿ç¨‹ã€‚ ä¸²è¡Œ- ä¸²è¡Œé˜¶æ®µä»…åœ¨å•ä¸ªgcçº¿ç¨‹ä¸Šæ‰§è¡Œã€‚ä¸ä¹‹å‰ä¸€æ ·ï¼Œå®ƒä¹Ÿæ²¡æœ‰è¯´æ˜GCçº¿ç¨‹æ˜¯å¦éœ€è¦æš‚åœåº”ç”¨ç¨‹åºçº¿ç¨‹ã€‚ STW - STWé˜¶æ®µï¼Œåº”ç”¨ç¨‹åºçº¿ç¨‹è¢«æš‚åœï¼Œä»¥ä¾¿gcæ‰§è¡Œå…¶å·¥ä½œã€‚ å½“åº”ç”¨ç¨‹åºå› ä¸ºGCæš‚åœæ—¶ï¼Œè¿™é€šå¸¸æ˜¯ç”±äºStop The Worldé˜¶æ®µã€‚ å¹¶å‘ -å¦‚æœä¸€ä¸ªé˜¶æ®µæ˜¯å¹¶å‘çš„ï¼Œé‚£ä¹ˆGCçº¿ç¨‹å¯ä»¥å’Œåº”ç”¨ç¨‹åºçº¿ç¨‹åŒæ—¶è¿›è¡Œã€‚ å¹¶å‘é˜¶æ®µå¾ˆå¤æ‚ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦åœ¨é˜¶æ®µå®Œæˆä¹‹å‰å¤„ç†å¯èƒ½ä½¿å·¥ä½œæ— æ•ˆï¼ˆè¯‘è€…æ³¨ï¼šå› ä¸ºæ˜¯å¹¶å‘è¿›è¡Œçš„ï¼ŒGCçº¿ç¨‹åœ¨å®Œæˆä¸€é˜¶æ®µçš„åŒæ—¶ï¼Œåº”ç”¨çº¿ç¨‹ä¹Ÿåœ¨å·¥ä½œäº§ç”Ÿæ“ä½œå†…å­˜ï¼Œæ‰€ä»¥éœ€è¦é¢å¤–å¤„ç†ï¼‰çš„åº”ç”¨ç¨‹åºçº¿ç¨‹ã€‚ å¢é‡ -å¦‚æœä¸€ä¸ªé˜¶æ®µæ˜¯å¢é‡çš„ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥è¿è¡Œä¸€æ®µæ—¶é—´ä¹‹åç”±äºæŸäº›æ¡ä»¶æå‰ç»ˆæ­¢ï¼Œä¾‹å¦‚éœ€è¦æ‰§è¡Œæ›´é«˜ä¼˜å…ˆçº§çš„gcé˜¶æ®µï¼ŒåŒæ—¶ä»ç„¶å®Œæˆç”Ÿäº§æ€§å·¥ä½œã€‚ å¢é‡é˜¶æ®µä¸éœ€è¦å®Œå…¨å®Œæˆçš„é˜¶æ®µå½¢æˆé²œæ˜å¯¹æ¯”ã€‚ Serialæ”¶é›†å™¨Serialæ”¶é›†å™¨æ˜¯æœ€åŸºæœ¬çš„æ”¶é›†å™¨ï¼Œè¿™æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨ï¼Œå®ƒä»ç„¶æ˜¯JVMåœ¨Clientæ¨¡å¼ä¸‹çš„é»˜è®¤æ–°ç”Ÿä»£æ”¶é›†å™¨ã€‚å®ƒæœ‰ç€ä¼˜äºå…¶ä»–æ”¶é›†å™¨çš„åœ°æ–¹ï¼šç®€å•è€Œé«˜æ•ˆï¼ˆä¸å…¶ä»–æ”¶é›†å™¨çš„å•çº¿ç¨‹æ¯”è¾ƒï¼‰ï¼ŒSerialæ”¶é›†å™¨ç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œä¸“å¿ƒåªåšåƒåœ¾æ”¶é›†è‡ªç„¶ä¹Ÿè·å¾—æœ€é«˜çš„æ•ˆç‡ã€‚åœ¨ç”¨æˆ·æ¡Œé¢åœºæ™¯ä¸‹ï¼Œåˆ†é…ç»™JVMçš„å†…å­˜ä¸ä¼šå¤ªå¤šï¼Œåœé¡¿æ—¶é—´å®Œå…¨å¯ä»¥åœ¨å‡ ååˆ°ä¸€ç™¾å¤šæ¯«ç§’ä¹‹é—´ï¼Œåªè¦æ”¶é›†ä¸é¢‘ç¹ï¼Œè¿™æ˜¯å®Œå…¨å¯ä»¥æ¥å—çš„ã€‚ ParNewæ”¶é›†å™¨ParNewæ˜¯Serialçš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œåœ¨å›æ”¶ç®—æ³•ã€å¯¹è±¡åˆ†é…åŸåˆ™ä¸Šéƒ½æ˜¯ä¸€è‡´çš„ã€‚ParNewæ”¶é›†å™¨æ˜¯è®¸å¤šè¿è¡Œåœ¨Serveræ¨¡å¼ä¸‹çš„é»˜è®¤æ–°ç”Ÿä»£åƒåœ¾æ”¶é›†å™¨ï¼Œå…¶ä¸»è¦åœ¨äºé™¤äº†Serialæ”¶é›†å™¨ï¼Œç›®å‰åªæœ‰ParNewæ”¶é›†å™¨èƒ½å¤Ÿä¸CMSæ”¶é›†å™¨é…åˆå·¥ä½œã€‚ Parallel Scavengeæ”¶é›†å™¨Parallel Scavengeæ”¶é›†å™¨æ˜¯ä¸€ä¸ªæ–°ç”Ÿä»£åƒåœ¾æ”¶é›†å™¨ï¼Œå…¶ä½¿ç”¨çš„ç®—æ³•æ˜¯å¤åˆ¶ç®—æ³•ï¼Œä¹Ÿæ˜¯å¹¶è¡Œçš„å¤šçº¿ç¨‹æ”¶é›†å™¨ã€‚ Parallel Scavenge æ”¶é›†å™¨æ›´å…³æ³¨å¯æ§åˆ¶çš„ååé‡ï¼Œååé‡ç­‰äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´/(è¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´+åƒåœ¾æ”¶é›†æ—¶é—´)ã€‚ç›´è§‚ä¸Šï¼Œåªè¦æœ€å¤§çš„åƒåœ¾æ”¶é›†åœé¡¿æ—¶é—´è¶Šå°ï¼Œååé‡æ˜¯è¶Šé«˜çš„ï¼Œä½†æ˜¯GCåœé¡¿æ—¶é—´çš„ç¼©çŸ­æ˜¯ä»¥ç‰ºç‰²ååé‡å’Œæ–°ç”Ÿä»£ç©ºé—´ä½œä¸ºä»£ä»·çš„ã€‚æ¯”å¦‚åŸæ¥10ç§’æ”¶é›†ä¸€æ¬¡ï¼Œæ¯æ¬¡åœé¡¿100æ¯«ç§’ï¼Œç°åœ¨å˜æˆ5ç§’æ”¶é›†ä¸€æ¬¡ï¼Œæ¯æ¬¡åœé¡¿70æ¯«ç§’ã€‚åœé¡¿æ—¶é—´ä¸‹é™çš„åŒæ—¶ï¼Œååé‡ä¹Ÿä¸‹é™äº†ã€‚ åœé¡¿æ—¶é—´è¶ŠçŸ­å°±è¶Šé€‚åˆéœ€è¦ä¸ç”¨æˆ·äº¤äº’çš„ç¨‹åºï¼›è€Œé«˜ååé‡åˆ™å¯ä»¥æœ€é«˜æ•ˆçš„åˆ©ç”¨CPUçš„æ—¶é—´ï¼Œå°½å¿«çš„å®Œæˆè®¡ç®—ä»»åŠ¡ï¼Œä¸»è¦é€‚ç”¨äºåå°è¿ç®—ã€‚ Serial Oldæ”¶é›†å™¨Serial Oldæ”¶é›†å™¨æ˜¯Serialæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨ï¼Œé‡‡ç”¨â€œæ ‡è®°-æ•´ç†ç®—æ³•â€è¿›è¡Œå›æ”¶ã€‚å…¶è¿è¡Œè¿‡ç¨‹ä¸Serialæ”¶é›†å™¨ä¸€æ ·ã€‚ Parallel Oldæ”¶é›†å™¨Parallel Oldæ”¶é›†å™¨æ˜¯Parallel Scavengeæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œä½¿ç”¨å¤šçº¿ç¨‹å’Œæ ‡è®°-æ•´ç†ç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ã€‚å…¶é€šå¸¸ä¸Parallel Scavengeæ”¶é›†å™¨é…åˆä½¿ç”¨ï¼Œâ€œååé‡ä¼˜å…ˆâ€æ”¶é›†å™¨æ˜¯è¿™ä¸ªç»„åˆçš„ç‰¹ç‚¹ï¼Œåœ¨æ³¨é‡ååé‡å’ŒCPUèµ„æºæ•æ„Ÿçš„åœºåˆï¼Œéƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ªç»„åˆã€‚ CMS æ”¶é›†å™¨CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨æ˜¯ä¸€ç§ä»¥è·å–æœ€çŸ­åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ï¼ŒCMSæ”¶é›†å™¨é‡‡ç”¨æ ‡è®°â€“æ¸…é™¤ç®—æ³•ï¼Œè¿è¡Œåœ¨è€å¹´ä»£ã€‚ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š åˆå§‹æ ‡è®° å¹¶å‘æ ‡è®° é‡æ–°æ ‡è®° å¹¶å‘æ¸…é™¤ å…¶ä¸­åˆå§‹æ ‡è®°å’Œé‡æ–°æ ‡è®°ä»ç„¶éœ€è¦â€œStop the worldâ€ã€‚åˆå§‹æ ‡è®°ä»…ä»…æ ‡è®°GC Rootèƒ½ç›´æ¥å…³è”çš„å¯¹è±¡ï¼Œå¹¶å‘æ ‡è®°å°±æ˜¯è¿›è¡ŒGC Root Tracingè¿‡ç¨‹ï¼Œè€Œé‡æ–°æ ‡è®°åˆ™æ˜¯ä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´ï¼Œå› ç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œè€Œå¯¼è‡´æ ‡è®°å˜åŠ¨çš„é‚£éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ã€‚ ç”±äºæ•´ä¸ªè¿‡ç¨‹ä¸­æœ€è€—æ—¶çš„å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤ï¼Œæ”¶é›†çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹ä¸€èµ·å·¥ä½œï¼Œæ‰€ä»¥æ€»ä½“ä¸Šæ¥è¯´ï¼ŒCMSæ”¶é›†å™¨å›æ”¶è¿‡ç¨‹æ˜¯ä¸ç”¨æˆ·çº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„ã€‚è™½ç„¶CMSä¼˜ç‚¹æ˜¯å¹¶å‘æ”¶é›†ã€ä½åœé¡¿ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šå·²ç»æ˜¯ä¸€ä¸ªä¸é”™çš„åƒåœ¾æ”¶é›†å™¨ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸‰ä¸ªæ˜¾è‘—çš„ç¼ºç‚¹ï¼š CMSæ”¶é›†å™¨å¯¹CPUèµ„æºå¾ˆæ•æ„Ÿã€‚åœ¨å¹¶å‘é˜¶æ®µï¼Œè™½ç„¶å®ƒä¸ä¼šå¯¼è‡´ç”¨æˆ·çº¿ç¨‹åœé¡¿ï¼Œä½†æ˜¯ä¼šå› ä¸ºå ç”¨ä¸€éƒ¨åˆ†çº¿ç¨‹ï¼ˆCPUèµ„æºï¼‰è€Œå¯¼è‡´åº”ç”¨ç¨‹åºå˜æ…¢ã€‚ CMSæ”¶é›†å™¨ä¸èƒ½å¤„ç†æµ®åŠ¨åƒåœ¾ã€‚æ‰€è°“çš„â€œæµ®åŠ¨åƒåœ¾â€ï¼Œå°±æ˜¯åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µï¼Œç”±äºç”¨æˆ·ç¨‹åºåœ¨è¿è¡Œï¼Œé‚£ä¹ˆè‡ªç„¶å°±ä¼šæœ‰æ–°çš„åƒåœ¾äº§ç”Ÿï¼Œè¿™éƒ¨åˆ†åƒåœ¾è¢«æ ‡è®°è¿‡åï¼ŒCMSæ— æ³•åœ¨å½“æ¬¡é›†ä¸­å¤„ç†å®ƒä»¬ï¼Œåªå¥½åœ¨ä¸‹ä¸€æ¬¡GCçš„æ—¶å€™å¤„ç†ï¼Œè¿™éƒ¨åˆ†æœªå¤„ç†çš„åƒåœ¾å°±ç§°ä¸ºâ€œæµ®åŠ¨åƒåœ¾â€ã€‚ä¹Ÿæ˜¯ç”±äºåœ¨åƒåœ¾æ”¶é›†é˜¶æ®µç¨‹åºè¿˜éœ€è¦è¿è¡Œï¼Œå³è¿˜éœ€è¦é¢„ç•™è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ä¾›ç”¨æˆ·ä½¿ç”¨ï¼Œå› æ­¤CMSæ”¶é›†å™¨ä¸èƒ½åƒå…¶ä»–æ”¶é›†å™¨é‚£æ ·ç­‰åˆ°è€å¹´ä»£å‡ ä¹å¡«æ»¡æ‰è¿›è¡Œæ”¶é›†ï¼Œéœ€è¦é¢„ç•™ä¸€éƒ¨åˆ†ç©ºé—´æä¾›å¹¶å‘æ”¶é›†æ—¶ç¨‹åºè¿ä½œä½¿ç”¨ã€‚è¦æ˜¯CMSé¢„ç•™çš„å†…å­˜ç©ºé—´ä¸èƒ½æ»¡è¶³ç¨‹åºçš„è¦æ±‚ï¼Œè¿™æ˜¯JVMå°±ä¼šå¯åŠ¨é¢„å¤‡æ–¹æ¡ˆï¼šä¸´æ—¶å¯åŠ¨Serial Oldæ”¶é›†å™¨æ¥æ”¶é›†è€å¹´ä»£ï¼Œè¿™æ ·åœé¡¿çš„æ—¶é—´å°±ä¼šå¾ˆé•¿ã€‚ ç”±äºCMSä½¿ç”¨æ ‡è®°â€“æ¸…é™¤ç®—æ³•ï¼Œæ‰€ä»¥åœ¨æ”¶é›†ä¹‹åä¼šäº§ç”Ÿå¤§é‡å†…å­˜ç¢ç‰‡ã€‚å½“å†…å­˜ç¢ç‰‡è¿‡å¤šæ—¶ï¼Œå°†ä¼šç»™åˆ†é…å¤§å¯¹è±¡å¸¦æ¥å›°éš¾ï¼Œè¿™æ˜¯å°±ä¼šè¿›è¡ŒFull GCã€‚ G1æ”¶é›†å™¨G1æ”¶é›†å™¨ä¸CMSç›¸æ¯”æœ‰å¾ˆå¤§çš„æ”¹è¿›ï¼š Â· G1æ”¶é›†å™¨é‡‡ç”¨æ ‡è®°â€“æ•´ç†ç®—æ³•å®ç°ã€‚ Â· å¯ä»¥éå¸¸ç²¾ç¡®åœ°æ§åˆ¶åœé¡¿ã€‚ â€‹ G1æ”¶é›†å™¨å¯ä»¥å®ç°åœ¨åŸºæœ¬ä¸ç‰ºç‰²ååé‡çš„æƒ…å†µä¸‹å®Œæˆä½åœé¡¿çš„å†…å­˜å›æ”¶ï¼Œè¿™æ˜¯ç”±äºå®ƒæåŠ›çš„é¿å…å…¨åŒºåŸŸçš„å›æ”¶ï¼ŒG1æ”¶é›†å™¨å°†Javaå †ï¼ˆåŒ…æ‹¬æ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼‰åˆ’åˆ†ä¸ºå¤šä¸ªåŒºåŸŸï¼ˆRegionï¼‰ï¼Œå¹¶åœ¨åå°ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶åƒåœ¾æœ€å¤šçš„åŒºåŸŸ ã€‚ ZGCæ”¶é›†å™¨Java 11 æ–°åŠ å…¥çš„ZGCåƒåœ¾æ”¶é›†å™¨å·ç§°å¯ä»¥è¾¾åˆ°10ms ä»¥ä¸‹çš„ GC åœé¡¿ï¼ŒZGCç»™Hotspot Garbage Collectorså¢åŠ äº†ä¸¤ç§æ–°æŠ€æœ¯ï¼šç€è‰²æŒ‡é’ˆå’Œè¯»å±éšœã€‚ä¸‹é¢å¼•ç”¨å›½å¤–æ–‡ç« è¯´çš„å†…å®¹ï¼š ç€è‰²æŒ‡é’ˆç€è‰²æŒ‡é’ˆæ˜¯ä¸€ç§å°†ä¿¡æ¯å­˜å‚¨åœ¨æŒ‡é’ˆï¼ˆæˆ–ä½¿ç”¨Javaæœ¯è¯­å¼•ç”¨ï¼‰ä¸­çš„æŠ€æœ¯ã€‚å› ä¸ºåœ¨64ä½å¹³å°ä¸Šï¼ˆZGCä»…æ”¯æŒ64ä½å¹³å°ï¼‰ï¼ŒæŒ‡é’ˆå¯ä»¥å¤„ç†æ›´å¤šçš„å†…å­˜ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ä¸€äº›ä½æ¥å­˜å‚¨çŠ¶æ€ã€‚ ZGCå°†é™åˆ¶æœ€å¤§æ”¯æŒ4Tbå †ï¼ˆ42-bitsï¼‰ï¼Œé‚£ä¹ˆä¼šå‰©ä¸‹22ä½å¯ç”¨ï¼Œå®ƒç›®å‰ä½¿ç”¨äº†4ä½ï¼š finalizableï¼Œ remapï¼Œ mark0å’Œmark1ã€‚ æˆ‘ä»¬ç¨åè§£é‡Šå®ƒä»¬çš„ç”¨é€”ã€‚ ç€è‰²æŒ‡é’ˆçš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå½“æ‚¨éœ€è¦å–æ¶ˆç€è‰²æ—¶ï¼Œå®ƒéœ€è¦é¢å¤–çš„å·¥ä½œï¼ˆå› ä¸ºéœ€è¦å±è”½ä¿¡æ¯ä½ï¼‰ã€‚ åƒSPARCè¿™æ ·çš„å¹³å°æœ‰å†…ç½®ç¡¬ä»¶æ”¯æŒæŒ‡é’ˆå±è”½æ‰€ä»¥ä¸æ˜¯é—®é¢˜ï¼Œè€Œå¯¹äºx86å¹³å°æ¥è¯´ï¼ŒZGCå›¢é˜Ÿä½¿ç”¨äº†ç®€æ´çš„å¤šé‡æ˜ å°„æŠ€å·§ã€‚ å¤šé‡æ˜ å°„è¦äº†è§£å¤šé‡æ˜ å°„çš„å·¥ä½œåŸç†ï¼Œæˆ‘ä»¬éœ€è¦ç®€è¦è§£é‡Šè™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜ä¹‹é—´çš„åŒºåˆ«ã€‚ ç‰©ç†å†…å­˜æ˜¯ç³»ç»Ÿå¯ç”¨çš„å®é™…å†…å­˜ï¼Œé€šå¸¸æ˜¯å®‰è£…çš„DRAMèŠ¯ç‰‡çš„å®¹é‡ã€‚ è™šæ‹Ÿå†…å­˜æ˜¯æŠ½è±¡çš„ï¼Œè¿™æ„å‘³ç€åº”ç”¨ç¨‹åºå¯¹ï¼ˆé€šå¸¸æ˜¯éš”ç¦»çš„ï¼‰ç‰©ç†å†…å­˜æœ‰è‡ªå·±çš„è§†å›¾ã€‚ æ“ä½œç³»ç»Ÿè´Ÿè´£ç»´æŠ¤è™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜èŒƒå›´ä¹‹é—´çš„æ˜ å°„ï¼Œå®ƒé€šè¿‡ä½¿ç”¨é¡µè¡¨å’Œå¤„ç†å™¨çš„å†…å­˜ç®¡ç†å•å…ƒï¼ˆMMUï¼‰å’Œè½¬æ¢æŸ¥æ‰¾ç¼“å†²å™¨ï¼ˆTLBï¼‰æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œåè€…è½¬æ¢åº”ç”¨ç¨‹åºè¯·æ±‚çš„åœ°å€ã€‚ å¤šé‡æ˜ å°„æ¶‰åŠå°†ä¸åŒèŒƒå›´çš„è™šæ‹Ÿå†…å­˜æ˜ å°„åˆ°åŒä¸€ç‰©ç†å†…å­˜ã€‚ ç”±äºè®¾è®¡ä¸­åªæœ‰ä¸€ä¸ªremapï¼Œmark0å’Œmark1åœ¨ä»»ä½•æ—¶é—´ç‚¹éƒ½å¯ä»¥ä¸º1ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ä¸‰ä¸ªæ˜ å°„æ¥å®Œæˆæ­¤æ“ä½œã€‚ ZGCæºä»£ç ä¸­æœ‰ä¸€ä¸ªå¾ˆå¥½çš„å›¾è¡¨å¯ä»¥è¯´æ˜è¿™ä¸€ç‚¹ã€‚ è¯»å±éšœè¯»å±éšœæ˜¯æ¯å½“åº”ç”¨ç¨‹åºçº¿ç¨‹ä»å †åŠ è½½å¼•ç”¨æ—¶è¿è¡Œçš„ä»£ç ç‰‡æ®µï¼ˆå³è®¿é—®å¯¹è±¡ä¸Šçš„éåŸç”Ÿå­—æ®µnon-primitive fieldï¼‰ï¼š 1234567&gt; void printName( Person person ) &#123;&gt; String name = person.name; // è¿™é‡Œè§¦å‘è¯»å±éšœ&gt; // å› ä¸ºéœ€è¦ä»heapè¯»å–å¼•ç”¨ &gt; // &gt; System.out.println(name); // è¿™é‡Œæ²¡æœ‰ç›´æ¥è§¦å‘è¯»å±éšœ&gt; &#125;&gt; åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼ŒString name = person.name è®¿é—®äº†å †ä¸Šçš„personå¼•ç”¨ï¼Œç„¶åå°†å¼•ç”¨åŠ è½½åˆ°æœ¬åœ°çš„nameå˜é‡ã€‚æ­¤æ—¶è§¦å‘è¯»å±éšœã€‚ Systemt.outé‚£è¡Œä¸ä¼šç›´æ¥è§¦å‘è¯»å±éšœï¼Œå› ä¸ºæ²¡æœ‰æ¥è‡ªå †çš„å¼•ç”¨åŠ è½½ï¼ˆnameæ˜¯å±€éƒ¨å˜é‡ï¼Œå› æ­¤æ²¡æœ‰ä»å †åŠ è½½å¼•ç”¨ï¼‰ã€‚ ä½†æ˜¯Systemå’Œoutï¼Œæˆ–è€…printlnå†…éƒ¨å¯èƒ½ä¼šè§¦å‘å…¶ä»–è¯»å±éšœã€‚ è¿™ä¸å…¶ä»–GCä½¿ç”¨çš„å†™å±éšœå½¢æˆå¯¹æ¯”ï¼Œä¾‹å¦‚G1ã€‚è¯»å±éšœçš„å·¥ä½œæ˜¯æ£€æŸ¥å¼•ç”¨çš„çŠ¶æ€ï¼Œå¹¶åœ¨å°†å¼•ç”¨ï¼ˆæˆ–è€…ç”šè‡³æ˜¯ä¸åŒçš„å¼•ç”¨ï¼‰è¿”å›ç»™åº”ç”¨ç¨‹åºä¹‹å‰æ‰§è¡Œä¸€äº›å·¥ä½œã€‚ åœ¨ZGCä¸­ï¼Œå®ƒé€šè¿‡æµ‹è¯•åŠ è½½çš„å¼•ç”¨æ¥æ‰§è¡Œæ­¤ä»»åŠ¡ï¼Œä»¥æŸ¥çœ‹æ˜¯å¦è®¾ç½®äº†æŸäº›ä½ã€‚ å¦‚æœé€šè¿‡äº†æµ‹è¯•ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•å…¶ä»–å·¥ä½œï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™åœ¨å°†å¼•ç”¨è¿”å›ç»™åº”ç”¨ç¨‹åºä¹‹å‰æ‰§è¡ŒæŸäº›ç‰¹å®šäºé˜¶æ®µçš„ä»»åŠ¡ã€‚ æ ‡è®°ç°åœ¨æˆ‘ä»¬äº†è§£äº†è¿™ä¸¤ç§æ–°æŠ€æœ¯æ˜¯ä»€ä¹ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ZGçš„GCå¾ªç¯ã€‚ GCå¾ªç¯çš„ç¬¬ä¸€éƒ¨åˆ†æ˜¯æ ‡è®°ã€‚æ ‡è®°åŒ…æ‹¬æŸ¥æ‰¾å’Œæ ‡è®°è¿è¡Œä¸­çš„åº”ç”¨ç¨‹åºå¯ä»¥è®¿é—®çš„æ‰€æœ‰å †å¯¹è±¡ï¼Œæ¢å¥è¯è¯´ï¼ŒæŸ¥æ‰¾ä¸æ˜¯åƒåœ¾çš„å¯¹è±¡ã€‚ ZGCçš„æ ‡è®°åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µã€‚ ç¬¬ä¸€é˜¶æ®µæ˜¯STWï¼Œå…¶ä¸­GC rootsè¢«æ ‡è®°ä¸ºæ´»å¯¹è±¡ã€‚ GC rootsç±»ä¼¼äºå±€éƒ¨å˜é‡ï¼Œé€šè¿‡å®ƒå¯ä»¥è®¿é—®å †ä¸Šå…¶ä»–å¯¹è±¡ã€‚ å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸èƒ½é€šè¿‡éå†ä»rootså¼€å§‹çš„å¯¹è±¡å›¾æ¥è®¿é—®ï¼Œé‚£ä¹ˆåº”ç”¨ç¨‹åºä¹Ÿå°±æ— æ³•è®¿é—®å®ƒï¼Œåˆ™è¯¥å¯¹è±¡è¢«è®¤ä¸ºæ˜¯åƒåœ¾ã€‚ä»rootsè®¿é—®çš„å¯¹è±¡é›†åˆç§°ä¸ºLiveé›†ã€‚GC rootsæ ‡è®°æ­¥éª¤éå¸¸çŸ­ï¼Œå› ä¸ºrootsçš„æ€»æ•°é€šå¸¸æ¯”è¾ƒå°ã€‚ è¯¥é˜¶æ®µå®Œæˆåï¼Œåº”ç”¨ç¨‹åºæ¢å¤æ‰§è¡Œï¼ŒZGCå¼€å§‹ä¸‹ä¸€é˜¶æ®µï¼Œè¯¥é˜¶æ®µåŒæ—¶éå†å¯¹è±¡å›¾å¹¶æ ‡è®°æ‰€æœ‰å¯è®¿é—®çš„å¯¹è±¡ã€‚ åœ¨æ­¤é˜¶æ®µæœŸé—´ï¼Œè¯»å±éšœé’ˆä½¿ç”¨æ©ç æµ‹è¯•æ‰€æœ‰å·²åŠ è½½çš„å¼•ç”¨ï¼Œè¯¥æ©ç ç¡®å®šå®ƒä»¬æ˜¯å¦å·²æ ‡è®°æˆ–å°šæœªæ ‡è®°ï¼Œå¦‚æœå°šæœªæ ‡è®°å¼•ç”¨ï¼Œåˆ™å°†å…¶æ·»åŠ åˆ°é˜Ÿåˆ—ä»¥è¿›è¡Œæ ‡è®°ã€‚ åœ¨éå†å®Œæˆä¹‹åï¼Œæœ‰ä¸€ä¸ªæœ€ç»ˆçš„ï¼Œæ—¶é—´å¾ˆçŸ­çš„çš„Stop The Worldé˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µå¤„ç†ä¸€äº›è¾¹ç¼˜æƒ…å†µï¼ˆæˆ‘ä»¬ç°åœ¨å°†å®ƒå¿½ç•¥ï¼‰ï¼Œè¯¥é˜¶æ®µå®Œæˆä¹‹åæ ‡è®°é˜¶æ®µå°±å®Œæˆäº†ã€‚ é‡å®šä½GCå¾ªç¯çš„ä¸‹ä¸€ä¸ªä¸»è¦éƒ¨åˆ†æ˜¯é‡å®šä½ã€‚é‡å®šä½æ¶‰åŠç§»åŠ¨æ´»åŠ¨å¯¹è±¡ä»¥é‡Šæ”¾éƒ¨åˆ†å †å†…å­˜ã€‚ ä¸ºä»€ä¹ˆè¦ç§»åŠ¨å¯¹è±¡è€Œä¸æ˜¯å¡«è¡¥ç©ºéš™ï¼Ÿ æœ‰äº›GCå®é™…æ˜¯è¿™æ ·åšçš„ï¼Œä½†æ˜¯å®ƒå¯¼è‡´äº†ä¸€ä¸ªä¸å¹¸çš„åæœï¼Œå³åˆ†é…å†…å­˜å˜å¾—æ›´åŠ æ˜‚è´µï¼Œå› ä¸ºå½“éœ€è¦åˆ†é…å†…å­˜æ—¶ï¼Œå†…å­˜åˆ†é…å™¨éœ€è¦æ‰¾åˆ°å¯ä»¥æ”¾ç½®å¯¹è±¡çš„ç©ºé—²ç©ºé—´ã€‚ ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¦‚æœå¯ä»¥é‡Šæ”¾å¤§å—å†…å­˜ï¼Œé‚£ä¹ˆåˆ†é…å†…å­˜å°±å¾ˆç®€å•ï¼Œåªéœ€è¦å°†æŒ‡é’ˆé€’å¢æ–°å¯¹è±¡æ‰€éœ€çš„å†…å­˜å¤§å°å³å¯ã€‚ ZGCå°†å †åˆ†æˆè®¸å¤šé¡µé¢ï¼Œåœ¨æ­¤é˜¶æ®µå¼€å§‹æ—¶ï¼Œå®ƒåŒæ—¶é€‰æ‹©ä¸€ç»„éœ€è¦é‡å®šä½æ´»åŠ¨å¯¹è±¡çš„é¡µé¢ã€‚é€‰æ‹©é‡å®šä½é›†åï¼Œä¼šå‡ºç°ä¸€ä¸ªStop The Worldæš‚åœï¼Œå…¶ä¸­ZGCé‡å®šä½è¯¥é›†åˆä¸­rootå¯¹è±¡ï¼Œå¹¶å°†ä»–ä»¬çš„å¼•ç”¨æ˜ å°„åˆ°æ–°ä½ç½®ã€‚ä¸ä¹‹å‰çš„Stop The Worldæ­¥éª¤ä¸€æ ·ï¼Œæ­¤å¤„æ¶‰åŠçš„æš‚åœæ—¶é—´ä»…å–å†³äºrootçš„æ•°é‡ä»¥åŠé‡å®šä½é›†çš„å¤§å°ä¸å¯¹è±¡çš„æ€»æ´»åŠ¨é›†çš„æ¯”ç‡ï¼Œè¿™é€šå¸¸ç›¸å½“å°ã€‚æ‰€ä»¥ä¸åƒå¾ˆå¤šæ”¶é›†å™¨é‚£æ ·ï¼Œæš‚åœæ—¶é—´éšå †å¢åŠ è€Œå¢åŠ ã€‚ ç§»åŠ¨rootåï¼Œä¸‹ä¸€é˜¶æ®µæ˜¯å¹¶å‘é‡å®šä½ã€‚ åœ¨æ­¤é˜¶æ®µï¼ŒGCçº¿ç¨‹éå†é‡å®šä½é›†å¹¶é‡æ–°å®šä½å…¶åŒ…å«çš„é¡µä¸­æ‰€æœ‰å¯¹è±¡ã€‚ å¦‚æœåº”ç”¨ç¨‹åºçº¿ç¨‹è¯•å›¾åœ¨GCé‡æ–°å®šä½å¯¹è±¡ä¹‹å‰åŠ è½½å®ƒä»¬ï¼Œé‚£ä¹ˆåº”ç”¨ç¨‹åºçº¿ç¨‹ä¹Ÿå¯ä»¥é‡å®šä½è¯¥å¯¹è±¡ï¼Œè¿™å¯ä»¥é€šè¿‡è¯»å±éšœï¼ˆåœ¨ä»å †åŠ è½½å¼•ç”¨æ—¶è§¦å‘ï¼‰ è¿™å¯ç¡®ä¿åº”ç”¨ç¨‹åºçœ‹åˆ°çš„æ‰€æœ‰å¼•ç”¨éƒ½å·²æ›´æ–°ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºä¸å¯èƒ½åŒæ—¶å¯¹é‡å®šä½çš„å¯¹è±¡è¿›è¡Œæ“ä½œã€‚ GCçº¿ç¨‹æœ€ç»ˆå°†å¯¹é‡å®šä½é›†ä¸­çš„æ‰€æœ‰å¯¹è±¡é‡å®šä½ï¼Œç„¶è€Œå¯èƒ½ä»æœ‰å¼•ç”¨æŒ‡å‘è¿™äº›å¯¹è±¡çš„æ—§ä½ç½®ã€‚ GCå¯ä»¥éå†å¯¹è±¡å›¾å¹¶é‡æ–°æ˜ å°„è¿™äº›å¼•ç”¨åˆ°æ–°ä½ç½®ï¼Œä½†æ˜¯è¿™ä¸€æ­¥ä»£ä»·å¾ˆé«˜æ˜‚ã€‚ å› æ­¤è¿™ä¸€æ­¥ä¸ä¸‹ä¸€ä¸ªæ ‡è®°é˜¶æ®µåˆå¹¶åœ¨ä¸€èµ·ã€‚åœ¨ä¸‹ä¸€ä¸ªGCå‘¨æœŸçš„æ ‡è®°é˜¶æ®µéå†å¯¹è±¡å¯¹è±¡å›¾çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°æœªé‡æ˜ å°„çš„å¼•ç”¨ï¼Œåˆ™å°†å…¶é‡æ–°æ˜ å°„ï¼Œç„¶åæ ‡è®°ä¸ºæ´»åŠ¨çŠ¶æ€ã€‚ JVMå†…å­˜ä¼˜åŒ–åœ¨ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ä¸€ä¹¦ä¸­è®²äº†å¾ˆå¤šjvmä¼˜åŒ–æ€è·¯ï¼Œä¸‹é¢æˆ‘æ¥ç®€å•è¯´è¯´ã€‚ javaå†…å­˜æŠ–åŠ¨å †å†…å­˜éƒ½æœ‰ä¸€å®šçš„å¤§å°ï¼Œèƒ½å®¹çº³çš„æ•°æ®æ˜¯æœ‰é™åˆ¶çš„ï¼Œå½“Javaå †çš„å¤§å°å¤ªå¤§æ—¶ï¼Œåƒåœ¾æ”¶é›†ä¼šå¯åŠ¨åœæ­¢å †ä¸­ä¸å†åº”ç”¨çš„å¯¹è±¡ï¼Œæ¥é‡Šæ”¾å†…å­˜ã€‚ç°åœ¨ï¼Œå†…å­˜æŠ–åŠ¨è¿™ä¸ªæœ¯è¯­å¯ç”¨äºæè¿°åœ¨æçŸ­æ—¶é—´å†…åˆ†é…ç»™å¯¹è±¡çš„è¿‡ç¨‹ã€‚ å…·ä½“å¦‚ä½•ä¼˜åŒ–è¯·è°·æ­ŒæŸ¥è¯¢~ jvmå¤§é¡µå†…å­˜ä»€ä¹ˆæ˜¯å†…å­˜åˆ†é¡µï¼ŸCPUæ˜¯é€šè¿‡å¯»å€æ¥è®¿é—®å†…å­˜çš„ã€‚32ä½CPUçš„å¯»å€å®½åº¦æ˜¯ 0~0xFFFFFFFFï¼Œå³4Gï¼Œä¹Ÿå°±æ˜¯è¯´å¯æ”¯æŒçš„ç‰©ç†å†…å­˜æœ€å¤§æ˜¯4Gã€‚ä½†åœ¨å®è·µè¿‡ç¨‹ä¸­ï¼Œç¨‹åºéœ€è¦ä½¿ç”¨4Gå†…å­˜ï¼Œè€Œå¯ç”¨ç‰©ç†å†…å­˜å°äº4Gï¼Œå¯¼è‡´ç¨‹åºä¸å¾—ä¸é™ä½å†…å­˜å ç”¨ã€‚ä¸ºäº†è§£å†³æ­¤ç±»é—®é¢˜ï¼Œç°ä»£CPUå¼•å…¥äº†MMUï¼ˆMemory Management Unitï¼Œå†…å­˜ç®¡ç†å•å…ƒï¼‰ã€‚ MMU çš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨è™šæ‹Ÿåœ°å€æ›¿ä»£ç‰©ç†åœ°å€ï¼Œå³CPUå¯»å€æ—¶ä½¿ç”¨è™šå€ï¼Œç”±MMUè´Ÿè´£å°†è™šå€æ˜ å°„ä¸ºç‰©ç†åœ°å€ã€‚MMUçš„å¼•å…¥ï¼Œè§£å†³äº†å¯¹ç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œå¯¹ç¨‹åºæ¥è¯´ï¼Œå°±åƒè‡ªå·±åœ¨ä½¿ç”¨4Gå†…å­˜ä¸€æ ·ã€‚ å†…å­˜åˆ†é¡µ(Paging)æ˜¯åœ¨ä½¿ç”¨MMUçš„åŸºç¡€ä¸Šï¼Œæå‡ºçš„ä¸€ç§å†…å­˜ç®¡ç†æœºåˆ¶ã€‚å®ƒå°†è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€æŒ‰å›ºå®šå¤§å°ï¼ˆ4Kï¼‰åˆ†å‰²æˆé¡µ(page)å’Œé¡µå¸§(page frame)ï¼Œå¹¶ä¿è¯é¡µä¸é¡µå¸§çš„å¤§å°ç›¸åŒã€‚è¿™ç§æœºåˆ¶ï¼Œä»æ•°æ®ç»“æ„ä¸Šï¼Œä¿è¯äº†è®¿é—®å†…å­˜çš„é«˜æ•ˆï¼Œå¹¶ä½¿OSèƒ½æ”¯æŒéè¿ç»­æ€§çš„å†…å­˜åˆ†é…ã€‚åœ¨ç¨‹åºå†…å­˜ä¸å¤Ÿç”¨æ—¶ï¼Œè¿˜å¯ä»¥å°†ä¸å¸¸ç”¨çš„ç‰©ç†å†…å­˜é¡µè½¬ç§»åˆ°å…¶ä»–å­˜å‚¨è®¾å¤‡ä¸Šï¼Œæ¯”å¦‚ç£ç›˜ï¼Œè¿™å°±æ˜¯è™šæ‹Ÿå†…å­˜ã€‚ è¦çŸ¥é“ï¼Œè™šæ‹Ÿåœ°å€ä¸ç‰©ç†åœ°å€éœ€è¦é€šè¿‡æ˜ å°„ï¼Œæ‰èƒ½ä½¿CPUæ­£å¸¸å·¥ä½œã€‚è€Œæ˜ å°„å°±éœ€è¦å­˜å‚¨æ˜ å°„è¡¨ã€‚åœ¨ç°ä»£CPUæ¶æ„ä¸­ï¼Œæ˜ å°„å…³ç³»é€šå¸¸è¢«å­˜å‚¨åœ¨ç‰©ç†å†…å­˜ä¸Šä¸€ä¸ªè¢«ç§°ä¹‹ä¸ºé¡µè¡¨(page table)çš„åœ°æ–¹ã€‚ é¡µè¡¨æ˜¯è¢«å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼ŒCPUé€šè¿‡æ€»çº¿è®¿é—®å†…å­˜ï¼Œè‚¯å®šæ…¢äºç›´æ¥è®¿é—®å¯„å­˜å™¨çš„ã€‚ä¸ºäº†è¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½ï¼Œç°ä»£CPUæ¶æ„å¼•å…¥äº†TLBï¼ˆTranslation lookaside bufferï¼Œé¡µè¡¨å¯„å­˜å™¨ç¼“å†²ï¼‰ï¼Œç”¨æ¥ç¼“å­˜ä¸€éƒ¨åˆ†ç»å¸¸è®¿é—®çš„é¡µè¡¨å†…å®¹ ã€‚ ä¸ºä»€ä¹ˆè¦æ”¯æŒå¤§å†…å­˜åˆ†é¡µï¼ŸTLBæ˜¯æœ‰é™çš„ï¼Œè¿™ç‚¹æ¯«æ— ç–‘é—®ã€‚å½“è¶…å‡ºTLBçš„å­˜å‚¨æé™æ—¶ï¼Œå°±ä¼šå‘ç”Ÿ TLB missï¼Œäºæ˜¯OSå°±ä¼šå‘½ä»¤CPUå»è®¿é—®å†…å­˜ä¸Šçš„é¡µè¡¨ã€‚å¦‚æœé¢‘ç¹çš„å‡ºç°TLB missï¼Œç¨‹åºçš„æ€§èƒ½ä¼šä¸‹é™åœ°å¾ˆå¿«ã€‚ ä¸ºäº†è®©TLBå¯ä»¥å­˜å‚¨æ›´å¤šçš„é¡µåœ°å€æ˜ å°„å…³ç³»ï¼Œæˆ‘ä»¬çš„åšæ³•æ˜¯è°ƒå¤§å†…å­˜åˆ†é¡µå¤§å°ã€‚ å¦‚æœä¸€ä¸ªé¡µ4Mï¼Œå¯¹æ¯”ä¸€ä¸ªé¡µ4Kï¼Œå‰è€…å¯ä»¥è®©TLBå¤šå­˜å‚¨1000ä¸ªé¡µåœ°å€æ˜ å°„å…³ç³»ï¼Œæ€§èƒ½çš„æå‡æ˜¯æ¯”è¾ƒå¯è§‚çš„ã€‚ å¼€å¯JVMå¤§é¡µå†…å­˜JVMå¯ç”¨æ—¶åŠ å‚æ•° -XX:LargePageSizeInBytes=10m å¦‚æœJDKæ˜¯åœ¨1.5 update5ä»¥å‰çš„ï¼Œè¿˜éœ€è¦åŠ  -XX:+UseLargePagesï¼Œä½œç”¨æ˜¯å¯ç”¨å¤§å†…å­˜é¡µæ”¯æŒã€‚ é€šè¿‡è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨æå‡JVMå†…å­˜ä½¿ç”¨æ€§èƒ½å¼ºè½¯å¼±è™š å¼ºå¼•ç”¨ï¼š åªè¦å¼•ç”¨å­˜åœ¨ï¼Œåƒåœ¾å›æ”¶å™¨æ°¸è¿œä¸ä¼šå›æ”¶ Object obj = new Object(); //å¯ç›´æ¥é€šè¿‡objå–å¾—å¯¹åº”çš„å¯¹è±¡ å¦‚obj.equels(new Object()); è€Œè¿™æ · objå¯¹è±¡å¯¹åé¢new Objectçš„ä¸€ä¸ªå¼ºå¼•ç”¨ï¼Œåªæœ‰å½“objè¿™ä¸ªå¼•ç”¨è¢«é‡Šæ”¾ä¹‹åï¼Œå¯¹è±¡æ‰ä¼šè¢«é‡Šæ”¾æ‰ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ç»å¸¸æ‰€ç”¨åˆ°çš„ç¼–ç å½¢å¼ã€‚ è½¯å¼•ç”¨ï¼ˆå¯ä»¥å®ç°ç¼“å­˜ï¼‰ï¼š éå¿…é¡»å¼•ç”¨ï¼Œå†…å­˜æº¢å‡ºä¹‹å‰è¿›è¡Œå›æ”¶ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç å®ç°1234567Object obj = new Object();SoftReference&lt;Object&gt; sf = new SoftReference&lt;Object&gt;(obj);obj = null;sf.get();//æœ‰æ—¶å€™ä¼šè¿”å›null è¿™æ—¶å€™sfæ˜¯å¯¹objçš„ä¸€ä¸ªè½¯å¼•ç”¨ï¼Œé€šè¿‡sf.get()æ–¹æ³•å¯ä»¥å–åˆ°è¿™ä¸ªå¯¹è±¡ï¼Œå½“ç„¶ï¼Œå½“è¿™ä¸ªå¯¹è±¡è¢«æ ‡è®°ä¸ºéœ€è¦å›æ”¶çš„å¯¹è±¡æ—¶ï¼Œåˆ™è¿”å›nullï¼›è½¯å¼•ç”¨ä¸»è¦ç”¨æˆ·å®ç°ç±»ä¼¼ç¼“å­˜çš„åŠŸèƒ½ï¼Œåœ¨å†…å­˜è¶³å¤Ÿçš„æƒ…å†µä¸‹ç›´æ¥é€šè¿‡è½¯å¼•ç”¨å–å€¼ï¼Œæ— éœ€ä»ç¹å¿™çš„çœŸå®æ¥æºæŸ¥è¯¢æ•°æ®ï¼Œæå‡é€Ÿåº¦ï¼›å½“å†…å­˜ä¸è¶³æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤è¿™éƒ¨åˆ†ç¼“å­˜æ•°æ®ï¼Œä»çœŸæ­£çš„æ¥æºæŸ¥è¯¢è¿™äº›æ•°æ®ã€‚ å¼±å¼•ç”¨ï¼ˆç”¨æ¥åœ¨å›è°ƒå‡½æ•°ä¸­é˜²æ­¢å†…å­˜æ³„éœ²ï¼‰ï¼š ç¬¬äºŒæ¬¡åƒåœ¾å›æ”¶æ—¶å›æ”¶ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹ä»£ç å®ç°123456789Object obj = new Object();WeakReference&lt;Object&gt; wf = new WeakReference&lt;Object&gt;(obj);obj = null;wf.get();//æœ‰æ—¶å€™ä¼šè¿”å›nullwf.isEnQueued();//è¿”å›æ˜¯å¦è¢«åƒåœ¾å›æ”¶å™¨æ ‡è®°ä¸ºå³å°†å›æ”¶çš„åƒåœ¾ å¼±å¼•ç”¨æ˜¯åœ¨ç¬¬äºŒæ¬¡åƒåœ¾å›æ”¶æ—¶å›æ”¶ï¼ŒçŸ­æ—¶é—´å†…é€šè¿‡å¼±å¼•ç”¨å–å¯¹åº”çš„æ•°æ®ï¼Œå¯ä»¥å–åˆ°ï¼Œå½“æ‰§è¡Œè¿‡ç¬¬äºŒæ¬¡åƒåœ¾å›æ”¶æ—¶ï¼Œå°†è¿”å›nullã€‚å¼±å¼•ç”¨ä¸»è¦ç”¨äºç›‘æ§å¯¹è±¡æ˜¯å¦å·²ç»è¢«åƒåœ¾å›æ”¶å™¨æ ‡è®°ä¸ºå³å°†å›æ”¶çš„åƒåœ¾ï¼Œå¯ä»¥é€šè¿‡å¼±å¼•ç”¨çš„isEnQueuedæ–¹æ³•è¿”å›å¯¹è±¡æ˜¯å¦è¢«åƒåœ¾å›æ”¶å™¨æ ‡è®°ã€‚ è™šå¼•ç”¨ï¼š åƒåœ¾å›æ”¶æ—¶å›æ”¶ï¼Œæ— æ³•é€šè¿‡å¼•ç”¨å–åˆ°å¯¹è±¡å€¼ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹ä»£ç å®ç° 12345Object obj = new Object();PhantomReference&lt;Object&gt; pf = new PhantomReference&lt;Object&gt;(obj);obj=null;pf.get();//æ°¸è¿œè¿”å›nullpf.isEnQueued();//è¿”å›æ˜¯å¦ä»å†…å­˜ä¸­å·²ç»åˆ é™¤ è™šå¼•ç”¨æ˜¯æ¯æ¬¡åƒåœ¾å›æ”¶çš„æ—¶å€™éƒ½ä¼šè¢«å›æ”¶ï¼Œé€šè¿‡è™šå¼•ç”¨çš„getæ–¹æ³•æ°¸è¿œè·å–åˆ°çš„æ•°æ®ä¸ºnullï¼Œå› æ­¤ä¹Ÿè¢«æˆä¸ºå¹½çµå¼•ç”¨ã€‚è™šå¼•ç”¨ä¸»è¦ç”¨äºæ£€æµ‹å¯¹è±¡æ˜¯å¦å·²ç»ä»å†…å­˜ä¸­åˆ é™¤ã€‚ ä¼˜åŒ–ç®€å•æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨è½¯å¼•ç”¨è¿˜å¼•ç”¨æ•°é‡å·¨å¤§çš„å¯¹è±¡ï¼Œè¯¦æƒ…è¯·å‚è€ƒhttp://www.cnblogs.com/JavaArchitect/p/8685993.html æ€»ç»“æ­¤ç¯‡æ–‡ç« æ€»å…±1.5Wå­—ï¼Œæˆ‘ä»è®¡ç®—æœºç‰©ç†å†…å­˜ä½“ç³»è®²åˆ°äº†javaå†…å­˜æ¨¡å‹ï¼Œåœ¨é€šè¿‡javaå†…å­˜æ¨¡å‹å¼•å‡ºäº†JVMå†…å­˜çš„ç›¸å…³çŸ¥è¯†ç‚¹ã€‚è§‰å¾—å†™çš„å¥½çš„è¯·ç»™ä¸ªèµã€‚æœ¬ç¯‡æ–‡ç« æˆ‘ä¼šç‡å…ˆå‘å¸ƒåœ¨æˆ‘çš„ä¸ªäººåšå®¢ï¼Œéšåä¼šåœ¨æ˜é‡‘ç­‰å¹³å°ç›¸ç»§å‘å‡ºã€‚æœ€åï¼Œéå¸¸æ„Ÿè°¢ä½ çš„é˜…è¯»~ å‚è€ƒèµ„æ–™æ–‡ä¸­çš„å„ç§è¶…é“¾æ¥ ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ ã€ŠJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹ ã€Šæ¶æ„è§£å¯†ä»åˆ†å¸ƒå¼åˆ°å¾®æœåŠ¡ã€‹ SMPã€NUMAã€MPPä½“ç³»ç»“æ„ä»‹ç» ZGCåŸç†ï¼ˆè¯·ç”¨æ­£ç¡®çš„å§¿åŠ¿é­”æ³•ä¸Šç½‘è§‚çœ‹ï¼‰ Stefan Karlssonå’ŒPerLiden Jfokusçš„æ¼”è®²ï¼ˆè¯·ç”¨æ­£ç¡®çš„å§¿åŠ¿é­”æ³•ä¸Šç½‘ï¼‰ å£°æ˜ã€ç‰ˆæƒç”³æ˜ã€‘æ­¤ç‰‡ä¸ºåŸåˆ›å†…å®¹ï¼Œä½¿ç”¨ CC BY-NC-SA 3.0æˆæƒæ¡æ¬¾ï¼Œè¯·éµå®ˆå¯¹åº”çš„ä¹‰åŠ¡ï¼Œå³è¢«æˆæƒäººæœ‰ä¹‰åŠ¡åœ¨æ‰€æœ‰å‰¯æœ¬ä¸­éƒ½å¿…é¡»åŒ…å«ç‰ˆæƒå£°æ˜ã€‚è°¢è°¢åˆä½œ~ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢https://blog.tengshe789.tech/ï¼ˆğŸ˜˜]]></content>
      <tags>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>å¹¶å‘</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°ä¸€æ¬¡ä¸ç»æ€è€ƒçš„æ¶ˆè´¹(AppStoreé€€æ¬¾)]]></title>
    <url>%2F2018%2F09%2F03%2F%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%B8%8D%E7%BB%8F%E6%80%9D%E8%80%83%E7%9A%84%E6%B6%88%E8%B4%B9-AppStore%E9%80%80%E6%AC%BE%2F</url>
    <content type="text"><![CDATA[æ˜¨å¤©æ™šä¸Šï¼Œæˆ‘åšäº†ä¸€ä¸ªæƒŠå¤©åœ°æ³£é¬¼ç¥çš„äº‹æƒ… å¸®åª³å¦‡æ”¹å®Œè®ºæ–‡ï¼Œçªç„¶æŠ–äº†ä¸€ä¸ªæœºçµâ€œæ¯å¤©éƒ½ç”¨ç”µè„‘ï¼Œæˆ‘éš¾é“æ°¸è¿œçš„è„±ç¦»ä½¿ç”¨çº¸å’Œç¬”ä¹ˆï¼Ÿâ€ æˆ‘è¿˜æ˜¯ä¸ªå­©å­ï¼ è¯´ç½¢ï¼Œæ‰“å¼€AppStoreï¼Œå°±æ˜¯ä¸€å †ç¿»ã€‚æ²¡é”™ï¼Œä¸Šä¸ªæœˆæˆ‘å…¥äº†ä¸€ä¸ªapple pencilï¼Œå‡ ä¹æ²¡æ€ä¹ˆç”¨ã€‚æˆ‘ç°åœ¨çš„æ‰€æœ‰æ€ç»´éƒ½æ˜¯ç»™æˆ‘çš„apple pencilæ‰¾è€å©† ä¸€çœ¼å°±çœ‹åˆ°äº†è¿™ä¸ªappï¼Œæ”¯æŒæ‰‹å†™ç¬”ï¼Œè‡ªåŠ¨è°·æ­ŒåŒæ­¥ï¼Œå¯ä»¥OCRï¼Œé‚£ä¸ªçœ¼é¦‹å•Š çº ç»“äº†ä¸€é˜µï¼Œ ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ ç„¶åæˆ‘å°±ä¹°äº†ã€‚ã€‚ æ‰“å¼€appä»¥åï¼Œ è¿™å•¥å•Šï¼Œé•¿å¾—å’ŒOneNoteä¸€æ¯›ä¸€æ ·ï¼Œç«Ÿç„¶æ”¶50å¤§æ´‹ é€€é€€é€€ï¼ æœæ–­æ‰“å¼€æœå­å®˜æ–¹ç½‘æ‰¾é€€æ¬¾é€šé“ ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ğŸ¤¨ ä¸€å°æ—¶è¿‡å»äº† ğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µğŸ˜µ å¤œè¿˜æ˜¯è¾£ä¹ˆé»‘ï¼Œæˆ‘çš„é’±åŒ…è¿˜æ˜¯è¾£ä¹ˆç˜ª æ³•å…‹QğŸ™‚æœå­ æˆ‘å¿ƒé‡Œå’†å“®ç€ æ²¡åŠæ³•ï¼Œç™¾åº¦å§ï¼Œä»¥ä¸‹æ˜¯æ­£æ–‡ é€€æ¬¾è¦çŸ¥é“ï¼Œåœ¨è‹¹æœçœ¼ä¸­ï¼Œé€€æ¬¾æ˜¯åˆ†ä¸ºä¸¤ç§çš„ï¼Œè¶…è¿‡90å¤©å’Œæ²¡æœ‰è¶…è¿‡90å¤©ã€‚è¦é˜…è¯»æœ¬ç‰‡æ–‡ç« ï¼Œä½ è¦çŸ¥é“ï¼Œç”¨äº†è¶…è¿‡90å¤©çš„appæ˜¯éå¸¸éš¾é€€æ¬¾çš„ã€‚ä¸‹é¢æˆ‘æ¥ä»‹ç»è‹¹æœå®¶æ²¡æœ‰è¶…è¿‡90å¤©é€€æ¬¾appçš„æ–¹æ³• ç¬¬ä¸€æ­¥æ‰“å¼€ https://reportaproblem.apple.com/ ï¼Œå¹¶ç™»é™†ä½ çš„æœå­è´¦å· â€»ç¬¬äºŒæ­¥â€» å¯»æ‰¾ä½ ä¹°è¿‡çš„çˆ±å•ªå•ªï¼Œç‚¹å‡»æŠ¥å‘Šé—®é¢˜ï¼Œé€‰æ‹©éœ€è¦æŠ¥å‘Šçš„é—®é¢˜ã€‚ è¿™å…¶ä¸­æœ‰â€œæˆ‘æ²¡æœ‰æˆæƒæ­¤é¡¹è´­ä¹°â€ã€â€œå¹¶ä¸åƒè´­ä¹°æ­¤é¡¹ç›®â€ã€â€œåŸæœ¬æ‰“ç®—è´­ä¹°å¦ä¸€ä¸ªé¡¹ç›®â€ã€â€œæœªä¸‹è½½é¡¹ç›®æˆ–è€…æ— æ³•æ‰¾åˆ°é¡¹ç›®â€ã€â€œé¡¹ç›®æ— æ³•å®‰è£…æˆ–ä¸‹è½½å¤ªæ…¢â€ã€â€œé¡¹ç›®å¯æ‰“å¼€ï¼Œä½†æ˜¯æœªèµ·åˆ°é¢„æœŸçš„ä½œç”¨â€ã€â€œæ²¡æœ‰åˆ—å‡ºæˆ‘çš„é—®é¢˜â€ç­‰å¤šä¸ªé€‰é¡¹å„é€‰ã€‚ ç”±è¿™äº›é€‰é¡¹æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè‹¹æœå¯¹é€€æ¬¾åŸå› çš„æ¥å—åº¦è¿˜æ˜¯æŒºå¹¿çš„ï¼Œè¿™äº›é€‰é¡¹å‡ ä¹åŒ…å«äº†æ‰€æœ‰çš„åŸå› ï¼Œå°¤å…¶æ˜¯â€œå¹¶ä¸æƒ³è´­ä¹°æ­¤é¡¹ç›®â€æ˜¾å¾—æ ¼å¤–ä»»æ€§ã€‚ ä¸‹é¢ç»™å¤§å®¶ä¸€ä¸ªé—®é¢˜æè¿°çš„èŒƒæ–‡ï¼š I have downloaded a XXXXï¼ˆè¦é€€è´¹ç¨‹åºçš„åç§°ï¼‰program for iPhone ï¼ˆæˆ– iPadï¼‰ from the App Storeï¼Œ but this item dose not meet my expectation. Would you please help me refund my payment ï¼Ÿ Thank you very much. ç¬¬ä¸‰æ­¥æ…¢æ…¢ç­‰é‚®ä»¶ä¹ˆï¼Œæˆ‘æ˜¯æ™šä¸Š12ç‚¹é€€çš„ï¼Œç¬¬äºŒå¤©é†’æ¥å°±æ”¶åˆ°é€€æ¬¾å’Œé€€æ¬¾é‚®ä»¶äº†~ å¦‚ä½•ç†æ€§æ¶ˆè´¹ ç†æ€§ï¼ ä¸å¯èƒ½çš„ï¼è¿™è¾ˆå­éƒ½æ— æ³•ç†æ€§ï¼]]></content>
      <tags>
        <tag>çªé—¨</tag>
        <tag>ç”Ÿæ´»</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•ç”¨Javaä¸pythonä»£ç è§£é‡ŠIOæ¨¡å‹]]></title>
    <url>%2F2018%2F08%2F25%2FIO%E6%A8%A1%E5%9E%8B%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘çˆ·çˆ·ç”Ÿç—…ï¼Œæˆ‘ä¸€ç›´åœ¨é™ªåºŠã€‚é™ªåºŠç©ºéš™ï¼Œå¶è€Œç ”ç©¶ä¸€ä¼šèµ„æ–™ã€‚å‰å¤©åˆšå¥½çœ‹äº†ç‚¹ã€ŠUNIXç½‘ç»œç¼–ç¨‹ã€‹ï¼Œæ¯”è¾ƒå¤´å¤§ã€‚ç°åœ¨æˆ‘æ¥æ•´ç†ä¸€ä¸‹æ‰€å­¦æ‰€å¾—ï¼Œå¹¶ç”¨äºä¸ªäººå¤‡å¿˜ã€‚å¦‚æœæœ‰ä¸å¯¹ï¼Œè¯·æ‰¹è¯„ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®https://blog.tengshe789.tech/ IOæ¨¡å‹ä»‹ç»IOæ¨¡å‹æ˜¯ä»€ä¹ˆï¼Ÿå¾ˆå¤šä¹¦ç±æˆ–è€…ç™¾åº¦ç™¾åº¦ç™¾ç§‘ï¼Œéƒ½æ²¡æœ‰ç»™å‡ºæ˜ç¡®çš„è§£é‡Šï¼Œæˆ‘ä¹Ÿä¸æ•¢ä¹±ä¸‹å®šä¹‰ã€‚ä»¥æˆ‘æ„šè§ï¼ŒIOæ¨¡å‹ï¼Œæ˜¯é€šè¿‡æ ¹æ®å‰äººä¸»è§‚æ„è¯†çš„æ€è€ƒè€Œæ„æˆå®¢è§‚é˜è¿°IOå¤æ‚æ“ä½œé€»è¾‘çš„ç‰©ä»¶ã€‚ è¦çŸ¥é“ï¼Œåº”ç”¨ç¨‹åºä½¿ç”¨ç³»ç»Ÿèµ„æºçš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œè¿›ç¨‹æ— æ³•ç›´æ¥æ“ä½œIOè®¾å¤‡çš„ï¼Œå› ä¸ºç”¨æˆ·è¿›ç¨‹ä¸èƒ½ç›´æ¥è®¿é—®ç£ç›˜ï¼Œæ‰€ä»¥è¦é€šè¿‡å†…æ ¸çš„ç³»ç»Ÿè°ƒç”¨è¯»å–ï¼Œè¿™ä¸ªå†…æ ¸è¯»å–çš„è¿‡ç¨‹å°±æ˜¯ç”¨æˆ·è¿›ç¨‹ç­‰å¾…çš„è¿‡ç¨‹ï¼Œç­‰å¾…å†…æ ¸è¯»å–åå°†æ•°æ®ä»å†…æ ¸å†…å­˜å¤åˆ¶åˆ°è¿›ç¨‹å†…å­˜ã€‚å› æ­¤æ“ä½œç³»ç»Ÿè®¾ç«‹ä¸€ä¸ªIOæ¨¡å‹è¿›è¡Œè§„èŒƒï¼Œå°±éå¸¸æœ‰å¿…è¦äº†ã€‚ ä¸ºäº†æ›´å¥½åœ°äº†è§£IOæ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦äº‹å…ˆå›é¡¾ä¸‹ï¼šåŒæ­¥ã€å¼‚æ­¥ã€é˜»å¡ã€éé˜»å¡ åŒæ­¥ä¸å¼‚æ­¥ï¼šæè¿°çš„æ˜¯ç”¨æˆ·çº¿ç¨‹ä¸å†…æ ¸çš„äº¤äº’æ–¹å¼ï¼ŒåŒæ­¥æŒ‡ç”¨æˆ·çº¿ç¨‹å‘èµ·IOè¯·æ±‚åéœ€è¦ç­‰å¾…æˆ–è€…è½®è¯¢å†…æ ¸IOæ“ä½œå®Œæˆåæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼›è€Œå¼‚æ­¥æ˜¯æŒ‡ç”¨æˆ·çº¿ç¨‹å‘èµ·IOè¯·æ±‚åä»ç„¶ç»§ç»­æ‰§è¡Œï¼Œå½“å†…æ ¸IOæ“ä½œå®Œæˆåä¼šé€šçŸ¥ç”¨æˆ·çº¿ç¨‹ï¼Œæˆ–è€…è°ƒç”¨ç”¨æˆ·çº¿ç¨‹æ³¨å†Œçš„å›è°ƒå‡½æ•°ã€‚ é˜»å¡ä¸éé˜»å¡ï¼šæè¿°æ˜¯ç”¨æˆ·çº¿ç¨‹è°ƒç”¨å†…æ ¸IOæ“ä½œçš„æ–¹å¼ï¼Œé˜»å¡æ˜¯æŒ‡IOæ“ä½œéœ€è¦å½»åº•å®Œæˆåæ‰è¿”å›åˆ°ç”¨æˆ·ç©ºé—´ï¼›è€Œéé˜»å¡æ˜¯æŒ‡IOæ“ä½œè¢«è°ƒç”¨åç«‹å³è¿”å›ç»™ç”¨æˆ·ä¸€ä¸ªçŠ¶æ€å€¼ï¼Œæ— éœ€ç­‰åˆ°IOæ“ä½œå½»åº•å®Œæˆã€‚ IOæ¨¡å‹ä¸€å…±æœ‰5ç±»ï¼š blocking-IO BIOï¼ˆé˜»å¡IOï¼‰ non-blocking IO NIOï¼ˆéé˜»å¡IOï¼‰ IO multiplexing IOå¤šè·¯å¤ç”¨ signal driven IO ä¿¡å·é©±åŠ¨IO asynchronous IO AIOï¼ˆå¼‚æ­¥IOï¼‰ ç”±äºsignal driven IOï¼ˆä¿¡å·é©±åŠ¨IOï¼‰åœ¨å®é™…ä¸­å¹¶ä¸å¸¸ç”¨ï¼Œæ‰€ä»¥ä¸»è¦ä»‹ç»å…¶ä½™å››ç§IO Modelã€‚ BIOï¼ˆblocking ioï¼‰å…ˆæ¥çœ‹çœ‹è¯»æ“ä½œæµç¨‹ ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œç”¨æˆ·è¿›ç¨‹è°ƒç”¨äº†recvfromè¿™ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œkernelå°±å¼€å§‹äº†IOçš„ç¬¬ä¸€ä¸ªé˜¶æ®µï¼šå‡†å¤‡æ•°æ®ã€‚ å¯¹äºnetwork ioæ¥è¯´ï¼Œå¾ˆå¤šæ—¶å€™æ•°æ®åœ¨ä¸€å¼€å§‹è¿˜æ²¡æœ‰åˆ°è¾¾ï¼ˆæ¯”å¦‚ï¼Œè¿˜æ²¡æœ‰æ”¶åˆ°ä¸€ä¸ªå®Œæ•´çš„UDPåŒ…ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™kernelå°±è¦ç­‰å¾…è¶³å¤Ÿçš„æ•°æ®åˆ°æ¥ã€‚ è€Œåœ¨ç”¨æˆ·è¿›ç¨‹è¿™è¾¹ï¼Œæ•´ä¸ªè¿›ç¨‹ä¼šè¢«é˜»å¡ã€‚å½“kernelä¸€ç›´ç­‰åˆ°æ•°æ®å‡†å¤‡å¥½äº†ï¼Œå®ƒå°±ä¼šå°†æ•°æ®ä»kernelä¸­æ‹·è´åˆ°ç”¨æˆ·å†…å­˜ï¼Œç„¶åkernelè¿”å›ç»“æœï¼Œç”¨æˆ·è¿›ç¨‹æ‰è§£é™¤blockçš„çŠ¶æ€ï¼Œé‡æ–°è¿è¡Œèµ·æ¥ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œblocking IOçš„ç‰¹ç‚¹å°±æ˜¯åœ¨IOæ‰§è¡Œçš„ä¸¤ä¸ªé˜¶æ®µï¼ˆç­‰å¾…æ•°æ®å’Œæ‹·è´æ•°æ®ä¸¤ä¸ªé˜¶æ®µï¼‰éƒ½è¢«blockäº†ã€‚ JAVA é˜»å¡ demoä¸‹é¢çš„ä¾‹å­ä¸»è¦ä½¿ç”¨Socketé€šé“è¿›è¡Œç¼–ç¨‹ã€‚æœåŠ¡ç«¯å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132/** * @program: socketTest * @description: one thread demo for bio version * @author: tEngSHe789 * @create: 2018-08-26 21:17 **/public class Server &#123; public static void main(String[] args) &#123; try &#123; ServerSocket serverSocket=new ServerSocket(8888); System.out.println("æœåŠ¡ç«¯Start...."); //ç­‰å¾…å®¢æˆ·ç«¯å°±ç»ª -&gt; å µå¡ while (true)&#123; Socket socket = serverSocket.accept(); System.out.println("å‘ç°å®¢æˆ·ç«¯è¿æ¥"); InputStream is=socket.getInputStream(); byte[] b =new byte[1024]; //ç­‰å¾…å®¢æˆ·ç«¯å‘é€è¯·æ±‚ -&gt; å µå¡ while (true) &#123; int data = is.read(b); String info=null; if (data!=-1)&#123; info=new String(b,0,data,"GBK"); &#125; System.out.println(info); &#125; &#125; &#125; catch (IOException e) &#123; &#125; &#125;&#125; å®¢æˆ·ç«¯ 123456789101112131415161718/** * @program: socketTest * @description: one thread demo for bio version * @author: tEngSHe789 **/public class Client &#123; public static void main(String[] args) &#123; try &#123; Socket socket=new Socket("127.0.0.1",8888); OutputStream os = socket.getOutputStream(); System.out.println("æ­£åœ¨å‘é€æ•°æ®"); os.write("è¿™æ˜¯æ¥è‡ªå®¢æˆ·ç«¯çš„ä¿¡æ¯".getBytes()); os.flush(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;&#125; PY é˜»å¡ demoæœåŠ¡ç«¯ 12345678910111213import sockets = socket.socket()s.bind(('127.0.0.1',8888))print('æœåŠ¡ç«¯å¯åŠ¨....')# ç­‰å¾…å®¢æˆ·ç«¯å°±ç»ª -&gt; å µå¡s.listen()# ç­‰å¾…å®¢æˆ·ç«¯å‘é€è¯·æ±‚ -&gt; å µå¡conn,addr = s.accept()msg = conn.recv(1024).decode('utf-8')print(msg)conn.close()s.close() å®¢æˆ·ç«¯ 1234567import sockets = socket.socket()s.connect(('127.0.0.1',8888))print('å®¢æˆ·ç«¯å·²å¯åŠ¨....')s.send('æ­£åœ¨å‘é€æ•°æ®'.encode('utf-8'))s.close() NIOï¼ˆnon blocking ioï¼‰NIOå°±ä¸ä¸€æ ·äº†ï¼Œrecvformç³»ç»Ÿè°ƒç”¨è°ƒç”¨ä¹‹åï¼Œè¿›ç¨‹å¹¶æ²¡æœ‰è¢«é˜»å¡ï¼Œå†…æ ¸é©¬ä¸Šè¿”å›ç»™è¿›ç¨‹ï¼Œå¦‚æœæ•°æ®è¿˜æ²¡å‡†å¤‡å¥½ï¼Œæ­¤æ—¶ä¼šè¿”å›ä¸€ä¸ªerrorã€‚è¿›ç¨‹åœ¨è¿”å›ä¹‹åï¼Œå¯ä»¥å¹²ç‚¹åˆ«çš„äº‹æƒ…ï¼Œç„¶åå†å‘èµ·recvformç³»ç»Ÿè°ƒç”¨ã€‚é‡å¤ä¸Šé¢çš„è¿‡ç¨‹ï¼Œå¾ªç¯å¾€å¤çš„è¿›è¡Œrecvformç³»ç»Ÿè°ƒç”¨ã€‚è¿™ä¸ªè¿‡ç¨‹é€šå¸¸è¢«ç§°ä¹‹ä¸ºè½®è¯¢ã€‚ è½®è¯¢æ£€æŸ¥å†…æ ¸æ•°æ®ï¼Œç›´åˆ°æ•°æ®å‡†å¤‡å¥½ï¼Œå†æ‹·è´æ•°æ®åˆ°è¿›ç¨‹ï¼Œè¿›è¡Œæ•°æ®å¤„ç†ã€‚éœ€è¦æ³¨æ„ï¼Œæ‹·è´æ•°æ®æ•´ä¸ªè¿‡ç¨‹ï¼Œè¿›ç¨‹ä»ç„¶æ˜¯å±äºé˜»å¡çš„çŠ¶æ€ã€‚ JAVA ä¸NIOJava NIO(New IO)æ˜¯ä¸€ä¸ªå¯ä»¥æ›¿ä»£æ ‡å‡†Java IO APIçš„IO APIï¼ˆä»Java 1.4å¼€å§‹)ï¼ŒJava NIOæä¾›äº†ä¸æ ‡å‡†IOä¸åŒçš„IOå·¥ä½œæ–¹å¼ã€‚ åœ¨javaä¸­ï¼Œæ ‡å‡†çš„IOåŸºäºå­—èŠ‚æµå’Œå­—ç¬¦æµè¿›è¡Œæ“ä½œçš„ï¼Œè€ŒNIOæ˜¯åŸºäºé€šé“ï¼ˆChannelï¼‰å’Œç¼“å†²åŒºï¼ˆBufferï¼‰è¿›è¡Œæ“ä½œï¼Œæ•°æ®æ€»æ˜¯ä»é€šé“è¯»å–åˆ°ç¼“å†²åŒºä¸­ï¼Œæˆ–è€…ä»ç¼“å†²åŒºå†™å…¥åˆ°é€šé“ä¸­ã€‚ æˆ‘ä»¬å…ˆçœ‹çœ‹Bufferç±» Bufferç±»Java NIOä¸­çš„Bufferä¸»è¦ç”¨äºä¸NIOé€šé“è¿›è¡Œäº¤äº’ï¼Œæ•°æ®æ˜¯ä»é€šé“è¯»å…¥åˆ°ç¼“å†²åŒºï¼Œä»ç¼“å†²åŒºå†™å…¥é€šé“ä¸­çš„ã€‚æ¦‚å¿µä¸Šï¼Œç¼“å†²åŒºå¯ä»¥çœ‹æˆåŒ…åœ¨ä¸€ä¸ªå¯¹è±¡å†…çš„æ•°ç»„ï¼Œä¸‹é¢çœ‹ä¸€ä¸ªå›¾ è¿™æ˜¯ä¸€ä¸ªæ–°åˆ›å»ºçš„å®¹é‡ä¸º10çš„ByteBufferé€»è¾‘å›¾ï¼Œä»–æœ‰å››ä¸ªå±æ€§æ¥æä¾›å…³äºå…¶åŒ…å«çš„æ•°æ®å…ƒç´ ä¿¡æ¯ï¼Œåˆ†åˆ«æ˜¯ï¼š 1ï¼‰å®¹é‡ï¼ˆcapacityï¼‰ï¼šè¡¨ç¤ºBufferæœ€å¤§æ•°æ®å®¹é‡ï¼Œç¼“å†²åŒºå®¹é‡ä¸èƒ½ä¸ºè´Ÿï¼Œå¹¶ä¸”å»ºç«‹åä¸èƒ½ä¿®æ”¹ã€‚ 2ï¼‰é™åˆ¶ï¼ˆlimitï¼‰ï¼šä¹Ÿå«ä¸Šç•Œã€‚ç¬¬ä¸€ä¸ªä¸åº”è¯¥è¯»å–æˆ–è€…å†™å…¥çš„æ•°æ®çš„ç´¢å¼•ï¼Œå³ä½äºlimitåçš„æ•°æ®ä¸å¯ä»¥è¯»å†™ã€‚ç¼“å†²åŒºçš„é™åˆ¶ä¸èƒ½ä¸ºè´Ÿï¼Œå¹¶ä¸”ä¸èƒ½å¤§äºå…¶å®¹é‡ï¼ˆcapacityï¼‰ã€‚ 3ï¼‰ä½ç½®ï¼ˆpositionï¼‰ï¼šä¸‹ä¸€ä¸ªè¦è¯»å–æˆ–å†™å…¥çš„æ•°æ®çš„ç´¢å¼•ã€‚ç¼“å†²åŒºçš„ä½ç½®ä¸èƒ½ä¸ºè´Ÿï¼Œå¹¶ä¸”ä¸èƒ½å¤§äºå…¶é™åˆ¶ï¼ˆlimitï¼‰ã€‚ 4ï¼‰æ ‡è®°ï¼ˆmarkï¼‰ä¸é‡ç½®ï¼ˆresetï¼‰ï¼šæ ‡è®°æ˜¯ä¸€ä¸ªç´¢å¼•ï¼Œé€šè¿‡Bufferä¸­çš„mark()æ–¹æ³•æŒ‡å®šBufferä¸­ä¸€ä¸ªç‰¹å®šçš„positionï¼Œä¹‹åå¯ä»¥é€šè¿‡è°ƒç”¨reset()æ–¹æ³•æ¢å¤åˆ°è¿™ä¸ªpositionã€‚ ä»è¿™å¹…å›¾å¯ä»¥çœ‹åˆ°ï¼Œä»–çš„å®¹é‡ï¼ˆcapacityï¼‰å’Œé™åˆ¶ï¼ˆlimitï¼‰è®¾ç½®ä¸º10ï¼Œä½ç½®è®¾ç½®ä¸º0ï¼Œæ¯ä¸ªç¼“å†²åŒºå®¹é‡æ˜¯å›ºå®šçš„ï¼Œæ ‡è®°æ˜¯æœªå®šä¹‰çš„ï¼Œå…¶ä»–ä¸‰ä¸ªå±æ€§å¯ä»¥é€šè¿‡ä½¿ç”¨ç¼“å†²åŒºè§£å†³ã€‚ ç¼“å†²åŒºå­˜å‚¨æ•°æ®æ”¯æŒçš„æ•°æ®ç±»å‹æ”¯æŒä¸ƒç§æ•°æ®ç±»å‹ï¼Œä»–ä»¬æ˜¯ï¼š1.byteBuffer2.charBuffer3.shortBuffer4.IntBuffer5.LongBuffer6.FloatBuffer7.DubooBuffer åŸºæœ¬ç”¨æ³•ä½¿ç”¨Bufferè¯»å†™æ•°æ®ä¸€èˆ¬éµå¾ªä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š (1) å†™å…¥æ•°æ®åˆ°Bufferï¼Œä¸€èˆ¬æœ‰å¯ä»¥ä»Channelè¯»å–åˆ°ç¼“å†²åŒºä¸­ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨putæ–¹æ³•å†™å…¥ã€‚ (2) è°ƒç”¨flip()æ–¹æ³•ï¼Œåˆ‡æ¢æ•°æ®æ¨¡å¼ã€‚ (3) ä»Bufferä¸­è¯»å–æ•°æ®ï¼Œä¸€èˆ¬ä»ç¼“å†²åŒºè¯»å–æ•°æ®å†™å…¥åˆ°é€šé“ä¸­ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨getæ–¹æ³•è¯»å–ã€‚ (4) è°ƒç”¨clear()æ–¹æ³•æˆ–è€…compact()æ–¹æ³•ã€‚ ç¼“å†²åŒºAPIé¦–å…ˆï¼Œç”¨allocate æŒ‡å®šç¼“å†²åŒºå¤§å°1024 1ByteBuffer byteBuffer=ByteBuffer.allocate(1024); å­˜å‚¨æˆ–å¡«å……æˆ‘ä»¬å¯ä»¥ç”¨put å­˜å…¥æ•°æ®åˆ°ç¼“å†²åŒº 1byteBuffer.put("tengshe789".getBytes()); å½“è°ƒç”¨putæ—¶ï¼Œä¼šæŒ‡å‡ºä¸‹ä¸€ä¸ªå…ƒç´ åº”å½“è¢«æ’å…¥çš„ä½ç½®ï¼Œä½ç½®ï¼ˆpositionï¼‰æŒ‡å‘çš„æ˜¯ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœæŒ‡å‘çš„ä½ç½®è¶…è¿‡é™åˆ¶ï¼ˆlimitï¼‰ï¼Œåˆ™æŠ›å‡ºBufferOverFlowExceptionå¼‚å¸¸ã€‚ ç¿»è½¬Flipå°†ä¸€ä¸ªèƒ½å¤Ÿç»§ç»­æ·»åŠ æ•°æ®å…ƒç´ çš„å¡«å……çŠ¶æ€çš„ç¼“å†²åŒºç¿»è½¬æˆä¸€ä¸ªå‡†å¤‡è¯»å‡ºå…ƒç´ çš„é‡Šæ”¾çŠ¶æ€ 1byteBuffer.flip(); å…·ä½“æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ å¯¹äºå·²ç»å†™æ»¡äº†ç¼“å†²åŒºï¼Œå¦‚æœå°†ç¼“å†²åŒºå†…å®¹ä¼ é€’ç»™ä¸€ä¸ªé€šé“ï¼Œä»¥ä½¿å†…å®¹èƒ½è¢«å…¨éƒ¨å†™å‡ºã€‚ ä½†å¦‚æœé€šé“ç°åœ¨åœ¨ç¼“å†²åŒºä¸Šæ‰§è¡Œgetï¼Œé‚£ä¹ˆå®ƒå°†ä»æˆ‘ä»¬åˆšåˆšæ’å…¥çš„æœ‰ç”¨æ•°æ®ä¹‹å¤–å–å‡ºæœªå®šä¹‰æ•°æ®ã€‚é€šè¿‡ç¿»è½¬å°†ä½ç½®å€¼é‡æ–°è®¾ä¸º 0ï¼Œé€šé“å°±ä¼šä»æ­£ç¡®ä½ç½®å¼€å§‹è·å–ã€‚ ä¾‹å¦‚æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå®¹é‡æ˜¯10çš„bufferï¼Œå¹¶å¡«å…¥helloï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º ç¿»è½¬åå¦‚ä¸‹å›¾æ‰€ç¤º é‡è¯»Rewindä¸ flipç›¸ä¼¼ï¼Œä½†ä¸å½±å“ä¸Šç•Œå±æ€§ã€‚å®ƒåªæ˜¯å°†ä½ç½®å€¼è®¾å› 0ã€‚å¯ä»¥ä½¿ç”¨ rewind()åé€€ï¼Œé‡è¯»å·²ç»è¢«ç¿»è½¬çš„ç¼“å†²åŒºä¸­çš„æ•°æ®ã€‚ 1byteBuffer.rewind(); è·å–ç¿»è½¬å®Œäº†ï¼Œå°±å¯ä»¥ç”¨getè·å–ç¼“å†²åŒºæ•°æ®äº† 12byte[] b= new byte[byteBuffer.limit()];byteBuffer.get(b); å½“è°ƒç”¨getæ—¶ï¼Œä¼šæŒ‡å‡ºä¸‹ä¸€ä¸ªå…ƒç´ åº”å½“è¢«ç´¢å¼•çš„ä½ç½®ï¼Œä½ç½®ï¼ˆpositionï¼‰è¿”å›æ—¶ä¼š+1sã€‚å¦‚æœæŒ‡å‘çš„ä½ç½®è¶…è¿‡é™åˆ¶ï¼ˆlimitï¼‰ï¼Œåˆ™æŠ›å‡ºBufferUnderFlowExceptionå¼‚å¸¸ã€‚å¦‚æœæä¾›çš„ç´¢å¼•è¶…è¿‡èŒƒå›´ï¼Œä¹Ÿä¼šæŠ›å‡ºIndexOutOfBoundsExceptionå¼‚å¸¸ é‡Šæ”¾remainingå¯ä»¥å‘Šè¯‰ä½ ä»å½“å‰ä½ç½®ï¼ˆpositionï¼‰åˆ°é™åˆ¶ï¼ˆlimitï¼‰è¿˜å‰©çš„å…ƒç´ æ•°ç›® 1int count = byteBuffer.remaining(); clearå°†ç¼“å†²åŒºé‡ç½®ä¸ºç©ºçŠ¶æ€ 1byteBuffer.clear(); å‹ç¼©å¦‚æœæˆ‘ä»¬åªæƒ³ä»ç¼“å†²åŒºä¸­é‡Šæ”¾ä¸€éƒ¨åˆ†æ•°æ®ï¼Œè€Œä¸æ˜¯å…¨éƒ¨ï¼Œç„¶åé‡æ–°å¡«å……ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæœªè¯»çš„æ•°æ®å…ƒç´ éœ€è¦ä¸‹ç§»ä»¥ä½¿ç¬¬ä¸€ä¸ªå…ƒç´ ç´¢å¼•ä¸º 0ã€‚å°½ç®¡é‡å¤è¿™æ ·åšä¼šæ•ˆç‡ä½ä¸‹ï¼Œä½†è¿™æœ‰æ—¶éå¸¸å¿…è¦ï¼Œè€Œ API å¯¹æ­¤ä¸ºæ‚¨æä¾›äº†ä¸€ä¸ª compact()å‡½æ•°ã€‚ 1byteBuffer.compact(); æ ‡è®°ä¸é‡ç½®æ ‡è®°æ˜¯ä¸€ä¸ªç´¢å¼•ï¼Œé€šè¿‡Bufferä¸­çš„mark()æ–¹æ³•æŒ‡å®šBufferä¸­ä¸€ä¸ªç‰¹å®šçš„positionï¼Œä¹‹åå¯ä»¥é€šè¿‡è°ƒç”¨reset()æ–¹æ³•æ¢å¤åˆ°è¿™ä¸ªpositionã€‚è¦çŸ¥é“ç¼“å†²åŒºçš„æ ‡è®°åœ¨mark()å‡½æ•°è¢«è°ƒç”¨å‰æ—¶æœªå®šä¹‰çš„ï¼Œå¦‚æœæ ‡è®°æœªå®šä¹‰ï¼Œè°ƒç”¨reset()ä¼šå¯¼è‡´InvalidMarkExceptionå¼‚å¸¸ 1byteBuffer.position(2).mark().position(4).reset(); è¦æ³¨æ„ï¼Œjava.nioä¸­çš„ç±»ç‰¹æ„è¢«è®¾è®¡ä¸ºæ”¯æŒçº§è”è°ƒç”¨ï¼Œä¼˜é›…çš„ä½¿ç”¨çº§è”è°ƒç”¨ï¼Œå¯ä»¥äº§ç”Ÿä¼˜ç¾æ˜“è¯»çš„ä»£ç ã€‚ ç›´æ¥ç¼“å†²åŒºä¸éç›´æ¥ç¼“å†²åŒºéç›´æ¥ç¼“å†²åŒºä¸Šé¢æˆ‘ä»¬è¯´äº†ByteBufferï¼Œä¹Ÿå°±æ˜¯ç¼“å†²åŒºçš„ç”¨æ³•ï¼Œè­¬å¦‚ç”¨allocate() æ–¹æ³•æŒ‡å®šç¼“å†²åŒºå¤§å°ï¼Œç„¶åè¿›è¡Œå¡«å……æˆ–ç¿»è½¬æ“ä½œç­‰ç­‰ç­‰ã€‚æˆ‘ä»¬æ‰€åˆ›å»ºçš„ç¼“å†²åŒºï¼Œéƒ½å±äºç›´æ¥ç¼“å†²åŒºã€‚ä»–ä»¬éƒ½æ˜¯åœ¨JVMä¸­å†…å­˜ä¸­åˆ›å»ºï¼Œåœ¨æ¯æ¬¡è°ƒç”¨åŸºç¡€æ“ä½œç³»ç»Ÿçš„ä¸€ä¸ªæœ¬æœºIOä¹‹å‰æˆ–è€…ä¹‹åï¼Œè™šæ‹Ÿæœºéƒ½ä¼šå°†ç¼“å†²åŒºçš„å†…å®¹å¤åˆ¶åˆ°ä¸­é—´ç¼“å†²åŒºï¼ˆæˆ–è€…ä»ä¸­é—´ç¼“å†²åŒºå¤åˆ¶å†…å®¹ï¼‰ï¼Œç¼“å†²åŒºçš„å†…å®¹é©»ç•™åœ¨JVMå†…ï¼Œå› æ­¤é”€æ¯å®¹æ˜“ï¼Œä½†æ˜¯å ç”¨JVMå†…å­˜å¼€é”€ï¼Œå¤„ç†è¿‡ç¨‹ä¸­æœ‰å¤åˆ¶æ“ä½œã€‚ éç›´æ¥ç¼“å†²åŒºå†™å…¥æ­¥éª¤ï¼š 1.åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„ç›´æ¥ByteBufferå¯¹è±¡ã€‚2.å°†éç›´æ¥ç¼“å†²åŒºçš„å†…å®¹å¤åˆ¶åˆ°ä¸´æ—¶ç¼“å†²ä¸­ã€‚3.ä½¿ç”¨ä¸´æ—¶ç¼“å†²åŒºæ‰§è¡Œä½å±‚æ¬¡I/Oæ“ä½œã€‚4.ä¸´æ—¶ç¼“å†²åŒºå¯¹è±¡ç¦»å¼€ä½œç”¨åŸŸï¼Œå¹¶æœ€ç»ˆæˆä¸ºè¢«å›æ”¶çš„æ— ç”¨æ•°æ®ã€‚ 1234567891011121314151617181920212223242526/** * @program: UndirectBuffer * @description: åˆ©ç”¨é€šé“å®Œæˆæ–‡ä»¶çš„å¤åˆ¶(éç›´æ¥ç¼“å†²åŒº) * @author: tEngSHe789 **/public class UndirectBuffer &#123; public static void main(String[] args) throws IOException &#123; // åˆ›å»ºæµ FileInputStream fis = new FileInputStream("d://blog.md"); FileOutputStream fos = new FileOutputStream("d://blog.md"); //è·å–ç®¡é“ FileChannel in = fis.getChannel(); FileChannel out = fos.getChannel(); // åˆ†é…æŒ‡å®šå¤§å°çš„ç¼“å†²åŒº ByteBuffer buffer = ByteBuffer.allocate(1024); while (in.read(buffer) !=-1)&#123; buffer.flip();// å‡†å¤‡è¯»æ•°æ®äº† out.write(buffer); buffer.clear(); &#125; out.close(); in.close(); fis.close(); fos.close(); &#125;&#125; ç›´æ¥ç¼“å†²åŒºç›´æ¥ç¼“å†²åŒºï¼Œæ˜¯é€šè¿‡ allocateDirect() æ–¹æ³•åœ¨JVMå†…å­˜å¤–å¼€è¾Ÿå†…å­˜ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨åŸºç¡€æ“ä½œç³»ç»Ÿçš„ä¸€ä¸ªæœ¬æœºIOä¹‹å‰æˆ–è€…ä¹‹åï¼Œè™šæ‹Ÿæœºéƒ½ä¼šé¿å…å°†ç¼“å†²åŒºçš„å†…å®¹å¤åˆ¶åˆ°ä¸­é—´ç¼“å†²åŒºï¼ˆæˆ–è€…ä»ä¸­é—´ç¼“å†²åŒºå¤åˆ¶å†…å®¹ï¼‰ï¼Œç¼“å†²åŒºçš„å†…å®¹é©»ç•™åœ¨ç‰©ç†å†…å­˜å†…ï¼Œä¼šå°‘ä¸€æ¬¡å¤åˆ¶è¿‡ç¨‹ï¼Œå¦‚æœéœ€è¦å¾ªç¯ä½¿ç”¨ç¼“å†²åŒºï¼Œç”¨ç›´æ¥ç¼“å†²åŒºå¯ä»¥å¾ˆå¤§åœ°æé«˜æ€§èƒ½ã€‚ è™½ç„¶ç›´æ¥ç¼“å†²åŒºä½¿JVMå¯ä»¥è¿›è¡Œé«˜æ•ˆçš„I/Oæ“ä½œï¼Œä½†å®ƒä½¿ç”¨çš„å†…å­˜æ˜¯æ“ä½œç³»ç»Ÿåˆ†é…çš„ï¼Œç»•è¿‡äº†JVMå †æ ˆï¼Œå»ºç«‹å’Œé”€æ¯æ¯”å †æ ˆä¸Šçš„ç¼“å†²åŒºè¦æ›´å¤§çš„å¼€é”€ã€‚ 12345678910111213141516171819202122/** * @program: DirectBuffer * @description: ä½¿ç”¨ç›´æ¥ç¼“å†²åŒºå®Œæˆæ–‡ä»¶çš„å¤åˆ¶(å†…å­˜æ˜ å°„æ–‡ä»¶) * @author: tEngSHe789 **/public class DirectBuffer &#123; public static void main(String[] args) throws IOException &#123; //åˆ›å»ºç®¡é“ FileChannel in=FileChannel.open(Paths.get("d://blog.md"),StandardOpenOption.READ); FileChannel out=FileChannel.open(Paths.get("d://blog.md"),StandardOpenOption.WRITE ,StandardOpenOption.READ,StandardOpenOption.CREATE); // æ‹¿åˆ°å°†ç®¡é“å†…å®¹æ˜ å°„åˆ°å†…å­˜çš„ç›´æ¥ç¼“å†²åŒºæ˜ å°„æ–‡ä»¶ï¼ˆä¸€ä¸ªä½ç½®åœ¨ç¡¬ç›˜çš„åŸºäºå†…å­˜çš„ç¼“å†²åŒºï¼‰ MappedByteBuffer inMappedByteBuffer = in.map(FileChannel.MapMode.READ_ONLY, 0, in.size()); MappedByteBuffer outMappedByteBuffer = out.map(FileChannel.MapMode.READ_WRITE, 0, in.size()); // å¯¹ç›´æ¥ç¼“å†²åŒºè¿›è¡Œæ•°æ®è¯»å†™æ“ä½œ byte[] bytes=new byte[inMappedByteBuffer.limit()]; inMappedByteBuffer.get(bytes); outMappedByteBuffer.put(bytes); in.close(); out.close(); &#125;&#125; ç›´æ¥ç¼“å†²åŒºä¸éç›´æ¥ç¼“å†²åŒºçš„åŒºåˆ« å­—èŠ‚ç¼“å†²åŒºè¦ä¹ˆæ˜¯ç›´æ¥çš„ï¼Œè¦ä¹ˆæ˜¯éç›´æ¥çš„ã€‚å¦‚æœä¸ºç›´æ¥å­—èŠ‚ç¼“å†²åŒºï¼Œåˆ™ Java è™šæ‹Ÿæœºä¼šå°½æœ€å¤§åŠªåŠ›ç›´æ¥åœ¨æ­¤ç¼“å†²åŒºä¸Šæ‰§è¡Œæœ¬æœº I/O æ“ä½œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ¯æ¬¡è°ƒç”¨åŸºç¡€æ“ä½œç³»ç»Ÿçš„ä¸€ä¸ªæœ¬æœº I/O æ“ä½œä¹‹å‰ï¼ˆæˆ–ä¹‹åï¼‰ï¼Œè™šæ‹Ÿæœºéƒ½ä¼šå°½é‡é¿å…å°†ç¼“å†²åŒºçš„å†…å®¹å¤åˆ¶åˆ°ä¸­é—´ç¼“å†²åŒºä¸­ï¼ˆæˆ–ä»ä¸­é—´ç¼“å†²åŒºä¸­å¤åˆ¶å†…å®¹ï¼‰ã€‚ ç›´æ¥å­—èŠ‚ç¼“å†²åŒºå¯ä»¥é€šè¿‡è°ƒç”¨æ­¤ç±»çš„ allocateDirect() å·¥å‚æ–¹æ³•æ¥åˆ›å»ºã€‚æ­¤æ–¹æ³•è¿”å›çš„ç¼“å†²åŒºè¿›è¡Œåˆ†é…å’Œå–æ¶ˆåˆ†é…æ‰€éœ€æˆæœ¬é€šå¸¸é«˜äºéç›´æ¥ç¼“å†²åŒºã€‚ç›´æ¥ç¼“å†²åŒºçš„å†…å®¹å¯ä»¥é©»ç•™åœ¨å¸¸è§„çš„åƒåœ¾å›æ”¶å †ä¹‹å¤–ï¼Œå› æ­¤ï¼Œå®ƒä»¬å¯¹åº”ç”¨ç¨‹åºçš„å†…å­˜éœ€æ±‚é‡é€ æˆçš„å½±å“å¯èƒ½å¹¶ä¸æ˜æ˜¾ã€‚æ‰€ä»¥ï¼Œå»ºè®®å°†ç›´æ¥ç¼“å†²åŒºä¸»è¦åˆ†é…ç»™é‚£äº›æ˜“å—åŸºç¡€ç³»ç»Ÿçš„æœ¬æœº I/O æ“ä½œå½±å“çš„å¤§å‹ã€æŒä¹…çš„ç¼“å†²åŒºã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæœ€å¥½ä»…åœ¨ç›´æ¥ç¼“å†²åŒºèƒ½åœ¨ç¨‹åºæ€§èƒ½æ–¹é¢å¸¦æ¥æ˜æ˜¾å¥½å¤„æ—¶åˆ†é…å®ƒä»¬ã€‚ ç›´æ¥å­—èŠ‚ç¼“å†²åŒºè¿˜å¯ä»¥é€šè¿‡ FileChannel çš„ map() æ–¹æ³• å°†æ–‡ä»¶åŒºåŸŸç›´æ¥æ˜ å°„åˆ°å†…å­˜ä¸­æ¥åˆ›å»ºã€‚è¯¥æ–¹æ³•è¿”å›MappedByteBuffer ã€‚ Java å¹³å°çš„å®ç°æœ‰åŠ©äºé€šè¿‡ JNI ä»æœ¬æœºä»£ç åˆ›å»ºç›´æ¥å­—èŠ‚ç¼“å†²åŒºã€‚å¦‚æœä»¥ä¸Šè¿™äº›ç¼“å†²åŒºä¸­çš„æŸä¸ªç¼“å†²åŒºå®ä¾‹æŒ‡çš„æ˜¯ä¸å¯è®¿é—®çš„å†…å­˜åŒºåŸŸï¼Œåˆ™è¯•å›¾è®¿é—®è¯¥åŒºåŸŸä¸ä¼šæ›´æ”¹è¯¥ç¼“å†²åŒºçš„å†…å®¹ï¼Œå¹¶ä¸”å°†ä¼šåœ¨è®¿é—®æœŸé—´æˆ–ç¨åçš„æŸä¸ªæ—¶é—´å¯¼è‡´æŠ›å‡ºä¸ç¡®å®šçš„å¼‚å¸¸ã€‚ å­—èŠ‚ç¼“å†²åŒºæ˜¯ç›´æ¥ç¼“å†²åŒºè¿˜æ˜¯éç›´æ¥ç¼“å†²åŒºå¯é€šè¿‡è°ƒç”¨å…¶ isDirect() æ–¹æ³•æ¥ç¡®å®šã€‚æä¾›æ­¤æ–¹æ³•æ˜¯ä¸ºäº†èƒ½å¤Ÿåœ¨æ€§èƒ½å…³é”®å‹ä»£ç ä¸­æ‰§è¡Œæ˜¾å¼ç¼“å†²åŒºç®¡ç†ã€‚ Channelé€šé“æ˜¯java.nioçš„ç¬¬äºŒä¸ªåˆ›æ–°ï¼Œè¡¨ç¤ºæä¾› IO è®¾å¤‡(ä¾‹å¦‚ï¼šæ–‡ä»¶ã€å¥—æ¥å­—)çš„ç›´æ¥è¿æ¥ã€‚ è‹¥éœ€è¦ä½¿ç”¨ NIO ç³»ç»Ÿï¼Œéœ€è¦è·å–ç”¨äºè¿æ¥ IO è®¾å¤‡çš„é€šé“ä»¥åŠç”¨äºå®¹çº³æ•°æ®çš„ç¼“å†²åŒºã€‚ç„¶åæ“ä½œç¼“å†²åŒºï¼Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€‚è¿™å…¶ä¸­ï¼ŒChannelè´Ÿè´£ä¼ è¾“ï¼Œ Buffer è´Ÿè´£å­˜å‚¨ã€‚ é€šé“æ˜¯ç”±java.nio.channels åŒ…å®šä¹‰çš„ï¼ŒChannel è¡¨ç¤º IO æºä¸ç›®æ ‡æ‰“å¼€çš„è¿æ¥ã€‚Channel ç±»ä¼¼äºä¼ ç»Ÿçš„â€œæµâ€ã€‚åªä¸è¿‡ Channelæœ¬èº«ä¸èƒ½ç›´æ¥è®¿é—®æ•°æ®ï¼Œ Channel åªèƒ½ä¸Buffer è¿›è¡Œäº¤äº’ã€‚ æ¥å£java.nio.channels.Channel æ¥å£ï¼š FileChannel SocketChannel ServerSocketChannel DatagramChannel ä¸ç¼“å†²åŒºä¸åŒï¼Œé€šé“APIä¸»è¦ç”±æ¥å£æŒ‡å®šï¼Œä¸åŒæ“ä½œç³»ç»Ÿä¸Šé€šé“çš„å®ç°ä¼šä¸ä¸€æ · å®ç°ç›´æ¥ç¼“å†²åŒºä¸éç›´æ¥ç¼“å†²åŒºçš„æ —å­ åˆ†æ•£è¯»å–ä¸èšé›†å†™å…¥é€šé“å¯ä»¥æœ‰é€‰æ‹©åœ°å®ç°ä¸¤ä¸ªæ–°çš„æ¥å£ï¼š ScatteringByteChannel å’Œ GatheringByteChannelã€‚ ScatteringByteChannel æœ‰2ä¸ªreadæ–¹æ³•ï¼Œæˆ‘ä»¬éƒ½å«å¥¹åˆ†æ•£è¯»å–(scattering Reads)ï¼Œåˆ†æ•£è¯»å–ä¸­ï¼Œé€šé“ä¾æ¬¡å¡«å……æ¯ä¸ªç¼“å†²åŒºã€‚å¡«æ»¡ä¸€ä¸ªç¼“å†²åŒºåï¼Œå®ƒå°±å¼€å§‹å¡«å……ä¸‹ä¸€ä¸ªã€‚åœ¨æŸç§æ„ä¹‰ä¸Šï¼Œç¼“å†²åŒºæ•°ç»„å°±åƒä¸€ä¸ªå¤§ç¼“å†²åŒºã€‚ GatheringByteChannelä¸­æœ‰2ä¸ªwirteæ–¹æ³•ï¼Œæˆ‘ä»¬éƒ½å«å¥¹èšé›†å†™å…¥(gathering Writes)ï¼Œä»–å¯ä»¥å°†å¤šä¸ªç¼“å†²åŒºçš„æ•°æ®èšé›†åˆ°é€šé“ä¸­ åˆ†æ•£è¯»å–ä¸èšé›†å†™å…¥çš„åº”ç”¨åˆ†æ•£è¯»å–/èšé›†å†™å…¥å¯¹äºå°†æ•°æ®åˆ’åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†å¾ˆæœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½åœ¨ç¼–å†™ä¸€ä¸ªä½¿ç”¨æ¶ˆæ¯å¯¹è±¡çš„ç½‘ç»œåº”ç”¨ç¨‹åºï¼Œæ¯ä¸€ä¸ªæ¶ˆæ¯è¢«åˆ’åˆ†ä¸ºå›ºå®šé•¿åº¦çš„å¤´éƒ¨å’Œå›ºå®šé•¿åº¦çš„æ­£æ–‡ã€‚æ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªåˆšå¥½å¯ä»¥å®¹çº³å¤´éƒ¨çš„ç¼“å†²åŒºå’Œå¦ä¸€ä¸ªåˆšå¥½å¯ä»¥å®¹éš¾æ­£æ–‡çš„ç¼“å†²åŒºã€‚å½“æ‚¨å°†å®ƒä»¬æ”¾å…¥ä¸€ä¸ªæ•°ç»„ä¸­å¹¶ä½¿ç”¨åˆ†æ•£è¯»å–æ¥å‘å®ƒä»¬è¯»å…¥æ¶ˆæ¯æ—¶ï¼Œå¤´éƒ¨å’Œæ­£æ–‡å°†æ•´é½åœ°åˆ’åˆ†åˆ°è¿™ä¸¤ä¸ªç¼“å†²åŒºä¸­ã€‚ æˆ‘ä»¬ä»ç¼“å†²åŒºæ‰€å¾—åˆ°çš„æ–¹ä¾¿æ€§å¯¹äºç¼“å†²åŒºæ•°ç»„åŒæ ·æœ‰æ•ˆã€‚å› ä¸ºæ¯ä¸€ä¸ªç¼“å†²åŒºéƒ½è·Ÿè¸ªè‡ªå·±è¿˜å¯ä»¥æ¥å—å¤šå°‘æ•°æ®ï¼Œæ‰€ä»¥åˆ†æ•£è¯»å–ä¼šè‡ªåŠ¨æ‰¾åˆ°æœ‰ç©ºé—´æ¥å—æ•°æ®çš„ç¬¬ä¸€ä¸ªç¼“å†²åŒºã€‚åœ¨è¿™ä¸ªç¼“å†²åŒºå¡«æ»¡åï¼Œå®ƒå°±ä¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªç¼“å†²åŒºã€‚ Pythonä¸NIOæœåŠ¡ç«¯ï¼ˆå…·ä½“è§æ³¨é‡Šï¼‰ 1234567891011121314151617181920212223242526272829303132333435from socket import *import times=socket(AF_INET,SOCK_STREAM)s.bind(('127.0.0.1',8888))s.listen(5)s.setblocking(False) #è®¾ç½®socketçš„æ¥å£ä¸ºéé˜»å¡conn_l=[] # å­˜å‚¨å’Œserverçš„è¿æ¥ çš„ è¿æ¥del_l=[] # å­˜å‚¨å’Œå’Œserverçš„æ–­å¼€ çš„ è¿æ¥while True: try: # è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸é˜»å¡çš„ conn,addr=s.accept() # å½“æ²¡äººè¿æ¥çš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œèµ°exceptionï¼ˆ&lt;- pyä¸­æ˜¯exceptï¼‰ conn_l.append(conn) except BlockingIOError: print(conn_l) for conn in conn_l: try: data=conn.recv(1024) if not data: del_l.append(conn) # è¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸é˜»å¡çš„ data=conn.recv(1024) # ä¸é˜»å¡ if not data: # å¦‚æœæ‹¿ä¸åˆ°data del_l.append(conn) # åœ¨åºŸå¼ƒåˆ—è¡¨ä¸­æ·»åŠ conn continue conn.send(data.upper()) except BlockingIOError: pass except ConnectionResetError: del_l.append(conn) for conn in del_l: conn_l.remove(conn) conn.close() del_l=[] å®¢æˆ·ç«¯ 12345678910from socket import *c=socket(AF_INET,SOCK_STREAM)c.connect(('127.0.0.1',8888))while True: msg=input('&gt;&gt;: ') if not msg:continue c.send(msg.encode('utf-8')) data=c.recv(1024) print(data.decode('utf-8')) IOå¤ç”¨(IO multiplexing)I/Oå¤šè·¯å¤ç”¨å®é™…ä¸Šå°±æ˜¯ç”¨select, poll, epollç›‘å¬å¤šä¸ªioå¯¹è±¡ï¼Œå½“ioå¯¹è±¡æœ‰å˜åŒ–ï¼ˆæœ‰æ•°æ®ï¼‰çš„æ—¶å€™å°±é€šçŸ¥ç”¨æˆ·è¿›ç¨‹ã€‚æœ‰äº›åœ°æ–¹ä¹Ÿç§°è¿™ç§IOæ–¹å¼ä¸ºäº‹ä»¶é©±åŠ¨IO(event driven IO)ã€‚ä¸å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹æŠ€æœ¯ç›¸æ¯”ï¼ŒI/Oå¤šè·¯å¤ç”¨æŠ€æœ¯çš„æœ€å¤§ä¼˜åŠ¿æ˜¯ç³»ç»Ÿå¼€é”€å°ï¼Œç³»ç»Ÿä¸å¿…åˆ›å»ºè¿›ç¨‹/çº¿ç¨‹ï¼Œä¹Ÿä¸å¿…ç»´æŠ¤è¿™äº›è¿›ç¨‹/çº¿ç¨‹ï¼Œä»è€Œå¤§å¤§å‡å°äº†ç³»ç»Ÿçš„å¼€é”€ã€‚å½“ç„¶å…·ä½“çš„å¯ä»¥çœ‹çœ‹è¿™ç¯‡åšå®¢ï¼Œç°åœ¨å…ˆæ¥çœ‹ä¸‹I/Oå¤šè·¯å¤ç”¨çš„æµç¨‹ï¼š ï¼ˆ1ï¼‰å½“ç”¨æˆ·è¿›ç¨‹è°ƒç”¨äº†selectï¼Œé‚£ä¹ˆæ•´ä¸ªè¿›ç¨‹ä¼šè¢«blockï¼› ï¼ˆ2ï¼‰è€ŒåŒæ—¶ï¼Œkernelä¼šâ€œç›‘è§†â€æ‰€æœ‰selectè´Ÿè´£çš„socketï¼› ï¼ˆ3ï¼‰å½“ä»»ä½•ä¸€ä¸ªsocketä¸­çš„æ•°æ®å‡†å¤‡å¥½äº†ï¼Œselectå°±ä¼šè¿”å›ï¼› ï¼ˆ4ï¼‰è¿™ä¸ªæ—¶å€™ç”¨æˆ·è¿›ç¨‹å†è°ƒç”¨readæ“ä½œï¼Œå°†æ•°æ®ä»kernelæ‹·è´åˆ°ç”¨æˆ·è¿›ç¨‹ã€‚ è¿™ä¸ªå›¾å’ŒBIOçš„å›¾å…¶å®å¹¶æ²¡æœ‰å¤ªå¤§çš„ä¸åŒï¼Œäº‹å®ä¸Šè¿˜æ›´å·®ä¸€äº›ã€‚å› ä¸ºè¿™é‡Œéœ€è¦ä½¿ç”¨ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨(selectå’Œrecvfrom)ï¼Œè€ŒBIOåªè°ƒç”¨äº†ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨(recvfrom)ã€‚ä½†æ˜¯ï¼Œç”¨selectçš„ä¼˜åŠ¿åœ¨äºå®ƒå¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªconnectionã€‚ JAVAå®ç°IOå¤ç”¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯java.nioä¸‹æ¨¡å—æ¥å®ŒæˆI/Oå¤šè·¯å¤ç”¨çš„ä¾‹å­ã€‚æˆ‘ç”¨åˆ°çš„Selectorï¼ˆé€‰æ‹©å™¨ï¼‰ï¼Œæ˜¯Java NIOä¸­èƒ½å¤Ÿæ£€æµ‹ä¸€åˆ°å¤šä¸ªNIOé€šé“ï¼Œå¹¶èƒ½å¤ŸçŸ¥æ™“é€šé“æ˜¯å¦ä¸ºè¯¸å¦‚è¯»å†™äº‹ä»¶åšå¥½å‡†å¤‡çš„ç»„ä»¶ã€‚è¿™æ ·ï¼Œä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹å¯ä»¥ç®¡ç†å¤šä¸ªchannelï¼Œä»è€Œç®¡ç†å¤šä¸ªç½‘ç»œè¿æ¥ã€‚ Selectorçš„ä½¿ç”¨Selectorçš„åˆ›å»º1Selector selector = Selector.open(); å‘Selectoræ³¨å†Œé€šé“ä¸ºäº†å°†Channelå’ŒSelectoré…åˆä½¿ç”¨ï¼Œå¿…é¡»å°†channelæ³¨å†Œåˆ°selectorä¸Šã€‚é€šè¿‡SelectableChannel.register()æ–¹æ³•æ¥å®ç°ï¼Œå¦‚ä¸‹ï¼š 12channel.configureBlocking(false);SelectionKey key = channel.register(selector,Selectionkey.OP_READ); register()æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªâ€œinteresté›†åˆâ€ï¼Œæ„æ€æ˜¯åœ¨é€šè¿‡Selectorç›‘å¬Channelæ—¶å¯¹ä»€ä¹ˆäº‹ä»¶æ„Ÿå…´è¶£ã€‚å¯ä»¥ç›‘å¬å››ç§ä¸åŒç±»å‹çš„äº‹ä»¶ï¼šConnectã€Acceptã€Readã€Write é€šé“è§¦å‘äº†ä¸€ä¸ªäº‹ä»¶æ„æ€æ˜¯è¯¥äº‹ä»¶å·²ç»å°±ç»ªã€‚æ‰€ä»¥ï¼ŒæŸä¸ªchannelæˆåŠŸè¿æ¥åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨ç§°ä¸ºâ€œè¿æ¥å°±ç»ªâ€ã€‚ä¸€ä¸ªserver socket channelå‡†å¤‡å¥½æ¥æ”¶æ–°è¿›å…¥çš„è¿æ¥ç§°ä¸ºâ€œæ¥æ”¶å°±ç»ªâ€ã€‚ä¸€ä¸ªæœ‰æ•°æ®å¯è¯»çš„é€šé“å¯ä»¥è¯´æ˜¯â€œè¯»å°±ç»ªâ€ã€‚ç­‰å¾…å†™æ•°æ®çš„é€šé“å¯ä»¥è¯´æ˜¯â€œå†™å°±ç»ªâ€ã€‚ è¿™å››ç§äº‹ä»¶ç”¨SelectionKeyçš„å››ä¸ªå¸¸é‡æ¥è¡¨ç¤ºï¼š SelectionKey.OP_CONNECTå¯è¿æ¥ SelectionKey.OP_ACCEPTå¯æ¥å—è¿æ¥ SelectionKey.OP_READå¯è¯» SelectionKey.OP_WRITEå¯å†™ SelectionKeyå½“å‘Selectoræ³¨å†ŒChannelæ—¶ï¼Œregister()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªSelectionKeyå¯¹è±¡ã€‚å®ƒåŒ…å«äº†ï¼š interesté›†åˆ readyé›†åˆ Channel Selector é™„åŠ çš„å¯¹è±¡ï¼ˆå¯é€‰ï¼‰ interesté›†åˆinteresté›†åˆæ˜¯ä½ æ‰€é€‰æ‹©çš„æ„Ÿå…´è¶£çš„äº‹ä»¶é›†åˆã€‚å¯ä»¥é€šè¿‡SelectionKeyè¯»å†™interesté›†åˆï¼Œåƒè¿™æ ·ï¼š 123456int interestSet = selectionKey.interestOps();boolean isInterestedInAccept = (interestSet &amp; SelectionKey.OP_ACCEPT) == SelectionKey.OP_ACCEPTï¼›boolean isInterestedInConnect = interestSet &amp; SelectionKey.OP_CONNECT;boolean isInterestedInRead = interestSet &amp; SelectionKey.OP_READ;boolean isInterestedInWrite = interestSet &amp; SelectionKey.OP_WRITE; å¯ä»¥çœ‹åˆ°ï¼Œç”¨â€œä½ä¸â€æ“ä½œinterest é›†åˆå’Œç»™å®šçš„SelectionKeyå¸¸é‡ï¼Œå¯ä»¥ç¡®å®šæŸä¸ªç¡®å®šçš„äº‹ä»¶æ˜¯å¦åœ¨interest é›†åˆä¸­ã€‚ readyé›†åˆready é›†åˆæ˜¯é€šé“å·²ç»å‡†å¤‡å°±ç»ªçš„æ“ä½œçš„é›†åˆã€‚åœ¨ä¸€æ¬¡é€‰æ‹©(Selection)ä¹‹åï¼Œä½ ä¼šé¦–å…ˆè®¿é—®è¿™ä¸ªready setã€‚Selectionå°†åœ¨ä¸‹ä¸€å°èŠ‚è¿›è¡Œè§£é‡Šã€‚å¯ä»¥è¿™æ ·è®¿é—®readyé›†åˆï¼š 1int readySet = selectionKey.readyOps(); å¯ä»¥ç”¨åƒæ£€æµ‹interesté›†åˆé‚£æ ·çš„æ–¹æ³•ï¼Œæ¥æ£€æµ‹channelä¸­ä»€ä¹ˆäº‹ä»¶æˆ–æ“ä½œå·²ç»å°±ç»ªã€‚ä½†æ˜¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å››ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬éƒ½ä¼šè¿”å›ä¸€ä¸ªå¸ƒå°”ç±»å‹ï¼š 1234selectionKey.isAcceptable();selectionKey.isConnectable();selectionKey.isReadable();selectionKey.isWritable(); ä»SelectionKeyè®¿é—®Channelå’ŒSelector12Channel channel = selectionKey.channel();Selector selector = selectionKey.selector(); javaä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849/** * @program: NIOServer * @description: æœåŠ¡ç«¯ * @author: tEngSHe789 **/public class NIOServer &#123; public static void main(String[] args) throws IOException &#123; System.out.println("æœåŠ¡ç«¯Start...."); // åˆ›å»ºé€šé“ ServerSocketChannel serverSocketChannel=ServerSocketChannel.open(); // è®¾ç½®éé˜»å¡ serverSocketChannel.configureBlocking(false); // ç»‘å®šè¿æ¥ serverSocketChannel.bind(new InetSocketAddress(8888)); // è·å–é€‰æ‹©å™¨ Selector selector=Selector.open(); // å°†é€šé“æ³¨å†Œåˆ°é€‰æ‹©å™¨ serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT); // è½®è°ƒå¼è·å–é€‰æ‹©â€œå·²ç»å‡†å¤‡å°±ç»ªâ€çš„äº‹ä»¶ while (selector.select() &gt; 0)&#123; // è·å–å½“å‰é€‰æ‹©å™¨çš„å·¦å³å·²ç»å‡†å¤‡å°±ç»ªçš„ç›‘å¬äº‹ä»¶ï¼ˆé€‰æ‹©keyï¼‰ Iterator&lt;SelectionKey&gt; iterator=selector.selectedKeys().iterator(); while (iterator.hasNext())&#123; // è·å–å‡†å¤‡å°±ç»ªäº‹ä»¶ SelectionKey selectionKey=iterator.next(); // åˆ¤æ–­å…·ä½“æ˜¯ä»€ä¹ˆäº‹ä»¶ if (selectionKey.isAcceptable())&#123;//å¦‚æœæ˜¯â€œæ¥å—å°±ç»ªâ€ SocketChannel socketChannel=serverSocketChannel.accept();// è·å–è¿æ¥ socketChannel.configureBlocking(false); // è®¾ç½®éé˜»å¡ //å°†è¯¥é€šé“æ³¨å†Œåˆ°æœåŠ¡å™¨ä¸Š socketChannel.register(selector, SelectionKey.OP_READ); &#125;else if (selectionKey.isReadable())&#123;//å¦‚æ˜¯â€œå·²ç»å°±ç»ªâ€ SocketChannel socketChannel= (SocketChannel) selectionKey.channel();//è·å–è¿æ¥ //è¯»æ•°æ® ByteBuffer buffer=ByteBuffer.allocate(1024); int len = 0; //åˆ†æ•£è¯»å– len=socketChannel.read(buffer); while (len &gt; 0)&#123; buffer.flip(); System.out.println(new String(buffer.array(),0,len)); buffer.clear(); &#125; &#125; iterator.remove(); &#125; &#125; &#125;&#125; å®¢æˆ·ç«¯ï¼š1234567891011121314151617181920212223242526272829/** * @program: NIOClient * @description: å®¢æˆ·ç«¯ * @author: tEngSHe789 **/public class NIOClient &#123; public static void main(String[] args) throws IOException &#123; System.out.println("å®¢æˆ·ç«¯Start...."); // åˆ›å»ºé€šé“ SocketChannel socketChannel=SocketChannel.open(new InetSocketAddress("127.0.0.1",8888)); // è®¾ç½®SocketChannelæ¥å£ä¸ºéé˜»å¡ socketChannel.configureBlocking(false); //æŒ‡å®šç¼“å†²åŒºå¤§å° ByteBuffer buffer=ByteBuffer.allocate(1024); Scanner scanner=new Scanner(System.in); while (scanner.hasNext())&#123; String msg = scanner.next(); // å­˜å‚¨ buffer.put((new Date().toString()+"\n"+msg).getBytes()); // ç¿»è½¬ buffer.flip(); // èšé›†å†™å…¥ socketChannel.write(buffer); // é‡Šæ”¾ buffer.clear(); &#125; socketChannel.close(); &#125;&#125; pythonå®ç°IOå¤ç”¨å¯¹æ¯”javaç”¨çš„æ˜¯Selectorï¼Œå¯ä»¥å¸®æˆ‘ä»¬åœ¨é»˜è®¤æ“ä½œç³»ç»Ÿä¸‹é€‰æ‹©æœ€åˆé€‚çš„select, poll, epollè¿™ä¸‰ç§å¤šè·¯å¤åˆæ¨¡å‹ï¼Œpythonæ˜¯é€šè¿‡ä¸€ç§æœºåˆ¶ä¸€ä¸ªè¿›ç¨‹èƒ½åŒæ—¶ç­‰å¾…å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œè€Œè¿™äº›æ–‡ä»¶æè¿°ç¬¦ï¼ˆå¥—æ¥å­—æè¿°ç¬¦ï¼‰å…¶ä¸­çš„ä»»æ„ä¸€ä¸ªè¿›å…¥è¯»å°±ç»ªçŠ¶æ€ï¼Œselect()å‡½æ•°å°±å¯ä»¥è¿”å›ã€‚ æœåŠ¡ç«¯12345678910111213141516171819202122232425262728293031from socket import *import selects=socket(AF_INET,SOCK_STREAM)s.setsockopt(SOL_SOCKET,SO_REUSEADDR,1)s.bind(('127.0.0.1',8888))s.listen(5)s.setblocking(False) #è®¾ç½®socketçš„æ¥å£ä¸ºéé˜»å¡read_l=[s,] # æ•°æ®å¯è¯»é€šé“çš„åˆ—è¡¨while True: # ç›‘å¬çš„read_lä¸­çš„socketå¯¹è±¡å†…éƒ¨å¦‚æœæœ‰å˜åŒ–ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±ä¼šåœ¨r_l # ç¬¬äºŒä¸ªå‚æ•°é‡Œæœ‰ä»€ä¹ˆå¯¹è±¡ï¼Œw_lä¸­å°±æœ‰ä»€ä¹ˆå¯¹è±¡ # ç¬¬ä¸‰ä¸ªå‚æ•° å¦‚æœè¿™é‡Œçš„å¯¹è±¡å†…éƒ¨å‡ºé”™ï¼Œé‚£ä¼šæŠŠè¿™äº›å¯¹è±¡åŠ åˆ°x_lä¸­ # 1 æ˜¯è¶…æ—¶æ—¶é—´ r_l,w_l,x_l=select.select(read_l,[],[],1) print(r_l) for ready_obj in r_l: if ready_obj == s: conn,addr=ready_obj.accept() #æ­¤æ—¶çš„ready_objç­‰äºs read_l.append(conn) else: try: data=ready_obj.recv(1024) #æ­¤æ—¶çš„ready_objç­‰äºconn if not data: ready_obj.close() read_l.remove(ready_obj) raise Exception('è¿æ¥æ–­å¼€') ready_obj.send(data.upper()) except ConnectionResetError: ready_obj.close() read_l.remove(ready_obj) å®¢æˆ·ç«¯12345678910from socket import *c=socket(AF_INET,SOCK_STREAM)c.connect(('127.0.0.1',8888))while True: msg=input('&gt;&gt;&gt;: ') if not msg:continue c.send(msg.encode('utf-8')) data=c.recv(1024) print(data.decode('utf-8')) AIOï¼ˆasynchronous ioï¼‰çœŸæ­£çš„å¼‚æ­¥I/Oå¾ˆç‰›é€¼ï¼Œæµç¨‹å¤§æ¦‚å¦‚ä¸‹ï¼š ï¼ˆ1ï¼‰ç”¨æˆ·è¿›ç¨‹å‘èµ·readæ“ä½œä¹‹åï¼Œç«‹åˆ»å°±å¯ä»¥å¼€å§‹å»åšå…¶å®ƒçš„äº‹ã€‚ ï¼ˆ2ï¼‰è€Œå¦ä¸€æ–¹é¢ï¼Œä»kernelçš„è§’åº¦ï¼Œå½“å®ƒå—åˆ°ä¸€ä¸ªasynchronous readä¹‹åï¼Œé¦–å…ˆå®ƒä¼šç«‹åˆ»è¿”å›ï¼Œæ‰€ä»¥ä¸ä¼šå¯¹ç”¨æˆ·è¿›ç¨‹äº§ç”Ÿä»»ä½•blockã€‚ ï¼ˆ3ï¼‰ç„¶åï¼Œkernelä¼šç­‰å¾…æ•°æ®å‡†å¤‡å®Œæˆï¼Œç„¶åå°†æ•°æ®æ‹·è´åˆ°ç”¨æˆ·å†…å­˜ï¼Œå½“è¿™ä¸€åˆ‡éƒ½å®Œæˆä¹‹åï¼Œkernelä¼šç»™ç”¨æˆ·è¿›ç¨‹å‘é€ä¸€ä¸ªsignalï¼Œå‘Šè¯‰å®ƒreadæ“ä½œå®Œæˆäº†ã€‚ JavaJavaä¸­ä½¿ç”¨AIOéœ€è¦ç”¨åˆ°java.nio.channels.AsynchronousChannelGroupå’Œjava.nio.channels.AsynchronousServerSocketChannelçš„åŒ…ï¼Œç”±äºå®é™…é¡¹ç›®é²œæœ‰äººç”¨ï¼Œå°±ä¸æ¼”ç¤ºäº† æ€»ç»“ å›é¡¾ä¸€ä¸‹å„ä¸ªIO Modelçš„æ¯”è¾ƒï¼Œå¦‚å›¾æ‰€ç¤ºï¼š blocking io ï¼šé˜»å¡å‹ioï¼Œå†ç†Ÿæ‚‰ä¸è¿‡ï¼Œå¤„ç†acceptã€readã€writeéƒ½ä¼šé˜»å¡ç”¨æˆ·è¿›ç¨‹ non blocking ioï¼šå½“é€šè¿‡ç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰è¿æ¥æˆ–è€…æ•°æ®åˆ°è¾¾å°±ç›´æ¥è¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œç”¨æˆ·è¿›ç¨‹ä¸é˜»å¡ä½†æ˜¯ä¸æ–­çš„è½®è¯¢ã€‚æ³¨æ„è¿™ä¸ªä¸æ˜¯java nioæ¡†æ¶ä¸­å¯¹åº”çš„ç½‘ç»œæ¨¡å‹ io multiplexingï¼šioå¤šè·¯å¤ç”¨æ‰æ˜¯nioå¯¹åº”çš„ç½‘ç»œioæ¨¡å‹ã€‚è¯¥æ¨¡å‹å¯¹äºç”¨æˆ·è¿›ç¨‹ä¹Ÿæ˜¯é˜»å¡çš„ï¼Œä¼˜ç‚¹æ˜¯å¯ä»¥åŒæ—¶æ”¯æŒå¤šä¸ªconnetciotnã€‚å‰ä¸‰ç§éƒ½å±äºåŒæ­¥æ¨¡å¼ï¼Œæ—¢ç„¶éƒ½æ˜¯åŒæ­¥çš„ï¼Œå¦‚æœè¦åšåˆ°çœ‹ä¼¼éé˜»å¡ï¼Œé‚£ä¹ˆå°±éœ€è¦è½®è¯¢æœºåˆ¶ã€‚ç›¸å¯¹äºä¸Šä¸€ç§æ¨¡å‹ï¼Œè¿™ç§åªæ˜¯å°†è½®è¯¢ä»ç”¨æˆ·è¿›ç¨‹è½¬ç§»åˆ°äº†æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œé€šè¿‡è°ƒç”¨selectå‡½æ•°ï¼Œä¸æ–­è½®è¯¢å¤šä¸ªconnectionæ˜¯å¦readyï¼Œå¦‚æœæœ‰ä¸€ç§readyå¥½çš„ï¼Œå°±é€šè¿‡äº‹ä»¶é€šçŸ¥ç”¨æˆ·è¿›ç¨‹ï¼Œç”¨æˆ·è¿›ç¨‹å†é€šè¿‡äº‹ä»¶æ¥å¤„ç†ã€‚æ‰€ä»¥åœ¨javaçš„nioä¸­ä¼šçœ‹åˆ°ä¸€å¤§å †äº‹ä»¶å¤„ç†ã€‚è¿™ç§æ¨¡å‹çš„é˜»å¡ä¸æ˜¯åœ¨socketå±‚é¢çš„é˜»å¡ï¼Œè€Œæ˜¯åœ¨è°ƒåŠ¨selectå‡½æ•°çš„é˜»å¡ã€‚è€Œä¸”ç›¸å¯¹äºblocking ioï¼Œè¿˜å¤šäº†ä¸€æ¬¡selectçš„ç³»ç»Ÿè°ƒç”¨ï¼Œå…¶å®æ€§èƒ½ä¼šæ›´ä½ï¼Œæ‰€ä»¥åœ¨ä½ååé‡ä¸‹ï¼Œè¿™ç§ioä¸è§å¾—æ¯”bio+çº¿ç¨‹æ± çš„æ¨¡å‹ä¼˜è¶Šã€‚ sign drivenï¼šæå°‘ä½¿ç”¨ï¼Œä¸çŸ¥é“ async io ï¼šjava7æ—¶å€™å¼€å§‹å‡çº§ï¼Œä¹Ÿæˆä¸ºnio2ã€‚å®ç°äº†å¼‚æ­¥çš„ioã€‚å‰ä¸‰ç§éƒ½æ˜¯é€šè¿‡ç”¨æˆ·è¿›ç¨‹åœ¨ä¸»åŠ¨è·å–ï¼ˆbioçš„é˜»å¡ï¼Œnbioçš„è½®è¯¢å’Œiomultçš„æŒ‰äº‹ä»¶è·å–ï¼‰ï¼Œè€Œaioäº¤äº’å¾ˆç®€å•ï¼Œç”¨æˆ·è¿›ç¨‹è°ƒç”¨åç«‹å³è¿”å›ï¼Œç”¨æˆ·è¿›ç¨‹ä¸é˜»å¡ï¼Œå†…æ ¸å½“å®Œæˆç½‘ç»œioå’Œæ•°æ®å¤åˆ¶åï¼Œä¸»åŠ¨é€šçŸ¥ç”¨æˆ·è¿›ç¨‹ã€‚å‰é¢è¯´åˆ°çš„ç³»ç»Ÿå†…æ ¸åšçš„æ“ä½œï¼Œé™¤äº†ç­‰å¾…ç½‘ç»œioå°±ç»ªæ•°æ®åˆ°è¾¾å†…æ ¸ï¼Œè¿˜æœ‰ä»ç³»ç»Ÿå†…æ ¸å¤åˆ¶ç”¨æˆ·ç©ºé—´å»çš„è¿‡ç¨‹ï¼Œå¼‚æ­¥ioè¿™ä¸¤è€…å¯¹äºç”¨æˆ·è¿›ç¨‹è€Œè¨€éƒ½æ˜¯éé˜»å¡çš„ï¼Œè€Œå‰ä¸‰ç§ï¼Œåœ¨æ•°æ®ä»å†…æ ¸å¤åˆ¶åˆ°ç”¨æˆ·ç©ºé—´è¿™ä¸ªè¿‡ç¨‹ï¼Œéƒ½æ˜¯é˜»å¡çš„ã€‚ å‚è€ƒèµ„æ–™å‰è¨€è¯´çš„é‚£æœ¬ä¹¦ Ron Hitchensäº2002å¹´ è‘—çš„ã€Šjava nioã€‹ findumars å†¬ç“œè”¡ å½¼å²¸èˆ¹å¤« NIOçš„/åˆ†æ•£è¯»å–å’Œèšé›†å†™å…¥ å¹¶å‘ç¼–ç¨‹ç½‘ æ„Ÿè°¢ ç»­1sæ—¶é—´å…¨ç‰‡ç»“æŸï¼Œè§‰å¾—æˆ‘å†™çš„ä¸é”™ï¼Ÿæƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿèµ¶å¿«æ‰“å¼€æˆ‘çš„ğŸ‘‰ä¸ªäººåšå®¢ ğŸ‘ˆå§ï¼ æœ¬æ–‡åœ°å€https://blog.tengshe789.tech/2018/08/25/IO%E6%A8%A1%E5%9E%8B/#moreï¼Œéƒ¨åˆ†è§‰å¾—æ¯”è¾ƒç”¨å¿ƒçš„ä¼šåŒæ­¥åˆ°æ˜é‡‘ï¼Œç®€ä¹¦ï¼Œè°¢è°¢ä½ é‚£ä¹ˆå¯çˆ±ï¼Œè¿˜ä¸€ç›´å…³æ³¨ç€æˆ‘~â¤ğŸ˜]]></content>
      <tags>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>python</tag>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è§£é‡Šæ€§è¯­è¨€&ç¼–è¯‘æ€§è¯­è¨€ï¼ŒåŠ¨æ€&é™æ€è¯­è¨€?]]></title>
    <url>%2F2018%2F08%2F21%2F%E8%A7%A3%E9%87%8A%E6%80%A7%E8%AF%AD%E8%A8%80-%E7%BC%96%E8%AF%91%E6%80%A7%E8%AF%AD%E8%A8%80%EF%BC%8C%E5%8A%A8%E6%80%81-%E9%9D%99%E6%80%81%E8%AF%AD%E8%A8%80%2F</url>
    <content type="text"><![CDATA[ä½ æ˜¯ä¸æ˜¯æ¯ä¸€æ¬¡å†™å®Œjavaï¼Œå†™å®Œpythonï¼Œéƒ½æœ‰è®¸äº›ç–‘æƒ‘~ ä¸ºä»€ä¹ˆæ¯æ¬¡æ–°å»ºä¸€ä¸ªpythoné¡¹ç›®ï¼ŒJetBrains PyCharm éƒ½ä¼šè®©ä½ é€‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œä»€ä¹ˆæ˜¯è§£é‡Šå™¨å‘¢ï¼Ÿ ä¸ºä»€ä¹ˆç¼–å†™Javaä¸éœ€è¦è§£é‡Šå™¨å‘¢ï¼Ÿä»Šå¤©å°±ç»™ä½ ä»¬å¸¦æ¥ç­”æ¡ˆ~ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®https://blog.tengshe789.tech/ ç¼–è¯‘å‹å’Œè§£é‡Šå‹çš„åŒºåˆ«ç¼–è¯‘å‹è¯­è¨€å…ˆæ¥çœ‹çœ‹ç¼–è¯‘å‹è¯­è¨€å®šä¹‰ï¼š ç¼–è¯‘å‹è¯­è¨€é¦–å…ˆæ˜¯å°†æºä»£ç ç¼–è¯‘ç”Ÿæˆæœºå™¨æŒ‡ä»¤ï¼Œå†ç”±æœºå™¨è¿è¡Œæœºå™¨ç (äºŒè¿›åˆ¶)ã€‚ å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œç¼–è¯‘å‹ç›¸å½“äºç”¨ä¸­è‹±æ–‡è¯å…¸ï¼ˆç¿»è¯‘å™¨ï¼‰å°†ä¸€æœ¬è‹±æ–‡ä¹¦ä¸€æ¬¡æ€§ç¿»è¯‘ï¼ˆç¼–è¯‘ï¼‰æˆä¸€æœ¬ä¸­æ–‡ä¹¦ã€‚ä»¥åæŸ¥çœ‹ç›´æ¥å°±æ˜¯ä¸­æ–‡äº†ã€‚å¯æƒ³è€ŒçŸ¥ï¼Œä»¥åè¯»ä¹¦ï¼ˆæ‰§è¡Œï¼‰ä¼šéå¸¸éå¸¸æ–¹ä¾¿ã€‚ æ‰€ä»¥ï¼Œç”±äºç¨‹åºæ‰§è¡Œé€Ÿåº¦å¿«ï¼ŒåŒç­‰æ¡ä»¶ä¸‹å¯¹ç³»ç»Ÿè¦æ±‚è¾ƒä½ï¼Œå› æ­¤åƒå¼€å‘æ“ä½œç³»ç»Ÿã€å¤§å‹åº”ç”¨ç¨‹åºã€æ•°æ®åº“ç³»ç»Ÿç­‰æ—¶éƒ½é‡‡ç”¨å®ƒï¼ŒåƒC/C++ã€Pascal/Object Pascalï¼ˆDelphiï¼‰ç­‰éƒ½æ˜¯ç¼–è¯‘è¯­è¨€ ç”¨cè¯­è¨€å¼€å‘äº†ç¨‹åºåï¼Œéœ€è¦é€šè¿‡ç¼–è¯‘å™¨æŠŠç¨‹åºç¼–è¯‘æˆæœºå™¨è¯­è¨€ï¼ˆå³è®¡ç®—æœºè¯†åˆ«çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› ä¸ºä¸åŒçš„æ“ä½œç³»ç»Ÿè®¡ç®—æœºè¯†åˆ«çš„äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯ä¸åŒçš„ï¼‰ï¼Œæ‰€ä»¥cè¯­è¨€ç¨‹åºè¿›è¡Œç§»æ¤åï¼Œè¦é‡æ–°ç¼–è¯‘ã€‚ï¼ˆå¦‚windowsç¼–è¯‘æˆextæ–‡ä»¶ï¼Œlinuxç¼–è¯‘æˆerpæ–‡ä»¶ï¼‰ è§£é‡Šå‹è¯­è¨€å†æ¥çœ‹çœ‹è§£é‡Šå‹è¯­è¨€çš„å®šä¹‰ï¼š è§£é‡Šå‹è¯­è¨€çš„æºä»£ç ä¸æ˜¯ç›´æ¥ç¿»è¯‘æˆæœºå™¨æŒ‡ä»¤ï¼Œè€Œæ˜¯å…ˆç¿»è¯‘æˆä¸­é—´ä»£ç ï¼Œå†ç”±è§£é‡Šå™¨å¯¹ä¸­é—´ä»£ç è¿›è¡Œè§£é‡Šè¿è¡Œã€‚ è€Œè§£é‡Šå‹ç›¸å½“äºç”¨ä¸­è‹±æ–‡è¯å…¸ï¼ˆç¿»è¯‘å™¨ï¼‰å°†ä¸€æœ¬è‹±æ–‡ä¹¦è¯»ä¸€æ®µç¿»è¯‘ä¸€æ®µï¼ˆè§£é‡Šï¼‰ä¸­æ–‡ã€‚ä»¥åæŸ¥çœ‹æ—¶è¿˜æ˜¯éœ€è¦é‡æ–°ç¿»è¯‘ã€‚è¿™æ ·æ•ˆç‡ä¼šä½ä¸€äº›ï¼Œå¿…é¡»ä¾èµ–è§£é‡Šå™¨ï¼Œä½†æ˜¯è·¨å¹³å°æ€§å¥½ã€‚ æ‰€ä»¥ï¼Œä¸€äº›ç½‘é¡µè„šæœ¬ã€æœåŠ¡å™¨è„šæœ¬åŠè¾…åŠ©å¼€å‘æ¥å£è¿™æ ·çš„å¯¹é€Ÿåº¦è¦æ±‚ä¸é«˜ã€å¯¹ä¸åŒç³»ç»Ÿå¹³å°é—´çš„å…¼å®¹æ€§æœ‰ä¸€å®šè¦æ±‚çš„ç¨‹åºåˆ™é€šå¸¸ä½¿ç”¨è§£é‡Šæ€§è¯­è¨€ï¼Œå¦‚JavaScriptã€VBScriptã€Perlã€Pythonã€Rubyã€MATLAB ç­‰ç­‰ Javaç¼–è¯‘å‹å’Œè§£é‡Šå‹çš„å®šä¹‰æ˜¯å¯¹ç«‹å­˜åœ¨çš„ï¼Œä½†ä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ªè¯­è¨€ä¸­åŒæ—¶å­˜åœ¨ã€‚ ä¸ºä»€ä¹ˆæˆ‘æŠŠ java è¯­è¨€å•ç‹¬æ”¾å‡ºæ¥å‘¢ï¼Ÿå› ä¸ºå®ƒåŒæ—¶å…¼æœ‰ç¼–è¯‘å‹å’Œè§£é‡Šå‹ç‰¹ç‚¹ã€‚ æ•´ä¸ªæµç¨‹å¦‚ä¸‹ï¼š æˆ‘ä»¬ç¼–å¥½æºä»£ç ï¼ˆ.java æ–‡ä»¶ï¼‰ï¼Œç¼–è¯‘ç”Ÿæˆå­—èŠ‚ç ï¼ˆ.class æ–‡ä»¶ï¼‰ï¼Œå†é€šè¿‡ JVMï¼ˆjava è™šæ‹Ÿæœºï¼‰è¿è¡Œç”Ÿæˆæœºå™¨æŒ‡ä»¤ï¼Œç”±æœºå™¨è¿è¡Œæœºå™¨ç ã€‚æ³¨æ„ï¼Œæ­¤å¤„ç”Ÿæˆæœºå™¨è¯­è¨€å‰çš„æ“ä½œæ˜¯è§£é‡Šå‹ï¼Œæ¯æ¬¡è¿è¡Œéƒ½è¦é‡æ–°è§£é‡Šã€‚å› æ­¤ï¼Œæ­¤å¤„è¡¨æ˜ java æ˜¯è§£é‡Šå‹ã€‚ ä½†æ˜¯ï¼Œéƒ¨åˆ† JVMï¼ˆjava è™šæ‹Ÿæœºï¼‰æœ‰ä¸€ç§ JITï¼ˆJust in timeï¼‰æœºåˆ¶ï¼Œèƒ½å¤Ÿå°†éƒ¨åˆ†å·²ç»è§£é‡Šç¿»è¯‘çš„å¸¸ç”¨æœºå™¨æŒ‡ä»¤ä¿å­˜ã€‚ä¸‹æ¬¡ä¸éœ€è¦è§£é‡Šï¼Œç›´æ¥è¿è¡Œå³å¯ã€‚æ­¤æ—¶ java æ˜¯ç¼–è¯‘å‹ã€‚ åŠ¨æ€è¯­è¨€å’Œé™æ€è¯­è¨€æˆ‘ä»¬å¸¸è¯´çš„åŠ¨æ€è¯­è¨€å’Œé™æ€è¯­è¨€ï¼Œå…¶å®æ˜¯æŒ‡åŠ¨æ€ç±»å‹è¯­è¨€å’Œé™æ€ç±»å‹è¯­è¨€ã€‚å…ˆæ¥çœ‹çœ‹åŠ¨æ€ç±»å‹è¯­è¨€ï¼š åŠ¨æ€ç±»å‹è¯­è¨€ï¼Œæ˜¯æŒ‡æ•°æ®ç±»å‹çš„æ£€æŸ¥æ˜¯åœ¨è¿è¡Œæ—¶åšçš„ã€‚ç”¨åŠ¨æ€ç±»å‹è¯­è¨€ç¼–ç¨‹æ—¶ï¼Œä¸ç”¨ç»™å˜é‡æŒ‡å®šæ•°æ®ç±»å‹ï¼Œè¯¥è¯­è¨€ä¼šåœ¨ä½ ç¬¬ä¸€æ¬¡èµ‹å€¼ç»™å˜é‡æ—¶ï¼Œåœ¨å†…éƒ¨è®°å½•æ•°æ®ç±»å‹ã€‚ åŠ¨æ€ç±»å‹è¯­è¨€çš„ä¼˜ç‚¹æ˜¯ä¸éœ€è¦å†™å¤šç§æ•°æ®ç±»å‹çš„ä»£ç ï¼Œä»£ç ç›¸å¯¹ç®€æ´ä¸€äº›ï¼Œæ–¹ä¾¿ä»£ç é˜…è¯»ã€‚ç¼ºç‚¹æ˜¯ä¸æ–¹ä¾¿è°ƒè¯•ï¼Œä»£ç å‘½åä¹Ÿå®¹æ˜“æ··æ·†ï¼› å†æ¥çœ‹çœ‹é™æ€ç±»å‹è¯­è¨€çš„å®šä¹‰ï¼š é™æ€ç±»å‹è¯­è¨€ï¼Œæ˜¯æŒ‡æ•°æ®ç±»å‹çš„æ£€æŸ¥æ˜¯åœ¨è¿è¡Œå‰ï¼ˆå¦‚ç¼–è¯‘é˜¶æ®µï¼‰åšçš„ã€‚ é™æ€ç±»å‹è¯­è¨€çš„ä¼˜ç‚¹æ˜¯æ–¹ä¾¿è°ƒè¯•ï¼Œä»£ç ç›¸å¯¹è§„èŒƒã€‚ç¼ºç‚¹æ˜¯éœ€è¦å†™å¾ˆå¤šæ•°æ®ç±»å‹ç›¸å…³çš„ä»£ç ï¼Œä»£ç ä¸å¤Ÿç®€æ´ã€‚ å®Œç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹~]]></content>
      <tags>
        <tag>æŠ€æœ¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸€æˆ˜ä¸­çš„åˆ¶å¼æ­¥æª]]></title>
    <url>%2F2018%2F08%2F19%2F%E4%B8%80%E6%88%98%E4%B8%AD%E7%9A%84%E5%88%B6%E5%BC%8F%E6%AD%A5%E6%9E%AA%2F</url>
    <content type="text"><![CDATA[ä»Šå¤©æˆ‘ä»¬ä¸èŠæŠ€æœ¯äº†ï¼ŒèŠä¸€èŠæªæ”¯ã€‚æˆ‘æœ¬äººæ˜¯ä¸ªç‹‚çƒ­çš„å†›äº‹è¿·ï¼Œè€Œæ°å¥½æœ€è¿‘æ‰¾åˆ°ä¸€æ¬¾æ¸¸æˆï¼Œæ˜¯ä¸€æˆ˜é¢˜æçš„ï¼Œå«â€˜æˆ˜åœ°1â€™ï¼ŒåŸæ±åŸå‘³çš„ä¸€æˆ˜æ­¦å™¨çš„åŠ å…¥ï¼Œè®©è¿™ä¸ªæœ¬æ¥å°±å¾ˆå¼ºåŠ¿çš„ç¬¬ä¸€äººç§°å°„å‡»æ¸¸æˆå¢æ·»äº†ç‹¬ç‰¹é­…åŠ›ã€‚åºŸè¯ä¸å¤šè¯´ï¼Œä»Šå¤©æˆ‘ä»¥è¿™ä¸ªæ¸¸æˆä¸­çš„ä¸€æˆ˜è§†è§’ï¼Œæ¥ä»‹ç»ä»¥ä¸‹ä¸€æˆ˜ä¸­çš„åˆ¶å¼æ­¦å™¨ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜ï¼ˆè‹±è¯­ï¼šWorld War Iã€First World Waræˆ–Great Warï¼Œç®€ç§°WWIæˆ–WW1ï¼‰ï¼Œç®€ç§°ä¸€æˆ˜ï¼Œæ˜¯åœ¨19ä¸–çºªæœ«20ä¸–çºªåˆï¼Œèµ„æœ¬ä¸»ä¹‰å›½å®¶å‘å…¶ç»ˆæé˜¶æ®µï¼Œå³å¸å›½ä¸»ä¹‰è¿‡æ¸¡æ—¶äº§ç”Ÿçš„å¹¿æ³›çš„ä¸å¯è°ƒå’ŒçŸ›ç›¾ã€äºšæ´²ï¼Œéæ´²ï¼Œæ‹‰ä¸ç¾æ´²æ®–æ°‘åœ°å’ŒåŠæ®–æ°‘åœ°åŸºæœ¬ä¸Šè¢«åˆ—å¼ºç“œåˆ†å®Œæ¯•ï¼Œæ–°æ—§æ®–æ°‘ä¸»ä¹‰çŸ›ç›¾æ¿€åŒ–ã€å„å¸å›½ä¸»ä¹‰ç»æµå‘å±•ä¸å¹³è¡¡ï¼Œç§©åºåˆ’åˆ†ä¸å¯¹ç­‰çš„èƒŒæ™¯ä¸‹ï¼Œä¸ºé‡æ–°ç“œåˆ†ä¸–ç•Œå’Œäº‰å¤ºå…¨çƒéœ¸æƒè€Œçˆ†å‘çš„ä¸€åœºä¸–ç•Œçº§å¸å›½ä¸»ä¹‰æˆ˜äº‰ã€‚æˆ˜äº‰è¿‡ç¨‹ä¸»è¦æ˜¯åŒç›Ÿå›½å’Œåçº¦å›½ä¹‹é—´çš„æˆ˜æ–—ã€‚ å¾·æ„å¿—å¸å›½ã€å¥¥åŒˆå¸å›½ã€å¥¥æ–¯æ›¼å¸å›½ã€ä¿åŠ åˆ©äºšç‹å›½å±åŒç›Ÿå›½é˜µè¥ å¤§è‹±å¸å›½ã€æ³•å…°è¥¿ç¬¬ä¸‰å…±å’Œå›½ã€ä¿„ç½—æ–¯å¸å›½ã€æ„å¤§åˆ©ç‹å›½å’Œç¾åˆ©åšåˆä¼—å›½åˆ™å±åçº¦å›½é˜µè¥ã€‚ è¿™åœºæˆ˜äº‰æ˜¯æ¬§æ´²å†å²ä¸Šç ´åæ€§æœ€å¼ºçš„æˆ˜äº‰ä¹‹ä¸€ã€‚å¤§çº¦æœ‰6500ä¸‡äººå‚æˆ˜ï¼Œ1000å¤šä¸‡äººä¸§ç”Ÿï¼Œ2000ä¸‡äººå—ä¼¤ã€‚æˆ˜äº‰é€ æˆäº†ä¸¥é‡çš„ç»æµæŸå¤±ã€‚ ä»€ä¹ˆæ˜¯åˆ¶å¼æ­¦å™¨é¦–å…ˆæˆ‘è¿™ä¸ªé¢˜ç›®å«â€˜ä¸€æˆ˜ä¸­çš„åˆ¶å¼æ­¥æªâ€™ï¼Œä»€ä¹ˆæ˜¯åˆ¶å¼æ­¥æªï¼ˆæ­¦å™¨ï¼‰å‘¢ï¼Ÿåˆ¶å¼æ­¦å™¨å³åŒä¸€ç§å…µå™¨çš„å„ç§æŠ€æœ¯å‚æ•°ç›¸åŒçš„æ­¦å™¨è£…å¤‡ï¼Œå¹¶ä¸”ç»éƒ¨é˜Ÿæ­¦å™¨è£…å¤‡éƒ¨é—¨æ‰¹å‡†å¤‡æ¡ˆï¼Œæœ‰æ­£å¼å‹å·ç¼–å·ï¼Œæ­£å¼æ‰¹é‡åˆ—è£…éƒ¨é˜Ÿä½¿ç”¨çš„æ­£è§„çš„æ ‡å‡†æ­¦å™¨ã€‚å°±åƒå’±ä»¬ä¸­å›½PLAï¼Œæ­¥å…µæ ‡é…çš„95å¼çªå‡»æ­¥æªï¼ˆType 95ï¼‰ï¼Œè¿™ä¸ª95å¼å°±æ˜¯åˆ¶å¼æ­¥æªã€‚å®ƒçš„å‡ºç°ä½¿å¾—å†›è­¦éƒ¨é˜Ÿçš„æ­¦å™¨ç®¡ç†ï¼Œä½¿ç”¨å¾—ä»¥æ ‡å‡†åŒ–ï¼Œç»Ÿä¸€åŒ–ã€‚åŠ å¼ºäº†æ­¦è£…éƒ¨é—¨çš„æ­£è§„åŒ–ã€‚ WWIåˆ¶å¼æ­¥æªWinchester 1895 (Russian)æ¸©å½»æ–¯ç‰¹M1894æ æ†æ­¥æªç”±ä¼ å¥‡æ€§äººç‰©çº¦ç¿°Â·æ‘©è¥¿Â·å‹ƒæœ—å®è®¾è®¡çš„M1894æ æ†æ­¥æªï¼Œæ˜¯ç¾å›½å†å²ä¸Šç¬¬ä¸€æ”¯ä½¿ç”¨æ— çƒŸå‘å°„è¯æªå¼¹ï¼Œå¹¶ä¸”ä¸ºç‹©çŒè€Œä¸“é—¨è®¾è®¡çš„æ æ†æ­¥æªã€‚ M1895æ­¥æªé‡‡ç”¨æ æ†æªæœºå¼ç»“æ„ï¼Œå…¶æ æ†å¼æªæœºçš„åŸºæœ¬åŸç†ä¸M1873æ­¥æªçš„ç›¸åŒï¼Œåªæ˜¯ç»“æ„æœ‰æ‰€ä¸åŒè€Œå·²ã€‚M1873æ­¥æªé€šè¿‡æ‰³æœºæŠ¤åœˆæ æ†çš„å‰åæ—‹è½¬ï¼Œå¸¦åŠ¨è‚˜èŠ‚æ‘†åŠ¨ï¼Œä»è€Œå¸¦åŠ¨æªæœºå‰åè¿åŠ¨ã€‚è€Œåœ¨M1895æ­¥æªä¸Šï¼Œæ‰³æœºæŠ¤åœˆæ æ†ä¸æ‰³æœºåº§ç›´æ¥ç»„æˆäº†è‚˜èŠ‚ç»“æ„ï¼Œå…¶ç»“æ„æ›´ä¸ºç®€å•ã€‚M1895æ­¥æªçš„æ‰³æœºåº§å°¾ç«¯å›ºå®šåœ¨æœºåŒ£ä¸Šï¼Œå…¶å‰ç«¯ä¸æ‰³æœºæŠ¤åœˆæ æ†ä¸­éƒ¨ç»æ¥åœ¨ä¸€èµ·ï¼Œè€Œæ‰³æœºæŠ¤åœˆæ æ†ä¸Šéƒ¨ä¸æªæœºå‰ç«¯ç»æ¥åœ¨ä¸€èµ·ï¼Œå½“æ‰³æœºæŠ¤åœˆæ æ†æ‘†åŠ¨æ—¶ï¼Œé€šè¿‡å…¶ä¸Šéƒ¨å¸¦åŠ¨æªæœºå‰åè¿åŠ¨ã€‚å¦å¤–ï¼ŒM1873æ­¥æªæ‰³æœºæŠ¤åœˆæ æ†çš„æ—‹è½¬è½´å›ºå®šåœ¨æœºåŒ£ä¸Šï¼Œè€ŒM1895æ­¥æªçš„æ‰³æœºæŠ¤åœˆæ æ†åˆ™æ²¡æœ‰å›ºå®šçš„æ—‹è½¬è½´ï¼Œå®ƒçš„è¿åŠ¨è½¨è¿¹æ¯”è¾ƒå¤æ‚ï¼Œä¸æ˜¯ç®€å•çš„æ—‹è½¬è¿åŠ¨ã€‚å‰æ¨æ‰³æœºæŠ¤åœˆæ æ†æ—¶ï¼Œå…¶å°¾ç«¯å…ˆå‘å‰ä¸‹æ–¹æ‘†åŠ¨ï¼Œæ‹‰æ‰³æœºåº§å‰ç«¯å‘ä¸‹ï¼Œä½¿è‚˜èŠ‚ç»“æ„å¼¯æ›²ã€‚å½“æ‰³æœºåº§å‰ç«¯å‘ä¸‹æ‘†åŠ¨åˆ°ä¸€å®šä½ç½®æ—¶ï¼Œæ‰³æœºæŠ¤åœˆæ æ†å‰ç«¯ä¾¿å¸¦åŠ¨æªæœºå‘åã€‚ç»§ç»­å‘ä¸‹æ¨æ‰³æœºæŠ¤åœˆæ æ†ï¼Œä¾¿ä½¿è‚˜èŠ‚ç»“æ„è¿›ä¸€æ­¥å¼¯æ›²ï¼Œæ‰³æœºæŠ¤åœˆæ æ†ä¸Šç«¯å¸¦åŠ¨æªæœºè¿›ä¸€æ­¥å‘åï¼Œç›´è‡³å°†å…¶å‘åæ¨åˆ°ä½ã€‚å› æ­¤ï¼Œæ‰³æœºæŠ¤åœˆæ æ†æ—¢æœ‰æ—‹è½¬è¿åŠ¨ï¼Œåˆæœ‰ä¸Šä¸‹æ–¹å‘çš„ç›´çº¿è¿åŠ¨ã€‚ M1895æ­¥æªçš„ç‰¹è‰²è¡¨ç°åœ¨ä¸‰ä¸ªæ–¹é¢ã€‚ ä¸€æ˜¯é‡‡ç”¨äº†ç›’å¼å¼¹ä»“ã€‚è¿™ç§å¼¹ä»“æ¯”ç°åœ¨æªæ¢°ä¸Šé‡‡ç”¨çš„å›ºå®šå¼å¼¹ä»“å¤æ‚å¾—å¤šã€‚ç›®å‰çš„å›ºå®šå¼å¼¹ä»“å¤šé‡‡ç”¨èºæ—‹å¼¹ç°§ åšæ‰˜å¼¹æ¿ç°§ï¼Œå¹¶ç›´æ¥ç½®äºæ‰˜å¼¹æ¿ä¹‹ä¸‹ï¼Œé ç°§åŠ›å°†å¼¹å‘ä¸ŠæŠ¬èµ·ã€‚è€ŒM1895æ­¥æªé‡‡ ç”¨äº†å½“æ—¶å¸¸ç”¨çš„ç‰‡ç°§åšæ‰˜å¼¹æ¿ç°§ï¼Œå…¶æ‰˜å¼¹æ¿å‘ˆâ€œVâ€å½¢ï¼Œä¸Šç«¯å¡åœ¨æªç®¡ä¸‹æ–¹çš„å›ºå®šæ§½å†…ï¼Œä¸‹æ–¹å¡åœ¨æ‰˜å¼¹æ†å°¾ç«¯çš„å‡¹æ§½å†…ï¼Œé ç°§åŠ›é©±åŠ¨æ‰˜å¼¹æ†é€†æ—¶é’ˆæ—‹è½¬ï¼Œå¸¦åŠ¨æ‰˜å¼¹æ¿å‘ä¸Šè¿åŠ¨ï¼Œä½¿å¼¹ä»“å†…çš„æªå¼¹è¿›å…¥å¾…è¿›è†›ä½ç½®ã€‚ å…¶äºŒï¼Œé‡‡ç”¨äº†é—­é”æ¥”é“ã€‚å‰æ¨æ‰³æœºæŠ¤åœˆæ æ†ï¼Œå…¶å‘å‰ä¸‹æ–¹è½¬åŠ¨ï¼Œä½¿æ‰³æœºåº§å‘ä¸‹æ–¹æ‘†åŠ¨ï¼Œæ‰³æœºåº§å‰ç«¯é’©ä½é—­é”æ¥”é“ä¸‹ç«¯ä½¿ä¹‹ä¸€èµ·å‘ä¸‹è¿åŠ¨ï¼Œé—­é”æ¥”é“ä¸Šç«¯ç¦»å¼€æªæœºå°¾éƒ¨çš„å‡¹æ§½è€Œä½¿æªæœºå¼€é”ã€‚ç»§ç»­å‰æ¨æ‰³æœºæŠ¤åœˆæ æ†ï¼Œåˆ™å¸¦åŠ¨æªæœºåé€€ï¼Œå¹¶å‹å€’å‡»é”¤ï¼›åæ‹‰æ‰³æœºæŠ¤åœˆæ æ†æ—¶ï¼Œåˆ™å…ˆå¸¦åŠ¨æªæœºå¤è¿›ã€‚æªæœºå¤è¿›åˆ°ä½æ—¶ï¼Œç»§ç»­åæ‹‰æ‰³æœºæŠ¤åœˆæ æ†ï¼Œå…¶å‘åä¸Šæ–¹è½¬åŠ¨ï¼Œå¸¦åŠ¨æ‰³æœºåº§å‘ä¸Šæ‘†åŠ¨ï¼Œæ¨åŠ¨é—­é”æ¥”é“å‘ä¸Šï¼Œå…¶ä¸Šç«¯è¿›å…¥æªæœºå°¾éƒ¨çš„å‡¹æ§½è€Œä½¿æªæœºé—­é”ã€‚è¿™ä¸ªé—­é”æ¥”é“çš„è®¾è®¡ä½¿æªæœºé—­é”æ›´åŠ ç¡®å®ï¼Œä¿è¯äº†å°„å‡»æ—¶çš„å®‰å…¨æ€§ã€‚å…¶ä¸‰ï¼ŒæŠ›å£³æŒºå…¼ä½œæ¨å¼¹é½¿ã€‚æ¸©å½»æ–¯ç‰¹M1873åŠM1890æ­¥æªå‡ä¾é å–å¼¹å™¨å°†å¼¹å£³æŠ›å‡ºï¼Œä½†ç”±äºé…åˆåŠ¨ä½œæœ‰æ—¶ä¸å¤ªä¸€è‡´ï¼Œä½¿å¾—æŠ›å£³åŠ›åº¦ä¸åŒï¼Œå› è€Œæ˜“å‡ºç°é—®é¢˜ã€‚M1895æ­¥æªåˆ™ä¸“é—¨è®¾è®¡äº†æŠ›å£³æŒºï¼Œä»è€Œè§£å†³äº†è¿™ä¸€é—®é¢˜ã€‚åœ¨æªæœºå‰ç«¯é¢ï¼ŒæŠ½å£³é’©åœ¨ä¸Šï¼ŒæŠ›å£³æŒºåœ¨ä¸‹ï¼Œç”±äºæŠ›å£³æŒºçªå‡ºäºæª æœºä¸‹ç¼˜ï¼Œæ•…å…¶å…¼å…·æ¨å¼¹é½¿çš„åŠŸèƒ½ã€‚ ä¸€æˆ˜ä¸­W 1895ä¸ºä»€ä¹ˆæ ‡æ³¨çš„å›½ç±æ˜¯Russianå‘¢ï¼Ÿ å› ä¸ºæ¨¡å‹ç‰ˆçš„W 1895 ä¸­ï¼Œ.35 WCFï¼Œ.405 WCFï¼Œ.30-03å’Œ.30-06å£å¾„çš„ç”¨äºç¾å›½ä½“è‚²å¸‚åœºï¼Œ é”€å”®é¢åœ¨30%-40%ã€‚ å…¶ä»–å¤§éƒ¨åˆ†æ˜¯ä¸ä¿„ç½—æ–¯å¸å›½å†›æ–¹ç­¾è®¢çš„åˆåŒä¸­å–çš„ã€‚ 1915å¹´ï¼Œä¿„ç½—æ–¯æ€¥éœ€å°å‹æ­¦å™¨ï¼Œå¹¶ä¸è®¸å¤šç¾å›½ä¸»è¦å·¥å‚æ¥æ´½ã€‚ é›·æ˜é¡¿å’Œæ–°è‹±æ ¼å…°è¥¿å±‹å…¬å¸éƒ½ç­¾è®¢äº†åˆ¶é€ Mosin-Nagantæ­¥æªçš„åˆåŒï¼Œæ¸©å½»æ–¯ç‰¹è¾¾æˆåè®®ï¼Œç”¨æ ‡å‡†çš„ä¿„ç½—æ–¯å†›ç”¨7.62x54Rå¼¹è¯ç­’ç”Ÿäº§30ä¸‡åª1895å‹æ­¥æªã€‚ ä¸Mosin-Nagantå‘½ä»¤ä¸åŒï¼Œæ‰€æœ‰æ¸©å½»æ–¯ç‰¹æ­¥æªéƒ½æ˜¯åœ¨ä¿„å›½é©å‘½ä¹‹å‰äº¤ä»˜çš„ã€‚ Gewehr M.95Gewehr M1895 æ˜¯æ ‡å‡†åæ‹‰å¼æªæœºæ­¥æªï¼ŒæœåŠ¡å¥¥åŒˆå†›é˜Ÿåœ¨ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜ã€‚é™¤äº†å…¶ä»–ä¸€äº›ä¸œæ¬§å’Œå·´å°”å¹²å›½å®¶ä¹‹å¤–ï¼Œè¿™ç§æ­¦å™¨å¤§é‡åˆ¶é€ ï¼Œåœ¨åœæˆ˜åè¿˜ä¸å¥¥åœ°åˆ©å’ŒåŒˆç‰™åˆ©çš„ç»§æ‰¿å›½ä¸€èµ·æœå½¹ã€‚ è¯¥æ­¦å™¨é‡‡ç”¨é©å‘½æ€§çš„ç›´æ‹‰åŠ¨ä½œèºæ “ï¼Œä½¿ç‹¬ç‰¹çš„æ­¦å™¨å…·æœ‰è¾ƒé«˜çš„å°„é€Ÿï¼Œè¡¥å……äº†å…¶è‰¯å¥½çš„å¯é æ€§ã€‚é€šè¿‡ä¸€ä¸ª5è½®æ•´ä½“å¤¹å­ï¼ˆä¸å¾·å›½Gewehr 98ä½¿ç”¨çš„å‰¥ç¦»å¤¹å­ç›¸åï¼‰ï¼ŒM1895æœ€åˆç”¨äºåœ†å¤´8x50mmR Mannlicherï¼Œå¹¶åœ¨ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜æœŸé—´ä½¿ç”¨è¯¥å¼¹è¯ç­’ã€‚ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜ï¼Œæ­¥æªè¢«è½¬æ¢æˆæ›´å¼ºå¤§çš„å°–å¤´â€œæ–¯çš®ç­–â€å­å¼¹ï¼Œå¦‚8x56mmRã€‚ Gew.98å¼98æ­¥æªï¼Œå¾·å›½æœ‰ä¸¤ä¸ª98å¼ï¼Œä¸€ä¸ªæ˜¯Gew.98ä¸€ä¸ªæ˜¯Kar98ï¼Œ G98è£…å¤‡åˆ°35å¹´ï¼Œä¹‹åæ˜¯K98ã€‚æ¯›ç‘Ÿ98kå¡å®¾æªæ˜¯äºŒæˆ˜ä¸­å¾·å›½ç‹™å‡»æ‰‹çš„åˆ¶å¼æ­¦å™¨ã€‚ä¸ºäº†é¿å…åœ¨å–ä¸‹ç„å‡†é•œåä¸è‡´å¤±å»æŠµæŠ—èƒ½åŠ›ï¼Œæªä¸Šè¿˜å¤‡æœ‰æœºæ¢°ç„å…·ã€‚åœ¨ç”Ÿäº§ä¸­ï¼ŒæŒ‘é€‰æœ€å¥½çš„æªç®¡ç”¨äºè£…ç„å‡†é•œçš„æ­¥æªã€‚è¿™äº›æ­¥æªçš„æ‰³æœºæ˜¯ç»è¿‡ä¿®æ”¹çš„ï¼Œå…¶æ‰³æœºåŠ›è¾¾1.8kgã€‚ Gew.98å¼æ­¥æªä¸ºæ¯›ç‘Ÿæ­¥æªçš„æ”¹è¿›å‹å·ï¼Œä¸ä»…å¸æ”¶äº†æ—©æœŸæ¯›ç‘Ÿå‹å·ä¸Šçš„æ‰€æœ‰æ”¹è¿›ï¼Œä¸»è¦ç‰¹å¾æ˜¯å›ºå®šå¼åŒæ’å¼¹ä»“å’Œæ—‹è½¬åæ‹‰å¼æªæœºã€‚å¼¹ä»“ä¸ºåŒæ’ã€å›ºå®šå¼ï¼Œå…¶åº•æ¿å¯ä»¥æ‹†å¸å‡ºæ¥ã€‚è£…å¡«æ—¶å¯ä»¥ä»é¡¶éƒ¨çš„æŠ›å£³å£ä¸€å‘ä¸€å‘åœ°è£…å…¥ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¼¹å¤¹ä¸€æ¬¡è£…å¡«æ»¡5å‘ã€‚æ¯ä¸ªæ¡¥å¤¹è£…5å‘å¼¹ï¼Œè¶³å¤Ÿè£…æ»¡ä¸€ä¸ªå¼¹ä»“ï¼Œåœ¨æœºåŒ£åæ¡¥ä¸Šæœ‰æœºå™¨åŠ å·¥å‡ºæ¥çš„æ¡¥å¤¹å¯¼æ§½ã€‚åœ¨è£…å¡«åï¼Œå½“æªæœºå…³é—­æ—¶ï¼Œç©ºçš„æ¡¥å¤¹ä¼šè¢«è‡ªåŠ¨æŠ›å‡ºã€‚å¼¹ä»“å¯ä»¥æ‰“å¼€æªæœºæ¸…ç©ºæˆ–é€šè¿‡æ‹†å¸å¼¹ä»“åº•æ¿è¿›è¡Œï¼Œä½†ä¸€èˆ¬ä¸æ¨èé‡‡ç”¨åä¸€ç§æ–¹æ³•ã€‚ SMLE MKIIIThe Short Magazine Lee-Enfield Mk IIIï¼Œæˆ–ç®€ç§°ä¸ºSMLE MkIIIï¼Œæ˜¯ä¸€ç§è‹±å¼èºæ “å¼æ­¥æªã€‚Mark IIIæ˜¯Lee-Enfieldçš„æ¼”å˜ï¼Œé¡¾åæ€ä¹‰å®ƒç¼©çŸ­äº†å¤§çº¦5è‹±å¯¸æˆ–13å˜ç±³ï¼Œå¹¶äº1907å¹´æ¨å‡ºã€‚åˆ¶é€ çš„å¤æ‚æ€§æ„å‘³ç€ä¸€ä¸ªç®€åŒ–çš„å˜ä½“ï¼ŒSMLE MkIII äº1915å¹´æ¨å‡ºã€‚ä¸€ä¸ªå¼¹åŒ£ä¸­æœ‰10å‘.303 Britishï¼Œå®ƒçš„å®¹é‡æ˜¯å…¶ä»–å¤§å¤šæ•°å›½å®¶æ­¥æªçš„ä¸¤å€ã€‚æŒ¥èˆç€æ­¥æªçš„è‹±å›½æ­¥å…µä¹Ÿå› â€œmad minuteâ€è€Œé—»åï¼Œåœ¨æ­¤æœŸé—´ä»–ä»¬å¯ä»¥è¾¾åˆ°æ¯åˆ†é’Ÿ30å‘ä»¥ä¸Šçš„é€Ÿåº¦ã€‚ è¿™ç§æ­¦å™¨åœ¨è‹±è”é‚¦å›½å®¶éå¸¸æ™®éï¼Œè¢«åŠ æ‹¿å¤§ï¼Œæ‹‰å‰å’Œæ¾³æ–°å†›å›¢ä»¥åŠè‹±å›½æœ¬èº«ä½¿ç”¨; å¼€å‘äº†è®¸å¤šå˜ä½“ï¼ŒåŒ…æ‹¬æˆ˜åœ°1942å¹´å‡ºç°çš„ç¬¬4å·ã€‚ æ˜¥ç”°M1903M1903æ˜¥ç”°æ­¥æª (M1903 Springfield rifle)æ˜¯ä¸€ç§æ—‹è½¬åæ‹‰å¼æªæœºæ­¥æªï¼Œç”±æ˜¥ç”°å…µå·¥å‚ç”Ÿäº§ï¼Œæ˜¯ç¾å†›åœ¨ä¸€æˆ˜åŠäºŒæˆ˜çš„åˆ¶å¼æ­¥æªï¼Œæ˜¯æ˜¥ç”°å…µå·¥å‚åœ¨æ¯›ç‘Ÿå…µå·¥å‚çš„ç‰¹è®¸ä¸‹ç ”åˆ¶çš„ï¼Œæ—‹è½¬åæ‹‰å¼æªæœºä»¿è‡ªå¾·å›½m1898ï¼Œå¯ä»¥ç®—æ˜¯ä»¥æ¯›ç‘Ÿæ­¥æªä¸ºåŸºç¡€çš„å˜å‹æªã€‚ M1903å› ä¸ºç¼©çŸ­äº†æªç®¡ï¼Œæ‰€ä»¥é•¿åº¦æ¯”æ¯›ç‘Ÿæ­¥æªçŸ­ï¼Œæ‹‰æœºæŸ„æ”¹ä¸ºå‘ä¸‹å¼¯æ›²ä¾¿äºæºè¡Œã€‚ç”±å®¹é‡5å‘å­å¼¹çš„å¼¹ä»“ä¾›å¼¹ï¼Œç”¨5å‘åˆ†ç¦»å¼å¼¹å¤¹è£…å¼¹ã€‚M1903æ­¥æªé…ç”¨çš„M1906æ­¥æªå¼¹ï¼ˆ.30-06æ­¥æªå¼¹ï¼‰æ˜¯åœ¨æ¯›ç‘Ÿå¼æ— åº•ç¼˜å¼¹çš„åŸºç¡€ä¸Šæ”¹è¿›è€Œæˆçš„ï¼Œæ—©æœŸçš„M1903æ­¥æªè¿˜é…æœ‰æ†å¼åˆºåˆ€ï¼Œåæ”¹ç”¨äº†åŒ•é¦–å‹åˆºåˆ€ã€‚ ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜æœŸé—´ï¼Œå½“ç¾å›½å‚æˆ˜æ—¶ï¼ŒM1903æ­¥æªæ•°é‡ä¸è¶³ï¼Œç¾å›½å°†åŒæ ·ä»¿è‡ªå¾·å›½æ¯›ç‘Ÿæ­¥æªæªæœºçš„ä¸€ç§æ©è²å°”å¾·M1917å‘½åä¸ºâ€œM1917æ­¥æªâ€ä½œè¡¥å……è£…å¤‡ï¼Œç”šè‡³ä¸€åº¦åœ¨å‰çº¿ç¾å›½å†›é˜Ÿä½¿ç”¨çš„M1917æ¯”M1903è¿˜å¤šã€‚ä¸€æˆ˜ç»“æŸåï¼Œç¾å›½å†›é˜Ÿåªä¿ç•™M1903ä½œä¸ºåˆ¶å¼æ­¥æªï¼ŒM1917å…¨éƒ¨æ’¤è£…ä½œå‚¨å¤‡ã€‚1938å¹´ï¼Œå–ä»£M1903æ­¥æªçš„åŠè‡ªåŠ¨M1åŠ å…°å¾·æ­¥æªäº§é‡ä¸è¶³ï¼Œå› æ­¤M1903æ­¥æªä»ç„¶æ˜¯ç¾å›½å†›é˜Ÿè£…å¤‡çš„ä¸»è¦æ­¥æªï¼Œåœ¨ç¬¬äºŒæ¬¡ä¸–ç•Œå¤§æˆ˜ä¸­ï¼Œç¾å›½å†›é˜Ÿä»ç„¶å¤§é‡è£…å¤‡ã€‚å‰©ä½™çš„M1903æ˜¥ç”°æ­¥æªè¢«èµ‹äºˆäº†æ–°çš„ä½¿å‘½ï¼ŒåŒ…æ‹¬æ”¹è£…æˆç‹™å‡»æ­¥æªï¼Œç‹™å‡»æ­¥æªç‰ˆæœ¬åŠ è£…å…‰å­¦ç„å‡†é•œï¼Œå…·æœ‰ç²¾åº¦ä¸Šçš„ä¼˜åŠ¿ï¼Œè€Œä¸ºä¸å¦¨ç¢ç„å‡†é•œçš„ä½¿ç”¨ï¼Œæ‰€ä»¥æ‹†é™¤äº†æœºæ¢°ç„å…·ã€‚ç¬¬äºŒæ¬¡ä¸–ç•Œå¤§æˆ˜æœŸé—´ï¼Œæ ¹æ®æ´åŠ©æ³•æ¡ˆå¤§é‡çš„M1903æ­¥æªè£…å¤‡ä¸­å›½å†›é˜Ÿï¼Œåœ¨ä¸­å›½æŠ—æˆ˜æ—¶æœŸä»¥åŠè§£æ”¾æˆ˜äº‰æ—¶æœŸå¹¿æ³›ä½¿ç”¨ã€‚ç”±äºè¯¥æªå¤–å½¢ã€é•¿çŸ­å‡ä¸å½“æ—¶ä¸­å›½å†›é˜Ÿè£…å¤‡çš„ä¸­æ­£å¼æ­¥æªï¼ˆä»¿æ¯›ç‘Ÿ1924ï¼‰ç›¸ä¼¼ï¼Œè¢«ä¸­å›½å£«å…µç§°ä¸ºâ€œèŠ±æ——ä¸­æ­£å¼â€ã€‚M1903æ­¥æªæˆä¸ºç¾å†›åˆ¶å¼è£…å¤‡100å¹´åï¼Œä»ç„¶åœ¨ç¾å›½å†›é˜Ÿä¸­å°‘é‡å‡ºç°ã€‚å¹¶å°†æªèº«é‡‘å±éƒ¨ä»¶é•€é“¬å¤„ç†ï¼Œé…ç™½è‰²èƒŒå¸¦ï¼Œä¾›è®­ç»ƒä¸æ£€é˜…ä½¿ç”¨ã€‚ Martini Henry é©¬è’‚å°¼-äº¨åˆ©æ­¥æªçºµè§‚19ä¸–çºªåæœŸçš„å†›ç”¨æ­¦å™¨ï¼Œè‹±å›½çš„é©¬è’‚å°¼-äº¨åˆ©æ­¥æªæ˜¯ä¸å¯ä¸æçš„ã€‚å®ƒä¸ºè‹±å›½å‘å…¨ä¸–ç•Œæ‰©å¼ å…¶å¸å›½é¢†åœŸï¼Œå‘æŒ¥äº†éå‡¡çš„ä½œç”¨ã€‚ä»å†°é›ªè¦†ç›–çš„åŠ æ‹¿å¤§åˆ°ä½äºæ’’å“ˆæ‹‰æ²™æ¼ è¾¹ç¼˜çš„è‹ä¸¹ï¼Œå†åˆ°ç¾¤å±±ä¹‹ä¸­çš„é˜¿å¯Œæ±—ï¼Œåˆ°å¤„éƒ½ç•™ä¸‹äº†å®ƒçš„è¶³è¿¹ã€‚å†å²ä¸Šè®¸å¤šå‹‡çŒ›çš„å°šæ­¦æ°‘æ—éƒ½è¢«æ‰‹æŒå°„ç¨‹è¿œã€å°„é€Ÿé«˜çš„é©¬è’‚å°¼-äº¨åˆ©æ­¥æªçš„è‹±å›½å£«å…µé•‡å‹äº†ã€‚ é©¬è’‚å°¼-äº¨åˆ©æ­¥æªçš„ä¼ å¥‡å†å²å§‹äºç¾å›½é©¬è¨è¯¸å¡å·çš„æªç‚®å•†äº¨åˆ©Â·çš®åšè¿ªã€‚ 1862å¹´ï¼Œçš®åšè¿ªè·å¾—äº†åè†›è£…å¡«æ­¥æªçš„ä¸“åˆ©æƒï¼Œè¿™ç§æ­¥æªé‡‡ç”¨èµ·è½å¼æªæœºï¼Œæªæœºä¸‹é™æ—¶å¼¹å£³å¯ä»¥è‡ªåŠ¨æŠ›å‡ºï¼Œå¹¶ä¸”èƒ½å¤Ÿä½¿ä¸‹ä¸€å‘æªå¼¹å¿«é€Ÿå…¥è†›ã€‚è¯¥æªé‡‡ç”¨ç®€å•çš„ç«æªå¼å‡»é”¤å‡»å‘æ–¹å¼è€Œä¸”å¿…é¡»æ‰‹åŠ¨å¾…å‡»ã€‚1860å¹´ä»£æœ«è‡³1870å¹´ä»£åˆï¼Œè¿™ç§åè†›è£…å¡«æ­¥æªå—åˆ°äº†è¥¿ç­ç‰™ã€åŠ æ‹¿å¤§ã€åœŸè€³å…¶ã€ç½—é©¬å°¼äºšã€æ–°è¥¿å…°å’Œå¢¨è¥¿å“¥ç­‰å›½çš„é’çï¼Œå¹¶è´­ä¹°äº†æ•°ä¸‡æ”¯ã€‚1866å¹´ï¼Œä¸€ä½å±…ä½åœ¨ç‘å£«çš„å¥¥åœ°åˆ©ç±è®¾è®¡å¸ˆå¼—é›·å¾·é‡Œå…‹Â·å†¯Â·é©¬è’‚å°¼ä¿®æ”¹äº†çš®åšè¿ªçš„è®¾è®¡ï¼Œç”¨å®‰è£…åœ¨æªæœºå†…éƒ¨ã€ç”±å¼¹ç°§æ§åˆ¶çš„å‡»é’ˆä»£æ›¿äº†ç¬¨é‡çš„å¤–ç½®å‡»é”¤ï¼Œå¹¶ä¸”è¿˜é‡æ–°è®¾è®¡äº†æœºåŒ£ã€åŠ å›ºäº†æŠ½å£³é’©ã€‚è¿™äº›æ”¹è¿›ä½¿å¾—è¯¥æªçš„å‡»å‘æ—¶é—´å˜å¾—æ›´çŸ­ (å‡»å‘æ—¶é—´å³ä¸ºæ‰£åŠ¨æ‰³æœºå®Œæˆç¬é—´è‡³åº•ç«å‘ç«çš„æ—¶é—´é—´éš”)ã€‚æ”¹è¿›åçš„æ­¥æªä¸ä½†æ¯”çš®åšè¿ªçš„åŸå‹æªæ›´åšå›ºï¼Œè€Œä¸”åœ¨å°„é€Ÿä¸Šä¹Ÿæœ‰å¾ˆå¤§æé«˜ã€‚ä½†ç‘å£«é™†å†›è¿˜æ˜¯å†³å®šé‡‡ç”¨æ—‹è½¬åæ‹‰å¼æªæœºçš„å•å‘æ­¥æªï¼Œé©¬è’‚å°¼åªå¾—æŠŠä»–çš„è®¾è®¡æä¾›ç»™äº†å…¶ä»–å›½å®¶ã€‚1867å¹´ï¼Œè‹±å›½é™†å†›å¯¹å¤–å®£å¸ƒè¦å¯»æ‰¾ä¸€ç§æ­¥æªæ¥æ›¿ä»£å…¶0.577è‹±å¯¸ï¼ˆ14. 66mmï¼‰å£å¾„çš„æ–¯å¥ˆå¾·æ­¥æªã€‚é©¬è’‚å°¼æºå¸¦ä»–çš„æ­¥æªå‚åŠ äº†è‹±å†›çš„è¯•éªŒï¼Œå°½ç®¡æœ‰å¾ˆå¤šåƒäº¨åˆ©è¿™æ ·çš„çŸ¥åæªç‚®å•†å‚ä¸ç«äº‰ï¼Œä½†ä»–çš„æ­¥æªå´æŠ€å‹ç¾¤é›„ã€‚1868å¹´ï¼Œåè½åœ¨æ©è²å°”å¾·çš„è‹±å›½çš‡å®¶è½»æ­¦å™¨åˆ¶é€ å‚æ¥åˆ°ç”Ÿäº§å‡ æ”¯é©¬è’‚å°¼æ­¥æªç”¨äºè¿›è¡Œè¿›ä¸€æ­¥é‡å¤–è¯•éªŒçš„å‘½ä»¤ã€‚ç»è¿‡å¤§é‡çš„é‡å¤–è¯•éªŒï¼Œ1871å¹´7æœˆ3æ—¥ï¼Œé©¬è’‚å°¼æ­¥æªè¢«è‹±å†›æ­£å¼é‡‡ç”¨ã€‚ç”±äºè¯¥æªé‡‡ç”¨äº†äº¨åˆ©è®¾è®¡çš„å¸¦æœ‰è†›çº¿çš„æªç®¡ï¼Œå› æ­¤è‹±å›½é™†å†›å®˜æ–¹å°†å…¶å‘½åä¸ºé©¬è’‚å°¼-äº¨åˆ©MKâ… æ­¥æªã€‚è¯¥æªæ˜¯ä¸€ç§å¾ˆå®ç”¨çš„æ­¦å™¨ï¼Œç›’å­çŠ¶çš„æœºåŒ£ä½¿å¾—æ‰³æœºæŠ¤åœˆä½ç½®å‘å‰äº†ï¼Œå¹¶ä¸”æ æ†ä¸€ç›´å»¶ä¼¸åˆ°æªæ‰˜ä¸Šã€‚é‡‡ç”¨èƒ¡æ¡ƒæœ¨æªæ‰˜å’ŒæŠ¤æœ¨ï¼ŒæŠ¤æœ¨ç”¨ä¸¤ä¸ªå¥—ç®å›ºå®šåœ¨æªèº«ä¸Šï¼Œå¹¶ä¸”æœ‰ä¸€åœ†æ†é€šè¿‡æ²Ÿæ§½é•¶åµŒåœ¨ä¸‹æŠ¤æœ¨çš„åº•éƒ¨ï¼Œæªç®¡å³ä¾§å®‰è£…äº†ä¸€æŠŠéª‘å…µåˆºåˆ€ã€‚ é©¬è’‚å°¼-äº¨åˆ©MKâ… æ­¥æªæ“ä½œèµ·æ¥éå¸¸ç®€ä¾¿ï¼Œå°„æ‰‹åªéœ€å‘ä¸‹æ‹‰åŠ¨æ æ†ï¼Œå°±ä¼šå®Œæˆå¦‚ä¸‹çš„åŠ¨ä½œï¼šå‡»é’ˆç¼©è¿›æªæœºçš„å‰éƒ¨ï¼›æªæœºå›è½¬ï¼Œéœ²å‡ºå¼¹è†›ï¼›æ‰³æœºåµŒå…¥é˜»é“æ§½ï¼›è¯¥æªä»…æœ‰çš„ä¿é™©è£…ç½®æ˜¯ä½äºæœºåŒ£å³ä¾§çš„æ°´æ»´çŠ¶å¾…å‡»æŒ‡ç¤ºå™¨ï¼Œå¾…å‡»æ—¶å…¶æŒ‡åœ¨åç‚¹é’Ÿçš„ä½ç½®ä¸Šï¼Œå‡»å‘åæŒ‡åœ¨åäºŒç‚¹é’Ÿçš„ä½ç½®ã€‚æœºåŒ£å³ä¾§é¡¶éƒ¨åˆ»æœ‰V.Rå­—æ ·ï¼Œå³ç»´å¤šåˆ©äºšç‹å† æ ‡å¿—ï¼Œå…¶å³ä¸‹ä¾§ä¸ºå†›é˜Ÿåˆ¶å¼æ ‡å¿—ã€‚ç½—é©¬æ•°å­—â… åˆ»åœ¨æœºåŒ£å³ä¾§é è¿‘åˆ¶é€ å•†æ ‡å¿—å¤„ã€‚ é©¬è’‚å°¼-äº¨åˆ©æ­¥æªæœ€åˆä½¿ç”¨çš„æªå¼¹å£å¾„ä¸º0.450è‹±å¯¸ï¼Œé‡‡ç”¨åšå…‹èµ›å¼åº•ç«ï¼Œå·åˆ¶é»„é“œå¼¹å£³ã€‚åæ¥ï¼Œè¯¥æªå¼¹æ”¹ä¸ºé‡‡ç”¨å‡ å±‚å¸¦çº¸å«çš„å·åˆ¶è–„é“œçš®å¼¹å£³èº«å¹¶é…ä»¥é“åˆ¶å¼¹å£³åº•éƒ¨çš„å¼¹å£³ã€‚ ä½¿ç”¨å·åˆ¶é»„é“œçš®å¼¹å£³çš„æªå¼¹çœ‹èµ·æ¥å¾ˆé€‚ç”¨ï¼Œä½†åœ¨å®æˆ˜ä¸­ç”¨è–„ææ–™åˆ¶æˆçš„å¼¹å£³æ˜“äºå˜å½¢ã€æ’•è£‚ã€å—æ½®ï¼Œè€Œä¸”å½“æ­¦å™¨è¿ç»­å‘å°„æ¸©åº¦è¾ƒé«˜æ—¶ï¼Œè–„é“œçš®æ˜“ç²˜ç€åœ¨å¼¹è†›ä¸Šï¼Œé˜»ç¢æŠ½å£³ã€‚è¿™æ ·å£«å…µä»¬åªå¥½å¼ºè¡Œä»å¼¹è†›é‡Œæ’¬å‡ºç©ºå¼¹å£³ï¼Œå¯¼è‡´é“åˆ¶å¼¹å£³åº•éƒ¨æ’•è£‚ï¼Œè€Œå·åˆ¶é»„é“œçš®å¼¹å£³ç•™åœ¨å¼¹è†›å†…ï¼Œä½¿å¾—ä¸€æ”¯å¾ˆå¥½çš„æ­¥æªä¹Ÿæ— ç”¨æ­¦ä¹‹åœ°äº†ã€‚1885å¹´ï¼Œä¸ºäº†å¯¹ä»˜ç¾¤ä½“çŠ¯ç½ªï¼Œè‹±å›½é™†å†›å‘æ˜äº†è£…å¡«é¹¿å¼¹çš„æªå¼¹é…å¤‡é©¬è’‚å°¼-äº¨åˆ©æ­¥æªä½¿ç”¨ã€‚å®ƒæ˜¯ä¸€ç§è£…æœ‰11ä¸ªå°çƒçš„å¸¦æœ‰åšå…‹èµ›å¼åº•ç«çš„æªå¼¹ï¼Œç›´å¾„ä¸º7mmï¼Œå†…è£…é»‘ç«è¯ã€‚æ­¤å¤–ï¼Œä¸ºäº†é˜²æ­¢å¼¹å†…å°çƒç›¸äº’ç¢°æ’å‘å‡ºå“å£°ï¼ŒæŸåé‡‘å±è–„ç‰‡çš„å¼¹å£³ï¼Œå¼¹å£³ä¸­çš„ç©ºéš™ç”¨éª¨ç²‰å¡«å……ã€‚ FusilModÃ¨le1886 å‹’è´å°”M1886å‹’è´å°”M1886ï¼ˆæ³•è¯­ï¼šFusilModÃ¨le1886ï¼‰æˆ–å‹’è´å°”æ­¥æªï¼ˆæ³•è¯­ï¼šFusilLebelï¼‰æ˜¯æ³•å›½äº1886å¹´æ¨å‡ºçš„æ‰‹åŠ¨æªæœºå¼æ­¥æªï¼Œç”±å°¼å¤æ‹‰æ–¯.å‹’è´å°”ä¸Šæ ¡ç ”åˆ¶ã€‚è¯¥æªè¿ç”¨äº†ç”±ä¿ç½—.ç»´åŸƒé‚£å¼€å‘çš„ç«è¯Bï¼Œäº¦æ˜¯å²ä¸Šç¬¬ä¸€ç§æœ€æˆåŠŸçš„æ— çƒŸç«è¯æªæ¢°ã€‚å‹’è´å°”æ­¥æªçš„å‡ºç°æ„å‘³ç€é‚£äº›ä½¿ç”¨é»‘ç«è¯çš„æªæ¢°å·²è¿‡æ—¶ï¼Œå„å›½äº¦å¼€å§‹æ”¹ä¸ºä¸“æ³¨äºç ”åˆ¶å’Œé‡‡è´­å‘å°„æ— çƒŸç«è¯çš„æªæ¢°ã€‚ å‹’è´å°”æ­¥æªå‘å°„8Ã—50æ¯«ç±³çš„å…¨å…¨å±å¤–å£³æ­¥æªå­å¼¹ï¼Œè½½å¼¹é‡ä¸º8å‘ï¼Œå¹¶ä»¥å†…ç½®å¼¹ä»“ä¾›å¼¹ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜å¯é…å¤‡ä¸€ç§é•¿é’ˆå‹çš„é‡å‰‘å¼åˆºåˆ€ä»¥åº”ä»˜ç™½åˆƒæˆ˜ã€‚åœ¨1887å¹´ï¼Œå‹’è´å°”æ­¥æªè¢«æ³•å›½å†›é˜Ÿåˆ—è£…ä¸ºåˆ¶å¼æ­¥æªï¼Œå¹¶å‚ä¸äº†å¤šæ¬¡å¯¹å¤–æˆ˜äº‰ï¼Œå½“ä¸­æ›´åŒ…æ‹¬ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜åŠç¬¬äºŒæ¬¡ä¸–ç•Œå¤§æˆ˜ã€‚åœ¨ä¸€æˆ˜æœŸé—´ï¼Œæ³•å†›æ›¾æ‰“ç®—ä»¥Mle1917åŠè‡ªåŠ¨æ­¥æªå¤§é‡å–ä»£å‹’è´å°”æ­¥æªã€‚ç„¶è€Œï¼Œå£«å…µä»¬å´æ™®éè®¤ä¸ºæ­¤æªè¿‡äºç¬¨é‡å’Œå¤ªé•¿ï¼Œå› æ­¤å¹¶ä¸å®¹æ˜“åœ¨æˆ˜å£•å†…æ“ä½œå’Œä¿å…»ã€‚åŸºäºè¿™äº›é—®é¢˜ï¼Œæ³•å†›ä¸€ç›´éƒ½æœªèƒ½æ‰¾åˆ°åˆé€‚çš„æ›¿ä»£å“ä»¥å–ä»£å‹’è´å°”æ­¥æªã€‚è€Œåœ¨1936å¹´æ¨å‡ºçš„MAS36æ­¥æªäº¦å› ç”Ÿäº§è¿›åº¦å¤ªæ…¢å¹¶ä¸èƒ½æ»¡è¶³å†›é˜Ÿï¼Œæ‰€ä»¥ç›´è‡³æ³•å›½è¢«çº³ç²¹å¾·å›½å é¢†ä¹‹å‰ï¼Œå‹’è´å°”æ­¥æªä»æ—§ä¸ºæ³•å†›çš„ä¸»åŠ›æ­¥æªã€‚å½“ä¸­æœ‰å°‘é‡çš„æ­¥æªæ›´è¢«çº³ç²¹å¾·å†›ç¼´è·ä½¿ç”¨ï¼Œå¹¶ä»¥Gewehr301(f)çš„åä¹‰åœ¨å†›ä¸­æœå½¹ã€‚ç›´è‡³1920å¹´åœäº§å‰ï¼Œå‹’è´å°”æ­¥æªä¸€å…±è¢«æ³•å›½çš„å›½è¥å…µå·¥å‚ç”Ÿäº§äº†çº¦2,880,000æ”¯ã€‚è€Œåœ¨äºŒæˆ˜è¿‡åçš„ä¸€äº›å†²çªä¸­ä»èƒ½æ‰¾åˆ°å‹’è´å°”æ­¥æªçš„èº«å½±ã€‚ è«è¾›-çº³ç”˜æ­¥æªè«è¾›-çº³ç”˜æ­¥æªï¼ˆè«è¾›çº³å¹²ç³»åˆ—ä¿„æ–‡Ğ’Ğ¸Ğ½Ñ‚Ğ¾Ğ²ĞºĞ° ĞœĞ¾ÑĞ¸Ğ½Ğ°ï¼Œè‹±æ–‡Mosin-Nagant,åˆç§°è«è¾›-çº³å¹²ï¼‰ï¼Œå³M1891è«è¾›-çº³ç”˜æ­¥æªï¼Œåœ¨ä¿„å›½è¢«ç§°ä¸ºâ€œVintovka Mosinaâ€ï¼ˆè«è¾›æ­¥æªï¼‰ï¼Œæ˜¯åœ¨ä¿„å›½æ”¿åºœå§”æ‰˜ä¸‹åœ¨1880å¹´ä»£åæœŸè‡³1890å¹´ä»£æ—©æœŸç ”åˆ¶çš„æ­¥æªã€‚è¯¥æªç”±ä¿„å›½å†›é˜Ÿåœ¨1891å¹´æ­£å¼é‡‡ç”¨ï¼Œå®šå‹ä¸º1891å‹3çº¿å£å¾„(7.62x54mmR)æ­¥æªã€‚M1891æ­¥æªåœ¨æ‹›æ ‡è¿‡ç¨‹ä¸­å‡ºç°äº†äº‰è®®ï¼Œæœ‰ä¸¤ä¸ªè®¾è®¡èƒ½å¤Ÿè¿›å…¥å®˜æ–¹è¯„å®¡çš„æœ€åé˜¶æ®µï¼Œä¸€ä¸ªæ˜¯ä¿„å›½é™†å†›ä¸Šå°‰è°¢å°”ç›–Â·ä¼Šå‡¡è¯ºç»´å¥‡Â·è«è¾›ï¼ˆSergei Ivanovich Mosinï¼‰çš„æ ·æªï¼Œå¦ä¸€ä¸ªæ˜¯æ¯”åˆ©æ—¶çš„è‰¾ç±³å°”Â·çº³ç”˜å’Œææ˜‚Â·çº³ç”˜ä¸¤å…„å¼Ÿï¼ˆEmil Nagantå’ŒLeon Nagantï¼‰è®¾è®¡çš„æ ·æªã€‚ å†å²è«è¾›å‡ºç”Ÿäº1849å¹´5æœˆ5æ—¥ï¼Œ12å²æ—¶è¿›å…¥ä¸€å®¶å†›äº‹å­¦é™¢å¹¶åœ¨é‚£é‡Œå‚äº†å†›ï¼Œåœ¨1867å¹´ä»–è¿›å…¥è«æ–¯ç§‘Alexandrovskoyeå†›äº‹ä¸­å­¦ï¼ˆAlexandrovskoye Military High Schoolï¼‰ï¼Œåœ¨1870å¹´ç¦»å¼€å†›äº‹ä¸­å­¦æ—¶ï¼Œä»–ä¸ºäº†èƒ½å¤Ÿè°ƒå»ç‚®å…µéƒ¨é—¨è€Œè½¬å…¥å¼€ä¾æ´›å¤«æ–¯ç§‘ä¼Šç‚®å…µå­¦é™¢ï¼ˆMikhailovskoye Artillery Academyï¼‰ã€‚ä»–åœ¨1875å¹´æ¯•ä¸šåè¢«è°ƒåˆ°å›¾æ‹‰å…µå·¥å‚ã€‚è«è¾›å½“ä¸Šæ­¦å™¨è®¾è®¡å¸ˆåçš„ç¬¬ä¸€ä¸ªå·¥ä½œå°±æ˜¯å¯¹ä¼¯ä¸¹IIæ­¥æªçš„æ”¹è¿›ï¼Œè«è¾›-çº³ç”˜æ­¥æªç®—æ˜¯ä»–çš„ç¬¬äºŒä¸ªè®¾è®¡ï¼Œè™½ç„¶å®šå‹çš„è«è¾›-çº³ç”˜æ­¥æªå¹¶æ²¡æœ‰å®Œå…¨é‡‡ç”¨ä»–çš„è®¾è®¡ã€‚è«è¾›æ˜¯åœ¨1883å¹´å¼€å§‹è®¾è®¡è¿å‘æ­¥æªçš„è®¾è®¡å·¥ä½œï¼Œä»–åœ¨1884å¹´å’Œ1885å¹´åˆ†åˆ«æä¾›äº†å‡ ç§å†…ç½®å¼¹ä»“ä¾›å¼¹çš„æ­¥æªè®¾è®¡ç»™è´Ÿè´£æ‹›æ ‡çš„å§”å‘˜ä¼šï¼Œæœ€åˆçš„è®¾è®¡æ˜¯10.6mmå£å¾„ã€‚ä½†è«è¾›çš„åŠªåŠ›æˆæœæ²¡æœ‰å—åˆ°ä¿„ç½—æ–¯å†›é˜Ÿçš„é‡è§†ã€‚åœ¨1886å¹´æ³•å›½é‡‡ç”¨8mmå£å¾„M1886å‹’è´å°”æ­¥æªåï¼ˆè¿™æ˜¯ç¬¬ä¸€ç§é‡‡ç”¨æ— çƒŸç«è¯çš„å°å£å¾„æªå¼¹çš„å†›ç”¨æ­¦å™¨ï¼‰ï¼Œæ­¤ä¸¾åœ¨ä¸–ç•Œå„å›½å¼•èµ·äº†ä¸€åœºä½¿ç”¨æ— çƒŸå‘å°„è¯å°å£å¾„æªå¼¹ï¼ˆç›¸å¯¹ä¹‹å‰çš„å¼¹è¯ï¼‰çš„è½»æ­¦å™¨å†›å¤‡å˜é©ï¼Œåœ¨1887å¹´è‡³1889å¹´é—´ï¼Œå¤§å¤šæ•°æ¬§æ´²å›½å®¶çš„å†›é˜Ÿéƒ½é‡‡ç”¨äº†ç±»ä¼¼çš„æ­¦å™¨ï¼Œä¿„å›½æ”¿åºœä¹Ÿå†³å®šé‡‡ç”¨ä¸€ç§ç±»ä¼¼çš„æ–°å‹è¿å‘æ­¥æªï¼Œä»£æ›¿ç°å½¹çš„ä¼¯ä¸¹æ­¥æªï¼ˆç±»ä¼¼äºè‹±å›½é©¬è’‚å°¼-äº¨åˆ©æ­¥æªçš„é»‘ç«è¯æªå¼¹å•å‘åè£…æªï¼‰ã€‚ä¸ºæ­¤ä¿„ç½—æ–¯æ”¿åºœç»„ç»‡äº†ä¸€ä¸ªå§”å‘˜ä¼šï¼Œä»ç°æœ‰çš„æ¯›ç‘Ÿã€å‹’è´å°”ã€æ-æ¢…ç‰¹ç¦ã€æ›¼åˆ©å¤ã€æ–½å¯†ç‰¹-é²å®¾å’Œå…‹æ‹‰æ ¼-çº¦æ ¹æ£®ç­‰è®¾è®¡ä¸­è¿›è¡Œé€‰æ‹©ã€‚è«è¾›ä¹Ÿæ¥å—å§”æ‰˜è®¾è®¡äº†ä¸€ç§5å‘å•æ’å¼¹ä»“çš„7.62mmå£å¾„æ­¥æªå‚ä¸æ‹›æ ‡ã€‚æ ¹æ®å¤è€çš„ä¿„ç½—æ–¯åº¦é‡è¡¡ç§°ä¸º3çº¿å£å¾„ã€æ³¨ï¼šliniyaï¼Œè‹±æ–‡ä¸ºlineï¼Œæ—§ä¿„ç½—æ–¯åº¦é‡è¡¡ï¼Œ1çº¿ç­‰äº0.1è‹±å¯¸æˆ–2.54mmï¼Œå› æ­¤ï¼Œ3çº¿ç­‰äº7.62mmæˆ–0.3è‹±å¯¸ã€‘ã€‚è€Œæ¯”åˆ©æ—¶æ­¦å™¨è®¾è®¡å¸ˆææ˜‚Â·çº³ç”˜åˆ™å‘ä¿„ç½—æ–¯å†›é˜Ÿæäº¤äº†ä¸€ç§3.5çº¿å£å¾„ï¼ˆ8.89mmï¼‰æ­¥æªå’Œ500å‘æªå¼¹è¿›è¡Œæµ‹è¯•ã€‚è«è¾›çº³å¹²1891æ­¥æªæ—©æœŸå‹è«è¾›çº³å¹²1891æ­¥æªæ—©æœŸå‹æ‰€æœ‰å‚ä¸æŠ•æ ‡çš„æ­¦å™¨éƒ½åœ¨1890å¹´è‡³1891å¹´é—´ç”±ä¿„ç½—æ–¯å†›é˜Ÿè¿›è¡Œæµ‹è¯•ï¼Œä¿„ç½—æ–¯å†›é˜Ÿåçˆ±çº³ç”˜çš„è®¾è®¡ã€‚åŸæœ¬å¯¹çº³ç”˜çš„è®¾è®¡æœ‰åˆ©ï¼Œä½†å‡ºäºä¿„ç½—æ–¯å›½å®¶å°Šä¸¥çš„è€ƒè™‘ï¼Œæ”¿åºœå¯¹è«è¾›çš„æ­¥æªå¾ˆæ„Ÿå…´è¶£ã€‚ç”±äºæ”¿åºœå’Œå†›é˜Ÿçš„æ„è§åˆ†æ­§ï¼Œäº’ä¸ç›¸è®©ï¼Œæœ€åå§”å‘˜ä¼šç”¨äº†æŠ˜è¡·çš„æ–¹æ³•ï¼šæŠŠè¿™ä¸¤ç§è®¾è®¡åˆå¹¶åœ¨ä¸€ç§æ­¥æªä¸Šï¼Œç»“æœæ˜¯æŠŠçº³ç”˜å…„å¼Ÿè®¾è®¡çš„ä¾›å¼¹ç³»ç»Ÿè£…åœ¨è«è¾›è®¾è®¡çš„æ­¥æªä¸Šï¼Œå› æ­¤è¿™ç§æ­¥æªç³»ç»Ÿè¢«ç§°ä¸ºè«è¾›-çº³å¹²æ­¥æªã€‚è€Œå‚ä¸ç«äº‰çš„åŒæ–¹éƒ½è·å¾—è¡¥å¿ï¼šçº³ç”˜å…„å¼Ÿå¾—åˆ°é…¬é‡‘ï¼ˆåæ¥çº³ç”˜å…„å¼Ÿè®¾è®¡çš„M1895æ‰‹æªä¹Ÿè¢«ä¿„ç½—æ–¯å†›é˜Ÿé‡‡ç”¨ï¼‰ï¼Œè€Œè«è¾›åˆ™æ™‹å‡æˆä¸Šæ ¡å¹¶è¢«ä»»å‘½ä¸ºè°¢æ–¯ç‰¹ç½—åˆ—èŒ¨å…‹å…µå·¥å‚çš„ä¸»ç®¡ï¼Œç»§ç»­æ”¹è¿›å’Œç”Ÿäº§è¿™ç§æ­¥æªï¼Œè«è¾›ä¸Šæ ¡äº1902å¹´2æœˆ8æ—¥å»ä¸–ï¼Œå®‰è‘¬åœ¨å›¾æ‹‰ã€‚åœ¨1960å¹´ï¼Œè‹è”è®¾ç«‹äº†ä¸€ä¸ªS.I.è«è¾›ç‰¹åˆ«å¥–ï¼Œå¥–åŠ±å„ä¸ªé˜²åŠ¡ä¼ä¸šç³»ç»Ÿå†…çš„ä¸“å®¶ã€‚è«è¾›-çº³ç”˜æ­¥æªè¢«é‡‡ç”¨æ—¶ä¿„å›½çš„è½»æ­¦å™¨ä¼ä¸šè¿˜æ²¡æœ‰åšå¥½ç”Ÿäº§å‡†å¤‡ï¼Œæ‰€ä»¥ç¬¬ä¸€æ‰¹M1891è«è¾›-çº³ç”˜æ­¥æªæ˜¯æ³•å›½çš„å¤ç‰¹ç½—è½»æ­¦å™¨å‚ç”Ÿäº§çš„ã€‚è«è¾›-çº³ç”˜æ­¥æªæ˜¯ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜ä¸­ä¿„å›½å†›é˜Ÿçš„ä¸»è¦è£…å¤‡ã€‚åœ¨ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜æœŸé—´ï¼Œå¤–å›½çš„æ‰¿åŒ…å•†å†ä¸€æ¬¡è¢«ç”¨æ¥ç”Ÿäº§è¿™ç§æ­¥æªï¼Œå½“æ—¶ä¿„å›½éå¸¸ç¼ºä¹æ­¥æªï¼Œæ‰€ä»¥ä¸ä¸¤å®¶ç¾å›½å…¬å¸ç­¾è®¢ç”Ÿäº§åˆåŒï¼Œä½†è¿™æ‰¹æ­¥æªç”±äº1917å¹´çš„åæœˆé©å‘½è€Œæ²¡æœ‰äº¤ç»™åæ¥çš„è‹ç»´åŸƒæ”¿æƒï¼Œåœ¨ç¾å›½ç”¨äºè®­ç»ƒå’Œæ°‘é—´é”€å”®ã€‚M1891æ­¥æªæœ€åˆæœ‰ä¸‰ç§å‹å·ï¼šæ­¥å…µæ­¥æªã€é¾™éª‘å…µæ­¥æªå’Œå“¥è¨å…‹æ­¥æªï¼Œæ­¥å…µæ­¥æªå°±æ˜¯æ ‡å‡†å‹é•¿æ­¥æªï¼Œåä¸¤ç§æ˜¯é…å‘ç»™éª‘å…µéƒ¨é˜Ÿä½¿ç”¨çš„éª‘æªï¼ˆå¡å®¾æªï¼‰ã€‚ ç»“æ„ç‰¹ç‚¹è«è¾›-çº³ç”˜æ˜¯æœ€æ—©çš„æ— çƒŸå‘å°„è¯å†›ç”¨æ­¥æªä¹‹ä¸€ï¼Œæªå£°æ¸…è„†, æœ‰å¦‚æ°´ç æº…è½, å› æ­¤æˆ‘ä»¬ä¸­å›½äººä¸ºè«è¾›-çº³ç”˜èµ·äº†ä¸€ä¸ªé¢‡å…·è¯—æ„çš„ç»°å·â€æ°´è¿ç â€ã€‚è«è¾›-çº³ç”˜ç³»åˆ—æ­¥æªä¸æ¯›ç‘Ÿæ­¥æªç³»åˆ—ã€æ-æ©è²å°”å¾·æ­¥æªç³»åˆ—ç­‰å…¶ä»–åŒæ—¶ä»£åŒç±»å†›ç”¨æ­¥æªç›¸æ¯”ï¼Œå…¶æªæœºè®¾è®¡æ˜¾å¾—è¾ƒä¸ºå¤æ‚ï¼Œå®ƒçš„è®¾è®¡ç²—ç³™è€Œä¸”è¿‡æ—¶ï¼Œæ•´ä½“çš„æ“ä½œæ„Ÿè§‰ä¹Ÿæ¯”è¿™äº›æ­¥æªç¬¨æ‹™ã€‚ä½†è«è¾›-çº³ç”˜æ­¥æªçš„ä¼˜ç‚¹æ˜¯æ˜“äºç”Ÿäº§å’Œä½¿ç”¨ç®€å•å¯é â€”â€”è¿™ç›¸å¯¹äºå·¥ä¸šåŸºç¡€ä½ã€å£«å…µæ•™è‚²ç¨‹åº¦ä½çš„è‹/ä¿„å†›é˜Ÿæ¥è¯´æ˜¯æå…¶é‡è¦çš„ï¼Œå°¤å…¶æ˜¯æ¶åŠ£çš„æˆ˜äº‰æ—¶æœŸåŒ…éœ€æé«˜æ­¦å™¨äº§é‡ä»¥æ»¡è¶³å‰çº¿éœ€è¦ï¼Œè€Œå¤§é‡è¡¥å……çš„æˆ˜æ–—äººå‘˜å¾€å¾€è®­ç»ƒæ—¶é—´ä¸è¶³ã€‚ è«è¾›-çº³ç”˜æ­¥æªæ˜¯ä¸€ç§æ—‹è½¬åæ‹‰å¼æªæœºã€å¼¹ä»“å¼ä¾›å¼¹çš„æ‰‹åŠ¨æ­¥æªï¼Œæ˜¯ä¿„ç½—æ–¯å†›é˜Ÿé‡‡ç”¨çš„ç¬¬ä¸€ç§æ— çƒŸå‘å°„è¯æ­¥æªã€‚å®ƒé‡‡ç”¨æ•´ä½“å¼çš„å¼¹ä»“ï¼Œé€šè¿‡æœºåŒ£é¡¶éƒ¨çš„æŠ›å£³å£å•å‘æˆ–ç”¨å¼¹å¤¹è£…å¡«ã€‚å¼¹ä»“ä½äºæªæ‰˜ä¸‹çš„æ‰³æœºæŠ¤åœˆå‰æ–¹ï¼Œå¼¹ä»“å®¹å¼¹é‡5å‘ï¼Œæœ‰é“°é“¾å¼åº•ç›–ï¼Œå¯æ‰“å¼€åº•ç›–ä»¥ä¾¿æ¸…ç©ºå¼¹ä»“æˆ–æ¸…æ´ç»´æŠ¤ã€‚ç”±äºæ˜¯å•æ’è®¾è®¡è€Œæ²¡æœ‰æŠ±å¼¹å£ï¼Œå› æ­¤å¼¹ä»“å£éƒ¨æœ‰ä¸€ä¸ªéš”æ–­é¢å™¨ï¼Œä¸Šè†›æ—¶éš”å¼€ç¬¬äºŒå‘å¼¹ï¼Œé¿å…å‡ºç°ä¸ŠåŒå¼¹çš„æ•…éšœã€‚åœ¨æ—©æœŸçš„æªå‹ä¸­ï¼Œè¿™ä¸ªè£…ç½®ä¹Ÿå…¼å…·æŠ›å£³æŒºçš„ä½œç”¨ï¼Œä½†è‡ªM1891/30å‹å¼€å§‹ï¼Œä»¥åçš„æªå‹éƒ½å¢åŠ äº†ä¸€ä¸ªç‹¬ç«‹çš„æŠ›å£³æŒºã€‚æªè†›å†…æœ‰4æ¡å³æ—‹è½¬è†›çº¿ã€‚å½“æªæœºé—­é”æ—¶ï¼Œå›è½¬å¼æªæœºå‰é¢çš„ä¸¤ä¸ªé—­é”å‡¸ç¬‹å‘ˆæ°´å¹³çŠ¶æ€ã€‚æ­¥æªæ˜¯å‡»é’ˆå¼å‡»å‘ï¼Œå‡»é’ˆåœ¨æ‰“å¼€æªæœºçš„è¿‡ç¨‹ä¸­è¿›å…¥å¾…å‘çŠ¶æ€ã€‚æ‰‹åŠ¨ä¿é™©è£…ç½®æ˜¯åœ¨æªæœºå°¾éƒ¨å‡¸å‡ºçš„ä¸€ä¸ªâ€œå°å¸½â€ï¼Œå‘åæ‹‰æ—¶ä¼šé”ä½å‡»é’ˆï¼Œè€Œå‘å‰æ¨æ—¶ä¼šè§£è„±ä¿é™©çŠ¶æ€ï¼Œæ“ä½œæ—¶ä¸å¤ªæ–¹ä¾¿è€Œä¸”è´¹åŠ›ã€‚æ°´å¹³ä¼¸å‡ºçš„æ‹‰æœºæŸ„åŠ›è‡‚è¾ƒçŸ­ï¼Œå› æ­¤æ“ä½œæ—¶éœ€è¦èŠ±è¾ƒå¤§çš„åŠ›æ°”ï¼Œè€Œä¸”æ¯”èµ·ä¸‹å¼¯å¼æ‹‰æœºæŸ„åœ¨æºè¡Œæ–¹é¢æ—¶è¾ƒä¸æ–¹ä¾¿ï¼Œè€Œä¸‹å¼¯å¼æ‹‰æœºæŸ„åªæœ‰ç‹™å‡»å‹æ‰æœ‰ã€‚ä»æ­¥æªä¸Šåˆ†è§£å‡ºæªæœºæ—¶ä¸éœ€è¦ä¸“é—¨å·¥å…·ï¼Œåªè¦æ‹‰å¼€æªæœºï¼Œç„¶åæ‰£ä¸‹æ¿æœºå°±èƒ½å–å‡ºæªæœºã€‚åœ¨æ²¡æœ‰å·¥å…·çš„æ¡ä»¶ä¸‹è¿˜å¯ä»¥è¿›ä¸€æ­¥åˆ†è§£å…¶ä»–å‡ ä¸ªä¸»è¦éƒ¨ä»¶ã€‚æ—©æœŸçš„æ£±å½¢åˆºåˆ€çš„æˆªé¢ä¸ºçŸ©å½¢ï¼Œåæ”¹ä¸ºä¸€å­—èºä¸èµ·å­å½¢ï¼Œå¹¶åœ¨åˆ†è§£æ­¥æªæ—¶å……å½“åˆ†è§£å·¥å…·ã€‚æ—©æœŸçš„åˆºåˆ€æ˜¯å¯æ‹†å¸çš„å››æ£±åˆºåˆ€é€šè¿‡ç”¨ç®¡çŠ¶æ’åº§å¥—åœ¨æªå£ä¸Šï¼ŒåæœŸä¸ºä¸å¯å¸çš„æŠ˜å å¼ï¼Œè€Œä¸”åˆºåˆ€åº§å…¼ä½œå‡†æ˜Ÿåº§ã€‚æªæ‰˜é€šå¸¸ç”¨æ¡¦æœ¨ã€‚ å¼¹è¯ä¸M1891æ­¥æªä¸€èµ·è¿˜æœ‰ä¸€ç§æ–°çš„å°å£å¾„æªå¼¹è¢«é‡‡ç”¨ï¼ˆç¡®å®æ˜¯é‚£ä¸ªå¹´ä»£é‡Œçš„å°å£å¾„æªå¼¹ï¼‰ï¼Œç›´åˆ°ä»Šå¤©ï¼Œ7.62Ã—54mmRæªå¼¹åœ¨ä¿„å›½å†›é˜Ÿæœå½¹å·²ç»è¶…è¿‡äº†ä¸€ä¸ªä¸–çºªã€‚è¯¥æªå¼¹é‡‡ç”¨çªåº•ç¼˜é”¥å½¢å¼¹å£³ï¼Œçªåº•ç¼˜å¼¹å£³çš„è®¾è®¡åœ¨19ä¸–çºªæœ«ä¹Ÿå·²ç»å¼€å§‹æ˜¾å¾—å¼€å§‹è¿‡æ—¶äº†ï¼Œä½†å´é€‚åˆåŸºç¡€è¾ƒä½çš„ä¿„ç½—æ–¯è½»æ­¦å™¨å·¥ä¸šï¼Œå› ä¸ºçªåº•ç¼˜å¼¹å£³å¯¹å¼¹è†›å°ºå¯¸çš„è¦æ±‚ç›¸å¯¹å®½æ¾ä¸€ç‚¹ï¼Œè¿™æ ·åœ¨æœºå™¨åŠ å·¥æ—¶å…è®¸æœ‰è¾ƒå¤§çš„ç”Ÿäº§å…¬å·®ï¼Œæ—¢èŠ‚çœäº†å·¥æ—¶åˆèŠ‚çº¦äº†é’±ã€‚M1891å¼æªå¼¹çš„å¼¹å¤´æ˜¯é‡210æ ¼ä»¤ã€é“œé•åˆé‡‘è¢«ç”²ã€é“…èŠ¯çš„é’åœ†å¤´å½¢å¼¹å¤´ï¼Œåœ¨å¾·å›½é‡‡ç”¨äº†å°–å¤´å¼¹åï¼Œä¿„ç½—æ–¯ä¹Ÿå¼€å§‹ç ”åˆ¶å°–å¤´å¼¹ï¼Œç»è¿‡å¹¿æ³›æµ‹è¯•åï¼Œåœ¨1908å¹´é‡‡ç”¨äº†ä¸€ç§é‡148æ ¼ä»¤ã€é“œé•è¢«ç”²çš„é“…èŠ¯å°–å¤´å¼¹ï¼ˆæˆ˜äº‰æ—¶æœŸé‡‡ç”¨è¦†é“œé’¢è¢«ç”²ï¼‰ã€‚åœ¨äºŒæˆ˜ç»“æŸåï¼Œè‹è”çš„åˆ¶å¼æ­¥æªå…ˆåé‡‡ç”¨äº†ä¸­é—´å¨åŠ›å‹æªå¼¹å’Œ5.45mmå°å£å¾„æ­¥æªå¼¹ï¼Œä½†ç›´åˆ°ç°åœ¨M1908å¼æªå¼¹ç³»åˆ—ä»ç„¶è¢«ç”¨ä½œæœºæªå’Œç‹™å‡»æ­¥æªçš„å¼¹è¯ã€‚ ä¸‰å…«å¼æ­©å…µé“³å…«å¼æ­¥æªï¼ˆæ—¥è¯­ï¼šä¸‰å…«å¼æ­©å…µé“³ï¼›ã•ã‚“ã±ã¡ã—ãã»ã¸ã„ã˜ã‚…ã†ï¼Œè‹±æ–‡ï¼šSanpachi-shiki hohei-juï¼‰ä¸ºæ‰‹åŠ¨æ­¥æªï¼Œæ—¥æœ¬é™†å†›äºæ—¥ä¿„æˆ˜äº‰å1907å¹´æ­£å¼é‡‡ç”¨ä¸ºåˆ¶å¼æ­¦å™¨ï¼Œä¸‰å…«å¼æ­¥æªæ˜¯ç¬¬äºŒæ¬¡ä¸–ç•Œå¤§æˆ˜ä¸­æ—¥æœ¬æ³•è¥¿æ–¯é™†ã€æµ·å†›æœ€ä¸»è¦ã€æœ€åŸºæœ¬çš„æ­¦å™¨ï¼Œä¸€ç›´ä½¿ç”¨åˆ°äºŒæˆ˜ç»“æŸï¼ˆæ—¥æœ¬æˆ˜è´¥ï¼‰ï¼Œç”¨äº†æ•´æ•´40å¹´ã€‚ä¸‰å…«å¼æ­¥æªåœ¨ä¸­å›½ä¸€å‘ä¿—ç§°ä¸ºä¸‰å…«å¤§ç›–ï¼Œç”±äºå…¶æªæœºä¸Šæœ‰ä¸€ä¸ªéšæªæœºè¿åŠ¨çš„é˜²å°˜ç›–ä»¥åŠæœºåŒ£ä¸Šåˆ»æœ‰â€œä¸‰å…«å¼â€å­—æ ·è€Œå¾—åã€‚ å†å²ä¸‰å…«å¼æ­¥æªçš„åŸå‹æ˜¯ä¸‰åå¹´å¼æ­¥æªå’Œä¸‰äº”å¼æµ·å†›æ­¥æªã€‚ä¸‰åå¹´å¼æ­¥æªä»¿é€ è‡ªå¾·å›½æ¯›ç‘Ÿæ­¥æªï¼Œè®¾è®¡å¸ˆæ˜¯æœ‰å‚æˆç« å¤§ä½ï¼Œä»¥å–ä»£ä»ç”²åˆæˆ˜äº‰ä»¥æ¥ï¼Œä»¥æ³•å›½M1874æ­¥æªä»¿é€ ä½†æ˜¯ä¸å¯é ä¹Ÿæ‰“ä¸å‡†çš„æ‘ç”°æªã€‚ è¿™ä¸¤ç§æ­¥æªä¹Ÿå› å…¶å‘æ˜è€…æœ‰å‚æˆç« è€Œå¾—åæœ‰å‚æ­¥æªã€‚æœ‰å‚åœ¨è®¾è®¡ä¸‰åå¹´å¼æ­¥æªæ—¶èµ·åˆè®¾å®šäº†ä¸‰ç§å£å¾„ä½œä¸ºç ”å‘æ–¹å‘ï¼š6æ¯«ç±³ã€6.5æ¯«ç±³ä»¥åŠ7æ¯«ç±³ã€‚ä¸‰åå¹´å¼æ­¥æªï¼ˆä¸‰åå¹´å¼æ­©å…µé“³ï¼‰äº1897å¹´è¿›è¡Œåˆ¶å¼åŒ–ç”Ÿäº§ï¼Œå¹¶äº1903å¹´å®Œæˆæ—¥æœ¬å…¨å†›æ›´æ¢æ•´è£…ã€‚æ—¥æœ¬é™†å†›æ¢å‘ä¸‰åå¹´å¼æ­¥æªåï¼Œæ—¥æœ¬æµ·å†›é™†æˆ˜é˜Ÿä¹Ÿè·Ÿç€æ¢æªï¼Œæœ‰å‚æˆç« å°†è®¾è®¡æ¡ˆè½¬å°†ç»™éƒ¨å±å—éƒ¨éº’æ¬¡éƒä¸Šå°‰è´Ÿè´£è¿›è¡Œæ”¹è¿›ã€‚å—éƒ¨éº’æ¬¡éƒåªè¿›è¡Œäº†å°æ”¹è‰¯ï¼Œå°†è¡¨å°ºæ”¹ä¸ºç›´ç«‹å¼ï¼Œå¹¶ä¸”åŠ ä¸Šæªæœºç›–ï¼Œå¹¶å‘½åä¸ºä¸‰äº”å¼æµ·å†›æ­¥æªï¼ˆä¸‰åäº”å¹´å¼æµ·å†›é“³ï¼‰ã€‚1904å¹´è‡³1905å¹´æ—¥å†›åœ¨ä¸­å›½ä¸œåŒ—æˆ˜åœºä¸Šä½¿ç”¨çš„ä¸‰åå¹´å¼æ­¥æªè¡¨éœ²å‡ºæœ‰ä¸€ç§ç»†å°çš„æ²™å°˜è¿›å…¥æ“ä½œæœºå…³å†…ï¼Œå¯¼è‡´æ“ä½œä¸è‰¯ï¼Œä¸‰åå¹´å¼æ­¥æªå¦å¤–æœ‰æ ¹å¾ˆå®¹æ˜“æŠ˜æ–­çš„æ’é’ˆã€‚ä¸Šè¿°çš„æƒ…å½¢åœ¨æ—¥ä¿„æˆ˜äº‰åæœ‰äººæå‡ºè®¨è®ºä¸è¿›è¡Œæ”¹å–„ï¼Œè¿™æ—¶å€™å·²ç»å‡ä»»å°çŸ³å·ç‚®å…µå·¥å‚ç ”ç©¶æ‰€æ‰€é•¿çš„å—éƒ¨éº’æ¬¡éƒå› æ­¤å°†æªæœºé‡æ–°è¿›è¡Œç®€åŒ–ï¼ŒåŒæ—¶åœ¨æªæœºè¡¨é¢å¢åŠ äº†ä¸€ä¸ªéšæªæœºè¿åŠ¨çš„é˜²å°˜ç›–ã€‚ç„¶è€Œå¢åŠ é˜²å°˜ç›–çš„ç«‹æ„è™½ç„¶è‰¯å¥½ï¼Œä¸è¿‡å´åˆä¸ºæ“ä½œæ—¶å¢åŠ äº†ç‹¬ç‰¹çš„é‡‘å±å™ªéŸ³ã€‚å…¶ä»–æ”¹è¿›åŒ…æ‹¬åœ¨å‡†æ˜Ÿä¸¤ä¾§å¢åŠ æŠ¤ç¿¼ï¼Œä¸‰å…«å¼æ­¥æªæœºæ¢°ç„å‡†å…·æ—©æœŸé‡‡ç”¨Vå‹ç¼ºå£ç…§é—¨ï¼ŒåæœŸé‡‡ç”¨è§‡å­”å¼ç…§é—¨ã€‚ å—éƒ¨å¾ˆå¿«åœ°å®Œæˆä¸‰åå¼æ­¥æªçš„æ”¹è‰¯åï¼Œäºæ˜æ²»å››åå¹´ï¼ˆ1907å¹´ï¼‰5æœˆå¼€å§‹åˆ¶å¼åŒ–åœ¨ä¸œäº¬å°çŸ³å·ç‚®å…µå·¥å‚è¿›è¡Œç”Ÿäº§ã€‚è™½ç„¶æ­£å¼çš„åˆ¶å¼åŒ–é‡äº§ä»1907å¹´å¼€å§‹ï¼Œä¸è¿‡å—éƒ¨éº’æ¬¡éƒå°†æ–°æ”¹è‰¯å¼€å‘çš„æ­¥æªä»ç„¶ä»¥æ˜æ²»å¤©çš‡å¹´å·ç¬¬ä¸‰åå…«å¹´ï¼ˆ1905å¹´ï¼‰å‘½åï¼›æ˜æ²»41å¹´3æœˆå¼€å§‹ï¼Œæ–°å¼çš„ä¸‰å…«å¼æ­©æªé€æ¸æˆä¸ºéƒ¨é˜Ÿçš„æ ‡å‡†é…å¤‡ï¼›åˆ°äº†æ˜æ²»43å¹´ï¼ˆ1910å¹´ï¼‰ï¼Œéƒ¨é˜Ÿä¸­çš„ä¸‰åå¹´å¼æ­¥æªå°±å…¨é¢è¢«ä¸‰å…«å¼æ­¥æªå–ä»£äº†ã€‚ ç»“æ„ç‰¹ç‚¹ä¸‰å…«å¼æ­¥æªé‡3.73åƒå…‹ï¼ŒåŠ ä¸Š30å¹´å¼åˆºåˆ€ä¸º4.1åƒå…‹ã€‚æªèº«å…¨é•¿127.6å˜ç±³ï¼Œå†åŠ ä¸Š30å¼å•åˆƒåˆºåˆ€åå°±å¯è¾¾166.3å˜ç±³ï¼Œè¯¥æªä¸€å¤§ç‰¹å¾å°±æ˜¯å®ƒçš„é•¿åº¦ã€‚ä¸‰å…«å¼æ­¥æªçš„æœºåŒ£åˆ¶ä½œå…¬å·®å°ï¼Œè¡¨é¢ç»è¿‡é˜²è…å¤„ç†ï¼Œæªæœºåœ¨æœºåŒ£å†…è¿è¡Œé¡ºç•…ï¼ŒæœºåŒ£ä¸Šé¢æœ‰ä¸¤ä¸ªæ’æ°”å°å­”ï¼Œä¿è¯å°„å‡»æ—¶çš„å®‰å…¨ï¼Œæªæœºä¸Šæ–¹æ˜¯æˆªé¢ä¸ºéšç€æªæœºå‰åæ»‘åŠ¨çš„â€œnâ€å‹çš„é˜²å°˜ç›–ï¼Œé˜²å°˜ç›–ä¸Šæœ‰å¼€å£ä¾›ç›´å¼æ‹‰æœºæŸ„ä¼¸å‡ºï¼Œæªæœºå°¾éƒ¨æœ‰åœ†å¸½å‹çš„è½¬åŠ¨ä¿é™©è£…ç½®ã€‚æªæœºç»„ä»¶çš„è®¾è®¡å…¶éƒ¨ä»¶æ•°é‡æ¯”æ¯›ç‘Ÿæªè¿˜å°‘3ä¸ªé›¶ä»¶ï¼Œä»…æœ‰5ä¸ªé›¶ä»¶ï¼Œæ˜¯å½“å¹´æ—‹è½¬åæ‹‰å¼æªæœºæ­¥æªä¸­ç»“æ„ç®€å•çš„ï¼Œæé«˜å¯é æ€§å’Œå‡ä½ç»´æŠ¤ä¿éšœéš¾åº¦ï¼Œä¸è¿‡é›¶ä»¶å¤–å½¢å¤æ‚å¢åŠ äº†åŠ å·¥éš¾åº¦ã€‚ä¸‰å…«å¼æ­¥æªçš„å¼¹ä»“é•¶åµŒåœ¨æªèº«å†…ï¼Œå®¹é‡5å‘å­å¼¹ï¼Œä¸‰å…«å¼æ­¥æªçš„å¼¹ä»“è¿˜æœ‰ç©ºä»“æç¤ºåŠŸèƒ½ï¼Œå½“å¼¹ä»“å†…æœ€åä¸€å‘æªå¼¹å°„å‡ºåï¼Œæªæœºåæ‹‰åˆ°ä½æ—¶æ‰˜å¼¹æ¿å°±ä¼šé¡¶ä½æªæœºå¤´æ— æ³•å‘å‰è¿åŠ¨æé†’å°„æ‰‹è£…å¼¹ã€‚ä¸‰å…«å¼æ­¥æªçš„æªæ‰˜åŠ å·¥æ–¹å¼ä¸çš„ä¸€èˆ¬å¼æ­¥æªæªæ‰˜åŠ å·¥æ–¹å¼ä¸åŒï¼Œä¸€èˆ¬å¼æ­¥æªçš„æªæ‰˜æ˜¯ç”¨ä¸€æ•´å—æœ¨æ–™åˆ‡å‰Šè€Œæˆï¼Œä¸‰å…«å¼æ­¥æªçš„æªæ‰˜æ˜¯ç”¨ä¸¤å—æœ¨æ–™æ‹¼æ¥è€Œæˆçš„ï¼Œæ­¤ç§æ–¹å¼è™½ç„¶æ—¥ä¹…å®¹æ˜“å¼€è£‚ä½†å¯èŠ‚çœæœ¨æã€‚ ä¸‰å…«å¼æ­¥æªå‚è€ƒæ•°æ® ç±»åˆ« æ—‹è½¬åæ‹‰å¼æªæœºï¼Œå¼¹ä»“ä¾›å¼¹ å£å¾„ 6.5æ¯«ç±³ å…¨æªé•¿ 1275æ¯«ç±³ æªç®¡é•¿åº¦ 797æ¯«ç±³ åŠ è£…åˆºåˆ€æ€»é•¿ æ¥è¿‘1700æ¯«ç±³ å…¨æªé‡ 4.1åƒå…‹ å¼¹åŒ£å®¹å¼¹é‡ 5å‘ å°„ç¨‹ 460ç±³ å¼¹è¯ 6.5Ã—50mm æ­¥æªå¼¹ åˆé€Ÿ 765ç±³/ç§’ å¡çˆ¾å¡è«¾M91/38å¡å°”å¡è¯ºæ˜¯è¿‡å»æ„å¤§åˆ©å¸¸ç”¨çš„æ‰‹åŠ¨æªæœºæ“ä½œå¼ä¸€ç³»åˆ—å†›ç”¨æ­¥æªå’Œå¡å®¾æªï¼Œæœ€åˆäº1891å¹´æ¨å‡ºæ—¶ï¼Œå‘å°„çš„æ˜¯6.5Ã—52æ¯«ç±³æ›¼åˆ©å½»-å¡å°”å¡è¯ºå£å¾„æ— ç¼˜å¼æ­¥æªå­å¼¹ï¼ˆCartuccia Modello 1895ï¼‰ã€‚è¿™ææ­¥æªæ˜¯ç”±é¦–å¸­æŠ€å¸ˆè¨å°”ç“¦å¤šÂ·å¡å°”å¡è¯ºåœ¨éƒ½çµå†›å…µå·¥å‚äº1890å¹´ç ”å‘ï¼Œå¹¶ä¸”ç§°ä¸ºM91ã€‚å®ƒå…ˆåå–ä»£äº†ä»¥å¾€çš„10.35Ã—47æ¯«ç±³RVetterli-ç»´å¡”åˆ©æ­¥æªå’Œå¡å®¾æªä»¥ï¼Œåœ¨1892å¹´åˆ°1945å¹´ä¹‹é—´ç”Ÿäº§ã€‚åœ¨ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜æœŸé—´çš„å¤§å¤šæ•°æ„å¤§åˆ©éƒ¨é˜Ÿå’Œç¬¬äºŒæ¬¡ä¸–ç•Œå¤§æˆ˜ä¸­çš„æ„å¤§åˆ©ä»¥åŠå¾·å›½å†›é˜Ÿä¹‹ä¸­ä¸€äº›éƒ¨é˜Ÿé‡Œï¼Œé‡‡ç”¨äº†M91çš„æ­¥æªï¼ˆfucile, sing.ï¼›fucili, pl.ï¼‰å’Œå¡å®¾æªï¼ˆmoschetto, sing.ï¼›moschetti, pl.ï¼‰å„ä¸¤ç§çš„å‹å·ã€‚åœ¨è¿‡ç¨‹ä¸­ï¼Œæ­¥æªä¹Ÿè¢«èŠ¬å…°äºå†¬å­£æˆ˜äº‰ä¸­ä½¿ç”¨ï¼Œä»¥ååˆåœ¨å™åˆ©äºšã€åˆ©æ¯”äºšã€çªå°¼æ–¯å’Œé˜¿å°”åŠåˆ©äºšè¿™äº›å›½å®¶æˆ˜åçš„å„ç§å†²çªä¸­è¢«æ­£è§„å’Œéæ­£è§„éƒ¨é˜Ÿä½¿ç”¨ã€‚ è™½ç„¶è¿™ç§æ­¥æªç»å¸¸è¢«ç§°ä¸ºâ€œæ›¼åˆ©å½»-å¡å°”å¡è¯ºâ€ï¼ˆç‰¹åˆ«æ˜¯åœ¨ç¾å›½çš„è¯´æ³•ï¼‰ï¼Œä½†ä¸è®ºæ˜¯è¯¥å‘½åè¿˜æ˜¯â€œæ¯›ç‘Ÿ-å¸•æ‹‰ç»´è¥¿å°¼â€ï¼ˆMauser-Parravicinoï¼‰ä¹Ÿä¸æ˜¯æ­£ç¡®çš„ã€‚è¯¥æªåœ¨æ„å¤§åˆ©çš„æ­£å¼åç§°æ˜¯Modello 1891ï¼Œæˆ–æ˜¯M91ï¼ˆâ€œil novantunoâ€ï¼‰ã€‚è¯¥æªçš„å¼¹åŒ£ç³»ç»Ÿä½¿ç”¨æ•´ä½“æ¼å¤¹å¼å¼¹å¤¹æ¡æ¥è£…å¡«ï¼Œè™½ç„¶æœ€åˆæ˜¯ç”±è´¹è¿ªå—å¾·Â·æ›¼åˆ©å½»ç ”å‘å¹¶è·å¾—äº†ä¸“åˆ©ï¼Œä½†äº‹å®ä¸Šå¡å°”å¡è¯ºæ­¥æªçš„å¼¹å¤¹æ¡çš„å®é™…å½¢çŠ¶å’Œè®¾è®¡æ˜¯ç”±å¾·å›½1888å¼å§”å‘˜ä¼šæ­¥æªæ‰€å¾—å‡ºçš„ã€‚ ç›´åˆ°1938å¹´ï¼Œæ‰€æœ‰çš„M91æ­¥æªå’Œå¡å®¾æªéƒ½æ”¹ä¸ºå‘å°„çš„æ˜¯6.5Ã—52æ¯«ç±³æ›¼åˆ©å½»-å¡å°”å¡è¯ºå£å¾„æ— ç¼˜å¼Modello 1895æ­¥æªå­å¼¹ï¼Œé‡‡ç”¨é‡é‡ä¸º160æ ¼ä»¤çš„åœ†å¤´é‡‘å±å¼¹å£³å­å¼¹ï¼Œè§†ä¹æªç®¡é•¿åº¦è€Œä»¤æªå£åˆé€Ÿåœ¨609.6â€”755 ç±³ï¼ç§’ï¼ˆ2,000â€”2,477.03 è‹±å°ºï¼ç§’ï¼‰ä¹‹é—´ã€‚ç”±äºé‡‡ç”¨æ¸è¿›è†›çº¿ï¼ˆè†›çº¿è¶Šæ¥è¿‘æªå£ç¼ è·è¶ŠçŸ­ï¼Œæ•ˆæœæ˜¯å¼¹å¤´è½¬é€Ÿè¶Šæ¥è¶Šå¿«ï¼‰ï¼Œè¯¥æªç²¾åº¦è‰¯å¥½ã€‚ä¸è¿‡ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªè½»æ­¦å™¨çš„æƒå¨æŒ‡å‡ºï¼Œä¸€äº›æ‰¹å·çš„6.5Ã—52 æ¯«ç±³å†›ç”¨å¼¹è¯è£…è½½çš„æ˜¯å¹¶éä¸€è‡´çš„ç«è¯ç±»å‹ï¼Œç»å¸¸å°†ä¸åŒçš„ç«è¯ç±»å‹å’Œå¼¹è¯æ‰¹å·æ··åˆå¹¶ä¸”åˆ¶ä½œæˆä¸ºå•ä¸€çš„å¼¹è¯ï¼ˆå¯èƒ½æ˜¯å‡ºäºæˆ˜æ—¶æˆæœ¬æ§åˆ¶çš„åŸå› ï¼Œäº¦å¯èƒ½æ˜¯ç”Ÿäº§æ··ä¹±æ‰€å¯¼è‡´ï¼‰ã€‚[1]åœ¨ç»è¿‡ä¿®æ”¹çš„æ­¥æªå¼¹è¯ä¸Šæ··ç”¨ç«è¯ç±»å‹å’Œå¼¹è¯æ‰¹å·çš„åšæ³•ä¸ºæ™®éå…¶ä»–å›½å®¶çš„å…µå·¥å‚æ‰€æåŠ›é¿å…çš„äº‹ï¼Œå› ä¸ºè¿™ç§ç²—åŠ£æ‰‹æ³•é€šå¸¸ä¼šå¯¼è‡´å­å¼¹åˆé€Ÿä¸åŒå’Œå­å¼¹ä¸ç›®æ ‡è¿‡åº¦åˆ†æ•£ã€‚ æˆ˜äº‰æµ·æŠ¥ä¸­çš„å¦‡å¥³æ‰‹ä¸­çš„å°±æ˜¯ä¸€æŠŠå¡å°”å¡è¯ºm1938æŠ˜å åˆºåˆ€å‹ï¼š ç½—æ–¯Mk-3ç½—æ–¯Mk-3æ˜¯åŠ æ‹¿å¤§è¿œå¾å†›çš„æ­¦å™¨ï¼Œç¬¬ä¸€æ”¯ç½—æ–¯æ­¥æªå‡ºç°äº1896å¹´ï¼Œå®ƒåœ¨é£å’Œæ—¥ä¸½çš„åŠ æ‹¿å¤§è¡¨ç°å¾ˆå¥½ï¼Œä»¥ç²¾åº¦è€Œé—»åï¼Œå®ƒçš„è®¾è®¡è€…ç½—æ–¯çˆµå£«æ˜¯ä¸€ä¸ªç¥å°„æ‰‹ï¼Œå®ƒå¯¹è‡ªå·±çš„æªè¦æ±‚å¾ˆé«˜ï¼Œè¦æœ‰ä¼˜ç§€çš„ç²¾åº¦å’Œå¿«é€Ÿçš„å°„é€Ÿï¼Œè€Œä¸”ä¸¥æ ¼æ§åˆ¶å…¬å·®ï¼Œäºæ˜¯è¿™æŠŠæªé‡‡ç”¨äº†ç›´æ‹‰æŸ„è®¾è®¡ï¼Œä¸ä¼ ç»Ÿçš„æ‰‹æ‹‰æ—‹è½¬å¼æ­¥æªæ­¥æªï¼Œè¿™æŠŠæªä»…ä»…éœ€è¦ä¸€å‰ä¸€åå°±å¯ä»¥å®ŒæˆæŠ›å£³ï¼Œé€€å¼¹ï¼Œé—­é”çš„æ­¥éª¤ï¼Œå°„é€Ÿè¾ƒå½“æ—¶çš„æ­¥æªæ›´å¿« M1917 Enfieldæ©è²å°”å¾·M1917ï¼ˆM1917 Enfieldï¼ŒåˆåP17ã€P1917æˆ–Pattern 1917ï¼‰æ˜¯â€œç¾å›½æ©è²å°”å¾·â€ï¼ˆAmerican Enfieldï¼‰äº1917è‡³1918å¹´é—´ç”Ÿäº§çš„.30-06å£å¾„æ‰‹åŠ¨æ­¥æªï¼Œè£…å¤‡ä¸€æˆ˜æ—¶æœŸçš„ç¾å›½å†›é˜Ÿï¼Œç¾å›½å½“æ—¶å‘½åä¸ºUnited States Rifle, cal .30, Model of 1917ã€‚ å†å²å½“è‹±å›½åŠ å…¥ä¸€æˆ˜æ—¶ï¼Œå…¶ç›Ÿå‹ç¾å›½æ€¥éœ€æœ¬åœŸç”Ÿäº§çš„æ­¥æªä½œå†›å¤‡ï¼Œå½“æ—¶çš„æ¸©å½»æ–¯ç‰¹åŠé›·æ˜ç™»è·é€‰å¹¶ç”Ÿäº§M1914æ­¥æªï¼ˆP14ï¼‰ã€‚å…¶åï¼Œç¾å›½å‚æˆ˜åéœ€è¦æ›´å¤šæ­¥æªï¼Œç¾å›½å†›æ¢°ç½²æå‡ºé‡‡ç”¨.30-06å£ä¿“å¼¹è¯çš„æ–°å‹æ­¥æªM1917ï¼ˆP17ï¼‰ï¼Œå¹¶ç”±ä½äºåº·ä¹ƒç‹„å…‹å·çº½é»‘æ–‡çš„æ¸©å½»æ–¯ç‰¹å·¥å‚åŠä½äºåº·ä¹ƒè¿ªå…‹å·Eddystoneå’Œçº½çº¦Ilionçš„é›·æ˜ç™»å·¥å‚ç”Ÿäº§ï¼Œè€Œä¸“ç”¨çš„M1917åˆºåˆ€ç”±å…¶ä»–å¤šé—´å°å‚ç”Ÿäº§ã€‚ M1917åŠM1903æ˜¥ç”°æ­¥æªä½œä¸ºä¸€æˆ˜æ—¶ç¾å†›çš„ä¸»è¦åˆ¶å¼æ­¥æªæœå½¹ã€‚åœ¨1918å¹´11æœˆ11æ—¥ï¼Œçº¦75%çš„ç¾å›½è¿œå¾å†›ï¼ˆAmerican Expeditionary Forceï¼‰éƒ½è£…å¤‡äº†M1917ã€‚åœæˆ˜åï¼Œç¾å†›æŠŠM1917ä½œå‚¨å¤‡å‚¨èµ·ã€‚åœ¨äºŒæˆ˜å¼€å§‹åˆæœŸï¼Œç¾å›½æŠŠå‚¨å¤‡èµ·æ¥çš„M1917é‡æ–°æ”¹é€ ï¼Œå¹¶ä½œè®­ç»ƒç”¨é€”åŠé€šè¿‡ç§Ÿå€Ÿæ³•æ¡ˆå‘å¤šä¸ªå›½å®¶ä½œå‡ºæ´åŠ©ï¼ˆåŒ…æ‹¬è‹±å›½ã€è²å¾‹å®¾ã€æ³•å›½åŠä¸­å›½ï¼‰ï¼Œè¿™æ‰¹M1917æ­¥æªä½œå–·æ²™åŠçƒ˜ç£·é…¸ç›å¤„ç†ï¼Œéƒ¨ä»½æ›´æ”¹ç”¨æ¡¦æœ¨åˆ¶çš„æŠ¤æœ¨ï¼Œå…¶ä¸­é€äº¤è‹±å›½çš„å›½åœŸé˜²å«å†›ï¼ˆBritish Home Guardï¼‰çš„M1917å°æœ‰çº¢è‰²è®°å·ä»¥é¿å…å£«å…µè£…ä¸ŠP14çš„å¼¹è¯ã€‚ ç»“æ„è®¾è®¡M1917ä¸æ-æ©è²å°”å¾·åŒç”±ä½äºè‹±å›½æ©è²å°”å¾·çš„è‹±å›½çš‡å®¶è½»å…µå™¨å·¥å‚ç”Ÿäº§ï¼Œä½†æ-æ©è²å°”å¾·ï¼ˆå¦‚SMLEï¼‰é‡‡ç”¨.303 Britishå£ä¿“å¼¹è¯ï¼Œè€ŒM1917é‡‡ç”¨æ¯›ç‘Ÿ98æªæœºåŠç¾å›½çš„.30-06å¼¹è¯ï¼Œç”±äº.30-06å¼¹è¯çš„ç›´å¾„è¾ƒç»†ï¼Œå› æ­¤å†…ç½®å¼¹ä»“å¯æ”¾6å‘å­å¼¹ï¼Œä½†å¼¹å¤¹ä»ç„¶åªæœ‰5å‘ã€‚ç”±äºä¸¤æˆ˜ä¹‹é—´å‚¨å¤‡è¿‡å‰©ï¼Œæœ‰äº›æªåŒ ä»¥M1917çš„æªæœºè£…ä¸Šé›·æ˜ç™»M30ç³»åˆ—ä¸Šä½œè¿åŠ¨æ­¥æªå‘å”®ï¼Œçº¦3000æŠŠ7æ¯«ç±³å£å¾„çš„M1917åœ¨1930å¹´å–ç»™æ´ªéƒ½æ‹‰æ–¯ã€‚ 1.59-inch Breech-Loading Vickers Q.F. Gun, Mk II1.59-inch Breech-Loading Vickers Q.F. Gun, Mk IIæ˜¯è‹±å›½è®¾è®¡åœ¨ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜çš„è½»ç«ç‚®ï¼ˆè¶…é‡å‹ç‹™å‡»æªï¼‰ã€‚æœ€åˆçš„ç›®çš„æ˜¯ç”¨äºå ‘å£•æˆ˜ï¼Œè€Œæ˜¯å¯¹é£æœºçš„ç©ºå¯¹ç©ºå’Œç©ºå¯¹åœ°ä½¿ç”¨è¿›è¡Œäº†æµ‹è¯•ã€‚è™½ç„¶å®ƒå‘å°„ç‚®å¼¹å¹¶ä¸”æ— æ³•å‘å°„ç«ç®­å¼¹ï¼Œä½†å®ƒè¢«å¹¿æ³›ä½†è¯¯å¯¼åœ°ç§°ä¸ºâ€œ ç»´å…‹æ–¯ - å…‹é›·ç¦å¾·ç«ç®­ç‚® â€ã€‚ ï¼ˆæ¸¸æˆä¸­æœªå‡ºç°ï¼Œæ— å›¾ï¼‰ Mauser 1918 T-Gewehræ¯›ç‘Ÿ13æ¯«ç±³åå¦å…‹æ­¥æªï¼ˆå¾·è¯­ï¼šTankgewehr M1918ï¼Œé€šå¸¸ç®€å†™T-Gewehr M1918ï¼‰æ˜¯ä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªåå¦å…‹æ­¥æªï¼Œå®ƒè®¾è®¡ç”¨äºç ´åè£…ç”²ç›®æ ‡ã€‚ç”Ÿäº§äº†å¤§çº¦15,800ä¸ªã€‚ M1918å’ŒçœŸäººæ¯”ä½ å°±ä¼šå‘ç°å®ƒéå¸¸éå¸¸å¤§ï¼ è¿™æŠŠæ¥è‡ªé»‘ç§‘æŠ€åˆé›†ä½“ç¬¬äºŒå¸å›½çš„T-Gewehr M1918 åå¦å…‹æ­¥æªå½“æ—¶è®©è‹±å†›å¦å…‹éƒ¨é˜Ÿèº²åœ¨è§’è½ç‘Ÿç‘Ÿå‘æŠ–ï¼Œåœ¨æ¡ä»¶å…è®¸çš„æƒ…å†µä¸‹ç”šè‡³å¯ä»¥è½»æ¾ç©¿é€100må¤–çš„MK-IVå¦å…‹çš„é˜²æŠ¤è£…ç”²ï¼ŒåŒæ—¶è¿™æŠŠæ­¦å™¨åªæ˜¯æ¯”æ™®é€šçš„æ¯›ç‘Ÿæ­¥æªç¨å¾®å¤§ä¸€ç‚¹ï¼Œæ‰€ä»¥ä¸€ä¸ªäººä¹Ÿå¯ä»¥æ‹¿ç€åˆ°å¤„èµ°ï¼Œåªæ˜¯æ¯”å…¶ä»–äººä¼šç¼“æ…¢ä¸€äº›ã€‚ å†å²åœ¨ç¬¬ä¸€æ¬¡ä¸–ç•Œå¤§æˆ˜æœŸé—´ï¼Œé™æ€å ‘å£•æˆ˜çš„å¼€å§‹å‡ºç°äº†ä½¿ç”¨è£…ç”²æ¿è¿›è¡Œäººèº«é˜²å¾¡çš„å…´èµ·ï¼Œä»¥åŠå¼€å‘å’Œä½¿ç”¨ç©¿ç”²å¼¹è¯æ¥å¯¹æŠ—è¿™ç§æƒ…å†µã€‚ä¸ºæ­¤ï¼Œè‹±å›½å’Œå¾·å›½éƒ½ä½¿ç”¨é«˜èƒ½æ­¥æªï¼Œä¾‹å¦‚æ¥è‡ªéæ´²æ®–æ°‘åœ°çš„å¤§è±¡æªã€‚è‹±å›½äººåœ¨1916å¹´9æœˆçš„Flers-Courceletteæˆ˜å½¹ä¸­é¦–æ¬¡ä½¿ç”¨è£…ç”²æˆ˜è½¦ï¼ˆå¦å…‹ï¼‰ï¼Œéšåæ˜¯æ³•å›½äººã€‚åˆ°1917å¹´6æœˆï¼Œå¾·å›½é™†å†›é¢å¯¹é©¬å…‹å››ä¸–å¦å…‹ï¼Œå‘ç°æ ‡å‡†ç©¿ç”²7.92æ¯«ç±³Kå­å¼¹ä¸å†æœ‰æ•ˆã€‚è¿™ä¿ƒä½¿å¾·å›½äººå¼€å‘å‡ºä¸€ç§å¤§å£å¾„å’Œé«˜é€Ÿæ­¥æªä½œä¸ºåå¦å…‹æ­¦å™¨ã€‚è¯¥æ¯›ç‘Ÿå…¬å¸å›åº”ä¸13æ¯«ç±³T-æ ¼éŸ¦å°”å¹¶å¼€å§‹æ‰¹é‡ç”Ÿäº§çš„å†…å¡æ²³ç•”å¥¥ä¼¯æ©å¤šå¤«äº1918å¹´äº”æœˆå…³é—­è¿›è¡Œé¢å‘çš„ç”Ÿäº§çº¿ä¸“é—¨æå‡ºåå¦å…‹åˆ†é˜Ÿçš„ç¬¬ä¸€é¡¹ã€‚ æ“ä½œè¯¥æ­¥æªæ˜¯ä¸€ç§å•å‘èºæ “åŠ¨ä½œæ­¥æªï¼Œä½¿ç”¨æ”¹è¿›çš„æ¯›ç‘ŸåŠ¨ä½œï¼Œæ‰‹åŠ¨å°†åœ†å½¢ç‰©è£…å…¥è…”å®¤ã€‚æ­¦å™¨æœ‰ä¸€ä¸ªæ‰‹æªå¼æ¡æŠŠå’Œä¸¤è„šæ¶ï¼Œä½†æ²¡æœ‰å‡å°‘åååŠ›çš„æ–¹æ³•ï¼Œä¾‹å¦‚æŸ”è½¯çš„è‡€éƒ¨æˆ–æªå£åˆ¶åŠ¨å™¨ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´é‡å¤å°„å‡»å°„æ‰‹çš„é—®é¢˜ã€‚åœ¨é“çš„æ™¯ç‚¹æ˜¯ç”±å‰ç‰‡å’Œååˆ‡çº¿çš„ï¼Œåœ¨100ç±³çš„å¢é‡ä»100ç±³åˆ°500ç±³æ¯•ä¸šã€‚è¿™æ”¯æ­¥æªç”±ä¸¤åæŒæªæ‰‹å’Œå¼¹è¯çš„æœºç»„äººå‘˜æ“ä½œæŒç¥¨äººï¼Œä»–ä»¬éƒ½å—è¿‡è®­ç»ƒï¼Œå¯ä»¥å¼€ç«ã€‚ç”±äºåå†²çš„å·¨å¤§é’åŠ›ï¼Œå®ƒè¢«è®¾è®¡æˆåœ¨é™æ­¢ä½ç½®æ‹æ‘„ï¼Œæ— è®ºæ˜¯ä¿¯å§è¿˜æ˜¯ä»æ²Ÿå†…ã€‚ å‚è€ƒèµ„æ–™Winchester 1895 (Russian) Gewehr M.95 å¡å°”å¡è¯º 1.59-inch Breech-Loading Vickers Q.F. Gun, Mk II Mauser 1918 T-Gewehr ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢]]></content>
      <tags>
        <tag>å†›äº‹</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[python-å¸¸ç”¨æ¨¡å—]]></title>
    <url>%2F2018%2F08%2F19%2Fpython-%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨å­¦ä¹ pythonå…¨æ ˆç›¸å…³çš„å†…å®¹ï¼Œéƒ¨åˆ†çŸ¥è¯†ç‚¹ç€å®éœ€è¦è®°å¿†ï¼Œç´¢æ€§å†™ä¸ªblogè®°å½•ä¸€ä¸‹ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ ä»€ä¹ˆæ˜¯æ¨¡å—ä¸€ä¸ªæ¨¡å—å°±æ˜¯ä¸€ä¸ªåŒ…å«äº†pythonå®šä¹‰å’Œå£°æ˜çš„æ–‡ä»¶ï¼Œæ–‡ä»¶åå°±æ˜¯æ¨¡å—åå­—åŠ ä¸Š.pyçš„åç¼€ã€‚ å¸¸ç”¨æ¨¡å—collectionsæ¨¡å—åœ¨å†…ç½®æ•°æ®ç±»å‹ï¼ˆdictã€listã€setã€tupleï¼‰çš„åŸºç¡€ä¸Šï¼Œcollectionsæ¨¡å—è¿˜æä¾›äº†å‡ ä¸ªé¢å¤–çš„æ•°æ®ç±»å‹ï¼šCounterã€dequeã€defaultdictã€namedtupleå’ŒOrderedDictç­‰ã€‚ namedtupleç”Ÿæˆå¯ä»¥ä½¿ç”¨åå­—æ¥è®¿é—®å…ƒç´ å†…å®¹çš„tuple ä½¿ç”¨è¿™ä¸ªå¯ä»¥å¾ˆæ–¹ä¾¿çš„è¡¨ç¤ºä¸€ä¸ªç‚¹çš„äºŒç»´åæ ‡ 12345from collections import namedtuplePoint = namedtuple('Point',['x','y']) #namedtuple('åç§°', [å±æ€§list])p = Point(1,2)print(p.x)print(p.y) deque:dequeæ˜¯ä¸ºäº†é«˜æ•ˆå®ç°æ’å…¥å’Œåˆ é™¤æ“ä½œçš„åŒå‘åˆ—è¡¨ï¼Œé€‚åˆç”¨äºé˜Ÿåˆ—å’Œæ ˆ å®ƒå¯ä»¥å®ç°æ·»åŠ æ“ä½œappend() å’Œåˆ é™¤æ“ä½œpop()ï¼Œå¾€å¤´éƒ¨æ·»åŠ æ“ä½œappendleft()å¾€å¤´éƒ¨åˆ é™¤popleft() CounterCounterç±»çš„ç›®çš„æ˜¯ç”¨æ¥è·Ÿè¸ªå€¼å‡ºç°çš„æ¬¡æ•°ã€‚ å®ƒæ˜¯ä¸€ä¸ªæ— åºçš„å®¹å™¨ç±»å‹ï¼Œä»¥å­—å…¸çš„é”®å€¼å¯¹å½¢å¼å­˜å‚¨ï¼Œå…¶ä¸­å…ƒç´ ä½œä¸ºkeyï¼Œå…¶è®¡æ•°ä½œä¸ºvalueã€‚è®¡æ•°å€¼å¯ä»¥æ˜¯ä»»æ„çš„Intergerï¼ˆåŒ…æ‹¬0å’Œè´Ÿæ•°ï¼‰ã€‚ 12345from collections import Counter# åˆ›å»ºc = Counter(&#123;1:'p',2:'y'&#125;)# è®¿é—® å½“æ‰€è®¿é—®çš„é”®ä¸å­˜åœ¨æ—¶ï¼Œè¿”å›0ï¼Œè€Œä¸æ˜¯KeyErrorï¼›å¦åˆ™è¿”å›å®ƒçš„è®¡æ•°ã€‚c[1] # p OrderedDictæœ‰åºå­—å…¸ defaultdictå¸¦æœ‰é»˜è®¤å€¼çš„å­—å…¸ æœ‰å¦‚ä¸‹å€¼é›†åˆ [11,22,33,44,55,66,77,88,99,90â€¦]ï¼Œå°†æ‰€æœ‰å¤§äº 66 çš„å€¼ä¿å­˜è‡³å­—å…¸çš„ç¬¬ä¸€ä¸ªkeyä¸­ï¼Œå°†å°äº 66 çš„å€¼ä¿å­˜è‡³ç¬¬äºŒä¸ªkeyçš„å€¼ä¸­ã€‚ 12345678from collections import defaultdictvalues = [11, 22, 33,44,55,66,77,88,99,90]defaultdict = defaultdict(list)for value in values: if value &gt; 66: defaultdict['k1'].append(value) else: defaultdict['k2'].append(value) timeæ¨¡å—åœ¨Pythonä¸­ï¼Œé€šå¸¸æœ‰è¿™ä¸‰ç§æ–¹å¼æ¥è¡¨ç¤ºæ—¶é—´ï¼šæ—¶é—´æˆ³ã€å…ƒç»„(struct_time)ã€æ ¼å¼åŒ–çš„æ—¶é—´å­—ç¬¦ä¸²ï¼š (1)æ—¶é—´æˆ³(timestamp) ï¼šé€šå¸¸æ¥è¯´ï¼Œæ—¶é—´æˆ³è¡¨ç¤ºçš„æ˜¯ä»1970å¹´1æœˆ1æ—¥00:00:00å¼€å§‹æŒ‰ç§’è®¡ç®—çš„åç§»é‡ã€‚æˆ‘ä»¬è¿è¡Œâ€œtype(time.time())â€ï¼Œè¿”å›çš„æ˜¯floatç±»å‹ã€‚ (2)æ ¼å¼åŒ–çš„æ—¶é—´å­—ç¬¦ä¸²(Format String)ï¼š â€˜1999-12-06â€™ pythonä¸­æ—¶é—´æ—¥æœŸæ ¼å¼åŒ–ç¬¦å·ï¼š %y ä¸¤ä½æ•°çš„å¹´ä»½è¡¨ç¤ºï¼ˆ00-99ï¼‰%Y å››ä½æ•°çš„å¹´ä»½è¡¨ç¤ºï¼ˆ000-9999ï¼‰%m æœˆä»½ï¼ˆ01-12ï¼‰%d æœˆå†…ä¸­çš„ä¸€å¤©ï¼ˆ0-31ï¼‰%H 24å°æ—¶åˆ¶å°æ—¶æ•°ï¼ˆ0-23ï¼‰%I 12å°æ—¶åˆ¶å°æ—¶æ•°ï¼ˆ01-12ï¼‰%M åˆ†é’Ÿæ•°ï¼ˆ00=59ï¼‰%S ç§’ï¼ˆ00-59ï¼‰%a æœ¬åœ°ç®€åŒ–æ˜ŸæœŸåç§°%A æœ¬åœ°å®Œæ•´æ˜ŸæœŸåç§°%b æœ¬åœ°ç®€åŒ–çš„æœˆä»½åç§°%B æœ¬åœ°å®Œæ•´çš„æœˆä»½åç§°%c æœ¬åœ°ç›¸åº”çš„æ—¥æœŸè¡¨ç¤ºå’Œæ—¶é—´è¡¨ç¤º%j å¹´å†…çš„ä¸€å¤©ï¼ˆ001-366ï¼‰%p æœ¬åœ°A.M.æˆ–P.M.çš„ç­‰ä»·ç¬¦%U ä¸€å¹´ä¸­çš„æ˜ŸæœŸæ•°ï¼ˆ00-53ï¼‰æ˜ŸæœŸå¤©ä¸ºæ˜ŸæœŸçš„å¼€å§‹%w æ˜ŸæœŸï¼ˆ0-6ï¼‰ï¼Œæ˜ŸæœŸå¤©ä¸ºæ˜ŸæœŸçš„å¼€å§‹%W ä¸€å¹´ä¸­çš„æ˜ŸæœŸæ•°ï¼ˆ00-53ï¼‰æ˜ŸæœŸä¸€ä¸ºæ˜ŸæœŸçš„å¼€å§‹%x æœ¬åœ°ç›¸åº”çš„æ—¥æœŸè¡¨ç¤º%X æœ¬åœ°ç›¸åº”çš„æ—¶é—´è¡¨ç¤º%Z å½“å‰æ—¶åŒºçš„åç§°%% %å·æœ¬èº« (3)å…ƒç»„(struct_time) ï¼šstruct_timeå…ƒç»„å…±æœ‰9ä¸ªå…ƒç´ å…±ä¹ä¸ªå…ƒç´ :(å¹´ï¼Œæœˆï¼Œæ—¥ï¼Œæ—¶ï¼Œåˆ†ï¼Œç§’ï¼Œä¸€å¹´ä¸­ç¬¬å‡ å‘¨ï¼Œä¸€å¹´ä¸­ç¬¬å‡ å¤©ç­‰ï¼‰ ç´¢å¼•ï¼ˆIndexï¼‰ å±æ€§ï¼ˆAttributeï¼‰ å€¼ï¼ˆValuesï¼‰ 0 tm_yearï¼ˆå¹´ï¼‰ æ¯”å¦‚2011 1 tm_monï¼ˆæœˆï¼‰ 1 - 12 2 tm_mdayï¼ˆæ—¥ï¼‰ 1 - 31 3 tm_hourï¼ˆæ—¶ï¼‰ 0 - 23 4 tm_minï¼ˆåˆ†ï¼‰ 0 - 59 5 tm_secï¼ˆç§’ï¼‰ 0 - 60 6 tm_wdayï¼ˆweekdayï¼‰ 0 - 6ï¼ˆ0è¡¨ç¤ºå‘¨ä¸€ï¼‰ 7 tm_ydayï¼ˆä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©ï¼‰ 1 - 366 8 tm_isdstï¼ˆæ˜¯å¦æ˜¯å¤ä»¤æ—¶ï¼‰ é»˜è®¤ä¸º0 12345678910111213#å¯¼å…¥æ—¶é—´æ¨¡å—import time# (çº¿ç¨‹)æ¨è¿ŸæŒ‡å®šçš„æ—¶é—´è¿è¡Œã€‚å•ä½ä¸ºç§’ã€‚secs = 0.1time.sleep(secs)# æ—¶é—´æˆ³time.time()# æ—¶é—´å­—ç¬¦ä¸²time.strftime("%Y-%m-%d %X")&gt;&gt;&gt;time.strftime("%Y-%m-%d %H-%M-%S")# æ—¶é—´å…ƒç»„:localtimeå°†ä¸€ä¸ªæ—¶é—´æˆ³è½¬æ¢ä¸ºå½“å‰æ—¶åŒºçš„struct_timetime.localtime()time.struct_time(tm_year=2018, tm_mon=8, tm_mday=19,tm_hour=13, tm_min=59, tm_sec=37,tm_wday=0, tm_yday=205, tm_isdst=0) randomæ¨¡å—å¸¸ç”¨æ–¹æ³• 12345678910111213141516171819202122232425262728&gt;&gt;&gt; import random#éšæœºå°æ•°&gt;&gt;&gt; random.random() # å¤§äº0ä¸”å°äº1ä¹‹é—´çš„å°æ•°0.7664338663654585&gt;&gt;&gt; random.uniform(1,3) #å¤§äº1å°äº3çš„å°æ•°1.6270147180533838#éšæœºæ•´æ•°&gt;&gt;&gt; random.randint(1,5) # å¤§äºç­‰äº1ä¸”å°äºç­‰äº5ä¹‹é—´çš„æ•´æ•°&gt;&gt;&gt; random.randrange(1,10,2) # å¤§äºç­‰äº1ä¸”å°äº10ä¹‹é—´çš„å¥‡æ•°#éšæœºé€‰æ‹©ä¸€ä¸ªè¿”å›&gt;&gt;&gt; random.choice([1,'23',[4,5]]) # #1æˆ–è€…23æˆ–è€…[4,5]#éšæœºé€‰æ‹©å¤šä¸ªè¿”å›ï¼Œè¿”å›çš„ä¸ªæ•°ä¸ºå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°&gt;&gt;&gt; random.sample([1,'23',[4,5]],2) # #åˆ—è¡¨å…ƒç´ ä»»æ„2ä¸ªç»„åˆ[[4, 5], '23']#æ‰“ä¹±åˆ—è¡¨é¡ºåº&gt;&gt;&gt; item=[1,3,5,7,9]&gt;&gt;&gt; random.shuffle(item) # æ‰“ä¹±æ¬¡åº&gt;&gt;&gt; item[5, 1, 3, 7, 9]&gt;&gt;&gt; random.shuffle(item)&gt;&gt;&gt; item[5, 9, 7, 1, 3] ä¸€ä¸ªç®€å•çš„ç”ŸæˆéªŒè¯ç åŠŸèƒ½ 12345678910import random# éšæœºç”Ÿæˆ6ä½éªŒè¯ç def Identifying_code(): code = '' for i in range(6): num=random.randint(0,9) # å¤§äºç­‰äº0ä¸”å°äºç­‰äº9ä¹‹é—´çš„æ•´æ•° alf=chr(random.randint(65,90)) # éšæœºå¤§å†™å­—æ¯ï¼Œæ•°å­—å¯¹åº”é˜¿æ–¯å…‹ç  add=random.choice([num,alf]) #éšæœºé€‰æ‹©ä¸€ä¸ªè¿”å› code="".join([code,str(add)]) return code osæ¨¡å—å¸¸ç”¨å’Œä¸å¸¸ç”¨çš„æ–¹æ³•os.getcwd()è·å–å½“å‰å·¥ä½œç›®å½•ï¼Œå³å½“å‰pythonè„šæœ¬å·¥ä½œçš„ç›®å½•è·¯å¾„os.chdir(&quot;dirname&quot;) æ”¹å˜å½“å‰è„šæœ¬å·¥ä½œç›®å½•ï¼›ç›¸å½“äºshellä¸‹cdos.curdirè¿”å›å½“å‰ç›®å½•: (â€˜.â€™)os.pardir è·å–å½“å‰ç›®å½•çš„çˆ¶ç›®å½•å­—ç¬¦ä¸²åï¼š(â€˜..â€™)os.makedirs(&#39;dirname1/dirname2&#39;)å¯ç”Ÿæˆå¤šå±‚é€’å½’ç›®å½•os.removedirs(&#39;dirname1&#39;) è‹¥ç›®å½•ä¸ºç©ºï¼Œåˆ™åˆ é™¤ï¼Œå¹¶é€’å½’åˆ°ä¸Šä¸€çº§ç›®å½•ï¼Œå¦‚è‹¥ä¹Ÿä¸ºç©ºï¼Œåˆ™åˆ é™¤ï¼Œä¾æ­¤ç±»æ¨os.mkdir(&#39;dirname&#39;) ç”Ÿæˆå•çº§ç›®å½•ï¼›ç›¸å½“äºshellä¸­mkdir dirnameos.rmdir(&#39;dirname&#39;) åˆ é™¤å•çº§ç©ºç›®å½•ï¼Œè‹¥ç›®å½•ä¸ä¸ºç©ºåˆ™æ— æ³•åˆ é™¤ï¼ŒæŠ¥é”™ï¼›ç›¸å½“äºshellä¸­rmdir dirnameos.listdir(&#39;dirname&#39;) åˆ—å‡ºæŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ï¼ŒåŒ…æ‹¬éšè—æ–‡ä»¶ï¼Œå¹¶ä»¥åˆ—è¡¨æ–¹å¼æ‰“å°os.remove() åˆ é™¤ä¸€ä¸ªæ–‡ä»¶os.rename(&quot;oldname&quot;,&quot;newname&quot;)é‡å‘½åæ–‡ä»¶/ç›®å½•os.stat(&#39;path/filename&#39;) è·å–æ–‡ä»¶/ç›®å½•ä¿¡æ¯os.sep è¾“å‡ºæ“ä½œç³»ç»Ÿç‰¹å®šçš„è·¯å¾„åˆ†éš”ç¬¦ï¼Œwinä¸‹ä¸ºâ€\â€œ,Linuxä¸‹ä¸ºâ€/â€œos.linesep è¾“å‡ºå½“å‰å¹³å°ä½¿ç”¨çš„è¡Œç»ˆæ­¢ç¬¦ï¼Œwinä¸‹ä¸ºâ€\t\nâ€,Linuxä¸‹ä¸ºâ€\nâ€os.pathsep è¾“å‡ºç”¨äºåˆ†å‰²æ–‡ä»¶è·¯å¾„çš„å­—ç¬¦ä¸² winä¸‹ä¸º;,Linuxä¸‹ä¸º:os.name è¾“å‡ºå­—ç¬¦ä¸²æŒ‡ç¤ºå½“å‰ä½¿ç”¨å¹³å°ã€‚win-&gt;â€™ntâ€™; Linux-&gt;â€™posixâ€™os.system(&quot;bash command&quot;) è¿è¡Œshellå‘½ä»¤ï¼Œç›´æ¥æ˜¾ç¤ºos.popen(&quot;bash command).read() è¿è¡Œshellå‘½ä»¤ï¼Œè·å–æ‰§è¡Œç»“æœos.environ è·å–ç³»ç»Ÿç¯å¢ƒå˜é‡ os.pathos.path.abspath(path) è¿”å›pathè§„èŒƒåŒ–çš„ç»å¯¹è·¯å¾„ os.path.split(path) å°†pathåˆ†å‰²æˆç›®å½•å’Œæ–‡ä»¶åäºŒå…ƒç»„è¿”å› os.path.dirname(path)è¿”å›pathçš„ç›®å½•ã€‚å…¶å®å°±æ˜¯os.path.split(path)çš„ç¬¬ä¸€ä¸ªå…ƒç´  os.path.basename(path) è¿”å›pathæœ€åçš„æ–‡ä»¶åã€‚å¦‚ä½•pathä»¥/æˆ–\ç»“å°¾ï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›ç©ºå€¼ã€‚å³os.path.split(path)çš„ç¬¬äºŒä¸ªå…ƒç´ os.path.exists(path) å¦‚æœpathå­˜åœ¨ï¼Œè¿”å›Trueï¼›å¦‚æœpathä¸å­˜åœ¨ï¼Œè¿”å›Falseos.path.isabs(path) å¦‚æœpathæ˜¯ç»å¯¹è·¯å¾„ï¼Œè¿”å›Trueos.path.isfile(path) å¦‚æœpathæ˜¯ä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶ï¼Œè¿”å›Trueã€‚å¦åˆ™è¿”å›Falseos.path.isdir(path) å¦‚æœpathæ˜¯ä¸€ä¸ªå­˜åœ¨çš„ç›®å½•ï¼Œåˆ™è¿”å›Trueã€‚å¦åˆ™è¿”å›Falseos.path.join(path1[, path2[, ...]]) å°†å¤šä¸ªè·¯å¾„ç»„åˆåè¿”å›ï¼Œç¬¬ä¸€ä¸ªç»å¯¹è·¯å¾„ä¹‹å‰çš„å‚æ•°å°†è¢«å¿½ç•¥os.path.getatime(path) è¿”å›pathæ‰€æŒ‡å‘çš„æ–‡ä»¶æˆ–è€…ç›®å½•çš„æœ€åè®¿é—®æ—¶é—´os.path.getmtime(path) è¿”å›pathæ‰€æŒ‡å‘çš„æ–‡ä»¶æˆ–è€…ç›®å½•çš„æœ€åä¿®æ”¹æ—¶é—´os.path.getsize(path) è¿”å›pathçš„å¤§å° sysæ¨¡å—sysæ¨¡å—æ˜¯ä¸pythonè§£é‡Šå™¨äº¤äº’çš„ä¸€ä¸ªæ¥å£ æ–¹æ³• sys.argv å‘½ä»¤è¡Œå‚æ•°Listï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ç¨‹åºæœ¬èº«è·¯å¾„ sys.exit(n) é€€å‡ºç¨‹åºï¼Œæ­£å¸¸é€€å‡ºæ—¶exit(0),é”™è¯¯é€€å‡ºsys.exit(1) sys.version è·å–Pythonè§£é‡Šç¨‹åºçš„ç‰ˆæœ¬ä¿¡æ¯ sys.path è¿”å›æ¨¡å—çš„æœç´¢è·¯å¾„ï¼Œåˆå§‹åŒ–æ—¶ä½¿ç”¨PYTHONPATHç¯å¢ƒå˜é‡çš„å€¼ sys.platform è¿”å›æ“ä½œç³»ç»Ÿå¹³å°åç§° åºåˆ—åŒ–æ¨¡å—ç”¨äºåºåˆ—åŒ–çš„ä¸¤ä¸ªæ¨¡å— jsonï¼Œç”¨äºå­—ç¬¦ä¸² å’Œ pythonæ•°æ®ç±»å‹é—´è¿›è¡Œè½¬æ¢ pickleï¼Œç”¨äºpythonç‰¹æœ‰çš„ç±»å‹ å’Œ pythonçš„æ•°æ®ç±»å‹é—´è¿›è¡Œè½¬æ¢ Jsonloadså’Œdumps 12345678910111213141516import jsondic = &#123;'k1':'v1','k2':'v2','k3':'v3'&#125;str_dic = json.dumps(dic) #åºåˆ—åŒ–ï¼šå°†ä¸€ä¸ªå­—å…¸è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²print(type(str_dic),str_dic) #&lt;class 'str'&gt; &#123;"k3": "v3", "k1": "v1", "k2": "v2"&#125;#æ³¨æ„ï¼Œjsonè½¬æ¢å®Œçš„å­—ç¬¦ä¸²ç±»å‹çš„å­—å…¸ä¸­çš„å­—ç¬¦ä¸²æ˜¯ç”±""è¡¨ç¤ºçš„dic2 = json.loads(str_dic) #ååºåˆ—åŒ–ï¼šå°†ä¸€ä¸ªå­—ç¬¦ä¸²æ ¼å¼çš„å­—å…¸è½¬æ¢æˆä¸€ä¸ªå­—å…¸#æ³¨æ„ï¼Œè¦ç”¨jsonçš„loadsåŠŸèƒ½å¤„ç†çš„å­—ç¬¦ä¸²ç±»å‹çš„å­—å…¸ä¸­çš„å­—ç¬¦ä¸²å¿…é¡»ç”±""è¡¨ç¤ºprint(type(dic2),dic2) #&lt;class 'dict'&gt; &#123;'k1': 'v1', 'k2': 'v2', 'k3': 'v3'&#125;list_dic = [1,['a','b','c'],3,&#123;'k1':'v1','k2':'v2'&#125;]str_dic = json.dumps(list_dic) #ä¹Ÿå¯ä»¥å¤„ç†åµŒå¥—çš„æ•°æ®ç±»å‹ print(type(str_dic),str_dic) #&lt;class 'str'&gt; [1, ["a", "b", "c"], 3, &#123;"k1": "v1", "k2": "v2"&#125;]list_dic2 = json.loads(str_dic)print(type(list_dic2),list_dic2) #&lt;class 'list'&gt; [1, ['a', 'b', 'c'], 3, &#123;'k1': 'v1', 'k2': 'v2'&#125;] loadå’Œdump 12345678910import jsonf = open('json_file','w')dic = &#123;'k1':'v1','k2':'v2','k3':'v3'&#125;json.dump(dic,f) #dumpæ–¹æ³•æ¥æ”¶ä¸€ä¸ªæ–‡ä»¶å¥æŸ„ï¼Œç›´æ¥å°†å­—å…¸è½¬æ¢æˆjsonå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶f.close()f = open('json_file')dic2 = json.load(f) #loadæ–¹æ³•æ¥æ”¶ä¸€ä¸ªæ–‡ä»¶å¥æŸ„ï¼Œç›´æ¥å°†æ–‡ä»¶ä¸­çš„jsonå­—ç¬¦ä¸²è½¬æ¢æˆæ•°æ®ç»“æ„è¿”å›f.close()print(type(dic2),dic2) shelveshelveä¹Ÿæ˜¯pythonæä¾›ç»™æˆ‘ä»¬çš„åºåˆ—åŒ–å·¥å…·ï¼Œæ¯”pickleç”¨èµ·æ¥æ›´ç®€å•ä¸€äº›ã€‚ shelveåªæä¾›ç»™æˆ‘ä»¬ä¸€ä¸ªopenæ–¹æ³•ï¼Œæ˜¯ç”¨keyæ¥è®¿é—®çš„ï¼Œä½¿ç”¨èµ·æ¥å’Œå­—å…¸ç±»ä¼¼ã€‚ reæ¨¡å—123456789101112131415161718192021222324252627282930313233import reret = re.findall('s', 'sadsadsa ssadsadsa sdadsadasd') # è¿”å›æ‰€æœ‰æ»¡è¶³åŒ¹é…æ¡ä»¶çš„ç»“æœ,æ”¾åœ¨åˆ—è¡¨é‡Œprint(ret) #ç»“æœ : ['s', 's', 's', 's', 's', 's', 's', 's', 's', 's']ret = re.search('s', 'sadsadsa ssadsadsa sdadsadasd').group()print(ret) # ç»“æœ : s# å‡½æ•°ä¼šåœ¨å­—ç¬¦ä¸²å†…æŸ¥æ‰¾æ¨¡å¼åŒ¹é…,åªåˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…ç„¶åè¿”å›ä¸€ä¸ªåŒ…å«åŒ¹é…ä¿¡æ¯çš„å¯¹è±¡,è¯¥å¯¹è±¡å¯ä»¥# é€šè¿‡è°ƒç”¨group()æ–¹æ³•å¾—åˆ°åŒ¹é…çš„å­—ç¬¦ä¸²,å¦‚æœå­—ç¬¦ä¸²æ²¡æœ‰åŒ¹é…ï¼Œåˆ™è¿”å›Noneã€‚ret = re.match('a', 'abc').group() # åŒsearch,ä¸è¿‡å°½åœ¨å­—ç¬¦ä¸²å¼€å§‹å¤„è¿›è¡ŒåŒ¹é…print(ret)#ç»“æœ : 'a'ret = re.split('[ab]', 'abcd') # å…ˆæŒ‰'a'åˆ†å‰²å¾—åˆ°''å’Œ'bcd',åœ¨å¯¹''å’Œ'bcd'åˆ†åˆ«æŒ‰'b'åˆ†å‰²print(ret) # ['', '', 'cd']ret = re.sub('\d', 'H', 'teng she 789', 1)#å°†æ•°å­—æ›¿æ¢æˆ'H'ï¼Œå‚æ•°1è¡¨ç¤ºåªæ›¿æ¢1ä¸ªprint(ret) # teng she H89ret = re.subn('\d', 'H', 'teng she 789')#å°†æ•°å­—æ›¿æ¢æˆ'H'ï¼Œè¿”å›å…ƒç»„(æ›¿æ¢çš„ç»“æœ,æ›¿æ¢äº†å¤šå°‘æ¬¡)print(ret) #('teng she HHH', 3)obj = re.compile('\d&#123;3&#125;') #å°†æ­£åˆ™è¡¨è¾¾å¼ç¼–è¯‘æˆä¸ºä¸€ä¸ª æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ï¼Œè§„åˆ™è¦åŒ¹é…çš„æ˜¯3ä¸ªæ•°å­—ret = obj.search('abc123eeee') #æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡è°ƒç”¨searchï¼Œå‚æ•°ä¸ºå¾…åŒ¹é…çš„å­—ç¬¦ä¸²print(ret.group()) #ç»“æœ ï¼š 123import reret = re.finditer('\d', 'ds3sy4784a') #finditerè¿”å›ä¸€ä¸ªå­˜æ”¾åŒ¹é…ç»“æœçš„è¿­ä»£å™¨print(ret) # &lt;callable_iterator object at 0x000001B84AADC7F0&gt;print(next(ret).group()) #æŸ¥çœ‹ç¬¬ä¸€ä¸ªç»“æœ 3print(next(ret).group()) #æŸ¥çœ‹ç¬¬äºŒä¸ªç»“æœ 4print([i.group() for i in ret]) #æŸ¥çœ‹å‰©ä½™çš„å·¦å³ç»“æœ ['7', '8', '4'] hashlibæ¨¡å—Pythonçš„hashlibæä¾›äº†å¸¸è§çš„hashç®—æ³• æˆ‘ä»¬ä»¥å¸¸è§çš„æ‘˜è¦ç®—æ³•MD5ä¸ºä¾‹ï¼Œè®¡ç®—å‡ºä¸€ä¸ªå­—ç¬¦ä¸²çš„MD5å€¼ï¼š 1234import hashlibmd5 = hashlib.md5()md5.update('how to use md5 in python hashlib?'.encode("gb2312"))print(md5.hexdigest()) è®¡ç®—ç»“æœå¦‚ä¸‹ï¼šd26a53750bc40b38b65a520292f69306 configparseræ¨¡å—è¯¥æ¨¡å—é€‚ç”¨äºé…ç½®æ–‡ä»¶çš„æ ¼å¼ä¸windows iniæ–‡ä»¶ç±»ä¼¼ï¼Œå¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ï¼ˆsectionï¼‰ï¼Œæ¯ä¸ªèŠ‚å¯ä»¥æœ‰å¤šä¸ªå‚æ•°ï¼ˆé”®=å€¼ï¼‰ã€‚ loggingæ¨¡å—é»˜è®¤æƒ…å†µä¸‹Pythonçš„loggingæ¨¡å—å°†æ—¥å¿—æ‰“å°åˆ°äº†æ ‡å‡†è¾“å‡ºä¸­ï¼Œä¸”åªæ˜¾ç¤ºäº†å¤§äºç­‰äºWARNINGçº§åˆ«çš„æ—¥å¿—ï¼Œè¿™è¯´æ˜é»˜è®¤çš„æ—¥å¿—çº§åˆ«è®¾ç½®ä¸ºWARNINGï¼ˆæ—¥å¿—çº§åˆ«ç­‰çº§CRITICAL &gt; ERROR &gt; WARNING &gt; INFO &gt; DEBUGï¼‰ï¼Œé»˜è®¤çš„æ—¥å¿—æ ¼å¼ä¸ºæ—¥å¿—çº§åˆ«ï¼šLoggeråç§°ï¼šç”¨æˆ·è¾“å‡ºæ¶ˆæ¯ã€‚ 123456import logging logging.debug('debug message') logging.info('info message') logging.warning('warning message') logging.error('error message') logging.critical('critical message')]]></content>
      <tags>
        <tag>æŠ€æœ¯</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åº”ç”¨è½¯ä»¶è£…åœ¨Cç›˜é‡Œä¼šè®©ç³»ç»Ÿå˜æ…¢ä¹ˆï¼Ÿ]]></title>
    <url>%2F2018%2F08%2F16%2F%E5%BA%94%E7%94%A8%E8%BD%AF%E4%BB%B6%E8%A3%85%E5%9C%A8C%E7%9B%98%E9%87%8C%E4%BC%9A%E8%AE%A9%E7%B3%BB%E7%BB%9F%E5%8F%98%E6%85%A2%E4%B9%88%EF%BC%9F%2F</url>
    <content type="text"><![CDATA[8012å¹´äº†ï¼ŒğŸŒè¿˜åœ¨è½¬ï¼Œä½†æ˜¯å¥½å¤šé¡½å›ºçš„äººğŸ§ ä¸è½¬äº†ï¼Œæ‰€ä»¥ä»Šå¤©å°±æœ‰äº†â€œåº”ç”¨è½¯ä»¶è£…åœ¨Cç›˜é‡Œä¼šè®©ç³»ç»Ÿå˜æ…¢ä¹ˆâ€è¿™ä¸ªè¯é¢˜ã€‚ ä¸ºå•¥äººä»¬æœ‰æŠŠè½¯ä»¶è£…åœ¨Cç›˜ä¹‹å¤–çš„ä¹ æƒ¯ï¼Ÿè¿™çœŸçš„æ˜¯ä¸€ä¸ªè¿œå¤æ—¶ä»£é—ç•™ä¸‹æ¥çš„ä¹ æƒ¯ã€‚ è¿‡å»çš„ç”µè„‘çš„ç¡¬ä»¶é…ç½®å¯ä¸å¦‚ç°åœ¨çš„è¿™ä¹ˆå¥½ï¼Œå½“æ—¶çš„ç¡¬ç›˜å¯èƒ½åªæœ‰10Gï¼Œå†…å­˜åˆ™å¯èƒ½åªæœ‰128Mï¼ŒæŠŠ10Gçš„ç¡¬ç›˜åˆ’ä¸ºCç›˜ï¼Œè£…è¿›å»ä¸€ä¸ªç³»ç»Ÿï¼Œå‰©ä¸‹çš„ç©ºé—´å°±ä¸å¤ªå¤šäº†ï¼Œæ‰€ä»¥å°±æœ‰äº†æŠŠè½¯ä»¶æ”¾åœ¨åˆ«çš„ç£ç›˜é‡Œé¢çš„ä¹ æƒ¯ å†åŠ ä¸Šè¿‡å»çš„ç”µè„‘æ€§èƒ½æ¯”è¾ƒå·®ï¼ŒæŠ€æœ¯è½åï¼Œæ…¢æ…¢å°±æœ‰æŠŠè½¯ä»¶è£…åœ¨cç›˜ä¼šå¡è¿™ç§è¯¯åŒº åº”ç”¨è½¯ä»¶è£…åœ¨Cç›˜é‡Œä¼šè®©ç³»ç»Ÿå˜æ…¢ä¹ˆï¼Ÿä¸ä¼šçš„ï¼Œå…„å¼Ÿï¼Œå¤§æ›¼ã€‚ ç°åœ¨å¤§éƒ¨åˆ†äººç”¨çš„æœºæ¢°ç¡¬ç›˜HDDæ˜¯è¿™æ ·çš„ğŸ‘‡ ç¡¬ç›˜æœ€æ ¸å¿ƒçš„éƒ¨ä»¶æ˜¯åƒå…‰ç›˜é‚£æ ·çš„ç£ç›˜å’Œè¿ç€å…‰ç›˜çš„ç£å¤´ å…¶ä¸­ï¼Œç£ç›˜æ˜¯ç”¨æ¥å­˜æ”¾æ•°æ®çš„ï¼Œç£å¤´æ˜¯ç”¨æ¥è¯»å–æ•°æ®çš„ã€‚ å†è¯´è¯´ç³»ç»Ÿåˆ†åŒºï¼Œæ­£å¸¸çš„æ–¹æ³•åˆ†åŒºçš„è¯ï¼ŒCç›˜åœ¨ç£ç›˜ç›˜ç‰‡ä¸Šçš„ä½ç½®åº”è¯¥æ˜¯é è¿‘å¤–åœˆçš„ï¼Œå¤–åœˆå› ä¸ºå‘¨é•¿æ¯”è¾ƒå¤§ï¼Œè¿™å°±å¯¼è‡´äº†ç£å¤´åœ¨ç›¸åŒæ—¶é—´å†…ï¼Œè¯»å–çš„æ•°æ®çš„æ€§èƒ½ä¹Ÿå¾ˆé«˜ã€‚ æ‰€ä»¥ï¼Œå¯¹æœºæ¢°ç¡¬ç›˜æ¥è¯´ï¼ŒæŠŠåº”ç”¨è½¯ä»¶è£…åœ¨Cç›˜ï¼Œéä½†ä¸ä¼šè®©ç³»ç»Ÿå˜å¡ï¼Œåè€Œä¼šè®©åº”ç”¨è½¯ä»¶è¿è¡Œå¾—æ›´å¿«ã€‚ è¿˜æœ‰å¾ˆå¤šå°ä¼™ä¼´ç”¨å›ºæ€ç¡¬ç›˜SSDï¼ŒæŠŠåº”ç”¨è½¯ä»¶è£…åœ¨å“ªä¸ªåˆ†åŒºè¿è¡Œé€Ÿåº¦éƒ½å·®ä¸å¤šã€‚ å¦‚ä½•è®©ç¬”è®°æœ¬å¼€æœºä¸å†å¡é¡¿è¯·çœ‹è¿™é‡Œhttps://blog.tengshe789.tech/2018/08/16/%E5%A6%82%E4%BD%95%E8%AE%A9%E5%BC%80%E6%9C%BA%E4%B8%8D%E5%9C%A8%E5%8D%A1%E9%A1%BF/#more ç»“æŸæ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢]]></content>
      <tags>
        <tag>æŠ€æœ¯</tag>
        <tag>ç¡¬ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•è®©ç¬”è®°æœ¬å¼€æœºä¸å†å¡é¡¿]]></title>
    <url>%2F2018%2F08%2F16%2F%E5%A6%82%E4%BD%95%E8%AE%A9%E5%BC%80%E6%9C%BA%E4%B8%8D%E5%9C%A8%E5%8D%A1%E9%A1%BF%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘è€æœ‰å°ä¼™ä¼´QQç§èŠæˆ‘ï¼šâ€œç„¶å“¥ç„¶å“¥ï¼Œæˆ‘ç”µè„‘å¡ï¼Œæ€ä¹ˆåŠï¼Ÿâ€ æˆ‘å°±å›å¤ï¼Œè¿˜èƒ½æ€ä¹ˆåŠå•Šï¼Œç™¾åº¦å» ç„¶åå¯¹é¢åˆæ¥è¯äº†ï¼Œâ€œç„¶å“¥ç„¶å“¥ï¼Œæˆ‘ä¸ä¼šæœï¼Œå’‹åŠå•Šï¼Ÿâ€ æˆ‘ï¼š é‚£ä¹ˆå‡ å¤©æˆ‘å°±åˆ†äº«ä¸€ä¸‹ï¼Œæˆ‘è®¾ç½®win10 PCçš„å°çªé—¨ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ é™ä½æ˜¾ç¤ºæ•ˆæœé¦–å…ˆï¼Œå³é”®å•å‡»æˆ‘çš„ç”µè„‘ï¼Œé€‰æ‹©å±æ€§ï¼Œæ‰¾åˆ°é«˜çº§ç³»ç»Ÿè®¾ç½®ï¼Œè¿›å…¥ååˆ‡æ¢é€‰é¡¹å¡åˆ°é«˜çº§ï¼Œåœ¨è§†è§‰æ•ˆæœä¸­ï¼Œé€‰ä¸­â€œè°ƒæ•´ä¸ºæœ€ä½³æ€§èƒ½â€ï¼Œç„¶åç‚¹å‡»åº”ç”¨ã€‚ åˆ é™¤ç³»ç»Ÿé—ç•™çš„æ— ç”¨æ–‡ä»¶ç„¶åï¼Œåœ¨å¼€å§‹èœå•è¾“å…¥cmdï¼Œé€‰æ‹©å‘½ä»¤æç¤ºç¬¦ï¼Œè¿›å…¥åè¾“å…¥å‘½ä»¤rd C:windows.old /sï¼Œåˆ é™¤ç³»ç»Ÿé—ç•™çš„æ— ç”¨æ–‡ä»¶ï¼Œå¢åŠ Cç›˜ç©ºé—´ã€‚å…³äºCç›˜çš„ç©ºé—´ï¼Œæˆ‘å»ºè®®è‡³å°‘è¦ä¿ç•™20%çš„å®¹é‡ï¼ˆå¹¶ä¸”ä¸å°äº10GBï¼‰ï¼Œç”¨æ¥ç»™ç³»ç»Ÿäº¤æ¢æ–‡ä»¶ä½¿ç”¨ã€‚ å–æ¶ˆWin10çš„å¯åŠ¨ç”»é¢ åœ¨å¼€å§‹èœå•è¾“å…¥msconfigï¼Œ ç„¶ååˆ‡æ¢é€‰é¡¹å¡åˆ°å¼•å¯¼ï¼Œå‹¾é€‰â€œæ— GUIå¼•å¯¼â€å°±å¯ä»¥äº† ç¦ç”¨éšç³»ç»Ÿå¯åŠ¨æ—¶åŠ è½½çš„æœåŠ¡è¿˜æ˜¯åœ¨åˆšæ‰çš„msconfigç³»ç»Ÿé…ç½®ä¸­ï¼Œåˆ‡æ¢åˆ°æœåŠ¡é€‰é¡¹å¡ï¼Œè¿™æ—¶æ‰€æœ‰éšç³»ç»Ÿå¯åŠ¨çš„åŠ è½½æœåŠ¡éƒ½ä¼šåˆ—è¡¨æ˜¾ç¤ºï¼Œå…ˆå‹¾é€‰â€œéšè—æ‰€æœ‰MicrosoftæœåŠ¡â€ï¼Œç„¶åæŸ¥çœ‹åˆ—è¡¨ä¸­å‰©ä½™çš„åŠ è½½æœåŠ¡é¡¹ï¼ŒæŠŠä½ è®¤ä¸ºä¸éœ€è¦çš„åº”ç”¨æœåŠ¡å–æ¶ˆå‹¾é€‰å³å¯ æœ€æœ‰æ•ˆçš„åŠæ³•éªšå¹´ï¼Œæ¢ä¸ªSSDå§ ç»“æŸæ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ ç°åœ¨ç™¾åº¦win10ä¼˜åŒ–ï¼Œè¿˜æœ‰å¾ˆå¤šå°æŠ€å·§ï¼Œæˆ‘å°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ï¼Œè¯¦æƒ…è¯·çœ‹çœ‹ç™¾åº¦ç¬¬ä¸€æ¡https://jingyan.baidu.com/article/c843ea0ba3d01377931e4a3d.html]]></content>
      <tags>
        <tag>Windows10</tag>
        <tag>çªé—¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®ºè‡ªåŠ¨ä¸‹è½½BingèƒŒæ™¯çš„å°æŠ€å·§]]></title>
    <url>%2F2018%2F08%2F16%2F%E8%87%AA%E5%8A%A8%E4%B8%8B%E8%BD%BDBing%E8%83%8C%E6%99%AF%2F</url>
    <content type="text"><![CDATA[Bingï¼Œå…„å¼Ÿä»¬æ‡‚å§ğŸ¤ è™½ç„¶Bingçš„æœç´¢å¼•æ“è¿˜å·®ç‚¹æ„æ€ï¼Œä¸è¿‡æ¯æ¬¡å¯åŠ¨å®ƒçš„æ—¶å€™ï¼Œæ€»æ˜¯è¢«å®ƒçš„èƒŒæ™¯éœ‡æ’¼åˆ°ï¼Œç”šè‡³å¾ˆå¤šäººéƒ½æŠŠå®ƒå½“ä½œç¾å›¾ç½‘ è¯ºï¼Œå°±æ˜¯è¿™ç§èƒŒæ™¯ï¼Œæ¯å¤©éƒ½ä¼šæ¢1å¼ ï¼Œè¿˜ä¸é‡å¤ æ˜¯ä¸æ˜¯æƒ³è¦æŠŠå®ƒè®¾ç½®æˆå£çº¸ï¼Ÿæ¯æ¬¡éƒ½è¦è‡ªå·±æ‰‹åŠ¨æ“ä½œå¯¹æ‡’ç™Œæ‚£è€…å®åœ¨æ˜¯ä¸å¤Ÿå‹å¥½ï¼Œæ—¢ç„¶ç°åœ¨ä»€ä¹ˆéƒ½è®²ç©¶AIï¼Œå’±ä»¬ä¹Ÿå°±æ¥ç‚¹æ™ºèƒ½åŒ–çš„Bingå£çº¸ä¸‹è½½æ“ä½œå§ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ã€‚ ç¬¬ä¸€æ­¥â€“codingå…ˆå‡†å¤‡ä¸€ä¸ªtxtï¼Œå°†ä¸‹åˆ—ä»£ç ç²˜è´´è¿›å» 123456789101112131415161718192021222324252627282930313233343536373839404142434445$x = Split-Path -Parent $MyInvocation.MyCommand.Definitioncd $xmkdir imagescd imagesmkdir jsonscd jsons$url = "http://www.bing.com/HPImageArchive.aspx?format=js&amp;idx=0&amp;n=10"$time = Get-Date$data = Invoke-WebRequest $url$data.Content | Out-File $time.DayOfYear$decode = ConvertFrom-Json($data)cd ..$range = 1..8$count = $range.Countfor($i=0; $i -lt $count; $i++)&#123;$temp = $decode.images.Get($i)$urlsplit = -Join("http://www.bing.com",$temp.url)echo $urlsplitInvoke-WebRequest $urlsplit -OutFile ($temp.hsh + ".jpg")&#125;echo ok!pause ç„¶åå°†æ–‡ä»¶åç¼€åæ”¹æˆ.ps1ï¼Œå­˜æ”¾åˆ°é¢„å…ˆæ‰¾åˆ°çš„å£çº¸æ–‡ä»¶å¤¹ä¸­ã€‚ ç¬¬äºŒæ­¥â€“runningç”¨é¼ æ ‡å³é”®é€‰æ‹©â€œä½¿ç”¨PowerShellè¿è¡Œâ€ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨ç”Ÿæˆä¸ªåä¸ºâ€œimagesâ€çš„æ–‡ä»¶å¤¹ï¼Œä¸‹è½½æœ€è¿‘å‡ å¤©æ˜¾ç¤ºçš„8å¼ Bingå£çº¸ã€‚ æ•ˆæœå°±æ˜¯è¿™æ ·ï¼š å‡ºé”™æ€ä¹ˆåŠï¼Ÿâ€“exceptionæ³¨æ„äº†ï¼Œé‚£äº›å·²ç»ä¸ç”¨IEæµè§ˆå™¨çš„å°ä¼™ä¼´ï¼Œåœ¨ä½¿ç”¨ä»£ç å‰ä¸€å®šè¦æŠŠIEçš„å¯åŠ¨è®¾ç½®é€‰é¡¹ä¼˜å…ˆå®Œæˆäº†ï¼Œä¸ç„¶é“å®šä¼šæŠ¥é”™çš„ã€‚ ç¬¬ä¸‰æ­¥â€“è‡ªåŠ¨åŒ–è¦æ˜¯è§‰å¾—æ¯å¤©éƒ½è¦æ‰‹åŠ¨ä¸€ä¸‹ä¸‹éå¸¸éº»çƒ¦ï¼Œè¿˜æœ‰ä¸ªå…¨å¥—è‡ªåŠ¨åŒ–ä¸‹è½½çš„æ–¹å¼ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•æŠŠä¸‹é¢åšæˆ.ps1æ–‡ä»¶ã€‚ 123456789101112131415161718192021222324252627282930313233$x = Split-Path -Parent $MyInvocation.MyCommand.Definitioncd $xmkdir imagescd imagesmkdir jsonscd jsons$url = "http://www.bing.com/HPImageArchive.aspx?format=js&amp;idx=0&amp;n=10"$time = Get-Date$data = Invoke-WebRequest $url$data.Content | Out-File $time.DayOfYear$decode = ConvertFrom-Json($data)cd ..$temp = $decode.images.Get(0)$urlsplit = -Join("http://www.bing.com",$temp.url)echo $urlsplitInvoke-WebRequest $urlsplit -OutFile ($temp.hsh + ".jpg")echo ok! ç„¶åè¿›å…¥â€œæ§åˆ¶é¢æ¿-ç®¡ç†å·¥å…·-ä»»åŠ¡è®¡åˆ’ç¨‹åºâ€ï¼Œé€‰æ‹©å³ä¾§çš„â€œåˆ›å»ºä»»åŠ¡â€ã€‚ åˆ‡æ¢åˆ°â€œæ“ä½œâ€é€‰é¡¹å¡ä¸‹ï¼Œç‚¹å‡»â€œæ–°å»ºâ€ï¼Œ åœ¨â€œç¨‹åºæˆ–è„šæœ¬â€ä¸€æ ä¸­ï¼Œå¡«å…¥ä¸‹é¢è¿™è¡Œå†…å®¹ 12%SystemRoot%\system32\WindowsPowerShell\v1.0\powershell.exe â€œæ·»åŠ å‚æ•°ï¼ˆå¯é€‰ï¼‰â€å†…ï¼Œå¤§å®¶åˆ™éœ€è¦æŠŠè„šæœ¬çš„ä¿å­˜è·¯å¾„å¡«è¿›å»ã€‚ ç‚¹å‡»ç¡®å®šåï¼Œåˆ‡æ¢åˆ°â€œè§¦å‘å™¨â€é€‰é¡¹å¡ï¼ŒåŒæ ·ç‚¹å‡»æ–°å»ºï¼Œé€‰æ‹©â€œæ¯å¤©â€ï¼Œç‚¹å‡»ç¡®å®šï¼Œä¿å­˜ä»»åŠ¡ã€‚ è¿™æ ·æ¯å¤©å›ºå®šçš„æ—¶é—´ç‚¹å°±ä¼šè‡ªåŠ¨ä¸‹è½½ä¸€å¼ å¿…åº”å£çº¸äº†ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œå£çº¸åº“ä¸å°±æœ‰äº†ä¹ˆï¼Ÿ å®Œç»“æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹ï¼Œå’±ä»¬ä¸¤ä¸ªæƒ³ä¸ªå·ç ï¼Œ ä¹°ä¸ªå½©ç¥¨ï¼Œå…ˆæŒ£ä»–ä¸ªå‡ ç™¾ä¸‡ğŸ˜]]></content>
      <tags>
        <tag>Windows10</tag>
        <tag>çªé—¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å­¦å¥½åˆ†å¸ƒå¼æ¶æ„=2=-é€šä¿¡åè®®HTTP]]></title>
    <url>%2F2018%2F08%2F16%2F%E5%88%86%E4%BA%AB%E4%B8%80%E4%B8%8B%E6%88%91%E5%AF%B9%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AEHTTP%E7%9A%84%E7%90%86%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[æˆ‘ä¸ºä»€ä¹ˆä¸æ–­çš„æ›´æ–°åšå®¢å‘¢ï¼Ÿè¿™æ˜¯ä¸€æ¬¡å¾ˆå¥½çš„æå‡æœºä¼šã€‚ å¹³æ—¶è§£å†³é—®é¢˜çš„æ—¶å€™å¯èƒ½è€ƒè™‘è¿›åº¦é—®é¢˜æ²¡æœ‰æ›´æ·±åˆ»åœ°å»ç†è§£ï¼Œä½†æ˜¯åœ¨å†™åšå®¢çš„æ—¶å€™ï¼Œä½ ä¼šä¸çŸ¥ä¸è§‰ä¸­å¯¹ä¸€äº›å†…å®¹è¿›è¡Œæ€è€ƒï¼Œå¹¶æœ‰å¯èƒ½å’Œè¯„è®ºè€…ä¸€èµ·æ·±å…¥ï¼Œè¿™äº›éƒ½æ˜¯éš¾å¾—çš„æœºä¼šã€‚ å¯èƒ½æœ‰äººä¼šé—®æˆ‘ï¼Œæˆ‘ä¸ºä»€ä¹ˆä¸æ–­çš„æ›´æ–°åšå®¢å‘¢ï¼Ÿ æˆ‘è§‰å¾—å§ï¼Œè¿™æ˜¯ä¸€æ¬¡å¾ˆå¥½çš„æå‡æœºä¼šã€‚ å¹³æ—¶è§£å†³é—®é¢˜çš„æ—¶å€™å¯èƒ½è€ƒè™‘è¿›åº¦é—®é¢˜æ²¡æœ‰æ›´æ·±åˆ»åœ°å»ç†è§£ï¼Œä½†æ˜¯åœ¨å†™åšå®¢çš„æ—¶å€™ï¼Œæˆ‘ä¼šä¸çŸ¥ä¸è§‰ä¸­å¯¹ä¸€äº›å†…å®¹è¿›è¡Œæ€è€ƒï¼Œå¯ä»¥æ›´æ·±å…¥çš„ç†è§£é—®é¢˜ã€‚åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œä¸æ–­çš„æ€»ç»“ï¼Œä¸æ–­çš„æ€è€ƒï¼Œä¸æ–­è®°å¿†ï¼Œæ…¢æ…¢çŸ¥è¯†å°±å·©å›ºäº†ã€‚ æˆ‘æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ…¢çƒ­çš„äººï¼Œå¸Œæœ›æˆ‘å¯ä»¥ç”¨è¿™ä¸ªæ–¹å¼ä¸æ–­æé«˜è‡ªå·±~ å…±åŒåŠ æ²¹ï¼ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ HTTPåè®®æ˜¯ä»€ä¹ˆï¼ŸHTTPåè®®ï¼ˆHyperText Transfer Protocolï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰:æ˜¯å®¢æˆ·ç«¯æµè§ˆå™¨æˆ–å…¶ä»–ç¨‹åºä¸WebæœåŠ¡å™¨ä¹‹é—´çš„åº”ç”¨å±‚é€šä¿¡åè®® ï¼Œæ˜¯åŸºäºè¯·æ±‚/å“åº”èŒƒå¼çš„ã€‚ ä¸€ä¸ªå®¢æˆ·æœºä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥åï¼Œå‘é€ä¸€ä¸ªè¯·æ±‚ç»™æœåŠ¡å™¨ï¼Œè¯·æ±‚æ–¹å¼çš„æ ¼å¼ä¸ºï¼Œç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ã€åè®®ç‰ˆæœ¬å·ï¼Œåè¾¹æ˜¯MIMEä¿¡æ¯åŒ…æ‹¬è¯·æ±‚ä¿®é¥°ç¬¦ã€å®¢æˆ·æœºä¿¡æ¯å’Œå¯èƒ½çš„å†…å®¹ã€‚ æœåŠ¡å™¨æ¥åˆ°è¯·æ±‚åï¼Œç»™äºˆç›¸åº”çš„å“åº”ä¿¡æ¯ï¼Œå…¶æ ¼å¼ä¸ºä¸€ä¸ªçŠ¶æ€è¡ŒåŒ…æ‹¬ä¿¡æ¯çš„åè®®ç‰ˆæœ¬å·ã€ä¸€ä¸ªæˆåŠŸæˆ–é”™è¯¯çš„ä»£ç ï¼Œåè¾¹æ˜¯MIMEä¿¡æ¯åŒ…æ‹¬æœåŠ¡å™¨ä¿¡æ¯ã€å®ä½“ä¿¡æ¯å’Œå¯èƒ½çš„å†…å®¹ã€‚ å®ƒåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯è¯·æ±‚å’Œç›¸åº” RT ä¼ è¾“èµ„æº é€šè¿‡htmlä¼ è¾“ ï¼šæ–‡æœ¬ã€wordã€aviç”µå½±ã€å…¶ä»–èµ„æº ä¼ è¾“çš„åª’ä½“ç±»å‹ æœåŠ¡ç«¯å‘æµè§ˆå™¨ä¼ è¾“MIMEç±»å‹çš„æ–‡ä»¶ï¼Œæµè§ˆå™¨æ‹¿åˆ°MIMEç±»å‹çš„æ–‡ä»¶ï¼Œå°±å¯ä»¥è§£æäº† ã€‚ è­¬å¦‚text/htmlã€ image/jpeg ã€application/xmlï¼Œjsonæ ¼å¼ï¼Œéƒ½å±äºMIMEç±»å‹ URIå’ŒURL è¦äº†è§£httpçš„ä¼ è¾“ï¼Œé¦–å…ˆè¦çŸ¥é“ä¼ è¾“çš„å¯¹è±¡æ˜¯ä»€ä¹ˆã€‚ URI:webæœåŠ¡å™¨ä¸­æŸä¸ªèµ„æºçš„åå­—ã€‚ è­¬å¦‚index.html URL:ç½‘ç»œèµ„æºæè¿° ä¸¾ä¸ªæ —å­ï¼š ( http://)[resume.tengshe789.tech][:80]/java/index.html[?query-string] #location è¿™æ—¶ä¸ªå…¸å‹çš„urlï¼Œurlé‡Œé¢æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ schema(åè®®): http/https/ftp. host: webæœåŠ¡å™¨çš„ipåœ°å€æˆ–è€…åŸŸå port: æœåŠ¡ç«¯ç«¯å£ï¼Œ httpé»˜è®¤è®¿é—®çš„ç«¯å£æ˜¯80 path: èµ„æºè®¿é—®è·¯å¾„#location query-string: æŸ¥è¯¢å‚æ•°[?query-string] æ–¹æ³• æ¯ä¸ªè¯·æ±‚éƒ½ä¼šæºå¸¦GET/PUT/DELETE/POST/HEADè¿™æ ·çš„ä¸€ä¸ªæ–¹æ³•ï¼ŒæœåŠ¡å™¨æ‹¿åˆ°æ–¹æ³•å°±çŸ¥é“è‡ªå·±è¯¥åšä»€ä¹ˆäº†ã€‚ é‚£javaä¸­æœ‰doGet()doPost()æ–¹æ³•ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ doGetï¼šGETæ–¹æ³•ä¼šæŠŠåå€¼å¯¹è¿½åŠ åœ¨è¯·æ±‚çš„URLåé¢ã€‚å› ä¸ºURLå¯¹å­—ç¬¦æ•°ç›®æœ‰é™åˆ¶ï¼Œè¿›è€Œé™åˆ¶äº†ç”¨åœ¨å®¢æˆ·ç«¯è¯·æ±‚çš„å‚æ•°å€¼çš„æ•°ç›®ã€‚å¹¶ä¸”è¯·æ±‚ä¸­çš„å‚æ•°å€¼æ˜¯å¯è§çš„ï¼Œå› æ­¤ï¼Œæ•æ„Ÿä¿¡æ¯ä¸èƒ½ç”¨è¿™ç§æ–¹å¼ä¼ é€’ã€‚ doPOSTï¼šPOSTæ–¹æ³•é€šè¿‡æŠŠè¯·æ±‚å‚æ•°å€¼æ”¾åœ¨è¯·æ±‚ä½“ä¸­æ¥å…‹æœGETæ–¹æ³•çš„é™åˆ¶ï¼Œå› æ­¤ï¼Œå¯ä»¥å‘é€çš„å‚æ•°çš„æ•°ç›®æ˜¯æ²¡æœ‰é™åˆ¶çš„ã€‚æœ€åï¼Œé€šè¿‡POSTè¯·æ±‚ä¼ é€’çš„æ•æ„Ÿä¿¡æ¯å¯¹å¤–éƒ¨å®¢æˆ·ç«¯æ˜¯ä¸å¯è§çš„ã€‚ æ–¹æ³• GET POST ç¼“å­˜ èƒ½è¢«ç¼“å­˜ ä¸èƒ½ç¼“å­˜ ç¼–ç ç±»å‹ application/x-www-form-urlencoded application/x-www-form-urlencoded æˆ– multipart/form-dataã€‚ä¸ºäºŒè¿›åˆ¶æ•°æ®ä½¿ç”¨å¤šé‡ç¼–ç ã€‚ å¯¹æ•°æ®é•¿åº¦çš„é™åˆ¶ æ˜¯çš„ã€‚å½“å‘é€æ•°æ®æ—¶ï¼ŒGET æ–¹æ³•å‘ URL æ·»åŠ æ•°æ®ï¼›URL çš„é•¿åº¦æ˜¯å—é™åˆ¶çš„ï¼ˆURL çš„æœ€å¤§é•¿åº¦æ˜¯ 2048 ä¸ªå­—ç¬¦ï¼‰ æ— é™åˆ¶ã€‚ å¯¹æ•°æ®ç±»å‹çš„é™åˆ¶ åªå…è®¸ ASCII å­—ç¬¦ æ²¡æœ‰é™åˆ¶ã€‚ä¹Ÿå…è®¸äºŒè¿›åˆ¶æ•°æ®ã€‚ å®‰å…¨æ€§ ä¸ POST ç›¸æ¯”ï¼ŒGET çš„å®‰å…¨æ€§è¾ƒå·®ï¼Œå› ä¸ºæ‰€å‘é€çš„æ•°æ®æ˜¯ URL çš„ä¸€éƒ¨åˆ†ã€‚åœ¨å‘é€å¯†ç æˆ–å…¶ä»–æ•æ„Ÿä¿¡æ¯æ—¶ç»ä¸è¦ä½¿ç”¨ GET POST æ¯” GET æ›´å®‰å…¨ï¼Œå› ä¸ºå‚æ•°ä¸ä¼šè¢«ä¿å­˜åœ¨æµè§ˆå™¨å†å²æˆ– web æœåŠ¡å™¨æ—¥å¿—ä¸­ã€‚ å¯è§æ€§ æ•°æ®åœ¨ URL ä¸­å¯¹æ‰€æœ‰äººéƒ½æ˜¯å¯è§çš„ã€‚ æ•°æ®ä¸ä¼šæ˜¾ç¤ºåœ¨ URL ä¸­ã€‚ æŠ¥æ–‡httpäº¤æ¢ä¸ä¼ è¾“çš„æ•°æ®å•å…ƒæ˜¯æŠ¥æ–‡ã€‚æŠ¥æ–‡ç”±ä»å®¢æˆ·æœºåˆ°æœåŠ¡å™¨çš„è¯·æ±‚å’Œä»æœåŠ¡å™¨åˆ°å®¢æˆ·æœºçš„å“åº”æ„æˆã€‚ åº”ç­”æŠ¥æ–‡æ ¼å¼å¦‚ä¸‹ï¼š çŠ¶æ€è¡Œ ï¼ é€šç”¨ä¿¡æ¯å¤´ ï¼ å“åº”å¤´ ï¼ å®ä½“å¤´ ï¼ æŠ¥æ–‡ä¸»ä½“ çŠ¶æ€ç å…ƒç”±3ä½æ•°å­—ç»„æˆï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¦è¢«ç†è§£æˆ–è¢«æ»¡è¶³ã€‚åŸå› åˆ†ææ˜¯å¯¹åŸæ–‡çš„çŠ¶æ€ç ä½œç®€çŸ­çš„æè¿°ï¼ŒçŠ¶æ€ç ç”¨æ¥æ”¯æŒè‡ªåŠ¨æ“ä½œï¼Œè€ŒåŸå› åˆ†æç”¨æ¥ä¾›ç”¨æˆ·ä½¿ç”¨ã€‚å®¢æˆ·æœºæ— éœ€ç”¨æ¥æ£€æŸ¥æˆ–æ˜¾ç¤ºè¯­æ³•ã€‚æœ‰å…³é€šç”¨ä¿¡æ¯å¤´ï¼Œå“åº”å¤´å’Œå®ä½“å¤´æ–¹é¢çš„å…·ä½“å†…å®¹å¯ä»¥å‚ç…§ç›¸å…³æ–‡ä»¶ã€‚ requestrequestæŠ¥æ–‡æ ¼å¼å¦‚ä¸‹ï¼š è¯·æ±‚è¡Œ ï¼ é€šç”¨ä¿¡æ¯å¤´ ï¼ è¯·æ±‚å¤´ ï¼ å®ä½“å¤´ ï¼ æŠ¥æ–‡ä¸»ä½“ requestæ¶ˆæ¯ç»“æ„åŒ…å«ä¸‰éƒ¨åˆ†ï¼š ï¼ˆèµ·å§‹è¡Œã€é¦–éƒ¨å­—æ®µã€ä¸»ä½“ï¼‰ ä¸‹é¢æŠ“åŒ…éªŒè¯ï¼ŒæŠ“åŒ…ä½¿ç”¨çš„æ˜¯Charlesè¿™ä¸ªè½¯ä»¶ã€‚ å¦‚å›¾æ‰€ç¤ºï¼Œèµ·å§‹è¡Œï¼š METHOD /path / http/version-number é¦–éƒ¨å­—æ®µï¼š å¤´ä¿¡æ¯Header-Name:value ä¸»ä½“ è¿”å›å†…å®¹optional request body è¯·æ±‚è¡Œä»¥æ–¹æ³•å­—æ®µå¼€å§‹ï¼Œåé¢åˆ†åˆ«æ˜¯ URL å­—æ®µå’Œ HTTP åè®®ç‰ˆæœ¬å­—æ®µï¼Œå¹¶ä»¥ CRLF ç»“å°¾ã€‚SP æ˜¯åˆ†éš”ç¬¦ã€‚é™¤äº†åœ¨æœ€åçš„ CRLF åºåˆ—ä¸­ CF å’Œ LF æ˜¯å¿…éœ€çš„ä¹‹å¤–ï¼Œå…¶ä»–éƒ½å¯ä»¥ä¸è¦ã€‚æœ‰å…³é€šç”¨ä¿¡æ¯å¤´ï¼Œè¯·æ±‚å¤´å’Œå®ä½“å¤´æ–¹é¢çš„å…·ä½“å†…å®¹å¯ä»¥å‚ç…§ç›¸å…³æ–‡ä»¶ã€‚ responseresponseæŠ¥æ–‡æ ¼å¼å¦‚ä¸‹ï¼š çŠ¶æ€è¡Œ ï¼ é€šç”¨ä¿¡æ¯å¤´ ï¼ å“åº”å¤´ ï¼ å®ä½“å¤´ ï¼ æŠ¥æ–‡ä¸»ä½“ ç¬¬ä¸€éƒ¨åˆ† åŒ…æ‹¬ åè®®ç‰ˆæœ¬http/version-number çŠ¶æ€status code message ç¬¬äºŒéƒ¨åˆ† å¤´ä¿¡æ¯header-name:value ç¬¬ä¸‰éƒ¨åˆ† body çŠ¶æ€ç å…ƒç”±3ä½æ•°å­—ç»„æˆï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¦è¢«ç†è§£æˆ–è¢«æ»¡è¶³ã€‚åŸå› åˆ†ææ˜¯å¯¹åŸæ–‡çš„çŠ¶æ€ç ä½œç®€çŸ­çš„æè¿°ï¼ŒçŠ¶æ€ç ç”¨æ¥æ”¯æŒè‡ªåŠ¨æ“ä½œï¼Œè€ŒåŸå› åˆ†æç”¨æ¥ä¾›ç”¨æˆ·ä½¿ç”¨ã€‚å®¢æˆ·æœºæ— éœ€ç”¨æ¥æ£€æŸ¥æˆ–æ˜¾ç¤ºè¯­æ³•ã€‚æœ‰å…³é€šç”¨ä¿¡æ¯å¤´ï¼Œå“åº”å¤´å’Œå®ä½“å¤´æ–¹é¢çš„å…·ä½“å†…å®¹å¯ä»¥å‚ç…§ç›¸å…³æ–‡ä»¶ã€‚ å¸¸è§çŠ¶æ€ç http/1.1ç‰ˆæœ¬çš„åè®®é‡Œé¢å®šä¹‰äº†äº”ç§ç±»å‹çš„çŠ¶æ€ç ï¼š 1XX æç¤ºä¿¡æ¯ 2XX æˆåŠŸ 3XX é‡å®šå‘ 4XX å®¢æˆ·ç«¯é”™è¯¯ 5XX æœåŠ¡å™¨ç«¯çš„é”™è¯¯ æ¶ˆæ¯ æè¿° 100 Continue æœåŠ¡å™¨ä»…æ¥æ”¶åˆ°éƒ¨åˆ†è¯·æ±‚ï¼Œä½†æ˜¯ä¸€æ—¦æœåŠ¡å™¨å¹¶æ²¡æœ‰æ‹’ç»è¯¥è¯·æ±‚ï¼Œå®¢æˆ·ç«¯åº”è¯¥ç»§ç»­å‘é€å…¶ä½™çš„è¯·æ±‚ã€‚ 101 Switching Protocols æœåŠ¡å™¨è½¬æ¢åè®®ï¼šæœåŠ¡å™¨å°†éµä»å®¢æˆ·çš„è¯·æ±‚è½¬æ¢åˆ°å¦å¤–ä¸€ç§åè®®ã€‚ æ¶ˆæ¯ æè¿° 200 OK è¯·æ±‚æˆåŠŸï¼ˆå…¶åæ˜¯å¯¹GETå’ŒPOSTè¯·æ±‚çš„åº”ç­”æ–‡æ¡£ã€‚ï¼‰ 201 Created è¯·æ±‚è¢«åˆ›å»ºå®Œæˆï¼ŒåŒæ—¶æ–°çš„èµ„æºè¢«åˆ›å»ºã€‚ 202 Accepted ä¾›å¤„ç†çš„è¯·æ±‚å·²è¢«æ¥å—ï¼Œä½†æ˜¯å¤„ç†æœªå®Œæˆã€‚ 203 Non-authoritative Information æ–‡æ¡£å·²ç»æ­£å¸¸åœ°è¿”å›ï¼Œä½†ä¸€äº›åº”ç­”å¤´å¯èƒ½ä¸æ­£ç¡®ï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯æ–‡æ¡£çš„æ‹·è´ã€‚ 204 No Content æ²¡æœ‰æ–°æ–‡æ¡£ã€‚æµè§ˆå™¨åº”è¯¥ç»§ç»­æ˜¾ç¤ºåŸæ¥çš„æ–‡æ¡£ã€‚å¦‚æœç”¨æˆ·å®šæœŸåœ°åˆ·æ–°é¡µé¢ï¼Œè€ŒServletå¯ä»¥ç¡®å®šç”¨æˆ·æ–‡æ¡£è¶³å¤Ÿæ–°ï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚ 205 Reset Content æ²¡æœ‰æ–°æ–‡æ¡£ã€‚ä½†æµè§ˆå™¨åº”è¯¥é‡ç½®å®ƒæ‰€æ˜¾ç¤ºçš„å†…å®¹ã€‚ç”¨æ¥å¼ºåˆ¶æµè§ˆå™¨æ¸…é™¤è¡¨å•è¾“å…¥å†…å®¹ã€‚ 206 Partial Content å®¢æˆ·å‘é€äº†ä¸€ä¸ªå¸¦æœ‰Rangeå¤´çš„GETè¯·æ±‚ï¼ŒæœåŠ¡å™¨å®Œæˆäº†å®ƒã€‚ æ¶ˆæ¯ æè¿° 300 Multiple Choices å¤šé‡é€‰æ‹©ã€‚é“¾æ¥åˆ—è¡¨ã€‚ç”¨æˆ·å¯ä»¥é€‰æ‹©æŸé“¾æ¥åˆ°è¾¾ç›®çš„åœ°ã€‚æœ€å¤šå…è®¸äº”ä¸ªåœ°å€ã€‚ 301 Moved Permanently æ‰€è¯·æ±‚çš„é¡µé¢å·²ç»è½¬ç§»è‡³æ–°çš„urlã€‚ 302 Found æ‰€è¯·æ±‚çš„é¡µé¢å·²ç»ä¸´æ—¶è½¬ç§»è‡³æ–°çš„urlã€‚ 303 See Other æ‰€è¯·æ±‚çš„é¡µé¢å¯åœ¨åˆ«çš„urlä¸‹è¢«æ‰¾åˆ°ã€‚ 304 Not Modified æœªæŒ‰é¢„æœŸä¿®æ”¹æ–‡æ¡£ã€‚å®¢æˆ·ç«¯æœ‰ç¼“å†²çš„æ–‡æ¡£å¹¶å‘å‡ºäº†ä¸€ä¸ªæ¡ä»¶æ€§çš„è¯·æ±‚ï¼ˆä¸€èˆ¬æ˜¯æä¾›If-Modified-Sinceå¤´è¡¨ç¤ºå®¢æˆ·åªæƒ³æ¯”æŒ‡å®šæ—¥æœŸæ›´æ–°çš„æ–‡æ¡£ï¼‰ã€‚æœåŠ¡å™¨å‘Šè¯‰å®¢æˆ·ï¼ŒåŸæ¥ç¼“å†²çš„æ–‡æ¡£è¿˜å¯ä»¥ç»§ç»­ä½¿ç”¨ã€‚ 305 Use Proxy å®¢æˆ·è¯·æ±‚çš„æ–‡æ¡£åº”è¯¥é€šè¿‡Locationå¤´æ‰€æŒ‡æ˜çš„ä»£ç†æœåŠ¡å™¨æå–ã€‚ 306 Unused æ­¤ä»£ç è¢«ç”¨äºå‰ä¸€ç‰ˆæœ¬ã€‚ç›®å‰å·²ä¸å†ä½¿ç”¨ï¼Œä½†æ˜¯ä»£ç ä¾ç„¶è¢«ä¿ç•™ã€‚ 307 Temporary Redirect è¢«è¯·æ±‚çš„é¡µé¢å·²ç»ä¸´æ—¶ç§»è‡³æ–°çš„urlã€‚ æ¶ˆæ¯ æè¿° 400 Bad Request æœåŠ¡å™¨æœªèƒ½ç†è§£è¯·æ±‚ã€‚ 401 Unauthorized è¢«è¯·æ±‚çš„é¡µé¢éœ€è¦ç”¨æˆ·åå’Œå¯†ç ã€‚ 401.1 ç™»å½•å¤±è´¥ã€‚ 401.2 æœåŠ¡å™¨é…ç½®å¯¼è‡´ç™»å½•å¤±è´¥ã€‚ 401.3 ç”±äº ACL å¯¹èµ„æºçš„é™åˆ¶è€Œæœªè·å¾—æˆæƒã€‚ 401.4 ç­›é€‰å™¨æˆæƒå¤±è´¥ã€‚ 401.5 ISAPI/CGI åº”ç”¨ç¨‹åºæˆæƒå¤±è´¥ã€‚ 401.7 è®¿é—®è¢« Web æœåŠ¡å™¨ä¸Šçš„ URL æˆæƒç­–ç•¥æ‹’ç»ã€‚è¿™ä¸ªé”™è¯¯ä»£ç ä¸º IIS 6.0 æ‰€ä¸“ç”¨ã€‚ 402 Payment Required æ­¤ä»£ç å°šæ— æ³•ä½¿ç”¨ã€‚ 403 Forbidden å¯¹è¢«è¯·æ±‚é¡µé¢çš„è®¿é—®è¢«ç¦æ­¢ã€‚ 403.1 æ‰§è¡Œè®¿é—®è¢«ç¦æ­¢ã€‚ 403.2 è¯»è®¿é—®è¢«ç¦æ­¢ã€‚ 403.3 å†™è®¿é—®è¢«ç¦æ­¢ã€‚ 403.4 è¦æ±‚ SSLã€‚ 403.5 è¦æ±‚ SSL 128ã€‚ 403.6 IP åœ°å€è¢«æ‹’ç»ã€‚ 403.7 è¦æ±‚å®¢æˆ·ç«¯è¯ä¹¦ã€‚ 403.8 ç«™ç‚¹è®¿é—®è¢«æ‹’ç»ã€‚ 403.9 ç”¨æˆ·æ•°è¿‡å¤šã€‚ 403.10 é…ç½®æ— æ•ˆã€‚ 403.11 å¯†ç æ›´æ”¹ã€‚ 403.12 æ‹’ç»è®¿é—®æ˜ å°„è¡¨ã€‚ 403.13 å®¢æˆ·ç«¯è¯ä¹¦è¢«åŠé”€ã€‚ 403.14 æ‹’ç»ç›®å½•åˆ—è¡¨ã€‚ 403.15 è¶…å‡ºå®¢æˆ·ç«¯è®¿é—®è®¸å¯ã€‚ 403.16 å®¢æˆ·ç«¯è¯ä¹¦ä¸å—ä¿¡ä»»æˆ–æ— æ•ˆã€‚ 403.17 å®¢æˆ·ç«¯è¯ä¹¦å·²è¿‡æœŸæˆ–å°šæœªç”Ÿæ•ˆã€‚ 403.18 åœ¨å½“å‰çš„åº”ç”¨ç¨‹åºæ± ä¸­ä¸èƒ½æ‰§è¡Œæ‰€è¯·æ±‚çš„ URLã€‚è¿™ä¸ªé”™è¯¯ä»£ç ä¸º IIS 6.0 æ‰€ä¸“ç”¨ã€‚ 403.19 ä¸èƒ½ä¸ºè¿™ä¸ªåº”ç”¨ç¨‹åºæ± ä¸­çš„å®¢æˆ·ç«¯æ‰§è¡Œ CGIã€‚è¿™ä¸ªé”™è¯¯ä»£ç ä¸º IIS 6.0 æ‰€ä¸“ç”¨ã€‚ 403.20 Passport ç™»å½•å¤±è´¥ã€‚è¿™ä¸ªé”™è¯¯ä»£ç ä¸º IIS 6.0 æ‰€ä¸“ç”¨ã€‚ 404 Not Found æœåŠ¡å™¨æ— æ³•æ‰¾åˆ°è¢«è¯·æ±‚çš„é¡µé¢ã€‚ 404.0 ï¼ˆæ— ï¼‰â€“æ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶æˆ–ç›®å½•ã€‚ 404.1 æ— æ³•åœ¨æ‰€è¯·æ±‚çš„ç«¯å£ä¸Šè®¿é—® Web ç«™ç‚¹ã€‚ 404.2 Web æœåŠ¡æ‰©å±•é”å®šç­–ç•¥é˜»æ­¢æœ¬è¯·æ±‚ã€‚ 404.3 MIME æ˜ å°„ç­–ç•¥é˜»æ­¢æœ¬è¯·æ±‚ã€‚ 405 Method Not Allowed è¯·æ±‚ä¸­æŒ‡å®šçš„æ–¹æ³•ä¸è¢«å…è®¸ã€‚ 406 Not Acceptable æœåŠ¡å™¨ç”Ÿæˆçš„å“åº”æ— æ³•è¢«å®¢æˆ·ç«¯æ‰€æ¥å—ã€‚ 407 Proxy Authentication Required ç”¨æˆ·å¿…é¡»é¦–å…ˆä½¿ç”¨ä»£ç†æœåŠ¡å™¨è¿›è¡ŒéªŒè¯ï¼Œè¿™æ ·è¯·æ±‚æ‰ä¼šè¢«å¤„ç†ã€‚ 408 Request Timeout è¯·æ±‚è¶…å‡ºäº†æœåŠ¡å™¨çš„ç­‰å¾…æ—¶é—´ã€‚ 409 Conflict ç”±äºå†²çªï¼Œè¯·æ±‚æ— æ³•è¢«å®Œæˆã€‚ 410 Gone è¢«è¯·æ±‚çš„é¡µé¢ä¸å¯ç”¨ã€‚ 411 Length Required â€œContent-Lengthâ€ æœªè¢«å®šä¹‰ã€‚å¦‚æœæ— æ­¤å†…å®¹ï¼ŒæœåŠ¡å™¨ä¸ä¼šæ¥å—è¯·æ±‚ã€‚ 412 Precondition Failed è¯·æ±‚ä¸­çš„å‰ææ¡ä»¶è¢«æœåŠ¡å™¨è¯„ä¼°ä¸ºå¤±è´¥ã€‚ 413 Request Entity Too Large ç”±äºæ‰€è¯·æ±‚çš„å®ä½“çš„å¤ªå¤§ï¼ŒæœåŠ¡å™¨ä¸ä¼šæ¥å—è¯·æ±‚ã€‚ 414 Request-url Too Long ç”±äºurlå¤ªé•¿ï¼ŒæœåŠ¡å™¨ä¸ä¼šæ¥å—è¯·æ±‚ã€‚å½“postè¯·æ±‚è¢«è½¬æ¢ä¸ºå¸¦æœ‰å¾ˆé•¿çš„æŸ¥è¯¢ä¿¡æ¯çš„getè¯·æ±‚æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚ 415 Unsupported Media Type ç”±äºåª’ä»‹ç±»å‹ä¸è¢«æ”¯æŒï¼ŒæœåŠ¡å™¨ä¸ä¼šæ¥å—è¯·æ±‚ã€‚ 416 Requested Range Not Satisfiable æœåŠ¡å™¨ä¸èƒ½æ»¡è¶³å®¢æˆ·åœ¨è¯·æ±‚ä¸­æŒ‡å®šçš„Rangeå¤´ã€‚ 417 Expectation Failed æ‰§è¡Œå¤±è´¥ã€‚ 423 é”å®šçš„é”™è¯¯ã€‚ æ¶ˆæ¯ æè¿° 500 Internal Server Error è¯·æ±‚æœªå®Œæˆã€‚æœåŠ¡å™¨é‡åˆ°ä¸å¯é¢„çŸ¥çš„æƒ…å†µã€‚ 500.12 åº”ç”¨ç¨‹åºæ­£å¿™äºåœ¨ Web æœåŠ¡å™¨ä¸Šé‡æ–°å¯åŠ¨ã€‚ 500.13 Web æœåŠ¡å™¨å¤ªå¿™ã€‚ 500.15 ä¸å…è®¸ç›´æ¥è¯·æ±‚ Global.asaã€‚ 500.16 UNC æˆæƒå‡­æ®ä¸æ­£ç¡®ã€‚è¿™ä¸ªé”™è¯¯ä»£ç ä¸º IIS 6.0 æ‰€ä¸“ç”¨ã€‚ 500.18 URL æˆæƒå­˜å‚¨ä¸èƒ½æ‰“å¼€ã€‚è¿™ä¸ªé”™è¯¯ä»£ç ä¸º IIS 6.0 æ‰€ä¸“ç”¨ã€‚ 500.100 å†…éƒ¨ ASP é”™è¯¯ã€‚ 501 Not Implemented è¯·æ±‚æœªå®Œæˆã€‚æœåŠ¡å™¨ä¸æ”¯æŒæ‰€è¯·æ±‚çš„åŠŸèƒ½ã€‚ 502 Bad Gateway è¯·æ±‚æœªå®Œæˆã€‚æœåŠ¡å™¨ä»ä¸Šæ¸¸æœåŠ¡å™¨æ”¶åˆ°ä¸€ä¸ªæ— æ•ˆçš„å“åº”ã€‚ 502.1 CGI åº”ç”¨ç¨‹åºè¶…æ—¶ã€‚ Â· 502.2 CGI åº”ç”¨ç¨‹åºå‡ºé”™ã€‚ 503 Service Unavailable è¯·æ±‚æœªå®Œæˆã€‚æœåŠ¡å™¨ä¸´æ—¶è¿‡è½½æˆ–å½“æœºã€‚ 504 Gateway Timeout ç½‘å…³è¶…æ—¶ã€‚ 505 HTTP Version Not Supported æœåŠ¡å™¨ä¸æ”¯æŒè¯·æ±‚ä¸­æŒ‡æ˜çš„HTTPåè®®ç‰ˆæœ¬ã€‚ ç¼“å­˜ä½œç”¨æœ‰ä¸‰ï¼Œå‡å°‘å®¢æˆ·ç«¯è¯·æ±‚é¢‘ç‡ï¼Œå¢åŠ å®¢æˆ·ç«¯å“åº”é€Ÿåº¦ï¼Œå‡å°‘å†—ä½™æ•°æ®çš„ä¼ è¾“ ä¸‹å›¾æ˜¯è°·æ­Œæµè§ˆå™¨è°ƒè¯•æ¨¡å¼ç•Œé¢ï¼Œåœ¨headeræ ä¸­æ¸…æ™°çš„æ˜¾ç¤ºäº†ç¼“å­˜çš„æœ€å¤§ä¿æŒæ—¶é—´ HTTPåè®®çš„ç‰¹ç‚¹ æ— çŠ¶æ€ï¼ˆæ¯æ¬¡è¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼‰ é€šè¿‡cookie+sessionçš„æœºåˆ¶ï¼Œå®Œæˆå®ƒçš„æ— çŠ¶æ€ç‰¹ç‚¹ å¤šæ¬¡è¯·æ±‚ åŸºäºTCPåè®® åè®®ç‰ˆæœ¬å·Http1.1å’ŒHttp1.0çš„åŒºåˆ« HTTP/1.0åè®®ä½¿ç”¨éæŒä¹…è¿æ¥,å³åœ¨éæŒä¹…è¿æ¥ä¸‹,ä¸€ä¸ªtcpè¿æ¥åªä¼ è¾“ä¸€ä¸ªWebå¯¹è±¡ï¼› HTTP/1.1é»˜è®¤ä½¿ç”¨æŒä¹…è¿æ¥(ç„¶è€Œ,HTTP/1.1åè®®çš„å®¢æˆ·æœºå’ŒæœåŠ¡å™¨å¯ä»¥é…ç½®æˆä½¿ç”¨éæŒä¹…è¿æ¥)ã€‚ HTTP2.0ä¸HTTP1.0çš„åŒºåˆ« HTTP2.0çš„å¤šè·¯å¤ç”¨ æµè§ˆå™¨å¯¹åŒä¸€åŸŸåä¸‹çš„å¹¶å‘è¿æ¥æ•°é‡æœ‰é™åˆ¶ï¼Œä¸€èˆ¬ä¸º6ä¸ªï¼ŒHTTP1ä¸­çš„Keep-Aliveç”¨äºé•¿è¿æ¥è€Œä¸å¿…é‡æ–°å»ºç«‹è¿æ¥ï¼Œç„¶è€Œkeep-aliveå¿…é¡»ç­‰æœ¬æ¬¡è¯·æ±‚å½»åº•å®Œæˆåæ‰èƒ½å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œè€ŒHTTP2çš„è¯·æ±‚ä¸å“åº”ä»¥äºŒè¿›åˆ¶å¸§çš„å½¢å¼äº¤é”™è¿›è¡Œï¼Œåªéœ€å»ºç«‹ä¸€æ¬¡è¿æ¥ï¼Œå³ä¸€è½®ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®ç°å¤šè·¯å¤ç”¨ã€‚ HTTP2.0å‹ç¼©æ¶ˆæ¯å¤´ HTTP1çš„æ¶ˆæ¯å¤´å¾ˆå¤§å†—ä½™ï¼Œè€ŒHTTP2.0åˆ©ç”¨HPACKå¯¹æ¶ˆæ¯å¤´è¿›è¡Œå‹ç¼©ä¼ è¾“ï¼Œå‡è®¾å°†å¸¸ç”¨çš„è¯·æ±‚GET/index.htmlç”¨1è¡¨ç¤ºï¼ŒPOST/index.htmlç”¨2è¡¨ç¤ºï¼Œå³æ˜¯å°†æ¶ˆæ¯å¤´ä¸­çš„ä¸åŒçš„éƒ¨åˆ†åˆ†åˆ«ç”¨ä¸ç”¨çš„ç´¢å¼•è¿›è¡Œè¡¨ç¤ºï¼Œä¸”ä¼šç”¨å“ˆå¤«æ›¼ç¼–ç å‹ç¼©å­—ç¬¦ä¸²ï¼Œæœ€åå°è£…æˆframeã€‚ç´¢å¼•è¡¨åˆ†ä¸ºåŠ¨æ€ç´¢å¼•å’Œé™æ€ç´¢å¼•ï¼ŒåŠ¨æ€ç´¢å¼•è¡¨åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯å…±åŒç»´æŠ¤ï¼Œé™æ€ç´¢å¼•é‡‡ç”¨ç¡¬ç¼–ç å½¢å¼ã€‚ HTTP2.0æœåŠ¡ç«¯æ¨é€ HTTP2.0ä¸­æœåŠ¡å™¨ä¼šä¸»åŠ¨å°†èµ„æºæ¨é€ç»™å®¢æˆ·ç«¯ï¼Œä¾‹å¦‚æŠŠjså’Œcssæ–‡ä»¶ä¸»åŠ¨æ¨é€ç»™å®¢æˆ·ç«¯è€Œä¸ç”¨å®¢æˆ·ç«¯è§£æHTMLåè¯·æ±‚å†å“åº”ã€‚ HTTPSHTTPè¯·æ±‚è¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´æ²¡æœ‰ä»»ä½•èº«ä»½ç¡®è®¤çš„è¿‡ç¨‹ï¼Œæ•°æ®å…¨éƒ¨æ˜æ–‡ä¼ è¾“ï¼Œâ€œè£¸å¥”â€åœ¨äº’è”ç½‘ä¸Šï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“é­åˆ°é»‘å®¢çš„æ”»å‡»åŠ«æŒè®©ç³»ç»Ÿç˜«ç—ªï¼Œå½“å®¢æˆ·ç«¯å‘é€è¯·æ±‚å¾ˆå®¹æ˜“è¢«é»‘å®¢æˆªè·ï¼Œå¦‚æœé»‘å®¢å†’å……ç›®æ ‡æœåŠ¡å™¨ï¼Œåˆ™å¯è¿”å›ä»»æ„ä¿¡æ¯ç»™å®¢æˆ·ç«¯ï¼Œä¸è¢«å®¢æˆ·ç«¯æ‰€å¯Ÿè§‰ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šå¬åˆ°â€œåŠ«æŒâ€ä¸€è¯ï¼Œæ‰€ä»¥ä½¿ç”¨ç›´æ¥ä½¿ç”¨HTTPä¼ è¾“æ˜¯æœ‰é£é™©çš„ã€‚ HTTPSåè®®ï¼ˆHyperText Transfer Protocol over Secure Socket Layerï¼‰ï¼šå¯ä»¥ç†è§£ä¸ºHTTP+SSL/TLSï¼Œå³HTTPä¸‹åŠ å…¥SSLå±‚ï¼ŒHTTPSçš„å®‰å…¨åŸºç¡€æ˜¯ SSLï¼Œå› æ­¤åŠ å¯†çš„è¯¦ç»†å†…å®¹å°±éœ€è¦SSLï¼Œç”¨äºå®‰å…¨çš„HTTPæ•°æ®ä¼ è¾“ã€‚ å†å² ç½‘è­¦å…¬å¸çš„SSL3.0 SSLï¼ˆSecure Socket Layerï¼Œå®‰å…¨å¥—æ¥å­—å±‚ï¼‰ï¼š1994å¹´ä¸ºç½‘æ™¯æ‰€ç ”å‘ï¼ŒSSLåè®®ä½äºTCP/IPåè®®ä¸å„ç§åº”ç”¨å±‚åè®®ä¹‹é—´ï¼Œä¸ºæ•°æ®é€šè®¯æä¾›å®‰å…¨æ”¯æŒã€‚ ISOCè¿™ä¸ªç»„ç»‡ åœ¨SSLçš„åŸºç¡€ä¸Šå‘å¸ƒäº†å‡çº§ç‰ˆæœ¬ TLS1.2 TLSï¼ˆTransport Layer Securityï¼Œä¼ è¾“å±‚å®‰å…¨ï¼‰ï¼šå…¶å‰èº«æ˜¯SSLï¼Œå®ƒæœ€åˆçš„å‡ ä¸ªç‰ˆæœ¬ï¼ˆSSL 1.0ã€SSL 2.0ã€SSL 3.0ï¼‰ç”±ç½‘æ™¯å…¬å¸å¼€å‘ï¼Œ1999å¹´ä»3.1 å¼€å§‹è¢«IETFæ ‡å‡†åŒ–å¹¶æ”¹åï¼Œå‘å±•è‡³ä»Šå·²ç»æœ‰ TLS 1.0ã€TLS 1.1ã€TLS 1.2 ä¸‰ä¸ªç‰ˆæœ¬ã€‚SSL3.0å’ŒTLS1.0ç”±äºå­˜åœ¨å®‰å…¨æ¼æ´ï¼Œå·²ç»å¾ˆå°‘è¢«ä½¿ç”¨åˆ°ã€‚ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„æ˜¯TLS 1.1ã€TLS 1.2ã€‚ HTTPSçš„å·¥ä½œåŸç†å‡è®¾Aè¦ç»™Bå‘â€œæˆ‘çˆ±ä½ â€ å¯¹ç§°åŠ è§£å¯†å¦‚æœä½¿ç”¨å¯¹ç§°åŠ è§£å¯† Bæœ‰å¯†é’¥ï¼Œå¯ä»¥è¿›è¡Œç›¸åº”çš„è§£å¯†ã€‚ç”±äºå¯†é’¥æ˜¯å…¬å¼€çš„ï¼Œæ‰€æœ‰çš„å®¢æˆ·ç«¯éƒ½å¯ä»¥æ‹¿åˆ°ï¼Œå¦‚å›¾ï¼š è‹¥ï¼Œé’ˆå¯¹ä¸åŒçš„å®¢æˆ·ç«¯ä½¿ç”¨ä¸åŒçš„å¯†é’¥ åˆä¼šå‡ºç°åå•†é—®é¢˜ï¼šç”±äºæ²¡æœ‰å…¬å…±çš„å¯†é’¥äº†ï¼ŒæœåŠ¡ç«¯è¦ç»™æ¯ä¸ªå®¢æˆ·ç«¯å‘å¯†é’¥ï¼Œä½†åå•†è¿‡ç¨‹æ˜¯æ²¡æœ‰åŠ å¯†çš„ï¼Œæ‰€ä»¥è¿˜ä¼šå‡ºç°è¢«æˆªæ–­çš„é—®é¢˜ éå¯¹ç§°åŠ è§£å¯†éå¯¹ç§°ï¼šå…¬é’¥å’Œç§é’¥çš„æ¦‚å¿µ é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼š å®¢æˆ·ç«¯å¦‚ä½•æ‹¿åˆ°å…¬é’¥ï¼Ÿ æ–¹æ¡ˆï¼š æœåŠ¡å™¨ç«¯æŠŠå…¬é’¥å‘é€ç»™æ¯ä¸€ä¸ªå®¢æˆ·ç«¯ æœåŠ¡å™¨ç«¯æŠŠå…¬é’¥æ”¾åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯å¯ä»¥è¯·æ±‚åˆ° è®©æµè§ˆå™¨ä¿å­˜æ‰€æœ‰çš„å…¬é’¥ï¼ˆä¸ç°å®ï¼‰ ç»“è®ºï¼š å…¬é’¥è¢«è°ƒåŒ…çš„é—®é¢˜æŒ‰ç…§ä¸Šé¢çš„æ–¹æ¡ˆï¼Œæ°¸è¿œå­˜åœ¨ã€‚ ç¬¬ä¸‰æ–¹æœºæ„ä¸æ•°å­—è¯ä¹¦è¿™æ—¶å€™å‡ºç°äº†é€šè¿‡ç¬¬ä¸‰æ–¹æœºæ„ï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹æœºæ„çš„ç§é’¥å¯¹æˆ‘ä»¬éœ€è¦ä¼ è¾“çš„å…¬é’¥è¿›è¡ŒåŠ å¯†ã€‚ æ•°å­—è¯ä¹¦æ˜¯ä¸€ä¸ªç»è¯ä¹¦æˆæƒä¸­å¿ƒæ•°å­—ç­¾åçš„åŒ…å«å…¬å¼€å¯†é’¥æ‹¥æœ‰è€…ä¿¡æ¯ä»¥åŠå…¬å¼€å¯†é’¥çš„æ–‡ä»¶ã€‚ æ•°å­—è¯ä¹¦é‡Œé¢åŒ…å«çš„å†…å®¹ï¼š å…¬å¸ä¿¡æ¯ã€ç½‘ç«™ä¿¡æ¯ã€æ•°å­—è¯ä¹¦çš„ç®—æ³•ã€å…¬é’¥ è¿æ¥è¿‡ç¨‹ å¦‚ä½•æŸ¥çœ‹å…¬é’¥ï¼Ÿæµè§ˆå™¨æœ‰å…¥å£ç›´æ¥æ‰“å¼€ã€‚ Charlesä¹Ÿå¯ä»¥æ›´æ”¹æ·»åŠ SSL æ€»ä½“æµç¨‹ å®¢æˆ·ç«¯å‘èµ·ä¸€ä¸ªhttpsè¯·æ±‚ a) å®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†æ–¹å¼ b) å®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºæ•°ï¼ˆç¬¬ä¸€ä¸ªéšæœºæ•°ï¼‰ æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚åï¼Œæ‹¿åˆ°éšæœºæ•°ï¼Œè¿”å› a) è¯ä¹¦ï¼ˆé¢å‘æœºæ„ï¼ˆCAï¼‰ã€è¯ä¹¦å†…å®¹æœ¬èº«çš„æ•°å­—ç­¾åï¼ˆä½¿ç”¨ç¬¬ä¸‰æ–¹æœºæ„çš„ç§é’¥åŠ å¯†ï¼‰ã€è¯ä¹¦æŒæœ‰è€…çš„å…¬é’¥ã€è¯ä¹¦ç­¾åç”¨åˆ°çš„hashç®—æ³•ï¼‰ b) ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ï¼ˆç¬¬äºŒä¸ªéšæœºæ•°ï¼‰ å®¢æˆ·ç«¯æ‹¿åˆ°è¯ä¹¦ä»¥ååšéªŒè¯ a) æ ¹æ®é¢å‘æœºæ„æ‰¾åˆ°æœ¬åœ°çš„è·Ÿè¯ä¹¦ b) æ ¹æ®CAå¾—åˆ°æ ¹è¯ä¹¦çš„å…¬é’¥ï¼Œé€šè¿‡å…¬é’¥å¯¹æ•°å­—ç­¾åè§£å¯†ï¼Œå¾—åˆ°è¯ä¹¦çš„å†…å®¹æ‘˜è¦ A c) ç”¨è¯ä¹¦æä¾›çš„ç®—æ³•å¯¹è¯ä¹¦å†…å®¹è¿›è¡Œæ‘˜è¦ï¼Œå¾—åˆ°æ‘˜è¦ B d) é€šè¿‡Aå’ŒBçš„å¯¹æ¯”ï¼Œä¹Ÿå°±æ˜¯éªŒè¯æ•°å­—ç­¾å éªŒè¯é€šè¿‡ä»¥åï¼Œç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼ˆç¬¬ä¸‰ä¸ªéšæœºæ•°ï¼‰ï¼Œé€šè¿‡è¯ä¹¦å†…çš„å…¬é’¥å¯¹è¿™ä¸ªéšæœºæ•°åŠ å¯†ï¼Œå‘é€ç»™æœåŠ¡å™¨ç«¯ ï¼ˆéšæœºæ•°1+2+3ï¼‰é€šè¿‡å¯¹ç§°åŠ å¯†å¾—åˆ°ä¸€ä¸ªå¯†é’¥ã€‚ï¼ˆä¼šè¯å¯†é’¥ï¼‰ é€šè¿‡ä¼šè¯å¯†é’¥å¯¹å†…å®¹è¿›è¡Œå¯¹ç§°åŠ å¯†ä¼ è¾“ HTTPSçš„ä¼˜ç‚¹1ã€SEOæ–¹é¢ è°·æ­Œæ›¾åœ¨2014å¹´8æœˆä»½è°ƒæ•´æœç´¢å¼•æ“ç®—æ³•ï¼Œå¹¶ç§°â€œæ¯”èµ·åŒç­‰HTTPç½‘ç«™ï¼Œé‡‡ç”¨HTTPSåŠ å¯†çš„ç½‘ç«™åœ¨æœç´¢ç»“æœä¸­çš„æ’åå°†ä¼šæ›´é«˜â€ã€‚ 2ã€å®‰å…¨æ€§ å°½ç®¡HTTPSå¹¶éç»å¯¹å®‰å…¨ï¼ŒæŒæ¡æ ¹è¯ä¹¦çš„æœºæ„ã€æŒæ¡åŠ å¯†ç®—æ³•çš„ç»„ç»‡åŒæ ·å¯ä»¥è¿›è¡Œä¸­é—´äººå½¢å¼çš„æ”»å‡»ï¼Œä½†HTTPSä»æ˜¯ç°è¡Œæ¶æ„ä¸‹æœ€å®‰å…¨çš„è§£å†³æ–¹æ¡ˆï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªå¥½å¤„ï¼š ï¼ˆ1ï¼‰ä½¿ç”¨HTTPSåè®®å¯è®¤è¯ç”¨æˆ·å’ŒæœåŠ¡å™¨ï¼Œç¡®ä¿æ•°æ®å‘é€åˆ°æ­£ç¡®çš„å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ï¼› ï¼ˆ2ï¼‰HTTPSåè®®æ˜¯ç”±SSL+HTTPåè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œè¦æ¯”httpåè®®å®‰å…¨ï¼Œå¯é˜²æ­¢æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«çªƒå–ã€æ”¹å˜ï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ã€‚ ï¼ˆ3ï¼‰HTTPSæ˜¯ç°è¡Œæ¶æ„ä¸‹æœ€å®‰å…¨çš„è§£å†³æ–¹æ¡ˆï¼Œè™½ç„¶ä¸æ˜¯ç»å¯¹å®‰å…¨ï¼Œä½†å®ƒå¤§å¹…å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„æˆæœ¬ã€‚ HTTPSçš„ç¼ºç‚¹ï¼ˆ1ï¼‰SSLè¯ä¹¦è´¹ç”¨å¾ˆé«˜ï¼Œä»¥åŠå…¶åœ¨æœåŠ¡å™¨ä¸Šçš„éƒ¨ç½²ã€æ›´æ–°ç»´æŠ¤éå¸¸ç¹ç ï¼ˆ2ï¼‰HTTPSé™ä½ç”¨æˆ·è®¿é—®é€Ÿåº¦ï¼ˆå¤šæ¬¡æ¡æ‰‹ï¼‰ ï¼ˆ3ï¼‰ç½‘ç«™æ”¹ç”¨HTTPSä»¥åï¼Œç”±HTTPè·³è½¬åˆ°HTTPSçš„æ–¹å¼å¢åŠ äº†ç”¨æˆ·è®¿é—®è€—æ—¶ï¼ˆå¤šæ•°ç½‘ç«™é‡‡ç”¨302è·³è½¬ï¼‰ ï¼ˆ4ï¼‰HTTPSæ¶‰åŠåˆ°çš„å®‰å…¨ç®—æ³•ä¼šæ¶ˆè€—CPUèµ„æºï¼Œéœ€è¦å¢åŠ å¤§é‡æœºå™¨ï¼ˆhttpsè®¿é—®) ï¼ˆ5ï¼‰HTTPSåè®®çš„åŠ å¯†èŒƒå›´ä¹Ÿæ¯”è¾ƒæœ‰é™ï¼Œåœ¨é»‘å®¢æ”»å‡»ã€æ‹’ç»æœåŠ¡æ”»å‡»ã€æœåŠ¡å™¨åŠ«æŒç­‰æ–¹é¢å‡ ä¹èµ·ä¸åˆ°ä»€ä¹ˆä½œç”¨ã€‚ httpä¸httpsçš„åŒºåˆ«HTTPçš„URLä»¥ http://å¼€å¤´ï¼Œè€ŒHTTPSçš„URLä»¥https://å¼€å¤´ã€‚ HTTPæ˜¯ä¸å®‰å…¨çš„ï¼Œè€ŒHTTPSæ˜¯å®‰å…¨çš„ã€‚ HTTPæ ‡å‡†ç«¯å£æ˜¯80 ï¼Œè€ŒHTTPSçš„æ ‡å‡†ç«¯å£æ˜¯443ã€‚ åœ¨OSIç½‘ç»œæ¨¡å‹ä¸­ï¼ŒHTTPå·¥ä½œäºåº”ç”¨å±‚ï¼Œè€ŒHTTPSå·¥ä½œåœ¨ä¼ è¾“å±‚ã€‚ HTTPæ— éœ€åŠ å¯†ï¼Œè€ŒHTTPSå¯¹ä¼ è¾“çš„æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚ HTTPæ— éœ€è¯ä¹¦ï¼Œè€ŒHTTPSéœ€è¦è®¤è¯è¯ä¹¦ã€‚ RESTfulREST ï¼šè¡¨è¿°æ€§çŠ¶æ€è½¬ç§» RESTfulæ˜¯ä½¿ç”¨WEBæ ‡å‡†æ¥åšä¸€äº›å‡†åˆ™å’Œçº¦æŸã€‚ RESTfulçš„åŸºæœ¬æ¦‚å¿µï¼š åœ¨RESTä¸­ï¼Œä¸€åˆ‡çš„å†…å®¹éƒ½è¢«è®¤ä¸ºæ˜¯ä¸€ç§èµ„æº æ¯ä¸ªèµ„æºéƒ½ç”±URIå”¯ä¸€æ ‡è¯† ä½¿ç”¨ç»Ÿä¸€çš„æ¥å£å¤„ç†èµ„æºè¯·æ±‚ï¼ˆPOST/GET/PUT/DELETE/HEADï¼‰ æ— çŠ¶æ€ èµ„æºå’ŒURI [/]è¡¨ç¤ºèµ„æºçš„å±‚çº§å…³ç³» ï¼Ÿè¿‡æ»¤èµ„æº ä½¿ç”¨_æˆ–è€…-è®©URIçš„å¯è¯»æ€§æ›´å¥½ ç»Ÿä¸€æ¥å£ GET è·å–æŸä¸ªèµ„æºã€‚ å¹‚ç­‰ POST åˆ›å»ºä¸€ä¸ªæ–°çš„èµ„æº PUT æ›¿æ¢æŸä¸ªå·²æœ‰çš„èµ„æºï¼ˆæ›´æ–°æ“ä½œï¼‰ ï¼Œ å¹‚ç­‰ DELETE åˆ é™¤æŸä¸ªèµ„æº PATCH/HEAD æ›´æ–°éƒ¨åˆ†èµ„æº èµ„æºè¡¨è¿°å®¢æˆ·ç«¯é€šè¿‡HTTPè·å–èµ„æº MIME ç±»å‹ï¼ˆï¼‰ accept: text/xml htmlæ–‡ä»¶ Content-Typeå‘Šè¯‰å®¢æˆ·ç«¯èµ„æºçš„è¡¨è¿°å½¢å¼ èµ„æºé“¾æ¥ è¶…åª’ä½“å³åº”ç”¨çŠ¶æ€å¼•æ“ çŠ¶æ€è½¬ç§»æœåŠ¡å™¨ç«¯ä¸åº”è¯¥ä¿å­˜å®¢æˆ·ç«¯çŠ¶æ€ã€‚ åº”ç”¨çŠ¶æ€- &gt;æœåŠ¡å™¨ç«¯ä¸ä¿å­˜åº”ç”¨çŠ¶æ€ å‚è€ƒæ–‡çŒ®ç™¾åº¦ç™¾ç§‘ æ„Ÿè°¢ï¼ ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹~]]></content>
      <tags>
        <tag>æŠ€æœ¯</tag>
        <tag>å­¦å¥½åˆ†å¸ƒå¼æ¶æ„</tag>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å­¦å¥½åˆ†å¸ƒå¼æ¶æ„=3=-åˆ†å¸ƒå¼äº‹åŠ¡]]></title>
    <url>%2F2018%2F08%2F16%2F%E5%AD%A6%E5%A5%BD%E5%88%86%E5%B8%83%E5%BC%8F%E6%9E%B6%E6%9E%84-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%2F</url>
    <content type="text"><![CDATA[è¿™æ˜¯ç¬¬äº”æœŸæ–‡ç« ã€‚è¿™ä¸€æœŸæˆ‘ä»¬èŠèŠåˆ†å¸ƒå¼äº‹åŠ¡ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ æ•°æ®åº“å•æœºäº‹åŠ¡è¦äº†è§£åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œé¦–å…ˆè¦æ˜ç™½ä»€ä¹ˆæ˜¯â€œäº‹åŠ¡â€ã€‚ã€‚ å¯ä»¥å‚è€ƒäº‹åŠ¡çš„å®šä¹‰ï¼š äº‹åŠ¡æ—¶æ•°æ®åº“è¿è¡Œä¸­çš„ä¸€ä¸ªé€»è¾‘å·¥ä½œå•å…ƒï¼Œå·¥ä½œå•å…ƒå†…çš„ä¸€ç³»åˆ—SQLå‘½ä»¤å…·æœ‰åŸå­æ€§æ“ä½œçš„ç‰¹ç‚¹ï¼Œè¿™äº›å‘½ä»¤è¦ä¹ˆå®Œå…¨æˆåŠŸè¿è¡Œï¼Œè¦ä¹ˆå®Œå…¨æ’¤é”€æˆ–è€…ä¸æ‰§è¡Œï¼Œå¦‚æœæ—¶åè€…ï¼Œåˆ™è¡¨ç°ä¸ºæ•°æ®åº“å†…çš„æœ€ç»ˆæ•°æ®æ²¡æœ‰å‘ç”Ÿæ”¹å˜ã€‚ æ•°æ®åº“äº‹åŠ¡æ»¡è¶³4ä¸ªè¦æ±‚ï¼š åŸå­æ€§ï¼šäº‹åŠ¡å¿…é¡»æ—¶åŸå­å·¥ä½œå•å…ƒï¼Œå¯¹å…¶è¿›è¡Œæ•°æ®ä¿®æ”¹ï¼Œè¦ä¹ˆå…¨éƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œ ä¸€è‡´æ€§ï¼šäº‹åŠ¡åœ¨å®Œæˆæ—¶ï¼Œå¿…é¡»ä½¿æ‰€æœ‰æ•°æ®éƒ½ä¿æŒä¸€è‡´çš„çŠ¶æ€ï¼Œäº‹åŠ¡ç»“æŸæ—¶ï¼Œæ‰€æœ‰å†…éƒ¨æ•°æ®ç»“æ„éƒ½å¿…é¡»æ—¶æ­£ç¡®çš„ éš”ç¦»æ€§ï¼šç”±å¹¶å‘äº‹åŠ¡åšå‡ºçš„ä¿®æ”¹å¿…é¡»å’Œå…¶ä»–å¹¶å‘äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹éš”ç¦» æŒä¹…æ€§ï¼šäº‹åŠ¡å®Œæˆåï¼Œå¯¹ç³»ç»Ÿçš„å½±å“æ—¶æ°¸ä¹…çš„ è¿™å…¶ä¸­åŸå­æ€§ï¼Œéœ€è¦è®°å½•æ“ä½œè¿‡ç¨‹å’Œå¯¹åº”ç»“æœï¼Œä»¥ä¾¿äºå›é€€ï¼›è€Œéš”ç¦»æ€§ï¼Œéœ€è¦äº§ç”Ÿé”ï¼›è¿™ä¸¤ç§è¦æ±‚ï¼Œå¯¼è‡´æ•°æ®åº“äº‹åŠ¡æ‰§è¡Œä»£ä»·è¦è¿œé«˜äºéäº‹åŠ¡æ€§æ“ä½œ MySQLæ‰§è¡Œäº‹åŠ¡åœ¨MySQLé‡Œï¼Œäº‹åŠ¡ç›¸å…³çš„æ—¥å¿—ä¸ºredoå’Œundoä¸¤ä¸ªæ–‡ä»¶ï¼Œredo logè®°å½•äº‹åŠ¡ä¿®æ”¹åçš„æ•°æ®ï¼Œundo logè®°å½•äº‹åŠ¡å‰çš„æ•°æ® ä¸‹é¢æ—¶MySQLæ‰§è¡Œäº‹åŠ¡çš„ç®€åŒ–æµç¨‹ï¼š å…ˆè®°å½•undo/redo log ï¼Œç¡®ä¿æ—¥å¿—å†™å…¥ç¡¬ç›˜ æ›´æ–°æ•°æ®è®°å½•ï¼Œç¼“å­˜æ“ä½œå¹¶å¼‚æ­¥åˆ·æ–°ç¡¬ç›˜ commitäº‹åŠ¡æ“ä½œã€‚å…ˆæ¸…ç†undoä¿¡æ¯ï¼Œç„¶åé‡Šæ”¾é”èµ„æºï¼Œåœ¨redoä¸­å†™å…¥commitæ“ä½œï¼Œåˆ·æ–°åç¡®ä¿redoå®Œæˆå¹¶å­˜åœ¨ç¡¬ç›˜ä¸­ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ•°æ®åº“çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚ å¯ä»¥çœ‹åˆ°ï¼Œå¾ˆå¤šæ“ä½œï¼Œè­¬å¦‚å†™æ—¥å¿—ä»¥é˜²å›æ»šï¼Œéƒ½æ˜¯åœ¨å†™commitä¹‹å‰å®Œæˆçš„ã€‚commitæŒ‡ä»¤åœ¨äº‹åŠ¡ä¸­æ‰€å æ—¶é—´éå¸¸å°‘ï¼Œè¿™å°±æ—¶äº‹åŠ¡çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹ã€‚ X/OpenDTPäº‹åŠ¡æ¨¡å‹åˆ†å¸ƒå¼äº‹åŠ¡ä¸­ï¼Œä¸€ä¸ªäº‹åŠ¡å†…çš„SQLå¾€å¾€æ“ä½œå¾ˆå¤šæ•°æ®åº“ï¼Œä¹Ÿè¦ä¿è¯äº‹åŠ¡çš„4ä¸ªè¦æ±‚ã€‚æ‰€ä»¥å°±æœ‰X/OpenDTPè¿™ä¸ªè§„èŒƒäº† X/Open DTP å®šä¹‰äº†ä¸‰ä¸ªè§’è‰²ï¼š APï¼ŒTMï¼ŒRM AP(Application Program)ï¼šä¹Ÿå°±æ˜¯åº”ç”¨ç¨‹åºï¼Œå¯ä»¥ç†è§£ä¸ºä½¿ç”¨DTPçš„ç¨‹åºï¼Œæˆ‘ä»¬crudçš„ä»£ç å°±æ˜¯è¿™ä¸ª RM(Resource Manager)ï¼šèµ„æºç®¡ç†å™¨ï¼Œè¿™é‡Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªDBMSç³»ç»Ÿï¼Œæˆ–è€…æ¶ˆæ¯æœåŠ¡å™¨ç®¡ç†ç³»ç»Ÿï¼Œåº”ç”¨ç¨‹åºé€šè¿‡èµ„æºç®¡ç†å™¨å¯¹èµ„æºè¿›è¡Œæ§åˆ¶ã€‚èµ„æºå¿…é¡»å®ç°XAå®šä¹‰çš„æ¥å£ TM(Transaction Manager)ï¼šäº‹åŠ¡ç®¡ç†å™¨ï¼Œè´Ÿè´£åè°ƒå’Œç®¡ç†äº‹åŠ¡ï¼Œæä¾›ç»™APåº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ä»¥åŠç®¡ç†èµ„æºç®¡ç†å™¨ å…¶ä¸­ï¼ŒAP å¯ä»¥å’ŒTM ä»¥åŠ RM é€šä¿¡ï¼ŒTM å’Œ RM äº’ç›¸ä¹‹é—´å¯ä»¥é€šä¿¡ï¼ŒDTPæ¨¡å‹é‡Œé¢å®šä¹‰äº†XAæ¥å£ï¼ŒTM å’Œ RM é€šè¿‡XAæ¥å£è¿›è¡ŒåŒå‘é€šä¿¡ï¼Œä¾‹å¦‚:TMé€šçŸ¥RMæäº¤äº‹åŠ¡æˆ–è€…å›æ»šäº‹åŠ¡ï¼ŒRMæŠŠæäº¤ç»“æœé€šçŸ¥ç»™TMã€‚APå’ŒRMä¹‹é—´åˆ™é€šè¿‡RMæä¾›çš„Native API è¿›è¡Œèµ„æºæ§åˆ¶ï¼Œè¿™ä¸ªæ²¡æœ‰è¿›è¡Œçº¦APIå’Œè§„èŒƒï¼Œå„ä¸ªå‚å•†è‡ªå·±å®ç°è‡ªå·±çš„èµ„æºæ§åˆ¶ï¼Œæ¯”å¦‚Oracleè‡ªå·±çš„æ•°æ®åº“é©±åŠ¨ç¨‹åºã€‚ å…¶ä¸­åœ¨DTPå®šäº†ä»¥ä¸‹å‡ ä¸ªæ¦‚å¿µï¼š äº‹åŠ¡ï¼šä¸€ä¸ªäº‹åŠ¡æ˜¯ä¸€ä¸ªå®Œæ•´çš„å·¥ä½œå•å…ƒï¼Œç”±å¤šä¸ªç‹¬ç«‹çš„è®¡ç®—ä»»åŠ¡ç»„æˆï¼Œè¿™å¤šä¸ªä»»åŠ¡åœ¨é€»è¾‘ä¸Šæ˜¯åŸå­çš„ã€‚ å…¨å±€äº‹åŠ¡ï¼šå¯¹äºä¸€æ¬¡æ€§æ“ä½œå¤šä¸ªèµ„æºç®¡ç†å™¨çš„äº‹åŠ¡ï¼Œå°±æ˜¯å…¨å±€äº‹åŠ¡ åˆ†æ”¯äº‹åŠ¡ï¼šåœ¨å…¨å±€äº‹åŠ¡ä¸­ï¼ŒæŸä¸€ä¸ªèµ„æºç®¡ç†å™¨æœ‰è‡ªå·±ç‹¬ç«‹çš„ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡çš„é›†åˆä½œä¸ºè¿™ä¸ªèµ„æºç®¡ç†å™¨çš„åˆ†æ”¯ä»»åŠ¡ æ§åˆ¶çº¿ç¨‹ï¼šç”¨æ¥è¡¨ç¤ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œä¸»è¦æ˜¯å…³è”AP,TM,RMä¸‰è€…çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯äº‹åŠ¡ä¸Šä¸‹æ–‡ç¯å¢ƒã€‚ç®€å•çš„è¯´ï¼Œå°±æ˜¯éœ€è¦æ ‡è¯†ä¸€ä¸ªå…¨å±€äº‹åŠ¡ä»¥åŠåˆ†æ”¯äº‹åŠ¡çš„å…³ç³»ã€‚ ä¸¤é˜¶æ®µæäº¤åè®®ä¸‹é¢è¯´è¯´è¿™ä¸ªæ¨¡å‹ä¸­æœ€è‘—åçš„äºŒé˜¶æ®µæäº¤åè®® å½“ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡æ‰€è®¾è®¡çš„SQLéƒ½æ‰§è¡Œå®Œæˆï¼Œæ‰“äº†RMæœ€åæäº¤äº‹åŠ¡çš„æ—¶å€™ï¼Œä¸ºäº†é¿å…åˆ†å¸ƒå¼ç³»ç»Ÿæ‰€å›ºæœ‰çš„ä¸å¯é æ€§å¯¼è‡´æäº¤äº‹åŠ¡å¤±è´¥ï¼ŒTMè¿™æ—¶å€™ä¼šèµ°äºŒé˜¶æ®µæäº¤åè®® ä¸¤é˜¶æ®µæäº¤åè®®ï¼šå¦‚æœä¸€ä¸ªäº‹åŠ¡ç®¡ç†å™¨ç®¡ç†ç€å¤šä¸ªèµ„æºç®¡ç†å™¨ï¼Œå¦‚æœæ§åˆ¶å…¨å±€äº‹åŠ¡å’Œåˆ†æ”¯äº‹åŠ¡ï¼Œåœ¨DTPé‡Œé¢è¯´æ˜ä¸¤é˜¶æ®µæäº¤çš„åè®® ç¬¬ä¸€é˜¶æ®µï¼šå‘èµ·æŠ•ç¥¨è¡¨å†³ é€šçŸ¥æ‰€æœ‰RMå…ˆå®Œæˆäº‹åŠ¡æäº¤æ¶‰åŠçš„å¤æ‚å‡†å¤‡å·¥ä½œï¼Œè­¬å¦‚ä¸Šæ–‡æåˆ°çš„redoæ—¥å¿—ï¼Œå°½é‡æŠŠæäº¤è¿‡ç¨‹ä¸­æ‰€æœ‰æ¶ˆè€—æ—¶é—´çš„å·¥ä½œæå‰å®Œæˆï¼Œç¡®ä¿åé¢äº‹åŠ¡100%æˆåŠŸ ç¬¬äºŒé˜¶æ®µï¼šæ­£å¼æäº¤ TMå°†ç¬¬ä¸€é˜¶æ®µçš„ç»“æœè¿›è¡Œå†³ç­–ï¼Œå³æäº¤æˆ–å–æ¶ˆäº‹åŠ¡ã€‚å½“ä¸”ä»…å½“æ‰€æœ‰å‚ä¸çš„RMåŒæ„æäº¤æ—¶ï¼ŒTMæ‰é€šçŸ¥æ‰€æœ‰RMæ­£å¼æäº¤äº‹åŠ¡ï¼Œå¦åˆ™åˆ™å–æ¶ˆäº‹åŠ¡ã€‚ ä¸‹é¢å¼•ç”¨å‚è€ƒæ–‡çŒ®çš„ä¸€å¹…å›¾ï¼Œè¯¦ç»†æ¼”ç¤ºäº†æ­£å¸¸æƒ…å†µä¸‹çš„ä¸¤é˜¶æ®µæäº¤ï¼Œ å¦‚æœç¬¬ä¸€é˜¶æ®µæŸä¸€ä¸ªèµ„æºé¢„æäº¤å¤±è´¥ï¼Œç¬¬äºŒé˜¶æ®µå°±å›æ»šç¬¬ä¸€é˜¶æ®µå·²ç»é¢„æäº¤æˆåŠŸçš„èµ„æº ä»¥ä¸Šæ˜¯æ¯”è¾ƒæ­£å¸¸çš„æƒ…å†µï¼Œä½†æ˜¯ç”±äºRMæœ‰æƒåˆ©è‡ªå·±æ ¹æ®æƒ…å†µæäº¤æˆ–è€…å›æ»šè‡ªå·±çš„åˆ†æ”¯äº‹åŠ¡ï¼ˆå®˜æ–¹è¯´æ³•æ˜¯ï¼šHeuristic Decisionï¼‰é‚£ä¸‰ä¹ˆå°±å¯èƒ½å‡ºç°ä»¥ä¸‹ç§æƒ…å†µï¼š 1 åœ¨TMé€šçŸ¥RMæäº¤äº‹åŠ¡ä¹‹å‰ï¼ŒRMåˆ†æ”¯äº‹åŠ¡å·²ç»æäº¤ 2 åœ¨TMé€šçŸ¥RMæäº¤äº‹åŠ¡ä¹‹å‰ï¼ŒRMåˆ†æ”¯äº‹åŠ¡å…¨éƒ¨å›æ»š 3 åœ¨TMé€šçŸ¥RMæäº¤äº‹åŠ¡ä¹‹å‰ï¼ŒRMåˆ†æ”¯äº‹åŠ¡éƒ¨åˆ†å›æ»š äº’è”ç½‘ä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆä¸‹é¢ä»‹ç»ä¸‰ç§äº’è”ç½‘ä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ ç¬¬ä¸€ç§ï¼šä¸ç”¨åˆ†å¸ƒå¼è¿™ä¸ªæ–¹æ¡ˆæ—¶å°†ä¸€ä¸ªä¸šåŠ¡æµç¨‹ä¸­éœ€è¦åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œå¤šä¸ªç›¸å…³ä¸šåŠ¡æ¥å£åŒ…è£…åˆ°ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œä»è€Œé¿å…åˆ†å¸ƒå¼äº‹åŠ¡ã€‚ ç¬¬äºŒç§ï¼šeBayæ–¹æ¡ˆç¬¬ä¸‰ç§ï¼š æ”¯ä»˜å®DTSæ¡†æ¶å‚è€ƒèµ„æ–™X/Open DTP(X/Open Distributed Transaction Processing Reference Model) æ„Ÿè°¢ ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹ï¼Œå’±ä»¬ä¸¤ä¸ªæƒ³ä¸ªå·ç ï¼Œ ä¹°ä¸ªå½©ç¥¨ï¼Œå…ˆæŒ£ä»–ä¸ªå‡ ç™¾ä¸‡ğŸ˜]]></content>
      <tags>
        <tag>æŠ€æœ¯</tag>
        <tag>å­¦å¥½åˆ†å¸ƒå¼æ¶æ„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å­¦å¥½åˆ†å¸ƒå¼æ¶æ„=1=-TCP/IP]]></title>
    <url>%2F2018%2F08%2F16%2F%E6%88%91%E8%A6%81%E5%AD%A6%E5%A5%BD%E5%88%86%E5%B8%83%E5%BC%8F-TCP-IP%2F</url>
    <content type="text"><![CDATA[åˆ†å¸ƒå¼ä¸ç½‘ç»œäº’è”å°¤ä¸ºå¯†åˆ‡ï¼Œè€ŒTCP/IPï¼ˆä¼ è¾“æ§åˆ¶åè®®/äº’è”ç½‘ç»œåè®®ï¼‰æ˜¯ç½‘ç»œä¸­æœ€åŸºæœ¬çš„åè®®ã€‚TCP/IPç»“åˆDNSã€è·¯ç”±ç›¸å…³çš„åè®®æœ€ç»ˆå®ç°çš„äº†ç½‘ç»œçš„ä»»æ„ä¸¤ç‚¹çš„æ•°æ®é€šä¿¡é—®é¢˜ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ã€‚ åè®®æ€ä¹ˆåˆ†å±‚çš„å‘¢ï¼Ÿæåˆ°åè®®åˆ†å±‚ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“è”æƒ³åˆ°ISO-OSIçš„ä¸ƒå±‚åè®®ç»å…¸æ¶æ„ï¼Œä½†æ˜¯TCP/IPåè®®æ—çš„ç»“æ„åˆ™ç¨æœ‰ä¸åŒã€‚ OSIä¸ƒå±‚ç½‘ç»œæ¨¡å‹ TCP/IPå››å±‚æ¦‚å¿µæ¨¡å‹ å¯¹åº”ç½‘ç»œåè®® åº”ç”¨å±‚ï¼ˆApplicationï¼‰ åº”ç”¨å±‚ HTTPã€TFTP, FTP, NFS, WAISã€SMTP è¡¨ç¤ºå±‚ï¼ˆPresentationï¼‰ Telnet, Rlogin, SNMP, Gopher ä¼šè¯å±‚ï¼ˆSessionï¼‰ SMTP, DNS ä¼ è¾“å±‚ï¼ˆTransportï¼‰ ä¼ è¾“å±‚ TCP, UDP ç½‘ç»œå±‚ï¼ˆNetworkï¼‰ ç½‘ç»œå±‚ IP, ICMP, ARP, RARP, AKP, UUCP æ•°æ®é“¾è·¯å±‚ï¼ˆData Linkï¼‰ æ•°æ®é“¾è·¯å±‚ FDDI, Ethernet, Arpanet, PDN, SLIP, PPP ç‰©ç†å±‚ï¼ˆPhysicalï¼‰ IEEE 802.1A, IEEE 802.2åˆ°IEEE 802.11 TCP/IPåè®®æ—æŒ‰ç…§å±‚æ¬¡ç”±ä¸Šåˆ°ä¸‹ï¼Œå±‚å±‚åŒ…è£…ã€‚ æœ€ä¸Šé¢çš„å°±æ˜¯åº”ç”¨å±‚äº†ï¼Œè¿™é‡Œé¢æœ‰httpï¼Œftp,ç­‰ç­‰æˆ‘ä»¬ç†Ÿæ‚‰çš„åè®®ã€‚ ç¬¬äºŒå±‚åˆ™æ˜¯ä¼ è¾“å±‚ï¼Œè‘—åçš„TCPå’ŒUDPåè®®å°±åœ¨è¿™ä¸ªå±‚æ¬¡ï¼Œæˆ‘ä»¬ç†ŸçŸ¥çš„ç½‘é¡µå¤§éƒ¨åˆ†æ˜¯ç”±TCPä¼ è¾“çš„ï¼Œè€Œç©çš„æ¸¸æˆå¤§éƒ¨åˆ†æ˜¯ç”±UDPä¼ è¾“çš„ã€‚ ç¬¬ä¸‰å±‚æ˜¯ç½‘ç»œå±‚ï¼ŒIPåè®®å°±åœ¨è¿™é‡Œï¼Œå®ƒè´Ÿè´£å¯¹æ•°æ®åŠ ä¸ŠIPåœ°å€å’Œå…¶ä»–çš„æ•°æ®ä»¥ç¡®å®šä¼ è¾“çš„ç›®æ ‡ã€‚ ç¬¬å››å±‚æ˜¯å«æ•°æ®é“¾è·¯å±‚ï¼Œè¿™ä¸ªå±‚æ¬¡ä¸ºå¾…ä¼ é€çš„æ•°æ®åŠ å…¥ä¸€ä¸ªä»¥å¤ªç½‘åè®®å¤´ï¼Œå¹¶è¿›è¡ŒCRCç¼–ç ï¼Œä¸ºæœ€åçš„æ•°æ®ä¼ è¾“åšå‡†å¤‡ã€‚ TCP/IPå››å±‚åè®®ä¸OSIä¸ƒå±‚ç½‘ç»œæ¨¡å‹å±‚å±‚ç›¸å¯¹ï¼Œç»“æ„åˆ†æ˜ã€‚ åè®®æ˜¯ä»€ä¹ˆæ ·å­çš„å‘¢ï¼Ÿæ‰“å¼€cmdï¼ˆæœ¬äººwindowså¹³å°ï¼‰ï¼Œè¾“å…¥è¿è¡Œipconfig/all è¿™é‡Œå°±å¯ä»¥æ¸…æ¥šçš„æ˜¾ç¤ºå‡ºæ¥æˆ‘PCçš„å„ç§ç½‘è·¯ä¿¡æ¯ï¼Œç”šè‡³æˆ‘PCå‡ ä¸ªç½‘å¡éƒ½èƒ½çœ‹çš„ä¸€æ¸…äºŒæ¥šã€‚ ä¼ è¾“è¿‡ç¨‹æœ¬åœ°ä¼ è¾“å¦‚æœæˆ‘ä»¬æµè§ˆç½‘é¡µï¼Œé€šå¸¸ä¼šåœ¨æµè§ˆå™¨åœ°å€æ ä¸­æ‰“ä¸Š3ä¸ªwå’Œç½‘ç«™çš„åå­—ï¼Œå°±è­¬å¦‚æ‰“å¼€ç™¾åº¦éœ€è¦è¾“å…¥WWW.BAIDU.COMï¼Œè¿™ä¸ªåå­—å°±å«åŸŸåã€‚æˆ‘ä»¬çš„æµè§ˆå™¨ä¼šå‘ç°urlä¸­ç½‘ç«™çš„åŸŸåï¼Œç„¶åæŸ¥æ‰¾æœ¬åœ°çš„hostæ–‡ä»¶ï¼Œæ ¹æ®hostæ–‡ä»¶æŸ¥æ‰¾å“åº”çš„dnsæœåŠ¡å™¨ipåœ°å€ï¼Œç”¨UDPåè®®å‘dnsæœåŠ¡å™¨å‘é€dnsæŸ¥è¯¢å‘½ä»¤ï¼ŒdnsæœåŠ¡å™¨è·å–åˆ°æŸ¥è¯¢å‘½ä»¤å¹¶ä»ç¼“å­˜æˆ–è€…æ•°æ®åº“ä¸­æŸ¥è¯¢æ”¹åŸŸåå¯¹åº”ä¸»æœºçš„ipåœ°å€ï¼Œå†å°†è¿™ä¸ªipåœ°å€å‘åˆ°ä½ æµè§ˆå™¨ä¸Šã€‚ æœ‰ç‚¹ç»•å£ï¼Œå®é™…ä½ å¯ä»¥ä½¿ç”¨cmdçš„nslookupæ¥è·Ÿè¸ªè¿™ä¸ªè¿‡ç¨‹ã€‚ æˆ‘ä»¬çœ‹åˆ°ï¼Œä½¿ç”¨å¤šæ¬¡å‘½ä»¤æŸ¥è¯¢ï¼Œå¾—åˆ°çš„ipç»“æœæ€»æ˜¯ä¸ä¸€æ ·çš„ã€‚è¿™æ˜¯å› ä¸ºdnsæœ‰è´Ÿè½½å‡è¡¡æœºåˆ¶ï¼ŒæœåŠ¡å™¨ä¼šæŸ¥è¯¢å¹¶è¿”å›å¤šä¸ªipåœ°å€ï¼Œæ¯æ¬¡æŸ¥è¯¢è¿”å›çš„ipåœ°å€å¯èƒ½æœ‰æ‰€ä¸åŒã€‚ æ¥ç€å¾€ä¸‹è¯´ï¼Œå½“æˆ‘ä»¬æµè§ˆå™¨è·çŸ¥è¿™ä¸ªipåœ°å€çš„æ—¶å€™ï¼Œå°±å‘è¿™ä¸ªipåœ°å€çš„80ç«¯å£ï¼ˆHTTPæ ‡å‡†ç«¯å£æ˜¯80 ï¼Œè€ŒHTTPSçš„æ ‡å‡†ç«¯å£æ˜¯443ï¼‰å‘èµ·TCPè¿æ¥ï¼Œä½†å…¶å®è¿™ä¸ªipåœ°å€å¹¶ä¸æ˜¯è®¡ç®—æœºæ‰€åœ¨çš„å±€åŸŸç½‘ï¼Œè€Œæ˜¯ä¸€ä¸ªå¹¿åŸŸç½‘åœ°å€ï¼Œæ‰€ä»¥å­ç½‘çš„ç½‘å…³å°±éœ€è¦é€šè¿‡è·¯ç”±è½¬å‘äº† è·¯ç”±äº’è”ç½‘æ˜¯ç”±å¾ˆå¤šç›¸äº’éš”ç¦»çš„å°ç½‘ç»œæ— é™å»¶ä¼¸è€Œæˆçš„ä¸€ä¸ªå¤§ç½‘ç»œï¼Œè·¯ç”±å™¨è´Ÿè´£å°†å¤šä¸ªç½‘ç»œè¿æ¥ï¼Œå¹¶äº¤æ¢è·¯ç”±è¡¨ä¿¡æ¯æ¥ç¡®å®šä¸€ä¸ªIPæŠ¥æ–‡è¦ç»è¿‡å“ªä¸ªè·¯ç”±å™¨çš„å“ªä¸ªç«¯å£å‘ç»™å“ªä¸ªäº’è”çš„å­ç½‘ã€‚ ä¸ºäº†é˜²æ­¢ä¸€ä¸ªæ•°æ®åŒ…åœ¨å‘é€è¿‡ç¨‹ä¸­å½¢æˆæ­»å¾ªç¯ï¼ŒipåŒ…ä¸­çš„TTLå­—æ®µæ¯ç»è¿‡è·¯ç”±å™¨è½¬å‘ä¸€æ¬¡ï¼Œå°±ä¼š-1ã€‚å½“TTLä¸º0æ—¶åˆ™è¢«ä¸¢å¼ƒï¼Œè®¤ä¸ºç½‘ç»œä¸å¯è¾¾ï¼Œä¸€èˆ¬é»˜è®¤çš„æœ€å¤§TTLæ˜¯30 åŒæ ·æˆ‘ä»¬å¯ä»¥ä½¿ç”¨tracertæ¥è·Ÿè¸ªè¿™ä¸ªè¿‡ç¨‹ã€‚tacertæ˜¯æ ¹æ®ICMPåè®®æ¥ç¡®å®šä¸€ä¸ªipæŠ¥æ–‡åˆ°è¾¾ç›®æ ‡åœ°å€æ‰€ç»è¿‡çš„è·¯ç”±å™¨èŠ‚ç‚¹ Socketsocketæ—¶ä¸€ä¸ªipåœ°å€ä¸ç«¯å£çš„ç»„åˆï¼Œæ˜¯è®¡ç®—æœºçš„è¿œç¨‹é€šä¿¡æ¥å£ï¼Œæœ¬åœ°ä¸€ä¸ªsocketä¸è¿œç¨‹socketè¿æ¥çš„è¿‡ç¨‹ï¼Œå°±æ˜¯ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ã€‚ ä¸‰æ¬¡æ¡æ‰‹ ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€synåŒ…(SYN = 1ï¼Œåºåˆ—å·seq = xï¼ŒSYNæŠ¥æ–‡æ®µä¸èƒ½æºå¸¦æ•°æ®ï¼Œä½†è¦æ¶ˆè€—ä¸€ä¸ªåˆå§‹åºå·)åˆ°æœåŠ¡å™¨ï¼Œå¹¶è¿›å…¥SYN_SENDçŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨ç¡®è®¤ã€‚ ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°synåŒ…ï¼Œå¿…é¡»ç¡®è®¤å®¢æˆ·çš„SYNï¼ˆack=x+1ï¼‰ï¼ŒåŒæ—¶è‡ªå·±ä¹Ÿå‘é€ä¸€ä¸ªSYNåŒ…ï¼ˆSYN=1 ACK=1 seq=yï¼ŒåŒæ ·æ¶ˆè€—ä¸€ä¸ªåºå·ï¼‰ï¼Œå³SYN+ACKåŒ…ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥SYN_RECVçŠ¶æ€ã€‚ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨çš„SYNï¼‹ACKåŒ… ï¼Œå‘æœåŠ¡å™¨å‘é€ç¡®è®¤åŒ…ACK(ACK = 1 seq = x + 1 ack = y + 1ï¼ŒACKæŠ¥æ–‡æ®µå¯ä»¥æºå¸¦æ•°æ®ï¼Œä½†å¦‚æœä¸æºå¸¦æ•°æ®åˆ™ä¸æ¶ˆè€—åºå·ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä¸‹ä¸€ä¸ªæ•°æ®æŠ¥æ–‡æ®µçš„åºå·ä»æ˜¯seq=x+1)ï¼Œæ­¤åŒ…å‘é€å®Œæ¯•ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è¿›å…¥ESTABLISHEDçŠ¶æ€ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹ã€‚ å„ä¸ªçŠ¶æ€åç§°ä¸å«ä¹‰CLOSED: è¡¨ç¤ºåˆå§‹çŠ¶æ€ã€‚LISTEN: æœåŠ¡å™¨ç«¯å¤„äºç›‘å¬çŠ¶æ€ï¼Œå¯ä»¥æ¥å—è¿æ¥ã€‚SYN_RECV: å½“æ”¶åˆ°å®¢æˆ·ç«¯çš„ACKæŠ¥æ–‡åï¼ŒæœåŠ¡å™¨ä¼šè¿›å…¥åˆ°ESTABLISHEDçŠ¶æ€ã€‚SYN_SENT: å½“å®¢æˆ·ç«¯å‘é€SYNæŠ¥æ–‡ï¼Œéšå³å®ƒä¼šè¿›å…¥åˆ°äº†SYN_SENTçŠ¶æ€ï¼Œå¹¶ç­‰å¾…æœåŠ¡ç«¯çš„å‘é€ä¸‰æ¬¡æ¡æ‰‹ä¸­çš„ç¬¬2ä¸ªæŠ¥æ–‡ã€‚ESTABLISHEDï¼šè¡¨ç¤ºè¿æ¥å·²ç»å»ºç«‹äº†ã€‚ å››æ¬¡æŒ¥æ‰‹ ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šä¸»åŠ¨å…³é—­æ–¹å‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­ä¸»åŠ¨æ–¹åˆ°è¢«åŠ¨å…³é—­æ–¹çš„æ•°æ®ä¼ é€ï¼Œä¹Ÿå°±æ˜¯ä¸»åŠ¨å…³é—­æ–¹å‘Šè¯‰è¢«åŠ¨å…³é—­æ–¹ï¼šæˆ‘å·²ç»ä¸ä¼šå†ç»™ä½ å‘æ•°æ®äº†(å½“ç„¶ï¼Œåœ¨finåŒ…ä¹‹å‰å‘é€å‡ºå»çš„æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ°å¯¹åº”çš„ackç¡®è®¤æŠ¥æ–‡ï¼Œä¸»åŠ¨å…³é—­æ–¹ä¾ç„¶ä¼šé‡å‘è¿™äº›æ•°æ®)ï¼Œä½†æ˜¯ï¼Œæ­¤æ—¶ä¸»åŠ¨å…³é—­æ–¹è¿˜å¯ä»¥æ¥å—æ•°æ®ã€‚ ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šè¢«åŠ¨å…³é—­æ–¹æ”¶åˆ°FINåŒ…åï¼Œå‘é€ä¸€ä¸ªACKç»™å¯¹æ–¹ï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°åºå·+1ï¼ˆä¸SYNç›¸åŒï¼Œä¸€ä¸ªFINå ç”¨ä¸€ä¸ªåºå·ï¼‰ã€‚ ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šè¢«åŠ¨å…³é—­æ–¹å‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­è¢«åŠ¨å…³é—­æ–¹åˆ°ä¸»åŠ¨å…³é—­æ–¹çš„æ•°æ®ä¼ é€ï¼Œä¹Ÿå°±æ˜¯å‘Šè¯‰ä¸»åŠ¨å…³é—­æ–¹ï¼Œæˆ‘çš„æ•°æ®ä¹Ÿå‘é€å®Œäº†ï¼Œä¸ä¼šå†ç»™ä½ å‘æ•°æ®äº†ã€‚ ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šä¸»åŠ¨å…³é—­æ–¹æ”¶åˆ°FINåï¼Œå‘é€ä¸€ä¸ªACKç»™è¢«åŠ¨å…³é—­æ–¹ï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°åºå·+1ï¼Œè‡³æ­¤ï¼Œå®Œæˆå››æ¬¡æŒ¥æ‰‹ã€‚ å„ä¸ªçŠ¶æ€åç§°ä¸å«ä¹‰ FIN-WAIT-1ï¼šç­‰å¾…è¿œç¨‹TCPçš„è¿æ¥ä¸­æ–­è¯·æ±‚ã€‚ FIN-WAIT-2ï¼šä»è¿œç¨‹TCPç­‰å¾…è¿æ¥ä¸­æ–­è¯·æ±‚ã€‚ CLOSE-WAITï¼šç­‰å¾…ä»æœ¬åœ°ç”¨æˆ·å‘æ¥çš„è¿æ¥ä¸­æ–­è¯·æ±‚ã€‚ CLOSINGï¼šç­‰å¾…è¿œç¨‹TCPå¯¹è¿æ¥ä¸­æ–­çš„ç¡®è®¤ã€‚ LAST-ACKï¼šç­‰å¾…åŸæ¥å‘å‘è¿œç¨‹TCPçš„è¿æ¥ä¸­æ–­è¯·æ±‚çš„ç¡®è®¤ï¼› TIME-WAITï¼šç­‰å¾…è¶³å¤Ÿçš„æ—¶é—´ä»¥ç¡®ä¿è¿œç¨‹TCPæ¥æ”¶åˆ°è¿æ¥ä¸­æ–­è¯·æ±‚çš„ç¡®è®¤ é™„å½•å¸¸è§ç«¯å£ FTP 21 telnet 23 åŸŸåæœåŠ¡å™¨ 53 POP3 110 MySQL 3306 POP-2 109 SNMP 161 SSH 22 SMTP 25 HTTP 80 NTP 123 shellæˆ–è€…cmd 514 SQL Server 1433 ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹ï¼Œå’±ä»¬ä¸¤ä¸ªæƒ³ä¸ªå·ç ï¼Œ ä¹°ä¸ªå½©ç¥¨ï¼Œå…ˆæŒ£ä»–ä¸ªå‡ ç™¾ä¸‡ğŸ˜]]></content>
      <tags>
        <tag>æŠ€æœ¯</tag>
        <tag>å­¦å¥½åˆ†å¸ƒå¼æ¶æ„</tag>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ”¶åˆ°ä¸€ä¸ªä»¤æˆ‘æ‚²ä¼¤çš„æ¶ˆæ¯]]></title>
    <url>%2F2018%2F08%2F06%2F%E6%94%B6%E5%88%B0%E4%B8%80%E4%B8%AA%E4%BB%A4%E6%88%91%E6%82%B2%E4%BC%A4%E7%9A%84%E6%B6%88%E6%81%AF%2F</url>
    <content type="text"><![CDATA[æˆ‘çš„è¯¥æ­»çš„VPSæä¾›å•†åˆè¦ç ´paoäº§luäº†ï¼Œæ°”æ­»æˆ‘ä¹Ÿã€‚æœ€è¿‘çš„vpsæœåŠ¡éƒ½ä¸èƒ½ç”¨äº†ï¼ŒMySQLä¸€è¿ä¸€ä¸ªå¤±è´¥ã€‚åæ¥ä»–ä»¬ç»™æˆ‘å‘äº†ä¸€å°é‚®ä»¶ ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘†ğŸ‘† å¤§æ¦‚æ„æ€æ˜¯ä»–ä»¬å®Œäº†ï¼Œè¦æŠŠæœºå™¨æœåŠ¡è½¬ç»™æˆ‘çš„å¦ä¸€ä¸ªè€ä¸œå®¶NFHostingï¼Œå¯¹ï¼Œæ²¡é”™ã€‚å°±æ˜¯ç»™æˆ‘æä¾›ä¸Šä¸€ä¸ªåšå®¢æœåŠ¡çš„æ•°æ®ä¸­å¿ƒã€‚ è¯¥æ­»çš„ï¼Œæˆ‘ä¸Šä¸€ä¸ªåšå®¢çš„æ•°æ®è‡³ä»Šæ²¡æ‰¾å›æ¥ï¼ è¡Œå§ï¼Œæˆ‘å·²ç»æ— æ‰€è°“äº†ã€‚å°±å½“è€ƒéªŒæˆ‘çš„è¿ç»´æ°´å¹³äº†ï¼Œæ­å»ºä¸ªRabbitMQï¼ŒMySQLï¼Œredisï¼Œé˜¿å¸•å¥‡ï¼Œå¯¹è¿™ç§å•æ ¸VPSï¼Œä¸å°±ä¸€ä¸Šåˆä¹ˆï¼Ÿæˆ‘å¹²è¿˜ä¸è¡Œä¹ˆï¼Ÿ äºæ˜¯ä¹ï¼Œæˆ‘æŒ‰ç…§ä»–ä»¬çš„æµç¨‹å›å¤äº†é‚®ä»¶ã€‚ ç„¶åï¼Œå°±æ²¡æœ‰ç„¶åäº†ã€‚è¿™å®¶å…¬å¸çš„å·¥ç¨‹å¸ˆæ²¡ä¸€ä¸ªç†æˆ‘çš„ğŸ™ƒ ä¸èƒ½è‡ªç”˜å •è½å•Šï¼æˆ‘å¿ƒä¸­ç‡ƒæ°”äº†é›„å‡¶å¤§ç«ï¼ äºæ˜¯ä¹ï¼Œç»æœ›çš„å‘äº†ä¸ªrepost å¸Œæœ›ç¥ä¸æˆ‘åŒåœ¨å§ã€‚ã€‚ã€‚]]></content>
      <tags>
        <tag>æ—¥å¸¸</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä¸è¦æ‡’æƒ°ï¼ŒåŠ æ²¹]]></title>
    <url>%2F2018%2F08%2F04%2F%E5%8A%A0%E6%B2%B9%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘æ¯äº²è¦å»æœé²œæ—…æ¸¸ï¼Œå¿ƒç³»æ¯äº²ï¼Œæœ‰ç‚¹ç•¥å¾®æµ®èºã€‚å¥½ä¹…æ²¡æŒç»­å­¦ä¹ äº†ï¼Œç½ªè¿‡ç½ªè¿‡ã€‚ ç”¨å±±æœ¬è€€å¸çš„è¯ç»™è‡ªå·±æ‰“é¸¡è¡€ï¼š æˆ‘ä»ä¸ç›¸ä¿¡ä»€ä¹ˆæ‡’æ´‹æ´‹çš„è‡ªç”±ï¼Œæˆ‘å‘å¾€çš„è‡ªç”±æ˜¯é€šè¿‡å‹¤å¥‹å’ŒåŠªåŠ›å®ç°æ›´å¹¿é˜”çš„äººç”Ÿï¼Œé‚£æ ·çš„è‡ªç”±æ‰æ˜¯çè´µçš„ã€æœ‰ä»·å€¼çš„ã€‚æˆ‘ç›¸ä¿¡ä¸€ä¸‡å°æ—¶å®šå¾‹ï¼Œæˆ‘ä»æ¥ä¸ç›¸ä¿¡å¤©ä¸Šæ‰é¦…é¥¼çš„çµæ„Ÿå’Œåç­‰çš„æˆå°±ã€‚åšä¸€ä¸ªè‡ªç”±åˆè‡ªå¾‹çš„äººï¼Œé åŠ¿å¿…å®ç°çš„å†³å¿ƒè®¤çœŸåœ°æ´»ç€ã€‚ æ²¡æœ‰ç»å¯¹æ­£ç¡®çš„äº‹æƒ…ï¼Œä½ èƒ½åšçš„å°±æ˜¯æ›´åŠ åŠªåŠ›ï¼Œè¿™æ ·æ‰èƒ½è®©ä¸€åˆ‡å˜å¾—éƒ½æ˜¯æœ€å¥½çš„å®‰æ’ï¼è‡ªå·±å•Šï¼Œä¸€å®šè¦åŠ æ²¹ï¼]]></content>
      <tags>
        <tag>æ—¥å¸¸</tag>
        <tag>ç”Ÿæ´»</tag>
        <tag>åæ§½</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è¿™æ˜¯ä¸€ç¯‡ä¼˜é›…çš„Springboot2.0ä½¿ç”¨æ‰‹å†Œ]]></title>
    <url>%2F2018%2F08%2F04%2Fspringboot%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘å†ç ”ç©¶springbootçš„åŸç†ğŸ˜‹é¢‡æœ‰æ”¶è·ï¼Œç°åœ¨è®©æˆ‘åˆ†äº«ä¸€ä¸‹springbootå¦‚ä½•ä½¿ç”¨å§~ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ å•¥æ˜¯Springbootå’Œä¹¦ä¸Šç†è§£çš„ä¸åŒï¼Œæˆ‘è®¤ä¸ºSpringbootæ˜¯ä¸€ä¸ªä¼˜ç§€çš„å¿«é€Ÿæ­å»ºæ¡†æ¶ï¼Œä»–é€šè¿‡mavenç»§æ‰¿æ–¹å¼æ·»åŠ ä¾èµ–æ¥æ•´åˆå¾ˆå¤šç¬¬ä¸‰æ–¹å·¥å…·ï¼Œå¯ä»¥é¿å…å„ç§éº»çƒ¦çš„é…ç½®ï¼Œæœ‰å„ç§å†…åµŒå®¹å™¨ç®€åŒ–Webé¡¹ç›®ï¼Œè¿˜èƒ½é¿å…ä¾èµ–çš„å¹²æ‰°ï¼Œå®ƒå†…ç½®tomcatï¼Œjettyå®¹å™¨ï¼Œä½¿ç”¨çš„æ˜¯java appè¿è¡Œç¨‹åºï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„ç”¨æŠŠwaræ”¾åœ¨tomcatç­‰å®¹å™¨ä¸­è¿è¡Œ å’ŒJFinalçš„åŒºåˆ«JFinalæ˜¯å›½äººå‡ºå“çš„ä¸€ä¸ªweb + orm æ¡†æ¶ ï¼ŒJFinalï¼Œä¼˜ç‚¹æ˜¯å¼€å‘è¿…é€Ÿã€ä»£ç é‡å°‘ã€å­¦ä¹ ç®€å•ã€åŠŸèƒ½å¼ºå¤§ã€è½»é‡çº§ã€æ˜“æ‰©å±•ã€‚æ ¸å¿ƒå°±æ˜¯æè‡´ç®€æ´ã€‚ä»–æ²¡æœ‰å•†ä¸šæœºæ„çš„æ”¯æŒï¼Œæ‰€ä»¥å®£ä¼ ä¸åˆ°ä½ï¼Œå°‘æœ‰äººçŸ¥ã€‚ Springbootç›¸æ¯”ä¸JFinalæœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯æ”¯æŒçš„åŠŸèƒ½éå¸¸å¤šï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„å°†springçš„å„ç§æ¡†æ¶å¦‚springframework , spring-mvc, spring-security, spring-data-jpa, spring-cacheç­‰ç­‰é›†æˆèµ·æ¥è¿›è¡Œè‡ªåŠ¨åŒ–é…ç½® ï¼Œè€Œä¸”ç”Ÿæ€ æ¯”è¾ƒå¥½ï¼Œå¾ˆå¤šäº§å“éƒ½å¯¹Springbootåšå‡ºä¸€å®šæ”¯æŒã€‚ ä¸Springcloudçš„åŒºåˆ«å¯ä»¥è¿™ä¹ˆç†è§£ï¼ŒSpringbooté‡Œé¢åŒ…å«äº†Springcloudï¼ŒSpringcloudåªæ˜¯Springbooté‡Œé¢çš„ä¸€ä¸ªç»„ä»¶è€Œå·²ã€‚ Springcloudæä¾›äº†ç›¸å½“å®Œæ•´çš„å¾®æœåŠ¡æ¶æ„ã€‚è€Œå¾®æœåŠ¡æ¶æ„ï¼Œæœ¬è´¨æ¥è¯´å°±æ˜¯åˆ†å¸ƒå¼æ¶æ„ï¼Œæ„å‘³ç€ä½ è¦å°†åŸæ¥æ˜¯ä¸€ä¸ªæ•´ä½“çš„é¡¹ç›®æ‹†åˆ†æˆä¸€ä¸ªä¸ªçš„å°å‹é¡¹ç›®ï¼Œç„¶ååˆ©ç”¨æŸç§æœºåˆ¶å°†å…¶è”åˆèµ·æ¥ï¼Œä¾‹å¦‚æœåŠ¡æ²»ç†ã€é€šä¿¡æ¡†æ¶ç­‰åŸºç¡€è®¾æ–½ã€‚ SpringBootå’ŒSpringMVCåŒºåˆ«SpringBootçš„Webç»„ä»¶ï¼Œé»˜è®¤é›†æˆçš„æ˜¯SpringMVCæ¡†æ¶ã€‚ å¿«é€Ÿä½¿ç”¨è¦å¾€ä¸‹çœ‹çš„è¯ï¼Œæ³¨æ„äº†ğŸ‘‡ Springboot 2.x è¦æ±‚ JDK 1.8 ç¯å¢ƒåŠä»¥ä¸Šç‰ˆæœ¬ã€‚å¦å¤–ï¼ŒSpringboot 2.x åªå…¼å®¹ Spring Framework 5.0 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ ä¸º Springboot 2.x æä¾›äº†ç›¸å…³ä¾èµ–æ„å»ºå·¥å…·æ˜¯ Mavenï¼Œç‰ˆæœ¬éœ€è¦ 3.2 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ä½¿ç”¨ Gradle åˆ™éœ€è¦ 1.12 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ å»ºè®®ç”¨IntelliJ IDEA IntelliJ IDEA ï¼ˆç®€ç§° IDEAï¼‰ å»ºç«‹é¡¹ç›®æˆ‘å·²ç»å¥½ä¹…æ²¡ç”¨Eclipseäº†ï¼Œè¦çŸ¥é“Eclipseæ˜¯åˆ›å»ºä¸€ä¸ªmavené¡¹ç›®åœ¨å¼•å…¥Springbootä¾èµ–åˆ›å»ºçš„ã€‚ ä¸‹é¢æˆ‘åˆ†äº«ä¸€ä¸‹ç”¨IDEAåˆ›å»ºSpringbootçš„æ–¹æ³•ã€‚ å¾ˆç®€å•ï¼Œåœ¨è¿™ä¸ªç•Œé¢é‡Œé¢å°±å¯ä»¥åˆ›å»ºSpringbootäº†ã€‚æ¥ä¸‹æ¥åœ¨æ·»åŠ ä¸€äº›ç»„ä»¶ã€‚ å¤§åŠŸå‘Šæˆï¼ å†™ä¸€ä¸ªDEMOè¿™é‡Œç”¨æˆ‘å†™çš„ä¸€ä¸ªç§’æ€é¡¹ç›®ä½œä¸ºå‚è€ƒæ —å­ã€‚ç§’æ€å•†åŸ åˆ›å»ºä¸€ä¸ªconntrolleråŒ…ï¼Œç¼–å†™ä¸€ä¸ªæ ·åˆ—ã€‚ 123456789101112131415package cn.tengshe789.controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RestController;@RestController@RequestMapping("/demo")public class SampleController &#123; @RequestMapping("/hello") public String index() &#123; return "Hello World"; &#125;&#125; æ¥ä¸‹æ¥åœ¨ä»–åŒçº§åŒ…æˆ–è€…ä¸Šä¸€çº§çš„åŒ…å†…ï¼Œåˆ›å»ºä¸€ä¸ªä¸»æ–¹æ³•MainApplicationã€‚æ–¹æ³•å†…å®¹; 123456789@SpringBootApplication@EnableAsync//@ComponentScan("cn.tengshe789.controller")//@EnableAutoConfigurationpublic class MainApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(MainApplication.class, args); &#125;&#125; åœ¨æµè§ˆå™¨è¾“å…¥http://127.0.0.1:8080/demo/hello/ï¼Œå°±å¯ä»¥å¯åŠ¨äº†ï¼ SpringApplication.runSpringbootå°†ä»–æ ‡è¯†ä¸ºå¯åŠ¨ç±»ï¼Œç”¨å®ƒå¯åŠ¨Springbooté¡¹ç›® åŸºç¡€æ³¨è§£è§£é‡Š@RestControlleråœ¨ä¸ŠåŠ ä¸ŠRestController è¡¨ç¤ºä¿®é¥°è¯¥Controlleræ‰€æœ‰çš„æ–¹æ³•è¿”å›JSONæ ¼å¼,ç›´æ¥å¯ä»¥ç¼–å†™Restfulæ¥å£ã€‚å°±ç›¸å½“äº@Controller+@ResponseBodyè¿™ç§å®ç° @SpringBootApplicationç”¨åœ¨å¯åŠ¨Springbootä¸­ï¼Œç›¸å½“äº@ComponentScan+@EnableAutoConfiguration+@Configuration @ComponentScan(â€œcn.tengshe789.controllerâ€)æ§åˆ¶å™¨æ‰«åŒ…èŒƒå›´ã€‚ @EnableAutoConfigurationä»–è®© Spring Boot æ ¹æ®å’±åº”ç”¨æ‰€å£°æ˜çš„ä¾èµ–æ¥å¯¹ Spring æ¡†æ¶è¿›è¡Œè‡ªåŠ¨é…ç½®ã€‚æ„æ€æ˜¯ï¼Œåˆ›å»ºé¡¹ç›®æ—¶æ·»åŠ çš„spring-boot-starter-webæ·»åŠ äº†Tomcatå’ŒSpring MVCï¼Œæ‰€ä»¥auto-configurationå°†å‡å®šä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªwebåº”ç”¨å¹¶ç›¸åº”åœ°å¯¹Springè¿›è¡Œè®¾ç½®ã€‚ é…ç½®æ–‡ä»¶propertiesè§„åˆ™ï¼š 1ã€åç”¨å¤§å†™æ¯”è¾ƒè§„èŒƒ 2ã€=ä¸¤è¾¹åˆ«æ‰“ç©ºæ ¼ 3ã€åå€¼å¯¹å†™å®Œååˆ«æ‰“åˆ†å· è‡ªå®šä¹‰å‚æ•°1name=tengshe789 å¤šç¯å¢ƒé…ç½®12345spring.profiles.active=preapplication-dev.propertiesï¼šå¼€å‘ç¯å¢ƒapplication-test.propertiesï¼šæµ‹è¯•ç¯å¢ƒapplication-prod.propertiesï¼šç”Ÿäº§ç¯å¢ƒ ä¿®æ”¹ç«¯å£å·12server.port=8888 server.context-path=/tengshe789 yamlè§„åˆ™ï¼š ä½¿ç”¨ç©ºæ ¼ Space ç¼©è¿›è¡¨ç¤ºåˆ†å±‚ï¼Œä¸åŒå±‚æ¬¡ä¹‹é—´çš„ç¼©è¿›å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç©ºæ ¼æ•°ç›®ï¼Œä½†æ˜¯åŒå±‚å…ƒç´ ä¸€å®šå·¦å¯¹é½ï¼Œå³å‰é¢ç©ºæ ¼æ•°ç›®ç›¸åŒï¼ˆä¸èƒ½ä½¿ç”¨ Tabï¼Œå„ä¸ªç³»ç»Ÿ Tabå¯¹åº”çš„ Space æ•°ç›®å¯èƒ½ä¸åŒï¼Œå¯¼è‡´å±‚æ¬¡æ··ä¹±ï¼‰ â€˜#â€™è¡¨ç¤ºæ³¨é‡Šï¼Œåªèƒ½å•è¡Œæ³¨é‡Šï¼Œä»#å¼€å§‹å¤„åˆ°è¡Œå°¾ ç ´æŠ˜å·åé¢è·Ÿä¸€ä¸ªç©ºæ ¼ï¼ˆa dash and spaceï¼‰è¡¨ç¤ºåˆ—è¡¨ ç”¨å†’å·å’Œç©ºæ ¼è¡¨ç¤ºé”®å€¼å¯¹ key: value ç®€å•æ•°æ®ï¼ˆscalarsï¼Œæ ‡é‡æ•°æ®ï¼‰å¯ä»¥ä¸ä½¿ç”¨å¼•å·æ‹¬èµ·æ¥ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²æ•°æ®ã€‚ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·æ‹¬èµ·æ¥çš„è¢«å½“ä½œå­—ç¬¦ä¸²æ•°æ®ï¼Œåœ¨å•å¼•å·æˆ–åŒå¼•å·ä¸­ä½¿ç”¨Cé£æ ¼çš„è½¬ä¹‰å­—ç¬¦ 123server: port: 8080 context-path: /springboot xmlSpringbootå®˜æ–¹ä¸æ¨èxmlï¼Œç•¥ Webå¼€å‘ä¸€ä¸ªé¡¹ç›®ç”¨Springbootï¼Œåæœ‰å…«ä¹å°±æ˜¯ç”¨äºWebå¼€å‘ã€‚é¦–å…ˆè®©æˆ‘ä»¬çœ‹çœ‹Springbootæ€ä¹ˆå¿«é€Ÿå¼€å‘WebæŠŠ å¦‚ä½•è®¿é—®é™æ€èµ„æºè¯·åœ¨resourcesç›®å½•ä¸‹åˆ›å»ºstaticæ–‡ä»¶å¤¹ï¼Œåœ¨è¯¥ä½ç½®æ”¾ç½®ä¸€ä¸ªé™æ€èµ„æºã€‚ ç›®å½•ï¼šsrc/main/resources/static å¯åŠ¨ç¨‹åºåï¼Œå°è¯•è®¿é—®http://localhost:8080/img.xxx/ã€‚å°±å¯ä»¥è®¿é—®äº†ã€‚ å…³äºæ¸²æŸ“Webé¡µé¢åœ¨ä¹‹å‰çš„å¿«é€Ÿä½¿ç”¨çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡æ·»åŠ @RestControlleræ¥å¤„ç†è¯·æ±‚ï¼Œæ‰€ä»¥è¿”å›çš„å†…å®¹ä¸ºjsonå¯¹è±¡ã€‚é‚£ä¹ˆå¦‚æœéœ€è¦æ¸²æŸ“htmlé¡µé¢çš„æ—¶å€™ï¼Œè¦å¦‚ä½•å®ç°å‘¢ï¼Ÿ æ¨¡æ¿å¼•æ“æ–¹æ³•Springbootä¾ç„¶å¯ä»¥å®ç°åŠ¨æ€HTMLï¼Œå¹¶ä¸”æä¾›äº†å¤šç§æ¨¡æ¿å¼•æ“çš„é»˜è®¤é…ç½®æ”¯æŒï¼ŒSpringbootå®˜æ–¹æ–‡æ¡£æœ‰å¦‚ä¸‹æ¨èçš„æ¨¡æ¿å¼•æ“ï¼š Â· Thymeleaf Â· FreeMarker Â· Velocity Â· Groovy Â· Mustache Springbootå®˜æ–¹å»ºè®®é¿å…ä½¿ç”¨JSPï¼Œè‹¥ä¸€å®šè¦ä½¿ç”¨JSPå°†æ— æ³•å®ç°Spring Bootçš„å¤šç§ç‰¹æ€§ã€‚ åœ¨Springbootä¸­ï¼Œé»˜è®¤çš„æ¨¡æ¿é…ç½®è·¯å¾„éƒ½æ—¶ï¼šsrc/main/resources/templatesã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä¿®æ”¹è¿™ä¸ªè·¯å¾„ï¼Œå…·ä½“å¦‚ä½•ä¿®æ”¹ï¼Œå¯åœ¨å„æ¨¡æ¿å¼•æ“çš„é…ç½®å±æ€§ä¸­æŸ¥è¯¢å¹¶ä¿®æ”¹ã€‚ Thymeleafï¼ˆèƒ¸è…ºï¼‰è¿™é‡Œè¿˜æ˜¯ç”¨æˆ‘å†™çš„ä¸€ä¸ªç§’æ€é¡¹ç›®ä½œä¸ºå‚è€ƒæ —å­ã€‚ç§’æ€å•†åŸ POM1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt; &lt;/dependency&gt; é…ç½®æ–‡ä»¶åœ¨application.propertiesä¸­æ·»åŠ ï¼š 123456789#thymeleafspring.thymeleaf.prefix=classpath:/templates/spring.thymeleaf.suffix=.htmlspring.thymeleaf.cache=falsespring.thymeleaf.servlet.content-type=text/htmlspring.thymeleaf.enabled=truespring.thymeleaf.encoding=UTF-8# ä¸€ä»£å¡« spring.thymeleaf.mode=HTML5spring.thymeleaf.mode=HTML åå°åœ¨src/main/resources/åˆ›å»ºä¸€ä¸ªtemplatesæ–‡ä»¶å¤¹,æ–°ç½‘é¡µåç¼€ä¸º*.html 12345678@RequestMapping("/to_list") public String list(Model model,MiaoshaUser user) &#123; model.addAttribute("user", user); //æŸ¥è¯¢å•†å“åˆ—è¡¨ List&lt;GoodsVo&gt; goodsList = goodsService.listGoodsVo(); model.addAttribute("goodsList", goodsList); return "goods_list"; &#125; å‰å°è¿™é‡Œæ³¨æ„Thymeleafè¯­æ³•ï¼ŒThymeleafå¾ˆåƒHTMLï¼Œä¸åŒä¹‹å¤„åœ¨æ ‡ç­¾åŠ äº†ä¸€ä¸ªthå‰ç¼€ 1234567891011121314151617181920212223242526&lt;!DOCTYPE HTML&gt;&lt;html xmlns:th="http://www.thymeleaf.org"&gt;&lt;head&gt; &lt;title&gt;å•†å“åˆ—è¡¨&lt;/title&gt; &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt; &lt;!-- jquery --&gt; &lt;script type="text/javascript" th:src="@&#123;/js/jquery.min.js&#125;"&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class="panel panel-default" &gt; &lt;div class="panel-heading"&gt;ç§’æ€å•†å“åˆ—è¡¨&lt;/div&gt; &lt;table class="table" id="goodslist"&gt; &lt;tr&gt;&lt;td&gt;å•†å“åç§°&lt;/td&gt;&lt;td&gt;å•†å“å›¾ç‰‡&lt;/td&gt;&lt;td&gt;å•†å“åŸä»·&lt;/td&gt;&lt;td&gt;ç§’æ€ä»·&lt;/td&gt;&lt;td&gt;åº“å­˜æ•°é‡&lt;/td&gt;&lt;td&gt;è¯¦æƒ…&lt;/td&gt;&lt;/tr&gt; &lt;tr th:each="goods,goodsStat : $&#123;goodsList&#125;"&gt; &lt;td th:text="$&#123;goods.goodsName&#125;"&gt;&lt;/td&gt; &lt;td &gt;&lt;img th:src="@&#123;$&#123;goods.goodsImg&#125;&#125;" width="100" height="100" /&gt;&lt;/td&gt; &lt;td th:text="$&#123;goods.goodsPrice&#125;"&gt;&lt;/td&gt; &lt;td th:text="$&#123;goods.miaoshaPrice&#125;"&gt;&lt;/td&gt; &lt;td th:text="$&#123;goods.stockCount&#125;"&gt;&lt;/td&gt; &lt;td&gt;&lt;a th:href="'/goods_detail.htm?goodsId='+$&#123;goods.id&#125;"&gt;è¯¦æƒ…&lt;/a&gt;&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; Freemarker(è‡ªç”±æ ‡è®°)POM1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-freemarker&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶åœ¨application.propertiesä¸­æ·»åŠ ï¼š 12345678910111213141516#Freemarkerspring.freemarker.allow-request-override=falsespring.freemarker.cache=truespring.freemarker.check-template-location=truespring.freemarker.charset=UTF-8spring.freemarker.content-type=text/htmlspring.freemarker.expose-request-attributes=falsespring.freemarker.expose-session-attributes=falsespring.freemarker.expose-spring-macro-helpers=false#spring.freemarker.prefix=#spring.freemarker.request-context-attribute=#spring.freemarker.settings.*=spring.freemarker.suffix=.ftlspring.freemarker.template-loader-path=classpath:/templates/#comma-separated list#spring.freemarker.view-names= # whitelist of view names that can be resolved åå°åœ¨src/main/resources/åˆ›å»ºä¸€ä¸ªtemplatesæ–‡ä»¶å¤¹,æ–°ç½‘é¡µåç¼€ä¸º*.ftl 1234567891011@RequestMapping("/freemarkerIndex") public String index(Map&lt;String, Object&gt; result) &#123; result.put("nickname", "tEngSHe789"); result.put("old", "18"); result.put("my Blog", "HTTPS://blog.tengshe789.tech/"); List&lt;String&gt; listResult = new ArrayList&lt;String&gt;(); listResult.add("guanyu"); listResult.add("zhugeliang"); result.put("listResult", listResult); return "index"; &#125; å‰å°123456789101112131415161718192021&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head lang="en"&gt;&lt;meta charset="UTF-8" /&gt;&lt;title&gt;é¦–é¡µ&lt;/title&gt;&lt;/head&gt;&lt;body&gt; $&#123;nickname&#125;&lt;#if old=="18"&gt; å¤ªå‡äº†å§å“¥ä»¬ &lt;#elseif old=="21"&gt; ä½ æ˜¯çœŸçš„21å² &lt;#else&gt; å…¶ä»– &lt;/#if&gt; &lt;#list userlist as user&gt; $&#123;user&#125; &lt;/#list&gt;&lt;/body&gt; &lt;/html&gt; JSPä¸å»ºè®®ç”¨Springbootæ•´åˆJSPï¼Œè¦çš„è¯ä¸€å®šè¦ä¸ºwarç±»å‹ï¼Œå¦åˆ™ä¼šæ‰¾ä¸åˆ°é¡µé¢.,è€Œä¸”ä¸è¦æŠŠJSPé¡µé¢å­˜æ”¾åœ¨resources// jsp ä¸èƒ½è¢«è®¿é—®åˆ° POM123456789101112131415161718192021&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.4.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;!-- SpringBoot web æ ¸å¿ƒç»„ä»¶ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt; &lt;/dependency&gt;&lt;!-- SpringBoot å¤–éƒ¨tomcatæ”¯æŒ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt; &lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; é…ç½®æ–‡ä»¶åœ¨application.propertiesä¸­æ·»åŠ ï¼š 12spring.mvc.view.prefix=/WEB-INF/jsp/spring.mvc.view.suffix=.jsp åå°åœ¨src/main/resources/åˆ›å»ºä¸€ä¸ªtemplatesæ–‡ä»¶å¤¹,æ–°ç½‘é¡µåç¼€ä¸º*.jsp 1234567@Controllerpublic class IndexController &#123; @RequestMapping("/index") public String index() &#123; return "index"; &#125;&#125; å‰å°ç•¥ç•¥ç•¥ğŸ˜ &lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD é¢å‘æµç¼–ç¨‹è¦äº†è§£ WebFlux ,é¦–å…ˆäº†è§£ä¸‹ä»€ä¹ˆæ˜¯Reactiveå“åº”å¼(ååº”å¼ã€å¼‚æ­¥ã€é¢å‘æµ)ç¼–ç¨‹ ï¼Œä»–æ˜¯ä¸€ç§æ–°çš„ç¼–ç¨‹é£æ ¼ï¼Œå…¶ç‰¹ç‚¹æ˜¯å¼‚æ­¥æˆ–å¹¶å‘ã€äº‹ä»¶é©±åŠ¨ã€æ¨é€PUSHæœºåˆ¶ä»¥åŠè§‚å¯Ÿè€…æ¨¡å¼çš„è¡ç”Ÿã€‚reactiveåº”ç”¨(å“åº”å¼åº”ç”¨)å…è®¸å¼€å‘äººå‘˜æ„å»ºäº‹ä»¶é©±åŠ¨ï¼ˆevent-drivenï¼‰ï¼Œå¯æ‰©å±•æ€§ï¼Œå¼¹æ€§çš„ååº”ç³»ç»Ÿï¼šæä¾›é«˜åº¦æ•æ„Ÿçš„å®æ—¶çš„ç”¨æˆ·ä½“éªŒæ„Ÿè§‰ï¼Œå¯ä¼¸ç¼©æ€§å’Œå¼¹æ€§çš„åº”ç”¨ç¨‹åºæ ˆçš„æ”¯æŒï¼Œéšæ—¶å¯ä»¥éƒ¨ç½²åœ¨å¤šæ ¸å’Œäº‘è®¡ç®—æ¶æ„ã€‚ Spring WebfluxSpring Boot Webflux å°±æ˜¯åŸºäº Reactor å®ç°çš„ã€‚Spring Boot 2.0 åŒ…æ‹¬ä¸€ä¸ªæ–°çš„ spring-webflux æ¨¡å—ã€‚è¯¥æ¨¡å—åŒ…å«å¯¹å“åº”å¼ HTTP å’Œ WebSocket å®¢æˆ·ç«¯çš„æ”¯æŒï¼Œä»¥åŠå¯¹ RESTï¼ŒHTML å’Œ WebSocket äº¤äº’ç­‰ç¨‹åºçš„æ”¯æŒã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒSpring MVC ç”¨äºåŒæ­¥å¤„ç†ï¼ŒSpring Webflux ç”¨äºå¼‚æ­¥å¤„ç†ã€‚ Spring Boot Webflux æœ‰ä¸¤ç§ç¼–ç¨‹æ¨¡å‹å®ç°ï¼Œä¸€ç§ç±»ä¼¼ Spring MVC æ³¨è§£æ–¹å¼ï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨å…¶åŠŸèƒ½æ€§ç«¯ç‚¹æ–¹å¼ã€‚ WebFlux æ”¯æŒçš„å®¹å™¨æœ‰ Tomcatã€Jettyï¼ˆNon-Blocking IO APIï¼‰ ï¼Œä¹Ÿå¯ä»¥åƒ Netty å’Œ Undertow çš„æœ¬èº«å°±æ”¯æŒå¼‚æ­¥å®¹å™¨ã€‚åœ¨å®¹å™¨ä¸­ Spring WebFlux ä¼šå°†è¾“å…¥æµé€‚é…æˆ Mono æˆ–è€… Flux æ ¼å¼è¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚ POM1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-webflux&lt;/artifactId&gt;&lt;/dependency&gt; å®˜æ–¹å®ä¾‹1234567891011121314151617181920212223@RestControllerpublic class PersonController &#123; private final PersonRepository repository; public PersonController(PersonRepository repository) &#123; this.repository = repository; &#125; @PostMapping("/person") Mono&lt;Void&gt; create(@RequestBody Publisher&lt;Person&gt; personStream) &#123; return this.repository.save(personStream).then(); &#125; @GetMapping("/person") Flux&lt;Person&gt; list() &#123; return this.repository.findAll(); &#125; @GetMapping("/person/&#123;id&#125;") Mono&lt;Person&gt; findById(@PathVariable String id) &#123; return this.repository.findOne(id); &#125;&#125; Controllerå±‚Spring Boot 2.0 è¿™é‡Œæœ‰ä¸¤æ¡ä¸åŒçš„çº¿åˆ†åˆ«æ˜¯ï¼š Spring Web MVC -&gt; Spring Data Spring WebFlux -&gt; Spring Data Reactive å¦‚æœä½¿ç”¨ Spring Data Reactive ï¼ŒåŸæ¥çš„ Spring é’ˆå¯¹ Spring Data ï¼ˆJDBCç­‰ï¼‰çš„äº‹åŠ¡ç®¡ç†ä¼šä¸èµ·ä½œç”¨ã€‚å› ä¸ºåŸæ¥çš„ Spring äº‹åŠ¡ç®¡ç†ï¼ˆSpring Data JPAï¼‰éƒ½æ˜¯åŸºäº ThreadLocal ä¼ é€’äº‹åŠ¡çš„ï¼Œå…¶æœ¬è´¨æ˜¯åŸºäº é˜»å¡ IO æ¨¡å‹ï¼Œä¸æ˜¯å¼‚æ­¥çš„ã€‚ ä½† Reactive æ˜¯è¦æ±‚å¼‚æ­¥çš„ï¼Œä¸åŒçº¿ç¨‹é‡Œé¢ ThreadLocal è‚¯å®šå–ä¸åˆ°å€¼äº†ã€‚è‡ªç„¶ï¼Œæˆ‘ä»¬å¾—æƒ³æƒ³å¦‚ä½•åœ¨ä½¿ç”¨ Reactive ç¼–ç¨‹æ˜¯åšåˆ°äº‹åŠ¡ï¼Œæœ‰ä¸€ç§æ–¹å¼æ˜¯ å›è°ƒ æ–¹å¼ï¼Œä¸€ç›´ä¼ é€’ conn ï¼šnewTransaction(conn -&gt;{}) å› ä¸ºæ¯æ¬¡æ“ä½œæ•°æ®åº“ä¹Ÿæ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥ connection åœ¨ Reactive ç¼–ç¨‹ä¸­æ— æ³•é  ThreadLocal ä¼ é€’äº†ï¼Œåªèƒ½æ”¾åœ¨å‚æ•°ä¸Šé¢ä¼ é€’ã€‚è™½ç„¶ä¼šæœ‰ä¸€å®šçš„ä»£ç ä¾µå…¥è¡Œã€‚è¿›ä¸€æ­¥ï¼Œä¹Ÿå¯ä»¥ kotlin åç¨‹ï¼Œå»åšåˆ°é€æ˜çš„äº‹åŠ¡ç®¡ç†ï¼Œå³æŠŠ conn æ”¾åˆ° åç¨‹çš„å±€éƒ¨å˜é‡ä¸­å»ã€‚é‚£ Spring Data Reactive Repositories ä¸æ”¯æŒ MySQLï¼Œè¿›ä¸€æ­¥ä¹Ÿä¸æ”¯æŒ MySQL äº‹åŠ¡ï¼Œæ€ä¹ˆåŠï¼Ÿ ç­”æ¡ˆæ˜¯ï¼Œè¿™ä¸ªé—®é¢˜å…¶å®å’Œç¬¬ä¸€ä¸ªé—®é¢˜ä¹Ÿç›¸å…³ã€‚ ä¸ºå•¥ä¸æ”¯æŒ MySQLï¼Œå³ JDBC ä¸æ”¯æŒã€‚å¤§å®¶å¯ä»¥çœ‹åˆ° JDBC æ˜¯æ‰€å± Spring Data çš„ã€‚æ‰€ä»¥å¯ä»¥ç­‰å¾… Spring Data Reactive Repositories å‡çº§ IO æ¨¡å‹ï¼Œå»æ”¯æŒ MySQLã€‚ä¹Ÿå¯ä»¥å’Œä¸Šé¢ä¹Ÿè®²åˆ°äº†ï¼Œå¦‚ä½•ä½¿ç”¨ Reactive ç¼–ç¨‹æ”¯æŒäº‹åŠ¡ã€‚ å¦‚æœåº”ç”¨åªèƒ½ä½¿ç”¨ä¸å¼ºä¾èµ–æ•°æ®äº‹åŠ¡ï¼Œä¾æ—§ä½¿ç”¨ MySQL ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å®ç°ï¼Œä»£ç å¦‚ä¸‹ï¼š 12 Service å±‚1234567891011121314151617181920212223242526272829303132333435363738394041public interface CityService &#123; /** * è·å–åŸå¸‚ä¿¡æ¯åˆ—è¡¨ * * @return */ List&lt;City&gt; findAllCity(); /** * æ ¹æ®åŸå¸‚ ID,æŸ¥è¯¢åŸå¸‚ä¿¡æ¯ * * @param id * @return */ City findCityById(Long id); /** * æ–°å¢åŸå¸‚ä¿¡æ¯ * * @param city * @return */ Long saveCity(City city); /** * æ›´æ–°åŸå¸‚ä¿¡æ¯ * * @param city * @return */ Long updateCity(City city); /** * æ ¹æ®åŸå¸‚ ID,åˆ é™¤åŸå¸‚ä¿¡æ¯ * * @param id * @return */ Long deleteCity(Long id);&#125; å…·ä½“æ¡ˆä¾‹åœ¨æˆ‘å‚è€ƒåšä¸»çš„ Github è·¯ç”±å™¨ç±» Routeråˆ›å»ºä¸€ä¸ª Route ç±»æ¥å®šä¹‰ RESTful HTTP è·¯ç”± 12 è¯·å‚è€ƒèŠèŠ Spring Boot 2.x é‚£äº›äº‹å„¿ @Asyncéœ€è¦æ‰§è¡Œå¼‚æ­¥æ–¹æ³•æ—¶ï¼Œåœ¨æ–¹æ³•ä¸ŠåŠ ä¸Š@Asyncä¹‹åï¼Œåº•å±‚ä½¿ç”¨å¤šçº¿ç¨‹æŠ€æœ¯ ã€‚å¯åŠ¨åŠ ä¸Šéœ€è¦@EnableAsync æ•°æ®è®¿é—®æ•´åˆJdbcTemplateä½¿ç”¨è¿™ä¸ªéœ€è¦spring-boot-starter-parentç‰ˆæœ¬è¦åœ¨1.5ä»¥ä¸Š POM1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶åœ¨application.propertiesä¸­æ·»åŠ ï¼š 12345# jdbcæ¨¡æ¿spring.datasource.url=jdbc:mysql://localhost:3306/testspring.datasource.username=rootspring.datasource.password=123456spring.datasource.driver-class-name=com.mysql.jdbc.Driver åå°åˆ›å»ºä¸€ä¸ªService 12345678@Servicepublic class UserServiceImpl implements UserService &#123; @Autowired private JdbcTemplate jdbcTemplate; public void createUser(String name, Integer age) &#123; jdbcTemplate.update("insert into users values(null,?,?);", name, age); &#125;&#125; æ•´åˆMybatisè¿™é‡Œç”¨æˆ‘å†™çš„ä¸€ä¸ªç§’æ€é¡¹ç›®ä½œä¸ºå‚è€ƒæ —å­ã€‚ç§’æ€å•†åŸ POM12345&lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.3.2&lt;/version&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶åœ¨application.propertiesä¸­æ·»åŠ ï¼š 123456#mybatismybatis.type-aliases-package=cn.tengshe789.domainmybatis.configuration.map-underscore-to-camel-case=truemybatis.configuration.default-fetch-size=100mybatis.configuration.default-statement-timeout=3000mybatis.mapperLocations = classpath:cn/tengshe789/dao/*.xml åå°åˆ›å»ºä¸€ä¸ªDaoï¼ˆMapper ä»£ç ï¼‰ 1234567@Mapper@Componentpublic interface GoodsDao &#123; @Select("select g.*,mg.stock_count, mg.start_date, mg.end_date,mg.miaosha_price from miaosha_goods mg left join goods g on mg.goods_id = g.id") public List&lt;GoodsVo&gt; listGoodsVo();&#125; åˆ›å»ºservice 12345678910111213@Servicepublic class GoodsService &#123; @Autowired GoodsDao goodsDao; /* * å±•ç¤ºå•†å“åˆ—è¡¨ */ public List&lt;GoodsVo&gt; listGoodsVo() &#123; return goodsDao.listGoodsVo(); &#125;&#125; Mybatisæ•´åˆåˆ†é¡µæ’ä»¶PageHelperPageHelper æ˜¯ä¸€æ¬¾å¥½ç”¨çš„å¼€æºå…è´¹çš„ Mybatis ç¬¬ä¸‰æ–¹ç‰©ç†åˆ†é¡µæ’ä»¶ POM12345&lt;dependency&gt; &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt; &lt;artifactId&gt;pagehelper-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.2.5&lt;/version&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶åœ¨application.propertiesä¸­æ·»åŠ ï¼š 12345678# é…ç½®æ—¥å¿—logging.level.cn.tengshe789.dao=DEBUG# Pagehelperpagehelper.helperDialect=mysqlpagehelper.reasonable=truepagehelper.supportMethodsArguments=truepagehelper.params=count=countSqlpagehelper.page-size-zero=true æˆ–è€…åœ¨application.ymlä¸­æ·»åŠ ï¼š 123456789101112# ä¸mybatisæ•´åˆmybatis: config-location: classpath:mybatis.xml mapper-locations: - classpath:cn/tengshe789/dao/*.xml# åˆ†é¡µé…ç½®pagehelper: helper-dialect: mysql reasonable: true support-methods-arguments: true params: count=countSql ä»£ç å®ä½“å±‚é¢12345@Datapublic class User &#123; private Integer id; private String name;&#125; Daoå±‚1234public interface UserDao &#123; @Select("SELECT * FROM USERS ") List&lt;User&gt; findUserList();&#125; Serviceå±‚123456789101112131415161718@Servicepublic class UserService &#123; @Autowired private UserMapper userDao; /** * page å½“å‰é¡µæ•°&lt;br&gt; * size å½“å‰å±•ç¤ºçš„æ•°æ®&lt;br&gt; */ public PageInfo&lt;User&gt; findUserList(int page, int size) &#123; // å¼€å¯åˆ†é¡µæ’ä»¶,æ”¾åœ¨æŸ¥è¯¢è¯­å¥ä¸Šé¢ PageHelper.startPage(page, size); List&lt;User&gt; listUser = userDao.findUserList(); // å°è£…åˆ†é¡µä¹‹åçš„æ•°æ® PageInfo&lt;User&gt; pageInfoUser = new PageInfo&lt;User&gt;(listUser); return pageInfoUser; &#125;&#125; æ•´åˆSpringJPAspring-data-jpaä¸‰ä¸ªæ­¥éª¤ï¼š å£°æ˜æŒä¹…å±‚çš„æ¥å£ï¼Œè¯¥æ¥å£ç»§æ‰¿ Repositoryï¼ˆæˆ–Repositoryçš„å­æ¥å£ï¼Œå…¶ä¸­å®šä¹‰äº†ä¸€äº›å¸¸ç”¨çš„å¢åˆ æ”¹æŸ¥ï¼Œä»¥åŠåˆ†é¡µç›¸å…³çš„æ–¹æ³•ï¼‰ã€‚ åœ¨æ¥å£ä¸­å£°æ˜éœ€è¦çš„ä¸šåŠ¡æ–¹æ³•ã€‚Spring Data å°†æ ¹æ®ç»™å®šçš„ç­–ç•¥ç”Ÿæˆå®ç°ä»£ç ã€‚ åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­å¢åŠ ä¸€è¡Œå£°æ˜ï¼Œè®© Spring ä¸ºå£°æ˜çš„æ¥å£åˆ›å»ºä»£ç†å¯¹è±¡ã€‚é…ç½®äº† jpa:repositories åï¼ŒSpring åˆå§‹åŒ–å®¹å™¨æ—¶å°†ä¼šæ‰«æ base-package æŒ‡å®šçš„åŒ…ç›®å½•åŠå…¶å­ç›®å½•ï¼Œä¸ºç»§æ‰¿ Repository æˆ–å…¶å­æ¥å£çš„æ¥å£åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œå¹¶å°†ä»£ç†å¯¹è±¡æ³¨å†Œä¸º Spring Beanï¼Œä¸šåŠ¡å±‚ä¾¿å¯ä»¥é€šè¿‡ Spring è‡ªåŠ¨å°è£…çš„ç‰¹æ€§æ¥ç›´æ¥ä½¿ç”¨è¯¥å¯¹è±¡ã€‚ è¯¦æƒ…ï¼šJPAå®˜æ–¹ç½‘ç«™ POM1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶Springboot é»˜è®¤ä½¿ç”¨hibernateä½œä¸ºJPAçš„å®ç° ã€‚éœ€è¦åœ¨application.propertiesä¸­æ·»åŠ ï¼š 12345678# hibernatespring.datasource.url=jdbc:mysql://localhost:3306/test?useSSL=falsespring.datasource.username=rootspring.datasource.password=rootspring.datasource.tomcat.max-active=100spring.datasource.tomcat.max-idle=200spring.datasource.tomcat.initialSize=20spring.jpa.database-platform=org.hibernate.dialect.MySQL5Dialect ä»£ç Domain1234567891011@Data@Entity(name = "users")public class UserEntity &#123; @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private Integer id; @Column(name = "name") private String name; @Column(name = "age") private Integer age;&#125; æ³¨è§£çš„æ„æ€ï¼š @Entityä¼šè¢«springæ‰«æå¹¶åŠ è½½ï¼Œ @Idæ³¨è§£åœ¨ä¸»é”®ä¸Š @Column name=&quot;call_phone&quot; æŒ‡è¯¥å­—æ®µå¯¹åº”çš„æ•°æ®åº“çš„å­—æ®µåï¼Œå¦‚æœç›¸åŒå°±ä¸éœ€è¦å®šä¹‰ã€‚æ•°æ®åº“ä¸‹åˆ’çº¿é—´éš”å’Œä»£ç ä¸­çš„é©¼å³°æ³•è§†ä¸ºç›¸åŒï¼Œå¦‚æ•°æ®åº“å­—æ®µcreate_timeç­‰ä»·äºJavaç±»ä¸­çš„createTimeï¼Œå› æ­¤ä¸éœ€è¦ç”¨@Columnæ³¨è§£ã€‚ Daoå±‚æ­¤æ—¶éœ€è¦ç»§æ‰¿Repositoryæ¥å£~ 12public interface UserDao extends JpaRepository&lt;User, Integer&gt; &#123;&#125; Controller123456789101112@RestControllerpublic class IndexController &#123; @Autowired private UserDao userDao; @RequestMapping("/jpaFindUser") public Object jpaIndex(User user) &#123; Optional&lt;User&gt; userOptional = userDao.findById(user.getId()); User result = userOptional.get(); return reusltUser == null ? "æ²¡æœ‰æŸ¥è¯¢åˆ°æ•°æ®" : result; &#125;&#125; å¤šæ•°æ®æºå¾ˆå¤šå…¬å¸éƒ½ä¼šä½¿ç”¨å¤šæ•°æ®åº“ï¼Œä¸€ä¸ªæ•°æ®åº“å­˜æ”¾å…±åŒçš„é…ç½®æˆ–æ–‡ä»¶ï¼Œå¦ä¸€ä¸ªæ•°æ®åº“æ˜¯æ”¾å‚ç›´ä¸šåŠ¡çš„æ•°æ®ã€‚æ‰€ä»¥è¯´éœ€è¦ä¸€ä¸ªé¡¹ç›®ä¸­æœ‰å¤šä¸ªæ•°æ®æº è¿™ç©æ„åŸç†å¾ˆç®€å•ï¼Œæ ¹æ®ä¸åŒåŒ…åï¼ŒåŠ è½½ä¸åŒæ•°æ®æºã€‚ é…ç½®æ–‡ä»¶åœ¨application.propertiesä¸­æ·»åŠ ï¼š 12345678910# datasource1spring.datasource.test1.driver-class-name = com.mysql.jdbc.Driverspring.datasource.test1.jdbc-url =jdbc:mysql://localhost:3306/test01?useUnicode=true&amp;characterEncoding=utf-8spring.datasource.test1.username = rootspring.datasource.test1.password = 123456# datasource2spring.datasource.test2.driver-class-name = com.mysql.jdbc.Driverspring.datasource.test2.jdbc-url =jdbc:mysql://localhost:3306/test02?useUnicode=true&amp;characterEncoding=utf-8spring.datasource.test2.username = rootspring.datasource.test2.password = 123456 ä»£ç æ·»åŠ é…ç½®æ•°æ®åº“1çš„ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849//DataSource01@Configuration // æ³¨å†Œåˆ°springbootå®¹å™¨ä¸­@MapperScan(basePackages = "tech.tengshe789.test01", sqlSessionFactoryRef = "test1SqlSessionFactory")public class DataSource1Config &#123; /** * @methodDesc: åŠŸèƒ½æè¿°:(é…ç½®test1æ•°æ®åº“) * @author: tEngSHe789 */ @Bean(name = "test1DataSource") @ConfigurationProperties(prefix = "spring.datasource.test1") @Primary public DataSource testDataSource() &#123; return DataSourceBuilder.create().build(); &#125; /** * @methodDesc: åŠŸèƒ½æè¿°:(test1 sqlä¼šè¯å·¥å‚) */ @Bean(name = "test1SqlSessionFactory") @Primary public SqlSessionFactory testSqlSessionFactory(@Qualifier("test1DataSource") DataSource dataSource) throws Exception &#123; SqlSessionFactoryBean bean = new SqlSessionFactoryBean(); bean.setDataSource(dataSource); //åŠ è½½mapperï¼ˆä¸éœ€è¦ï¼‰ bean.setMapperLocations( new PathMatchingResourcePatternResolver().getResources("classpath:mybatis/mapper/test1/*.xml")); return bean.getObject(); &#125; /** * * @methodDesc: åŠŸèƒ½æè¿°:(test1 äº‹ç‰©ç®¡ç†) */ @Bean(name = "test1TransactionManager") @Primary public DataSourceTransactionManager testTransactionManager(@Qualifier("test1DataSource") DataSource dataSource) &#123; return new DataSourceTransactionManager(dataSource); &#125; @Bean(name = "test1SqlSessionTemplate") @Primary public SqlSessionTemplate testSqlSessionTemplate( @Qualifier("test1SqlSessionFactory") SqlSessionFactory sqlSessionFactory) throws Exception &#123; return new SqlSessionTemplate(sqlSessionFactory); &#125;&#125; æ•°æ®åº“2çš„åŒç†ã€‚ Dao1234public interface User1Dao &#123; @Insert("insert into users values(null,#&#123;name&#125;,#&#123;age&#125;);") public int addUser(@Param("name") String name, @Param("age") Integer age);&#125; æ³¨æ„äº‹é¡¹åœ¨å¤šæ•°æ®æºçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨@Transactionalæ³¨è§£æ—¶ï¼Œåº”è¯¥æŒ‡å®šäº‹åŠ¡ç®¡ç†è€…@Transactional(transactionManager = &quot;test1TransactionManager&quot;) äº‹ç‰©ç®¡ç†æ€ä¹ˆè¿›è¡Œäº‹ç‰©ç®¡ç†å‘¢ï¼Œç®€å•ï¼Œå¾€ä¸‹çœ‹ã€‚ å£°æ˜å¼äº‹åŠ¡æ‰¾åˆ°serviceå®ç°ç±»ï¼ŒåŠ ä¸Š@Transactional æ³¨è§£å°±è¡Œï¼Œæ­¤@Transactionalæ³¨è§£æ¥è‡ªorg.springframework.transaction.annotationåŒ… ï¼Œä¸æ˜¯æ¥è‡ªjavax.transaction ã€‚è€Œä¸”@Transactionalä¸ä»…å¯ä»¥æ³¨è§£åœ¨æ–¹æ³•ä¸Šï¼Œä¹Ÿå¯ä»¥æ³¨è§£åœ¨ç±»ä¸Šã€‚å½“æ³¨è§£åœ¨ç±»ä¸Šçš„æ—¶å€™æ„å‘³ç€æ­¤ç±»çš„æ‰€æœ‰publicæ–¹æ³•éƒ½æ˜¯å¼€å¯äº‹åŠ¡çš„ã€‚å¦‚æœç±»çº§åˆ«å’Œæ–¹æ³•çº§åˆ«åŒæ—¶ä½¿ç”¨äº†@Transactionalæ³¨è§£ï¼Œåˆ™ä½¿ç”¨åœ¨ç±»çº§åˆ«çš„æ³¨è§£ä¼šé‡è½½æ–¹æ³•çº§åˆ«çš„æ³¨è§£ã€‚ æ³¨æ„ï¼šSpringbootæä¾›äº†ä¸€ä¸ª@EnableTransactionManagementæ³¨è§£åœ¨é…ç½®ç±»ä¸Šæ¥å¼€å¯å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒã€‚æ³¨è§£@EnableTransactionManagementæ˜¯é»˜è®¤æ‰“å¼€çš„ï¼Œæƒ³è¦å…³é—­äº‹åŠ¡ç®¡ç†ï¼Œæƒ³è¦åœ¨ç¨‹åºå…¥å£å°†è¿™ä¸ªæ³¨è§£æ”¹ä¸ºfalse åˆ†å¸ƒå¼äº‹ç‰©ç®¡ç†å•¥æ˜¯åˆ†å¸ƒå¼äº‹åŠ¡å‘¢ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨æ‰§è¡Œä¸€ä¸ªä¸šåŠ¡é€»è¾‘çš„æ—¶å€™æœ‰ä¸¤æ­¥åˆ†åˆ«æ“ä½œAæ•°æ®æºå’ŒBæ•°æ®æºï¼Œå½“æˆ‘ä»¬åœ¨Aæ•°æ®æºæ‰§è¡Œæ•°æ®æ›´æ”¹åï¼Œåœ¨Bæ•°æ®æºæ‰§è¡Œæ—¶å‡ºç°è¿è¡Œæ—¶å¼‚å¸¸ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»è¦è®©Bæ•°æ®æºçš„æ“ä½œå›æ»šï¼Œå¹¶å›æ»šå¯¹Aæ•°æ®æºçš„æ“ä½œã€‚è¿™ç§æƒ…å†µåœ¨æ”¯ä»˜ä¸šåŠ¡æ—¶å¸¸å¸¸å‡ºç°ï¼Œæ¯”å¦‚ä¹°ç¥¨ä¸šåŠ¡åœ¨æœ€åæ”¯ä»˜å¤±è´¥ï¼Œé‚£ä¹‹å‰çš„æ“ä½œå¿…é¡»å…¨éƒ¨å›æ»šï¼Œå¦‚æœä¹‹å‰çš„æ“ä½œåˆ†å¸ƒåœ¨å¤šä¸ªæ•°æ®æºä¸­ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯å…¸å‹çš„åˆ†å¸ƒå¼äº‹åŠ¡å›æ»š äº†è§£äº†ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œé‚£åˆ†å¸ƒå¼äº‹åŠ¡åœ¨javaçš„è§£å†³æ–¹æ¡ˆå°±æ˜¯JTA(å³Java Transaction API)ã€‚ springbootå®˜æ–¹æä¾›äº† Atomikos ï¼Œ Bitronix ï¼ŒNarayana çš„ç±»äº‹åŠ¡ç®¡ç†å™¨ ç±»äº‹åŠ¡ç®¡ç†å™¨AtomikosPOM1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jta-atomikos&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®æ–‡ä»¶12345678910111213141516171819202122232425# Mysql 1mysql.datasource.test1.url = jdbc:mysql://localhost:3306/test01?useUnicode=true&amp;characterEncoding=utf-8mysql.datasource.test1.username = rootmysql.datasource.test1.password = 123456mysql.datasource.test1.minPoolSize = 3mysql.datasource.test1.maxPoolSize = 25mysql.datasource.test1.maxLifetime = 20000mysql.datasource.test1.borrowConnectionTimeout = 30mysql.datasource.test1.loginTimeout = 30mysql.datasource.test1.maintenanceInterval = 60mysql.datasource.test1.maxIdleTime = 60# Mysql 2mysql.datasource.test2.url =jdbc:mysql://localhost:3306/test02?useUnicode=true&amp;characterEncoding=utf-8mysql.datasource.test2.username =rootmysql.datasource.test2.password =123456mysql.datasource.test2.minPoolSize = 3mysql.datasource.test2.maxPoolSize = 25mysql.datasource.test2.maxLifetime = 20000mysql.datasource.test2.borrowConnectionTimeout = 30mysql.datasource.test2.loginTimeout = 30mysql.datasource.test2.maintenanceInterval = 60mysql.datasource.test2.maxIdleTime = 60 è¯»å–é…ç½®æ–‡ä»¶ä¿¡æ¯ä»¥ä¸‹æ˜¯è¯»å–æ•°æ®åº“1çš„é…ç½®æ–‡ä»¶ 123456789101112131415@Data@ConfigurationProperties(prefix = "mysql.datasource.test1")public class DBConfig1 &#123; private String url; private String username; private String password; private int minPoolSize; private int maxPoolSize; private int maxLifetime; private int borrowConnectionTimeout; private int loginTimeout; private int maintenanceInterval; private int maxIdleTime; private String testQuery;&#125; è¯»å–æ•°æ®åº“2çš„é…ç½®æ–‡ä»¶ç•¥ åˆ›å»ºæ•°æ®æºæ•°æ®æº1ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647@Configuration// basePackages æœ€å¥½åˆ†å¼€é…ç½® å¦‚æœæ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹å¯èƒ½ä¼šæŠ¥é”™@MapperScan(basePackages = "tech.tengshe789.test01", sqlSessionTemplateRef = "testSqlSessionTemplate")public class MyBatisConfig1 &#123; // é…ç½®æ•°æ®æº @Primary @Bean(name = "testDataSource") public DataSource testDataSource(DBConfig1 testConfig) throws SQLException &#123; MysqlXADataSource mysqlXaDataSource = new MysqlXADataSource(); mysqlXaDataSource.setUrl(testConfig.getUrl()); mysqlXaDataSource.setPinGlobalTxToPhysicalConnection(true); mysqlXaDataSource.setPassword(testConfig.getPassword()); mysqlXaDataSource.setUser(testConfig.getUsername()); mysqlXaDataSource.setPinGlobalTxToPhysicalConnection(true); AtomikosDataSourceBean xaDataSource = new AtomikosDataSourceBean(); xaDataSource.setXaDataSource(mysqlXaDataSource); xaDataSource.setUniqueResourceName("testDataSource"); xaDataSource.setMinPoolSize(testConfig.getMinPoolSize()); xaDataSource.setMaxPoolSize(testConfig.getMaxPoolSize()); xaDataSource.setMaxLifetime(testConfig.getMaxLifetime()); xaDataSource.setBorrowConnectionTimeout(testConfig.getBorrowConnectionTimeout()); xaDataSource.setLoginTimeout(testConfig.getLoginTimeout()); xaDataSource.setMaintenanceInterval(testConfig.getMaintenanceInterval()); xaDataSource.setMaxIdleTime(testConfig.getMaxIdleTime()); xaDataSource.setTestQuery(testConfig.getTestQuery()); return xaDataSource; &#125; @Primary @Bean(name = "testSqlSessionFactory") public SqlSessionFactory testSqlSessionFactory(@Qualifier("testDataSource") DataSource dataSource) throws Exception &#123; SqlSessionFactoryBean bean = new SqlSessionFactoryBean(); bean.setDataSource(dataSource); return bean.getObject(); &#125; @Primary @Bean(name = "testSqlSessionTemplate") public SqlSessionTemplate testSqlSessionTemplate( @Qualifier("testSqlSessionFactory") SqlSessionFactory sqlSessionFactory) throws Exception &#123; return new SqlSessionTemplate(sqlSessionFactory); &#125;&#125; æ•°æ®åº“2ç•¥ å¦‚ä½•å¯åŠ¨1234567@EnableConfigurationProperties(value = &#123; DBConfig1.class, DBConfig2.class &#125;)@SpringBootApplicationpublic class MainApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(MainApplication.class, args); &#125; &#125; å®šæ—¶ä»»åŠ¡åœ¨åšé¡¹ç›®æ—¶æœ‰æ—¶å€™ä¼šæœ‰å®šæ—¶å™¨ä»»åŠ¡çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æŸæŸæ—¶é—´åº”è¯¥åšä»€ä¹ˆï¼Œå¤šå°‘ç§’åº”è¯¥æ€ä¹ˆæ ·ä¹‹ç±»çš„ã€‚ springæ”¯æŒå¤šç§å®šæ—¶ä»»åŠ¡çš„å®ç°ã€‚æˆ‘ä»¬æ¥ä»‹ç»ä¸‹ä½¿ç”¨Quartz å’ŒScheduler Spring ScheduleSpring Schedule å®ç°å®šæ—¶ä»»åŠ¡æœ‰ä¸¤ç§æ–¹å¼ 1. ä½¿ç”¨XMLé…ç½®å®šæ—¶ä»»åŠ¡ï¼Œ 2. ä½¿ç”¨ @Scheduled æ³¨è§£ã€‚ ä»£ç å›ºå®šç­‰å¾…æ—¶é—´ @Scheduled(fixedDelay = æ—¶é—´é—´éš” ) å›ºå®šé—´éš”æ—¶é—´ @Scheduled(fixedRate = æ—¶é—´é—´éš” ) 123456789101112@Componentpublic class ScheduleJobs &#123; public final static long SECOND = 1 * 1000; FastDateFormat fdf = FastDateFormat.getInstance("yyyy-MM-dd HH:mm:ss"); @Scheduled(fixedDelay = SECOND * 2) public void fixedDelayJob() throws InterruptedException &#123; TimeUnit.SECONDS.sleep(2); System.out.println("[FixedDelayJob Execute]"+fdf.format(new Date())); &#125;&#125; Cornè¡¨è¾¾å¼ @Scheduled(cron = Cornè¡¨è¾¾å¼) 1234567891011@Componentpublic class ScheduleJobs &#123; public final static long SECOND = 1 * 1000; FastDateFormat fdf = FastDateFormat.getInstance("yyyy-MM-dd HH:mm:ss"); @Scheduled(cron = "0/4 * * * * ?") public void cronJob() &#123; System.out.println("[CronJob Execute]"+fdf.format(new Date())); &#125;&#125; å¯åŠ¨è¦åœ¨ä¸»æ–¹æ³•ä¸ŠåŠ ä¸Š@EnableScheduling QuartzPOM1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-quartz-starter&lt;/artifactId&gt; &lt;/dependency&gt; é…ç½®æ–‡ä»¶1234567891011121314# spring boot 2.x å·²é›†æˆQuartzï¼Œæ— éœ€è‡ªå·±é…ç½®spring.quartz.job-store-type=jdbcspring.quartz.properties.org.quartz.scheduler.instanceName=clusteredSchedulerspring.quartz.properties.org.quartz.scheduler.instanceId=AUTOspring.quartz.properties.org.quartz.jobStore.class=org.quartz.impl.jdbcjobstore.JobStoreTXspring.quartz.properties.org.quartz.jobStore.driverDelegateClass=org.quartz.impl.jdbcjobstore.StdJDBCDelegatespring.quartz.properties.org.quartz.jobStore.tablePrefix=QRTZ_spring.quartz.properties.org.quartz.jobStore.isClustered=truespring.quartz.properties.org.quartz.jobStore.clusterCheckinInterval=10000spring.quartz.properties.org.quartz.jobStore.useProperties=falsespring.quartz.properties.org.quartz.threadPool.class=org.quartz.simpl.SimpleThreadPoolspring.quartz.properties.org.quartz.threadPool.threadCount=10spring.quartz.properties.org.quartz.threadPool.threadPriority=5spring.quartz.properties.org.quartz.threadPool.threadsInheritContextClassLoaderOfInitializingThread=true é…ç½®ç±»12345678910111213141516@Configurationpublic class QuartzConfig &#123; @Bean public JobDetail uploadTaskDetail() &#123; return JobBuilder.newJob(UploadTask.class).withIdentity("uploadTask").storeDurably().build(); &#125; @Bean public Trigger uploadTaskTrigger() &#123; CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule("*/5 * * * * ?"); return TriggerBuilder.newTrigger().forJob(uploadTaskDetail()) .withIdentity("uploadTask") .withSchedule(scheduleBuilder) .build(); &#125;&#125; å®ç°ç±»åˆ›å»ºä¸€ä¸ªé…ç½®ç±»ï¼Œåˆ†åˆ«åˆ¶å®šå…·ä½“ä»»åŠ¡ç±»å’Œè§¦å‘çš„è§„åˆ™ 12345678910111213141516@Configuration@DisallowConcurrentExecutionpublic class UploadTask extends QuartzJobBean &#123; @Resource private TencentYunService tencentYunService; @Override protected void executeInternal(JobExecutionContext jobExecutionContext) throws JobExecutionException &#123; System.out.println("ä»»åŠ¡å¼€å§‹"); try &#123; Thread.sleep(6000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println("ä»»åŠ¡ç»“æŸ"); &#125;&#125; @DisallowConcurrentExecutionç¦æ­¢å¹¶å‘æ‰§è¡Œ å¹¶å‘æ‰§è¡Œæ–¹é¢ï¼Œç³»ç»Ÿé»˜è®¤ä¸ºtrue,å³ç¬¬ä¸€ä¸ªä»»åŠ¡è¿˜æœªæ‰§è¡Œå®Œæ•´ï¼Œç¬¬äºŒä¸ªä»»åŠ¡å¦‚æœåˆ°äº†æ‰§è¡Œæ—¶é—´ï¼Œåˆ™ä¼šç«‹é©¬å¼€å¯æ–°çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œè¿™æ ·å¦‚æœæˆ‘ä»¬æ˜¯ä»æ•°æ®åº“è¯»å–ä¿¡æ¯ï¼Œä¸¤æ¬¡é‡å¤è¯»å–å¯èƒ½å‡ºç°é‡å¤æ‰§è¡Œä»»åŠ¡çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªå€¼è®¾ç½®ä¸ºfalseï¼Œè¿™æ ·ç¬¬äºŒä¸ªä»»åŠ¡ä¼šå¾€åæ¨è¿Ÿï¼Œåªæœ‰åœ¨ç¬¬ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåæ‰ä¼šæ‰§è¡Œç¬¬äºŒä¸ªä»»åŠ¡ æ—¥å¿—ç®¡ç†log4jPOM12345678910111213141516171819&lt;!-- spring boot start --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;exclusions&gt; &lt;!-- æ’é™¤è‡ªå¸¦çš„logbackä¾èµ– --&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;!-- springboot-log4j --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-log4j&lt;/artifactId&gt; &lt;version&gt;1.3.8.RELEASE&lt;/version&gt; &lt;/dependency&gt; é…ç½®æ–‡ä»¶æ–‡ä»¶åç§°log4j.properties 1234567891011121314151617181920212223242526272829303132#log4j.rootLogger=CONSOLE,info,error,DEBUGlog4j.rootLogger=info,error,CONSOLE,DEBUGlog4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout log4j.appender.CONSOLE.layout.ConversionPattern=%d&#123;yyyy-MM-dd-HH-mm&#125; [%t] [%c] [%p] - %m%n log4j.logger.info=infolog4j.appender.info=org.apache.log4j.DailyRollingFileAppenderlog4j.appender.info.layout=org.apache.log4j.PatternLayout log4j.appender.info.layout.ConversionPattern=%d&#123;yyyy-MM-dd-HH-mm&#125; [%t] [%c] [%p] - %m%n log4j.appender.info.datePattern='.'yyyy-MM-ddlog4j.appender.info.Threshold = info log4j.appender.info.append=true #log4j.appender.info.File=/home/admin/pms-api-services/logs/info/api_services_infolog4j.appender.info.File=/Users/dddd/Documents/testspace/pms-api-services/logs/info/api_services_infolog4j.logger.error=error log4j.appender.error=org.apache.log4j.DailyRollingFileAppenderlog4j.appender.error.layout=org.apache.log4j.PatternLayout log4j.appender.error.layout.ConversionPattern=%d&#123;yyyy-MM-dd-HH-mm&#125; [%t] [%c] [%p] - %m%n log4j.appender.error.datePattern='.'yyyy-MM-ddlog4j.appender.error.Threshold = error log4j.appender.error.append=true #log4j.appender.error.File=/home/admin/pms-api-services/logs/error/api_services_errorlog4j.appender.error.File=/Users/dddd/Documents/testspace/pms-api-services/logs/error/api_services_errorlog4j.logger.DEBUG=DEBUGlog4j.appender.DEBUG=org.apache.log4j.DailyRollingFileAppenderlog4j.appender.DEBUG.layout=org.apache.log4j.PatternLayout log4j.appender.DEBUG.layout.ConversionPattern=%d&#123;yyyy-MM-dd-HH-mm&#125; [%t] [%c] [%p] - %m%n log4j.appender.DEBUG.datePattern='.'yyyy-MM-ddlog4j.appender.DEBUG.Threshold = DEBUG log4j.appender.DEBUG.append=true #log4j.appender.DEBUG.File=/home/admin/pms-api-services/logs/debug/api_services_debuglog4j.appender.DEBUG.File=/Users/dddd/Documents/testspace/pms-api-services/logs/debug/api_services_debug ä½¿ç”¨1private static final Logger logger = LoggerFactory.getLogger(IndexController.class); ä½¿ç”¨AOPç»Ÿä¸€å¤„ç†Webè¯·æ±‚æ—¥å¿—POM1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt; &lt;/dependency&gt; ä»£ç 1234567891011121314151617181920212223242526272829303132@Aspect@Componentpublic class WebLogAspect &#123; private static final Logger logger = LoggerFactory.getLogger(WebLogAspect.class); @Pointcut("execution(public * tech.tengshe789.controller.*.*(..))") public void webLog() &#123; &#125; @Before("webLog()") public void doBefore(JoinPoint joinPoint) throws Throwable &#123; // æ¥æ”¶åˆ°è¯·æ±‚ï¼Œè®°å½•è¯·æ±‚å†…å®¹ ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes(); HttpServletRequest request = attributes.getRequest(); // è®°å½•ä¸‹è¯·æ±‚å†…å®¹ logger.info("URL : " + request.getRequestURL().toString()); logger.info("HTTP_METHOD : " + request.getMethod()); logger.info("IP : " + request.getRemoteAddr()); Enumeration&lt;String&gt; enu = request.getParameterNames(); while (enu.hasMoreElements()) &#123; String name = (String) enu.nextElement(); logger.info("name:&#123;&#125;,value:&#123;&#125;", name, request.getParameter(name)); &#125; &#125; @AfterReturning(returning = "ret", pointcut = "webLog()") public void doAfterReturning(Object ret) throws Throwable &#123; // å¤„ç†å®Œè¯·æ±‚ï¼Œè¿”å›å†…å®¹ logger.info("RESPONSE : " + ret); &#125;&#125; lombok æ’ä»¶éå¸¸ç®€å•çš„åŠæ³• POM12345&lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;version&gt;1.18.0&lt;/version&gt; &lt;/dependency&gt; ä»£ç ç±»ä¸­æ·»åŠ @Slf4j æ³¨è§£å³å¯ã€‚ä½¿ç”¨æ˜¯ç›´æ¥è¾“å…¥logå…¨å±€å˜é‡ Lombokçš„å…¶ä»–ç”¨æ³•123456789101112131415@Data æ ‡ç­¾ï¼Œç”Ÿæˆgetter/setter toString()ç­‰æ–¹æ³• @NonNull : è®©ä½ ä¸åœ¨æ‹…å¿§å¹¶ä¸”çˆ±ä¸ŠNullPointerException @CleanUp : è‡ªåŠ¨èµ„æºç®¡ç†ï¼šä¸ç”¨å†åœ¨finallyä¸­æ·»åŠ èµ„æºçš„closeæ–¹æ³• @Setter/@Getter : è‡ªåŠ¨ç”Ÿæˆsetå’Œgetæ–¹æ³• @ToString : è‡ªåŠ¨ç”ŸæˆtoStringæ–¹æ³• @EqualsAndHashcode : ä»å¯¹è±¡çš„å­—æ®µä¸­ç”ŸæˆhashCodeå’Œequalsçš„å®ç° @NoArgsConstructor/@RequiredArgsConstructor/@AllArgsConstructor è‡ªåŠ¨ç”Ÿæˆæ„é€ æ–¹æ³• @Data : è‡ªåŠ¨ç”Ÿæˆset/getæ–¹æ³•ï¼ŒtoStringæ–¹æ³•ï¼Œequalsæ–¹æ³•ï¼ŒhashCodeæ–¹æ³•ï¼Œä¸å¸¦å‚æ•°çš„æ„é€ æ–¹æ³• @Value : ç”¨äºæ³¨è§£finalç±» @Builder : äº§ç”Ÿå¤æ‚çš„æ„å»ºå™¨apiç±»@SneakyThrows : å¼‚å¸¸å¤„ç†ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰ @Synchronized : åŒæ­¥æ–¹æ³•å®‰å…¨çš„è½¬åŒ– @Getter(lazy=true) : @Log : æ”¯æŒå„ç§loggerå¯¹è±¡ï¼Œä½¿ç”¨æ—¶ç”¨å¯¹åº”çš„æ³¨è§£ï¼Œå¦‚ï¼š@Log4 æ‹¦æˆªå™¨æ‹¦æˆªå™¨ï¼Œåœ¨AOP(Aspect-Oriented Programming)ä¸­ç”¨äºåœ¨æŸä¸ªæ–¹æ³•æˆ–å­—æ®µè¢«è®¿é—®ä¹‹å‰ï¼Œè¿›è¡Œæ‹¦æˆªï¼Œç„¶ååœ¨ä¹‹å‰æˆ–ä¹‹ååŠ å…¥æŸäº›æ“ä½œã€‚æ‹¦æˆªæ˜¯AOPçš„ä¸€ç§å®ç°ç­–ç•¥ã€‚ ï¼ˆ1ï¼‰æ‹¦æˆªå™¨æ˜¯åŸºäºjavaçš„åå°„æœºåˆ¶çš„ï¼Œè€Œè¿‡æ»¤å™¨æ˜¯åŸºäºå‡½æ•°å›è°ƒã€‚ ï¼ˆ2ï¼‰æ‹¦æˆªå™¨ä¸ä¾èµ–äºservletå®¹å™¨ï¼Œè€Œè¿‡æ»¤å™¨ä¾èµ–äºservletå®¹å™¨ã€‚ ï¼ˆ3ï¼‰æ‹¦æˆªå™¨åªèƒ½å¯¹Controllerè¯·æ±‚èµ·ä½œç”¨ï¼Œè€Œè¿‡æ»¤å™¨åˆ™å¯ä»¥å¯¹å‡ ä¹æ‰€æœ‰çš„è¯·æ±‚èµ·ä½œç”¨ã€‚ ï¼ˆ4ï¼‰åœ¨Controllerçš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œæ‹¦æˆªå™¨å¯ä»¥å¤šæ¬¡è¢«è°ƒç”¨ï¼Œè€Œè¿‡æ»¤å™¨åªèƒ½åœ¨å®¹å™¨åˆå§‹åŒ–æ—¶è¢«è°ƒç”¨ä¸€æ¬¡ã€‚ è¿‡æ»¤å™¨ï¼ˆfilterï¼‰å’Œæ‹¦æˆªå™¨ï¼ˆinterceptorï¼‰æ˜¯æœ‰åŒºåˆ«çš„ï¼Œè¯¦æƒ… ï¼Œä»–ä»¬çš„æ‰§è¡Œé¡ºåºï¼š å…ˆfilter å interceptor -&gt;è¿‡æ»¤å™¨åº”ç”¨åœºæ™¯:è®¾ç½®ç¼–ç å­—ç¬¦ã€è¿‡æ»¤é“­æ„Ÿå­—ç¬¦ -&gt;æ‹¦æˆªå™¨åº”ç”¨åœºæ™¯:æ‹¦æˆªæœªç™»é™†ç”¨æˆ·ã€å®¡è®¡æ—¥å¿— è‡ªå®šä¹‰æ‹¦æˆªå™¨ä»£ç æ³¨å†Œæ‹¦æˆªå™¨ 123456789101112131415@Configurationpublic class WebAppConfig &#123; @Autowired private LoginIntercept loginIntercept; @Bean public WebMvcConfigurer WebMvcConfigurer() &#123; return new WebMvcConfigurer() &#123; public void addInterceptors(InterceptorRegistry registry) &#123; registry.addInterceptor(loginIntercept).addPathPatterns("/*"); &#125;; &#125;; &#125;&#125; åˆ›å»ºæ¨¡æ‹Ÿç™»å½•æ‹¦æˆªå™¨ï¼ŒéªŒè¯è¯·æ±‚æ˜¯å¦æœ‰tokenå‚æ•° 123456789101112131415@Slf4j@Componentpublic class LoginIntercept implements HandlerInterceptor &#123; public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception &#123; log.info("å¼€å§‹æ‹¦æˆªç™»å½•è¯·æ±‚...."); String token = request.getParameter("token"); if (StringUtils.isEmpty(token)) &#123; response.getWriter().println("not found token"); return false; &#125; return true; &#125;&#125; ç¼“å­˜åœ¨ Spring Bootä¸­ï¼Œé€šè¿‡@EnableCachingæ³¨è§£è‡ªåŠ¨åŒ–é…ç½®åˆé€‚çš„ç¼“å­˜ç®¡ç†å™¨ï¼ˆCacheManagerï¼‰ï¼ŒSpring Bootæ ¹æ®ä¸‹é¢çš„é¡ºåºå»ä¾¦æµ‹ç¼“å­˜æä¾›è€…ï¼š Generic ï¼Œ JCache (JSR-107)ï¼Œ EhCache 2.x ï¼ŒHazelcast ï¼Œ Infinispan ï¼ŒRedis ï¼ŒGuava ï¼Œ Simple EhCachePOM1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt;&lt;/dependency&gt; æ–°å»ºehcache.xml æ–‡ä»¶123456789101112131415&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://ehcache.org/ehcache.xsd" updateCheck="false"&gt; &lt;diskStore path="java.io.tmpdir/Tmp_EhCache" /&gt; &lt;!-- é»˜è®¤é…ç½® --&gt; &lt;defaultCache maxElementsInMemory="5000" eternal="false" timeToIdleSeconds="120" timeToLiveSeconds="120" memoryStoreEvictionPolicy="LRU" overflowToDisk="false" /&gt; &lt;cache name="baseCache" maxElementsInMemory="10000" maxElementsOnDisk="100000" /&gt;&lt;/ehcache&gt; é…ç½®ä¿¡æ¯ä»‹ç» name:ç¼“å­˜åç§°ã€‚ maxElementsInMemoryï¼šç¼“å­˜æœ€å¤§ä¸ªæ•°ã€‚ eternal:å¯¹è±¡æ˜¯å¦æ°¸ä¹…æœ‰æ•ˆï¼Œä¸€ä½†è®¾ç½®äº†ï¼Œtimeoutå°†ä¸èµ·ä½œç”¨ã€‚ timeToIdleSecondsï¼šè®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰çš„å…è®¸é—²ç½®æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œå¯é€‰å±æ€§ï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œä¹Ÿå°±æ˜¯å¯é—²ç½®æ—¶é—´æ— ç©·å¤§ã€‚ timeToLiveSecondsï¼šè®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰å…è®¸å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚æœ€å¤§æ—¶é—´ä»‹äºåˆ›å»ºæ—¶é—´å’Œå¤±æ•ˆæ—¶é—´ä¹‹é—´ã€‚ä»…å½“eternal=falseå¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œé»˜è®¤æ˜¯0.ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡å­˜æ´»æ—¶é—´æ— ç©·å¤§ã€‚ overflowToDiskï¼šå½“å†…å­˜ä¸­å¯¹è±¡æ•°é‡è¾¾åˆ°maxElementsInMemoryæ—¶ï¼ŒEhcacheå°†ä¼šå¯¹è±¡å†™åˆ°ç£ç›˜ä¸­ã€‚ diskSpoolBufferSizeMBï¼šè¿™ä¸ªå‚æ•°è®¾ç½®DiskStoreï¼ˆç£ç›˜ç¼“å­˜ï¼‰çš„ç¼“å­˜åŒºå¤§å°ã€‚é»˜è®¤æ˜¯30MBã€‚æ¯ä¸ªCacheéƒ½åº”è¯¥æœ‰è‡ªå·±çš„ä¸€ä¸ªç¼“å†²åŒºã€‚ maxElementsOnDiskï¼šç¡¬ç›˜æœ€å¤§ç¼“å­˜ä¸ªæ•°ã€‚ diskPersistentï¼šæ˜¯å¦ç¼“å­˜è™šæ‹Ÿæœºé‡å¯æœŸæ•°æ® Whether the disk store persists between restarts of the Virtual Machine. The default value is false. diskExpiryThreadIntervalSecondsï¼šç£ç›˜å¤±æ•ˆçº¿ç¨‹è¿è¡Œæ—¶é—´é—´éš”ï¼Œé»˜è®¤æ˜¯120ç§’ã€‚ memoryStoreEvictionPolicyï¼šå½“è¾¾åˆ°maxElementsInMemoryé™åˆ¶æ—¶ï¼ŒEhcacheå°†ä¼šæ ¹æ®æŒ‡å®šçš„ç­–ç•¥å»æ¸…ç†å†…å­˜ã€‚é»˜è®¤ç­–ç•¥æ˜¯LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ã€‚ä½ å¯ä»¥è®¾ç½®ä¸ºFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æˆ–æ˜¯LFUï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰ã€‚ clearOnFlushï¼šå†…å­˜æ•°é‡æœ€å¤§æ—¶æ˜¯å¦æ¸…é™¤ã€‚ å…³äºæ³¨è§£å’Œä»£ç ä½¿ç”¨123456@CacheConfig(cacheNames = "baseCache")public interface UserDao &#123; @Select("select * from users where name=#&#123;name&#125;") @Cacheable UserEntity findName(@Param("name") String name);&#125; æ¸…é™¤ç¼“å­˜123456@Autowiredprivate CacheManager cacheManager;@RequestMapping("/remoKey")public void remoKey() &#123; cacheManager.getCache("baseCache").clear();&#125; å¯åŠ¨ä¸»æ–¹æ³•å¯åŠ¨æ—¶åŠ ä¸Š@EnableCachingå³å¯ Redisä½¿ç”¨è‡ªå¸¦é©±åŠ¨å™¨è¿æ¥ä½¿ç”¨RedisTemplate è¿æ¥ POM1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt; &lt;/dependency&gt; é…ç½®æ–‡ä»¶å•æœº 12345678910111213141516171819#redis# Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰spring.redis.database=0# RedisæœåŠ¡å™¨åœ°å€spring.redis.host=127.0.0.1# RedisæœåŠ¡å™¨è¿æ¥ç«¯å£spring.redis.port=6379# RedisæœåŠ¡å™¨è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰spring.redis.password=# è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰spring.redis.pool.max-active=8# è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰spring.redis.pool.max-wait=-1# è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥spring.redis.pool.max-idle=8# è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥spring.redis.pool.min-idle=0# è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰spring.redis.timeout=0 é›†ç¾¤æˆ–å“¨å…µæ¨¡å¼ 1234567891011121314151617181920212223242526272829303132333435363738#Matserçš„ipåœ°å€ redis.hostName=192.168.177.128#ç«¯å£å· redis.port=6382#å¦‚æœæœ‰å¯†ç  redis.password=#å®¢æˆ·ç«¯è¶…æ—¶æ—¶é—´å•ä½æ˜¯æ¯«ç§’ é»˜è®¤æ˜¯2000 redis.timeout=10000 #æœ€å¤§ç©ºé—²æ•° redis.maxIdle=300 #è¿æ¥æ± çš„æœ€å¤§æ•°æ®åº“è¿æ¥æ•°ã€‚è®¾ä¸º0è¡¨ç¤ºæ— é™åˆ¶,å¦‚æœæ˜¯jedis 2.4ä»¥åç”¨redis.maxTotal #redis.maxActive=600 #æ§åˆ¶ä¸€ä¸ªpoolå¯åˆ†é…å¤šå°‘ä¸ªjediså®ä¾‹,ç”¨æ¥æ›¿æ¢ä¸Šé¢çš„redis.maxActive,å¦‚æœæ˜¯jedis 2.4ä»¥åç”¨è¯¥å±æ€§ redis.maxTotal=1000 #æœ€å¤§å»ºç«‹è¿æ¥ç­‰å¾…æ—¶é—´ã€‚å¦‚æœè¶…è¿‡æ­¤æ—¶é—´å°†æ¥åˆ°å¼‚å¸¸ã€‚è®¾ä¸º-1è¡¨ç¤ºæ— é™åˆ¶ã€‚ redis.maxWaitMillis=1000 #è¿æ¥çš„æœ€å°ç©ºé—²æ—¶é—´ é»˜è®¤1800000æ¯«ç§’(30åˆ†é’Ÿ) redis.minEvictableIdleTimeMillis=300000 #æ¯æ¬¡é‡Šæ”¾è¿æ¥çš„æœ€å¤§æ•°ç›®,é»˜è®¤3 redis.numTestsPerEvictionRun=1024 #é€å‡ºæ‰«æçš„æ—¶é—´é—´éš”(æ¯«ç§’) å¦‚æœä¸ºè´Ÿæ•°,åˆ™ä¸è¿è¡Œé€å‡ºçº¿ç¨‹, é»˜è®¤-1 redis.timeBetweenEvictionRunsMillis=30000 #æ˜¯å¦åœ¨ä»æ± ä¸­å–å‡ºè¿æ¥å‰è¿›è¡Œæ£€éªŒ,å¦‚æœæ£€éªŒå¤±è´¥,åˆ™ä»æ± ä¸­å»é™¤è¿æ¥å¹¶å°è¯•å–å‡ºå¦ä¸€ä¸ª redis.testOnBorrow=true #åœ¨ç©ºé—²æ—¶æ£€æŸ¥æœ‰æ•ˆæ€§, é»˜è®¤false redis.testWhileIdle=true #redisé›†ç¾¤é…ç½® spring.redis.cluster.nodes=192.168.177.128:7001,192.168.177.128:7002,192.168.177.128:7003,192.168.177.128:7004,192.168.177.128:7005,192.168.177.128:7006spring.redis.cluster.max-redirects=3#å“¨å…µæ¨¡å¼#redis.sentinel.host1=192.168.177.128#redis.sentinel.port1=26379#redis.sentinel.host2=172.20.1.231 #redis.sentinel.port2=26379 é…ç½®ç±»12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152@Configuration@EnableCachingpublic class RedisConfig extends CachingConfigurerSupport&#123; @Value("$&#123;spring.redis.host&#125;") private String host; @Value("$&#123;spring.redis.port&#125;") private int port; @Value("$&#123;spring.redis.timeout&#125;") private int timeout; //è‡ªå®šä¹‰ç¼“å­˜keyç”Ÿæˆç­–ç•¥// @Bean// public KeyGenerator keyGenerator() &#123;// return new KeyGenerator()&#123;// @Override// public Object generate(Object target, java.lang.reflect.Method method, Object... params) &#123;// StringBuffer sb = new StringBuffer();// sb.append(target.getClass().getName());// sb.append(method.getName());// for(Object obj:params)&#123;// sb.append(obj.toString());// &#125;// return sb.toString();// &#125;// &#125;;// &#125; //ç¼“å­˜ç®¡ç†å™¨ @Bean public CacheManager cacheManager(@SuppressWarnings("rawtypes") RedisTemplate redisTemplate) &#123; RedisCacheManager cacheManager = new RedisCacheManager(redisTemplate); //è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ cacheManager.setDefaultExpiration(10000); return cacheManager; &#125; @Bean public RedisTemplate&lt;String, String&gt; redisTemplate(RedisConnectionFactory factory)&#123; StringRedisTemplate template = new StringRedisTemplate(factory); setSerializer(template);//è®¾ç½®åºåˆ—åŒ–å·¥å…· template.afterPropertiesSet(); return template; &#125; private void setSerializer(StringRedisTemplate template)&#123; @SuppressWarnings(&#123; "rawtypes", "unchecked" &#125;) Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class); ObjectMapper om = new ObjectMapper(); om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY); om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL); jackson2JsonRedisSerializer.setObjectMapper(om); template.setValueSerializer(jackson2JsonRedisSerializer); &#125;&#125; Dao123456789101112131415161718192021@Mapper@CacheConfig(cacheNames = "users")public interface UserMapper &#123; @Insert("insert into user(name,age) values(#&#123;name&#125;,#&#123;age&#125;)") int addUser(@Param("name")String name,@Param("age")String age); @Select("select * from user where id =#&#123;id&#125;") @Cacheable(key ="#p0") User findById(@Param("id") String id); @CachePut(key = "#p0") @Update("update user set name=#&#123;name&#125; where id=#&#123;id&#125;") void updataById(@Param("id")String id,@Param("name")String name); //å¦‚æœæŒ‡å®šä¸º trueï¼Œåˆ™æ–¹æ³•è°ƒç”¨åå°†ç«‹å³æ¸…ç©ºæ‰€æœ‰ç¼“å­˜ @CacheEvict(key ="#p0",allEntries=true) @Delete("delete from user where id=#&#123;id&#125;") void deleteById(@Param("id")String id); &#125; @Cacheableå°†æŸ¥è¯¢ç»“æœç¼“å­˜åˆ°redisä¸­ï¼Œï¼ˆkey=â€#p0â€ï¼‰æŒ‡å®šä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºredisçš„keyã€‚ @CachePutï¼ŒæŒ‡å®škeyï¼Œå°†æ›´æ–°çš„ç»“æœåŒæ­¥åˆ°redisä¸­ @CacheEvictï¼ŒæŒ‡å®škeyï¼Œåˆ é™¤ç¼“å­˜æ•°æ®ï¼ŒallEntries=true,æ–¹æ³•è°ƒç”¨åå°†ç«‹å³æ¸…é™¤ç¼“å­˜ ä½¿ç”¨Jedisè¿æ¥è¦æ³¨æ„ï¼Œredisåœ¨5.0ç‰ˆæœ¬ä»¥åä¸æ”¯æŒJedis POM1234&lt;dependency&gt; &lt;groupId&gt;redis.clients&lt;/groupId&gt; &lt;artifactId&gt;jedis&lt;/artifactId&gt; &lt;/dependency&gt; é…ç½®ç±»123456789101112@Data@Component@ConfigurationProperties(prefix="redis")public class RedisConfig &#123; private String host; private int port; private int timeout;//ç§’ private String password; private int poolMaxTotal; private int poolMaxIdle; private int poolMaxWait;//ç§’&#125; 123456789101112131415161718@Servicepublic class RedisPoolFactory &#123; @Autowired RedisConfig redisConfig; @Bean public JedisPool edisPoolFactory() &#123; JedisPoolConfig poolConfig = new JedisPoolConfig(); poolConfig.setMaxIdle(redisConfig.getPoolMaxIdle()); poolConfig.setMaxTotal(redisConfig.getPoolMaxTotal()); poolConfig.setMaxWaitMillis(redisConfig.getPoolMaxWait() * 1000); JedisPool jp = new JedisPool(poolConfig, redisConfig.getHost(), redisConfig.getPort(), redisConfig.getTimeout()*1000, redisConfig.getPassword(), 0); return jp; &#125;&#125; ç›‘æ§ä¸­å¿ƒSpringbootç›‘æ§ä¸­å¿ƒæ˜¯å¹²ä»€ä¹ˆçš„å‘¢ï¼Ÿä»–æ˜¯é’ˆå¯¹å¾®æœåŠ¡çš„ æœåŠ¡çŠ¶æ€ã€Httpè¯·æ±‚èµ„æºè¿›è¡Œç›‘æ§ï¼Œå¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å†…å­˜å˜åŒ–ï¼ˆå †å†…å­˜ã€çº¿ç¨‹ã€æ—¥å¿—ç®¡ç†ï¼‰ï¼Œå¯ä»¥æ£€æµ‹æœåŠ¡é…ç½®è¿æ¥åœ°å€æ˜¯å¦å¯ç”¨ï¼ˆæ¨¡æ‹Ÿè®¿é—®ï¼Œæ‡’åŠ è½½ï¼‰ï¼Œå¯ä»¥ç»Ÿè®¡æœ‰å¤šå°‘Beanæœ‰ä»€ä¹ˆå•ä¾‹å¤šä¾‹ï¼Œå¯ä»¥ç»Ÿè®¡SpringMVCæœ‰å¤šå°‘@RequestMapping ActuatorActuatoræ˜¯spring bootçš„ä¸€ä¸ªé™„åŠ åŠŸèƒ½,å¯å¸®åŠ©ä½ åœ¨åº”ç”¨ç¨‹åºç”Ÿäº§ç¯å¢ƒæ—¶ç›‘è§†å’Œç®¡ç†åº”ç”¨ç¨‹åºã€‚ å¯ä»¥ä½¿ç”¨HTTPçš„å„ç§è¯·æ±‚æ¥ç›‘ç®¡,å®¡è®¡,æ”¶é›†åº”ç”¨çš„è¿è¡Œæƒ…å†µ.è¿”å›çš„æ˜¯json ç¼ºç‚¹ï¼šæ²¡æœ‰å¯è§†åŒ–ç•Œé¢ã€‚ åœ¨springboot2.0ä¸­ï¼ŒActuatorçš„ç«¯ç‚¹ï¼ˆendpointï¼‰ç°åœ¨é»˜è®¤æ˜ å°„åˆ°/applicationï¼Œæ¯”å¦‚ï¼Œ/info ç«¯ç‚¹ç°åœ¨å°±æ˜¯åœ¨/application/infoã€‚ä½†ä½ å¯ä»¥ä½¿ç”¨management.context-pathæ¥è¦†ç›–æ­¤é»˜è®¤å€¼ã€‚ POM1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½®ä¿¡æ¯1234567891011121314# Actuator é€šè¿‡ä¸‹é¢çš„é…ç½®å¯ç”¨æ‰€æœ‰çš„ç›‘æ§ç«¯ç‚¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›ç«¯ç‚¹æ˜¯ç¦ç”¨çš„ï¼›management: endpoints: web: exposure: include: "*"spring: profiles: active: prod datasource: driver-class-name: com.mysql.jdbc.Driver url: jdbc:mysql://127.0.0.1:3306/test username: root password: 123456 Actuatorè®¿é—®è·¯å¾„é€šè¿‡actuator/+ç«¯ç‚¹åå°±å¯ä»¥è·å–ç›¸åº”çš„ä¿¡æ¯ã€‚ è·¯å¾„ ä½œç”¨ /actuator/beans æ˜¾ç¤ºåº”ç”¨ç¨‹åºä¸­æ‰€æœ‰Spring beançš„å®Œæ•´åˆ—è¡¨ã€‚ /actuator/configprops æ˜¾ç¤ºæ‰€æœ‰é…ç½®ä¿¡æ¯ã€‚ /actuator/env é™ˆåˆ—æ‰€æœ‰çš„ç¯å¢ƒå˜é‡ã€‚ /actuator/mappings æ˜¾ç¤ºæ‰€æœ‰@RequestMappingçš„urlæ•´ç†åˆ—è¡¨ã€‚ /actuator/health æ˜¾ç¤ºåº”ç”¨ç¨‹åºè¿è¡ŒçŠ¶å†µä¿¡æ¯ upè¡¨ç¤ºæˆåŠŸ downå¤±è´¥ /actuator/info æŸ¥çœ‹è‡ªå®šä¹‰åº”ç”¨ä¿¡æ¯ Admin-UIåˆ†å¸ƒå¼å¾®æœåŠ¡ç›‘æ§ä¸­å¿ƒAdmin-UIåº•å±‚ä½¿ç”¨actuatorï¼Œå®ç°ç›‘æ§ä¿¡æ¯ çš„ç•Œé¢ POM123456789101112131415161718192021222324&lt;!--æœåŠ¡ç«¯--&gt;&lt;dependency&gt; &lt;groupId&gt;de.codecentric&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-admin-starter-server&lt;/artifactId&gt; &lt;version&gt;2.0.0&lt;/version&gt;&lt;/dependency&gt;&lt;!--å®¢æˆ·ç«¯--&gt;&lt;dependency&gt; &lt;groupId&gt;de.codecentric&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-admin-starter-client&lt;/artifactId&gt; &lt;version&gt;2.0.0&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.jolokia&lt;/groupId&gt; &lt;artifactId&gt;jolokia-core&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.googlecode.json-simple&lt;/groupId&gt; &lt;artifactId&gt;json-simple&lt;/artifactId&gt; &lt;version&gt;1.1&lt;/version&gt; application.ymlé…ç½®æ–‡ä»¶123456789101112131415161718192021//æœåŠ¡ç«¯spring: application: name: spring-boot-admin-server//å®¢æˆ·ç«¯spring: boot: admin: client: url: http://localhost:8080server: port: 8081 management: endpoints: web: exposure: include: "*" endpoint: health: show-details: ALWAYS æ€§èƒ½ä¼˜åŒ–æ‰«åŒ…ä¼˜åŒ–é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ @SpringBootApplication æ³¨è§£æ¥è‡ªåŠ¨è·å–åº”ç”¨çš„é…ç½®ä¿¡æ¯ï¼Œä½†è¿™æ ·ä¹Ÿä¼šç»™åº”ç”¨å¸¦æ¥ä¸€äº›å‰¯ä½œç”¨ã€‚ä½¿ç”¨è¿™ä¸ªæ³¨è§£åï¼Œä¼šè§¦å‘è‡ªåŠ¨é…ç½®ï¼ˆ auto-configuration ï¼‰å’Œ ç»„ä»¶æ‰«æ ï¼ˆ component scanning ï¼‰ï¼Œè¿™è·Ÿä½¿ç”¨ @Configurationã€@EnableAutoConfiguration å’Œ @ComponentScan ä¸‰ä¸ªæ³¨è§£çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ã€‚è¿™æ ·åšç»™å¼€å‘å¸¦æ¥æ–¹ä¾¿çš„åŒæ—¶ï¼Œä¹Ÿä¼šæœ‰ä¸‰æ–¹é¢çš„å½±å“ï¼š 1ã€ä¼šå¯¼è‡´é¡¹ç›®å¯åŠ¨æ—¶é—´å˜é•¿ã€‚å½“å¯åŠ¨ä¸€ä¸ªå¤§çš„åº”ç”¨ç¨‹åº,æˆ–å°†åšå¤§é‡çš„é›†æˆæµ‹è¯•å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶ï¼Œå½±å“ä¼šç‰¹åˆ«æ˜æ˜¾ã€‚ 2ã€ä¼šåŠ è½½ä¸€äº›ä¸éœ€è¦çš„å¤šä½™çš„å®ä¾‹ï¼ˆbeansï¼‰ã€‚ 3ã€ä¼šå¢åŠ  CPU æ¶ˆè€—ã€‚ é’ˆå¯¹ä»¥ä¸Šä¸‰ä¸ªæƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ç§»é™¤ @SpringBootApplication å’Œ @ComponentScan ä¸¤ä¸ªæ³¨è§£æ¥ç¦ç”¨ç»„ä»¶è‡ªåŠ¨æ‰«æï¼Œç„¶ååœ¨æˆ‘ä»¬éœ€è¦çš„ bean ä¸Šè¿›è¡Œæ˜¾å¼é…ç½®ã€‚ SpringBoot JVMå‚æ•°è°ƒä¼˜å„ç§å‚æ•° å‚æ•°åç§° å«ä¹‰ é»˜è®¤å€¼ -Xms åˆå§‹å †å¤§å° ç‰©ç†å†…å­˜çš„1/64(&lt;1GB) é»˜è®¤(MinHeapFreeRatioå‚æ•°å¯ä»¥è°ƒæ•´)ç©ºä½™å †å†…å­˜å°äº40%æ—¶ï¼ŒJVMå°±ä¼šå¢å¤§å †ç›´åˆ°-Xmxçš„æœ€å¤§é™åˆ¶. -Xmx æœ€å¤§å †å¤§å° ç‰©ç†å†…å­˜çš„1/4(&lt;1GB) é»˜è®¤(MaxHeapFreeRatioå‚æ•°å¯ä»¥è°ƒæ•´)ç©ºä½™å †å†…å­˜å¤§äº70%æ—¶ï¼ŒJVMä¼šå‡å°‘å †ç›´åˆ° -Xmsçš„æœ€å°é™åˆ¶ -Xmn å¹´è½»ä»£å¤§å°(1.4or lator) æ³¨æ„ï¼šæ­¤å¤„çš„å¤§å°æ˜¯ï¼ˆeden+ 2 survivor space).ä¸jmap -heapä¸­æ˜¾ç¤ºçš„New genæ˜¯ä¸åŒçš„ã€‚ æ•´ä¸ªå †å¤§å°=å¹´è½»ä»£å¤§å° + å¹´è€ä»£å¤§å° + æŒä¹…ä»£å¤§å°. å¢å¤§å¹´è½»ä»£å,å°†ä¼šå‡å°å¹´è€ä»£å¤§å°.æ­¤å€¼å¯¹ç³»ç»Ÿæ€§èƒ½å½±å“è¾ƒå¤§,Sunå®˜æ–¹æ¨èé…ç½®ä¸ºæ•´ä¸ªå †çš„3/8 -XX:NewSize è®¾ç½®å¹´è½»ä»£å¤§å°(for 1.3/1.4) -XX:MaxNewSize å¹´è½»ä»£æœ€å¤§å€¼(for 1.3/1.4) -XX:PermSize è®¾ç½®æŒä¹…ä»£(perm gen)åˆå§‹å€¼ ç‰©ç†å†…å­˜çš„1/64 -XX:MaxPermSize è®¾ç½®æŒä¹…ä»£æœ€å¤§å€¼ ç‰©ç†å†…å­˜çš„1/4 -Xss æ¯ä¸ªçº¿ç¨‹çš„å †æ ˆå¤§å° JDK5.0ä»¥åæ¯ä¸ªçº¿ç¨‹å †æ ˆå¤§å°ä¸º1M,ä»¥å‰æ¯ä¸ªçº¿ç¨‹å †æ ˆå¤§å°ä¸º256K.æ›´å…·åº”ç”¨çš„çº¿ç¨‹æ‰€éœ€å†…å­˜å¤§å°è¿›è¡Œ è°ƒæ•´.åœ¨ç›¸åŒç‰©ç†å†…å­˜ä¸‹,å‡å°è¿™ä¸ªå€¼èƒ½ç”Ÿæˆæ›´å¤šçš„çº¿ç¨‹.ä½†æ˜¯æ“ä½œç³»ç»Ÿå¯¹ä¸€ä¸ªè¿›ç¨‹å†…çš„çº¿ç¨‹æ•°è¿˜æ˜¯æœ‰é™åˆ¶çš„,ä¸èƒ½æ— é™ç”Ÿæˆ,ç»éªŒå€¼åœ¨3000~5000å·¦å³ ä¸€èˆ¬å°çš„åº”ç”¨ï¼Œ å¦‚æœæ ˆä¸æ˜¯å¾ˆæ·±ï¼Œ åº”è¯¥æ˜¯128kå¤Ÿç”¨çš„ å¤§çš„åº”ç”¨å»ºè®®ä½¿ç”¨256kã€‚è¿™ä¸ªé€‰é¡¹å¯¹æ€§èƒ½å½±å“æ¯”è¾ƒå¤§ï¼Œéœ€è¦ä¸¥æ ¼çš„æµ‹è¯•ã€‚ï¼ˆæ ¡é•¿ï¼‰ å’Œthreadstacksizeé€‰é¡¹è§£é‡Šå¾ˆç±»ä¼¼,å®˜æ–¹æ–‡æ¡£ä¼¼ä¹æ²¡æœ‰è§£é‡Š,åœ¨è®ºå›ä¸­æœ‰è¿™æ ·ä¸€å¥è¯:â€â€ -Xss is translated in a VM flag named ThreadStackSizeâ€ ä¸€èˆ¬è®¾ç½®è¿™ä¸ªå€¼å°±å¯ä»¥äº†ã€‚ -XX:ThreadStackSize Thread Stack Size (0 means use default stack size) [Sparc: 512; Solaris x86: 320 (was 256 prior in 5.0 and earlier); Sparc 64 bit: 1024; Linux amd64: 1024 (was 0 in 5.0 and earlier); all others 0.] -XX:NewRatio å¹´è½»ä»£(åŒ…æ‹¬Edenå’Œä¸¤ä¸ªSurvivoråŒº)ä¸å¹´è€ä»£çš„æ¯”å€¼(é™¤å»æŒä¹…ä»£) -XX:NewRatio=4è¡¨ç¤ºå¹´è½»ä»£ä¸å¹´è€ä»£æ‰€å æ¯”å€¼ä¸º1:4,å¹´è½»ä»£å æ•´ä¸ªå †æ ˆçš„1/5 Xms=Xmxå¹¶ä¸”è®¾ç½®äº†Xmnçš„æƒ…å†µä¸‹ï¼Œè¯¥å‚æ•°ä¸éœ€è¦è¿›è¡Œè®¾ç½®ã€‚ -XX:SurvivorRatio EdenåŒºä¸SurvivoråŒºçš„å¤§å°æ¯”å€¼ è®¾ç½®ä¸º8,åˆ™ä¸¤ä¸ªSurvivoråŒºä¸ä¸€ä¸ªEdenåŒºçš„æ¯”å€¼ä¸º2:8,ä¸€ä¸ªSurvivoråŒºå æ•´ä¸ªå¹´è½»ä»£çš„1/10 -XX:LargePageSizeInBytes å†…å­˜é¡µçš„å¤§å°ä¸å¯è®¾ç½®è¿‡å¤§ï¼Œ ä¼šå½±å“Permçš„å¤§å° =128m -XX:+UseFastAccessorMethods åŸå§‹ç±»å‹çš„å¿«é€Ÿä¼˜åŒ– -XX:+DisableExplicitGC å…³é—­System.gc() è¿™ä¸ªå‚æ•°éœ€è¦ä¸¥æ ¼çš„æµ‹è¯• -XX:MaxTenuringThreshold åƒåœ¾æœ€å¤§å¹´é¾„ å¦‚æœè®¾ç½®ä¸º0çš„è¯,åˆ™å¹´è½»ä»£å¯¹è±¡ä¸ç»è¿‡SurvivoråŒº,ç›´æ¥è¿›å…¥å¹´è€ä»£. å¯¹äºå¹´è€ä»£æ¯”è¾ƒå¤šçš„åº”ç”¨,å¯ä»¥æé«˜æ•ˆç‡.å¦‚æœå°†æ­¤å€¼è®¾ç½®ä¸ºä¸€ä¸ªè¾ƒå¤§å€¼,åˆ™å¹´è½»ä»£å¯¹è±¡ä¼šåœ¨SurvivoråŒºè¿›è¡Œå¤šæ¬¡å¤åˆ¶,è¿™æ ·å¯ä»¥å¢åŠ å¯¹è±¡å†å¹´è½»ä»£çš„å­˜æ´» æ—¶é—´,å¢åŠ åœ¨å¹´è½»ä»£å³è¢«å›æ”¶çš„æ¦‚ç‡ è¯¥å‚æ•°åªæœ‰åœ¨ä¸²è¡ŒGCæ—¶æ‰æœ‰æ•ˆ. -XX:+AggressiveOpts åŠ å¿«ç¼–è¯‘ -XX:+UseBiasedLocking é”æœºåˆ¶çš„æ€§èƒ½æ”¹å–„ -Xnoclassgc ç¦ç”¨åƒåœ¾å›æ”¶ -XX:SoftRefLRUPolicyMSPerMB æ¯å…†å †ç©ºé—²ç©ºé—´ä¸­SoftReferenceçš„å­˜æ´»æ—¶é—´ 1s softly reachable objects will remain alive for some amount of time after the last time they were referenced. The default value is one second of lifetime per free megabyte in the heap -XX:PretenureSizeThreshold å¯¹è±¡è¶…è¿‡å¤šå¤§æ˜¯ç›´æ¥åœ¨æ—§ç”Ÿä»£åˆ†é… 0 å•ä½å­—èŠ‚ æ–°ç”Ÿä»£é‡‡ç”¨Parallel Scavenge GCæ—¶æ— æ•ˆ å¦ä¸€ç§ç›´æ¥åœ¨æ—§ç”Ÿä»£åˆ†é…çš„æƒ…å†µæ˜¯å¤§çš„æ•°ç»„å¯¹è±¡,ä¸”æ•°ç»„ä¸­æ— å¤–éƒ¨å¼•ç”¨å¯¹è±¡. -XX:TLABWasteTargetPercent TLABå edenåŒºçš„ç™¾åˆ†æ¯” 1% -XX:+CollectGen0First FullGCæ—¶æ˜¯å¦å…ˆYGC false è°ƒä¼˜ç­–ç•¥ åˆå§‹åŒ–å †å†…å­˜å’Œæœ€å¤§å †ç›¸åŒ å‡å°‘åƒåœ¾å›æ”¶æ¬¡æ•° å†…éƒ¨è°ƒä¼˜ è¾“å…¥ -XX:+PrintGCDetails æ˜¯ä¸ºäº†åœ¨æ§åˆ¶å°æ˜¾ç¤ºå›æ”¶çš„ä¿¡æ¯ å¤–éƒ¨è°ƒä¼˜è¿›å…¥å¯¹åº”jarçš„ç›®å½•ï¼Œåœ¨CMDè¾“å…¥java -server -Xms32m -Xmx32m -jar springboot.jar ä½¿ç”¨å·¥å…·java visual vm ä½¿ç”¨å·¥å…·java console å°†Servletå®¹å™¨ä»Tomcatå˜æˆUndertowUndertow æ˜¯ä¸€ä¸ªé‡‡ç”¨ Java å¼€å‘çš„çµæ´»çš„é«˜æ€§èƒ½ Web æœåŠ¡å™¨ï¼Œæä¾›åŒ…æ‹¬é˜»å¡å’ŒåŸºäº NIO çš„éå µå¡æœºåˆ¶ã€‚Undertow æ˜¯çº¢å¸½å…¬å¸çš„å¼€æºäº§å“ï¼Œæ˜¯ JBossé»˜è®¤çš„ Web æœåŠ¡å™¨ã€‚ğŸ‘‡ Undertow POMé¦–å…ˆï¼Œä»ä¾èµ–ä¿¡æ¯é‡Œç§»é™¤ Tomcat é…ç½® 12345678910&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt;&lt;/dependency&gt; ç„¶åæ·»åŠ  Undertowï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-undertow&lt;/artifactId&gt;&lt;/dependency&gt; Tomcat ä¼˜åŒ–è§ğŸ‘‰Spring Boot Memory Performance çƒ­éƒ¨ç½²çƒ­éƒ¨ç½²ï¼Œå°±æ˜¯åœ¨åº”ç”¨ç¨‹åºåœ¨ä¸åœæ­¢çš„æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨å®ç°æ–°çš„éƒ¨ç½² åŸç†ä½¿ç”¨ç±»åŠ è½½å™¨classroadæ¥æ£€æµ‹å­—èŠ‚ç æ–‡ä»¶ï¼Œç„¶åé‡æ–°åŠ è½½åˆ°jvmå†…å­˜ä¸­ ç¬¬ä¸€æ­¥ï¼šæ£€æµ‹æœ¬åœ°.classæ–‡ä»¶å˜åŠ¨ï¼ˆç‰ˆæœ¬å·ï¼Œä¿®æ”¹æ—¶é—´ä¸ä¸€æ ·ï¼‰ ç¬¬äºŒæ­¥ï¼šè‡ªåŠ¨ç›‘å¬ï¼Œå®ç°éƒ¨ç½² åº”ç”¨åœºæ™¯æœ¬åœ°å¼€å‘æ—¶ï¼Œå¯ä»¥æé«˜è¿è¡Œç¯å¢ƒ Dev-toolsspring-boot-devtools æ˜¯ä¸€ä¸ªä¸ºå¼€å‘è€…æœåŠ¡çš„ä¸€ä¸ªæ¨¡å—ï¼Œå…¶ä¸­æœ€é‡è¦çš„åŠŸèƒ½å°±æ˜¯è‡ªåŠ¨åº”ç”¨ä»£ç æ›´æ”¹åˆ°æœ€æ–°çš„Appä¸Šé¢å» POM123456&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;scope&gt;true&lt;/scope&gt;&lt;/dependency&gt; åŸç† devtoolsä¼šç›‘å¬classpathä¸‹çš„æ–‡ä»¶å˜åŠ¨ï¼Œå¹¶ä¸”ä¼šç«‹å³é‡å¯åº”ç”¨ï¼ˆå‘ç”Ÿåœ¨ä¿å­˜æ—¶æœºï¼‰ï¼Œå› ä¸ºå…¶é‡‡ç”¨çš„è™šæ‹Ÿæœºæœºåˆ¶ï¼Œè¯¥é¡¹é‡å¯æ˜¯å¾ˆå¿«çš„ã€‚ devtoolså¯ä»¥å®ç°é¡µé¢çƒ­éƒ¨ç½²ï¼ˆå³é¡µé¢ä¿®æ”¹åä¼šç«‹å³ç”Ÿæ•ˆï¼Œè¿™ä¸ªå¯ä»¥ç›´æ¥åœ¨application.propertiesæ–‡ä»¶ä¸­é…ç½®spring.thymeleaf.cache=falseæ¥å®ç°(æ³¨æ„ï¼šä¸åŒçš„æ¨¡æ¿é…ç½®ä¸ä¸€æ ·) å‘å¸ƒæ‰“åŒ…Jarç±»å‹æ‰“åŒ…æ–¹å¼1.ä½¿ç”¨mvn clean package æ‰“åŒ… 2.ä½¿ç”¨java â€“jar åŒ…å warç±»å‹æ‰“åŒ…æ–¹å¼1.ä½¿ç”¨mvn celan package æ‰“åŒ… 2.ä½¿ç”¨java â€“jar åŒ…å å¤–éƒ¨Tomcatè¿è¡Œ1.ä½¿ç”¨mvn celan package æ‰“åŒ… 2.å°†waråŒ… æ”¾å…¥åˆ°tomcat webappsä¸‹è¿è¡Œå³å¯ã€‚ æ³¨æ„:springboot2.0å†…ç½®tomcat8.5.25ï¼Œå»ºè®®ä½¿ç”¨å¤–éƒ¨Tomcat9.0ç‰ˆæœ¬è¿è¡Œå³å¯,å¦åˆ™æŠ¥é”™ç‰ˆæœ¬ä¸å…¼å®¹ã€‚ POM123456789101112131415161718192021222324252627&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;source&gt;1.8&lt;/source&gt; &lt;target&gt;1.8&lt;/target&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;maimClass&gt;com.itmayiedu.app.App&lt;/maimClass&gt; &lt;/configuration&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;repackage&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; å‚è€ƒæ–‡çŒ®JdbcTemplate SpringBootåˆ†é¡µæ’ä»¶PageHelper jpa Spring For All ç¤¾åŒº Spring å®˜æ–¹æ•™ç¨‹ç¿»è¯‘ SpringBootä½¿ç”¨Redisç¼“å­˜ Spring Boot Adminç®€å•ä½¿ç”¨ Spring Boot æ€§èƒ½ä¼˜åŒ– WebFlux æ„Ÿè°¢ä»¥ä¸Šå¤§å¤§ä»¬~ï¼ å¹¿å‘Šæ—¶é—´ï¼šæƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢]]></content>
      <tags>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Spring</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®‰åˆ©è½¯ä»¶-å¦‚ä½•ä¸€é”®è£…B]]></title>
    <url>%2F2018%2F08%2F02%2F%E5%A6%82%E4%BD%95%E4%B8%80%E9%94%AE%E8%A3%85B%2F</url>
    <content type="text"><![CDATA[ä»Šå¤©æ•™å¤§å®¶å¦‚æœé«˜å¤§ä¸Šçš„è£…Bï¼ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ ç¬¬ä¸€æ­¥https://github.com/WWILLV/GodOfHacker å…‹éš†è½¯ä»¶ ç¬¬äºŒéƒ¨ä½¿ç”¨ ä¸è°¢å“¦ğŸ˜ ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ . æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼ŒjuejinåŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹~]]></content>
      <tags>
        <tag>æ—¥å¸¸</tag>
        <tag>Windows10</tag>
        <tag>è½¯ä»¶æ•™å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®°ä¸€æ¬¡å¤±è´¥çš„rediså®‰è£…]]></title>
    <url>%2F2018%2F08%2F02%2F%E8%AE%B0%E4%B8%80%E6%AC%A1%E5%A4%B1%E8%B4%A5%E7%9A%84redis%E5%AE%89%E8%A3%85%2F</url>
    <content type="text"><![CDATA[åˆšåˆšçœ‹è§ç¾¤å‹è¯´VPSåˆæå¹´ä¸­ç‰¹ä»·äº†ï¼Œçœ‹æ¥çœ‹å»ï¼Œé€‰äº†ä¸ªå¹´ä»˜$9.99çš„CN2çº¿è·¯çš„KVM VPSï¼Œå¿ƒé‡Œç¾æ»‹æ»‹ã€‚ç„¶è€Œè¿™å®¶çš„æœ€å°åŒ–centOSå±…ç„¶å¾ˆå¤šåŸºç¡€è¿è¡Œç¯å¢ƒéƒ½ä¸è£…ï¼Œç”šæ˜¯å¤´ç–¼ã€‚æ¥ä¸‹æ¥æˆ‘æ¥åˆ†äº«ä¸€ä¸‹æˆ‘è£…æœºçš„è¿‡ç¨‹ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ å®‰è£…ç¼–è¯‘ç¯å¢ƒé¦–å…ˆï¼Œç”¨sftpï¼ˆå¦ˆè›‹ç«Ÿç„¶æ²¡æœ‰å†…ç½®wgetï¼‰ä¸‹è½½å¥½redisï¼Œè¿›å…¥redisç›®å½• è¿è¡Œ 123yum -y install wgetyum -y install makeyum install gcc è£…å¥½makeç­‰ç¯å¢ƒï¼Œmake ä¸€ä¸‹ï¼ŒæŠ¥é”™äº†ï¼š å›¾æ˜¯æˆ‘ä»csdnæˆªçš„ï¼Œæˆ‘å’Œä»–çš„é”™è¯¯ä¸€æ¨¡ä¸€æ ·ã€‚æŸ¥äº†æŸ¥åŸå› ï¼Œæ˜¯å› ä¸ºï¼Œredameä¸­æœ‰è¿™æ ·ä¸€å¥è¯ï¼š Allocator â€”â€”â€” Selecting a non-default memory allocator when building Redis is done by setting the MALLOC environment variable. Redis is compiled and linked against libc malloc by default, with the exception of jemalloc being the default on Linux systems. This default was picked because jemalloc has proven to have fewer fragmentation problems than libc malloc. To force compiling against libc malloc, use: % make MALLOC=libc To compile against jemalloc on Mac OS X systems, use: % make MALLOC=jemalloc å®ƒè¯´ï¼Œåœ¨æ„å»ºRedisæ—¶é€‰æ‹©éé»˜è®¤å†…å­˜åˆ†é…å™¨æ˜¯é€šè¿‡è®¾ç½®å®Œæˆçš„ MALLOCç¯å¢ƒå˜é‡ã€‚ Redisæ˜¯é’ˆå¯¹libcç¼–è¯‘å’Œé“¾æ¥çš„ é»˜è®¤æƒ…å†µä¸‹ä¸ºmallocï¼Œä½†jemallocæ˜¯Linuxä¸Šçš„é»˜è®¤è®¾ç½®ç³»ç»Ÿã€‚ æ‰€ä»¥ï¼Œè¦æ‰§è¡Œ 1make MALLOC=libc ç„¶åæ‰§è¡Œmake &amp;&amp; make install å®‰è£…redis å¤§åŠŸå‘Šæˆï¼ ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥ä¸‹æ¥æ”¹redisé…ç½®æ–‡ä»¶ ç»‘å®š0.0.0.0ï¼ŒåŠå…è®¸ä»»æ„æœåŠ¡å™¨è®¿é—®redis å°†daemonizeæ”¹æˆyesï¼ŒåŠå…è®¸åå°æ‰§è¡Œ è®¿é—®å¯†ç requirepassè®¾ç½®æˆè‡ªå·±çš„ å¯åŠ¨redisç”¨åˆšåˆšçš„é…ç½®æ–‡ä»¶å¯åŠ¨redisï¼š 12redis-server ./redis.confps -ef |grep redis ç„¶åè¿›å…¥utilsç›®å½•ä¸‹ï¼Œè¿è¡Œç”Ÿæˆç³»ç»ŸæœåŠ¡ 1./install_server.sh Redisé…ç½®æ–‡ä»¶æ ·ä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426# Redisé…ç½®æ–‡ä»¶æ ·ä¾‹# Note on units: when memory size is needed, it is possible to specifiy# it in the usual form of 1k 5GB 4M and so forth:## 1k =&gt; 1000 bytes# 1kb =&gt; 1024 bytes# 1m =&gt; 1000000 bytes# 1mb =&gt; 1024*1024 bytes# 1g =&gt; 1000000000 bytes# 1gb =&gt; 1024*1024*1024 bytes## units are case insensitive so 1GB 1Gb 1gB are all the same.# Redisé»˜è®¤ä¸æ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œï¼Œå¯ä»¥é€šè¿‡è¯¥é…ç½®é¡¹ä¿®æ”¹ï¼Œä½¿ç”¨yeså¯ç”¨å®ˆæŠ¤è¿›ç¨‹# å¯ç”¨å®ˆæŠ¤è¿›ç¨‹åï¼ŒRedisä¼šæŠŠpidå†™åˆ°ä¸€ä¸ªpidfileä¸­ï¼Œåœ¨/var/run/redis.piddaemonize no# å½“Redisä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œæ—¶ï¼ŒRedisé»˜è®¤ä¼šæŠŠpidå†™å…¥/var/run/redis.pidæ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡pidfileæŒ‡å®špidfile /var/run/redis.pid# æŒ‡å®šRedisç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º6379# å¦‚æœæŒ‡å®š0ç«¯å£ï¼Œè¡¨ç¤ºRedisä¸ç›‘å¬TCPè¿æ¥port 6379# ç»‘å®šçš„ä¸»æœºåœ°å€# ä½ å¯ä»¥ç»‘å®šå•ä¸€æ¥å£ï¼Œå¦‚æœæ²¡æœ‰ç»‘å®šï¼Œæ‰€æœ‰æ¥å£éƒ½ä¼šç›‘å¬åˆ°æ¥çš„è¿æ¥# bind 127.0.0.1# Specify the path for the unix socket that will be used to listen for# incoming connections. There is no default, so Redis will not listen# on a unix socket when not specified.## unixsocket /tmp/redis.sock# unixsocketperm 755# å½“å®¢æˆ·ç«¯é—²ç½®å¤šé•¿æ—¶é—´åå…³é—­è¿æ¥ï¼Œå¦‚æœæŒ‡å®šä¸º0ï¼Œè¡¨ç¤ºå…³é—­è¯¥åŠŸèƒ½timeout 0# æŒ‡å®šæ—¥å¿—è®°å½•çº§åˆ«ï¼ŒRedisæ€»å…±æ”¯æŒå››ä¸ªçº§åˆ«ï¼šdebugã€verboseã€noticeã€warningï¼Œé»˜è®¤ä¸ºverbose# debug (å¾ˆå¤šä¿¡æ¯, å¯¹å¼€å‘ï¼æµ‹è¯•æ¯”è¾ƒæœ‰ç”¨)# verbose (many rarely useful info, but not a mess like the debug level)# notice (moderately verbose, what you want in production probably)# warning (only very important / critical messages are logged)loglevel verbose# æ—¥å¿—è®°å½•æ–¹å¼ï¼Œé»˜è®¤ä¸ºæ ‡å‡†è¾“å‡ºï¼Œå¦‚æœé…ç½®ä¸ºredisä¸ºå®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œï¼Œè€Œè¿™é‡Œåˆé…ç½®ä¸ºæ ‡å‡†è¾“å‡ºï¼Œåˆ™æ—¥å¿—å°†ä¼šå‘é€ç»™/dev/nulllogfile stdout# To enable logging to the system logger, just set &apos;syslog-enabled&apos; to yes,# and optionally update the other syslog parameters to suit your needs.# syslog-enabled no# Specify the syslog identity.# syslog-ident redis# Specify the syslog facility. Must be USER or between LOCAL0-LOCAL7.# syslog-facility local0# è®¾ç½®æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ•°æ®åº“ä¸º0ï¼Œå¯ä»¥ä½¿ç”¨select &lt;dbid&gt;å‘½ä»¤åœ¨è¿æ¥ä¸ŠæŒ‡å®šæ•°æ®åº“id# dbidæ˜¯ä»0åˆ°â€˜databasesâ€™-1çš„æ•°ç›®databases 16################################ SNAPSHOTTING ################################## æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªæ¡ä»¶é…åˆ# Save the DB on disk:## save &lt;seconds&gt; &lt;changes&gt;## Will save the DB if both the given number of seconds and the given# number of write operations against the DB occurred.## æ»¡è¶³ä»¥ä¸‹æ¡ä»¶å°†ä¼šåŒæ­¥æ•°æ®:# 900ç§’ï¼ˆ15åˆ†é’Ÿï¼‰å†…æœ‰1ä¸ªæ›´æ”¹# 300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰å†…æœ‰10ä¸ªæ›´æ”¹# 60ç§’å†…æœ‰10000ä¸ªæ›´æ”¹# Note: å¯ä»¥æŠŠæ‰€æœ‰â€œsaveâ€è¡Œæ³¨é‡Šæ‰ï¼Œè¿™æ ·å°±å–æ¶ˆåŒæ­¥æ“ä½œäº†save 900 1save 300 10save 60 10000# æŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸ºyesï¼ŒRedisé‡‡ç”¨LZFå‹ç¼©ï¼Œå¦‚æœä¸ºäº†èŠ‚çœCPUæ—¶é—´ï¼Œå¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶å˜çš„å·¨å¤§rdbcompression yes# æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤å€¼ä¸ºdump.rdbdbfilename dump.rdb# å·¥ä½œç›®å½•.# æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½•ï¼Œæ–‡ä»¶åç”±ä¸Šä¸€ä¸ªdbfilenameé…ç½®é¡¹æŒ‡å®š# # Also the Append Only File will be created inside this directory.# # æ³¨æ„ï¼Œè¿™é‡Œåªèƒ½æŒ‡å®šä¸€ä¸ªç›®å½•ï¼Œä¸èƒ½æŒ‡å®šæ–‡ä»¶ådir ./################################# REPLICATION ################################## ä¸»ä»å¤åˆ¶ã€‚ä½¿ç”¨slaveofä» RedisæœåŠ¡å™¨å¤åˆ¶ä¸€ä¸ªRediså®ä¾‹ã€‚æ³¨æ„ï¼Œè¯¥é…ç½®ä»…é™äºå½“å‰slaveæœ‰æ•ˆ# so for example it is possible to configure the slave to save the DB with a# different interval, or to listen to another port, and so on.# è®¾ç½®å½“æœ¬æœºä¸ºslavæœåŠ¡æ—¶ï¼Œè®¾ç½®masteræœåŠ¡çš„ipåœ°å€åŠç«¯å£ï¼Œåœ¨Rediså¯åŠ¨æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ä»masterè¿›è¡Œæ•°æ®åŒæ­¥# slaveof &lt;masterip&gt; &lt;masterport&gt;# å½“masteræœåŠ¡è®¾ç½®äº†å¯†ç ä¿æŠ¤æ—¶ï¼ŒslavæœåŠ¡è¿æ¥masterçš„å¯†ç # ä¸‹æ–‡çš„â€œrequirepassâ€é…ç½®é¡¹å¯ä»¥æŒ‡å®šå¯†ç # masterauth &lt;master-password&gt;# When a slave lost the connection with the master, or when the replication# is still in progress, the slave can act in two different ways:## 1) if slave-serve-stale-data is set to &apos;yes&apos; (the default) the slave will# still reply to client requests, possibly with out of data data, or the# data set may just be empty if this is the first synchronization.## 2) if slave-serve-stale data is set to &apos;no&apos; the slave will reply with# an error &quot;SYNC with master in progress&quot; to all the kind of commands# but to INFO and SLAVEOF.#slave-serve-stale-data yes# Slaves send PINGs to server in a predefined interval. It&apos;s possible to change# this interval with the repl_ping_slave_period option. The default value is 10# seconds.## repl-ping-slave-period 10# The following option sets a timeout for both Bulk transfer I/O timeout and# master data or ping response timeout. The default value is 60 seconds.## It is important to make sure that this value is greater than the value# specified for repl-ping-slave-period otherwise a timeout will be detected# every time there is low traffic between the master and the slave.## repl-timeout 60################################## SECURITY #################################### Warning: since Redis is pretty fast an outside user can try up to# 150k passwords per second against a good box. This means that you should# use a very strong password otherwise it will be very easy to break.# è®¾ç½®Redisè¿æ¥å¯†ç ï¼Œå¦‚æœé…ç½®äº†è¿æ¥å¯†ç ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥Redisæ—¶éœ€è¦é€šè¿‡auth &lt;password&gt;å‘½ä»¤æä¾›å¯†ç ï¼Œé»˜è®¤å…³é—­# requirepass foobared# Command renaming.## It is possilbe to change the name of dangerous commands in a shared# environment. For instance the CONFIG command may be renamed into something# of hard to guess so that it will be still available for internal-use# tools but not available for general clients.## Example:## rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52## It is also possilbe to completely kill a command renaming it into# an empty string:## rename-command CONFIG &quot;&quot;################################### LIMITS ##################################### è®¾ç½®åŒä¸€æ—¶é—´æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°ï¼Œé»˜è®¤æ— é™åˆ¶ï¼ŒRediså¯ä»¥åŒæ—¶æ‰“å¼€çš„å®¢æˆ·ç«¯è¿æ¥æ•°ä¸ºRedisè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•°ï¼Œ# å¦‚æœè®¾ç½®maxclients 0ï¼Œè¡¨ç¤ºä¸ä½œé™åˆ¶ã€‚å½“å®¢æˆ·ç«¯è¿æ¥æ•°åˆ°è¾¾é™åˆ¶æ—¶ï¼ŒRedisä¼šå…³é—­æ–°çš„è¿æ¥å¹¶å‘å®¢æˆ·ç«¯è¿”å›max Number of clients reachedé”™è¯¯ä¿¡æ¯# maxclients 128# Don&apos;t use more memory than the specified amount of bytes.# When the memory limit is reached Redis will try to remove keys with an# EXPIRE set. It will try to start freeing keys that are going to expire# in little time and preserve keys with a longer time to live.# Redis will also try to remove objects from free lists if possible.## If all this fails, Redis will start to reply with errors to commands# that will use more memory, like SET, LPUSH, and so on, and will continue# to reply to most read-only commands like GET.## WARNING: maxmemory can be a good idea mainly if you want to use Redis as a# &apos;state&apos; server or cache, not as a real DB. When Redis is used as a real# database the memory usage will grow over the weeks, it will be obvious if# it is going to use too much memory in the long run, and you&apos;ll have the time# to upgrade. With maxmemory after the limit is reached you&apos;ll start to get# errors for write operations, and this may even lead to DB inconsistency.# æŒ‡å®šRedisæœ€å¤§å†…å­˜é™åˆ¶ï¼ŒRedisåœ¨å¯åŠ¨æ—¶ä¼šæŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¾¾åˆ°æœ€å¤§å†…å­˜åï¼ŒRedisä¼šå…ˆå°è¯•æ¸…é™¤å·²åˆ°æœŸæˆ–å³å°†åˆ°æœŸçš„Keyï¼Œ# å½“æ­¤æ–¹æ³•å¤„ç†åï¼Œä»ç„¶åˆ°è¾¾æœ€å¤§å†…å­˜è®¾ç½®ï¼Œå°†æ— æ³•å†è¿›è¡Œå†™å…¥æ“ä½œï¼Œä½†ä»ç„¶å¯ä»¥è¿›è¡Œè¯»å–æ“ä½œã€‚# Redisæ–°çš„vmæœºåˆ¶ï¼Œä¼šæŠŠKeyå­˜æ”¾å†…å­˜ï¼ŒValueä¼šå­˜æ”¾åœ¨swapåŒº# maxmemory &lt;bytes&gt;# MAXMEMORY POLICY: how Redis will select what to remove when maxmemory# is reached? You can select among five behavior:# # volatile-lru -&gt; remove the key with an expire set using an LRU algorithm# allkeys-lru -&gt; remove any key accordingly to the LRU algorithm# volatile-random -&gt; remove a random key with an expire set# allkeys-&gt;random -&gt; remove a random key, any key# volatile-ttl -&gt; remove the key with the nearest expire time (minor TTL)# noeviction -&gt; don&apos;t expire at all, just return an error on write operations# # Note: with all the kind of policies, Redis will return an error on write# operations, when there are not suitable keys for eviction.## At the date of writing this commands are: set setnx setex append# incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd# sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby# zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby# getset mset msetnx exec sort## The default is:## maxmemory-policy volatile-lru# LRU and minimal TTL algorithms are not precise algorithms but approximated# algorithms (in order to save memory), so you can select as well the sample# size to check. For instance for default Redis will check three keys and# pick the one that was used less recently, you can change the sample size# using the following configuration directive.## maxmemory-samples 3############################## APPEND ONLY MODE ################################ # Note that you can have both the async dumps and the append only file if you# like (you have to comment the &quot;save&quot; statements above to disable the dumps).# Still if append only mode is enabled Redis will load the data from the# log file at startup ignoring the dump.rdb file.# æŒ‡å®šæ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ“ä½œåè¿›è¡Œæ—¥å¿—è®°å½•ï¼ŒRedisåœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼‚æ­¥çš„æŠŠæ•°æ®å†™å…¥ç£ç›˜ï¼Œå¦‚æœä¸å¼€å¯ï¼Œå¯èƒ½ä¼šåœ¨æ–­ç”µæ—¶å¯¼è‡´ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®ä¸¢å¤±ã€‚# å› ä¸ºredisæœ¬èº«åŒæ­¥æ•°æ®æ–‡ä»¶æ˜¯æŒ‰ä¸Šé¢saveæ¡ä»¶æ¥åŒæ­¥çš„ï¼Œæ‰€ä»¥æœ‰çš„æ•°æ®ä¼šåœ¨ä¸€æ®µæ—¶é—´å†…åªå­˜åœ¨äºå†…å­˜ä¸­ã€‚é»˜è®¤ä¸ºno# IMPORTANT: Check the BGREWRITEAOF to check how to rewrite the append# log file in background when it gets too big.appendonly no# æŒ‡å®šæ›´æ–°æ—¥å¿—æ–‡ä»¶åï¼Œé»˜è®¤ä¸ºappendonly.aof# appendfilename appendonly.aof# The fsync() call tells the Operating System to actually write data on disk# instead to wait for more data in the output buffer. Some OS will really flush # data on disk, some other OS will just try to do it ASAP.# æŒ‡å®šæ›´æ–°æ—¥å¿—æ¡ä»¶ï¼Œå…±æœ‰3ä¸ªå¯é€‰å€¼ï¼š# no:è¡¨ç¤ºç­‰æ“ä½œç³»ç»Ÿè¿›è¡Œæ•°æ®ç¼“å­˜åŒæ­¥åˆ°ç£ç›˜ï¼ˆå¿«ï¼‰# always:è¡¨ç¤ºæ¯æ¬¡æ›´æ–°æ“ä½œåæ‰‹åŠ¨è°ƒç”¨fsync()å°†æ•°æ®å†™åˆ°ç£ç›˜ï¼ˆæ…¢ï¼Œå®‰å…¨ï¼‰# everysec:è¡¨ç¤ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼ˆæŠ˜è¡·ï¼Œé»˜è®¤å€¼ï¼‰appendfsync everysec# appendfsync no# When the AOF fsync policy is set to always or everysec, and a background# saving process (a background save or AOF log background rewriting) is# performing a lot of I/O against the disk, in some Linux configurations# Redis may block too long on the fsync() call. Note that there is no fix for# this currently, as even performing fsync in a different thread will block# our synchronous write(2) call.## In order to mitigate this problem it&apos;s possible to use the following option# that will prevent fsync() from being called in the main process while a# BGSAVE or BGREWRITEAOF is in progress.## This means that while another child is saving the durability of Redis is# the same as &quot;appendfsync none&quot;, that in pratical terms means that it is# possible to lost up to 30 seconds of log in the worst scenario (with the# default Linux settings).# # If you have latency problems turn this to &quot;yes&quot;. Otherwise leave it as# &quot;no&quot; that is the safest pick from the point of view of durability.no-appendfsync-on-rewrite no# Automatic rewrite of the append only file.# Redis is able to automatically rewrite the log file implicitly calling# BGREWRITEAOF when the AOF log size will growth by the specified percentage.# # This is how it works: Redis remembers the size of the AOF file after the# latest rewrite (or if no rewrite happened since the restart, the size of# the AOF at startup is used).## This base size is compared to the current size. If the current size is# bigger than the specified percentage, the rewrite is triggered. Also# you need to specify a minimal size for the AOF file to be rewritten, this# is useful to avoid rewriting the AOF file even if the percentage increase# is reached but it is still pretty small.## Specify a precentage of zero in order to disable the automatic AOF# rewrite feature.auto-aof-rewrite-percentage 100auto-aof-rewrite-min-size 64mb################################## SLOW LOG #################################### The Redis Slow Log is a system to log queries that exceeded a specified# execution time. The execution time does not include the I/O operations# like talking with the client, sending the reply and so forth,# but just the time needed to actually execute the command (this is the only# stage of command execution where the thread is blocked and can not serve# other requests in the meantime).# # You can configure the slow log with two parameters: one tells Redis# what is the execution time, in microseconds, to exceed in order for the# command to get logged, and the other parameter is the length of the# slow log. When a new command is logged the oldest one is removed from the# queue of logged commands.# The following time is expressed in microseconds, so 1000000 is equivalent# to one second. Note that a negative number disables the slow log, while# a value of zero forces the logging of every command.slowlog-log-slower-than 10000# There is no limit to this length. Just be aware that it will consume memory.# You can reclaim memory used by the slow log with SLOWLOG RESET.slowlog-max-len 1024################################ VIRTUAL MEMORY ################################## WARNING! Virtual Memory is deprecated in Redis 2.4### The use of Virtual Memory is strongly discouraged.### WARNING! Virtual Memory is deprecated in Redis 2.4### The use of Virtual Memory is strongly discouraged.# Virtual Memory allows Redis to work with datasets bigger than the actual# amount of RAM needed to hold the whole dataset in memory.# In order to do so very used keys are taken in memory while the other keys# are swapped into a swap file, similarly to what operating systems do# with memory pages.# æŒ‡å®šæ˜¯å¦å¯ç”¨è™šæ‹Ÿå†…å­˜æœºåˆ¶ï¼Œé»˜è®¤å€¼ä¸ºnoï¼Œ# VMæœºåˆ¶å°†æ•°æ®åˆ†é¡µå­˜æ”¾ï¼Œç”±Rediså°†è®¿é—®é‡è¾ƒå°‘çš„é¡µå³å†·æ•°æ®swapåˆ°ç£ç›˜ä¸Šï¼Œè®¿é—®å¤šçš„é¡µé¢ç”±ç£ç›˜è‡ªåŠ¨æ¢å‡ºåˆ°å†…å­˜ä¸­# æŠŠvm-enabledè®¾ç½®ä¸ºyesï¼Œæ ¹æ®éœ€è¦è®¾ç½®å¥½æ¥ä¸‹æ¥çš„ä¸‰ä¸ªVMå‚æ•°ï¼Œå°±å¯ä»¥å¯åŠ¨VMäº†vm-enabled no# vm-enabled yes# This is the path of the Redis swap file. As you can guess, swap files# can&apos;t be shared by different Redis instances, so make sure to use a swap# file for every redis process you are running. Redis will complain if the# swap file is already in use.## Redisäº¤æ¢æ–‡ä»¶æœ€å¥½çš„å­˜å‚¨æ˜¯SSDï¼ˆå›ºæ€ç¡¬ç›˜ï¼‰# è™šæ‹Ÿå†…å­˜æ–‡ä»¶è·¯å¾„ï¼Œé»˜è®¤å€¼ä¸º/tmp/redis.swapï¼Œä¸å¯å¤šä¸ªRediså®ä¾‹å…±äº«# *** WARNING *** if you are using a shared hosting the default of putting# the swap file under /tmp is not secure. Create a dir with access granted# only to Redis user and configure Redis to create the swap file there.vm-swap-file /tmp/redis.swap# With vm-max-memory 0 the system will swap everything it can. Not a good# default, just specify the max amount of RAM you can in bytes, but it&apos;s# better to leave some margin. For instance specify an amount of RAM# that&apos;s more or less between 60 and 80% of your free RAM.# å°†æ‰€æœ‰å¤§äºvm-max-memoryçš„æ•°æ®å­˜å…¥è™šæ‹Ÿå†…å­˜ï¼Œæ— è®ºvm-max-memoryè®¾ç½®å¤šå°‘ï¼Œæ‰€æœ‰ç´¢å¼•æ•°æ®éƒ½æ˜¯å†…å­˜å­˜å‚¨çš„ï¼ˆRedisçš„ç´¢å¼•æ•°æ®å°±æ˜¯keysï¼‰# ä¹Ÿå°±æ˜¯è¯´å½“vm-max-memoryè®¾ç½®ä¸º0çš„æ—¶å€™ï¼Œå…¶å®æ˜¯æ‰€æœ‰valueéƒ½å­˜åœ¨äºç£ç›˜ã€‚é»˜è®¤å€¼ä¸º0vm-max-memory 0# Redis swapæ–‡ä»¶åˆ†æˆäº†å¾ˆå¤šçš„pageï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥ä¿å­˜åœ¨å¤šä¸ªpageä¸Šé¢ï¼Œä½†ä¸€ä¸ªpageä¸Šä¸èƒ½è¢«å¤šä¸ªå¯¹è±¡å…±äº«ï¼Œvm-page-sizeæ˜¯è¦æ ¹æ®å­˜å‚¨çš„æ•°æ®å¤§å°æ¥è®¾å®šçš„ã€‚# å»ºè®®å¦‚æœå­˜å‚¨å¾ˆå¤šå°å¯¹è±¡ï¼Œpageå¤§å°æœ€åè®¾ç½®ä¸º32æˆ–64bytesï¼›å¦‚æœå­˜å‚¨å¾ˆå¤§çš„å¯¹è±¡ï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ›´å¤§çš„pageï¼Œå¦‚æœä¸ç¡®å®šï¼Œå°±ä½¿ç”¨é»˜è®¤å€¼vm-page-size 32# è®¾ç½®swapæ–‡ä»¶ä¸­çš„pageæ•°é‡ç”±äºé¡µè¡¨ï¼ˆä¸€ç§è¡¨ç¤ºé¡µé¢ç©ºé—²æˆ–ä½¿ç”¨çš„bitmapï¼‰æ˜¯å­˜æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œåœ¨ç£ç›˜ä¸Šæ¯8ä¸ªpageså°†æ¶ˆè€—1byteçš„å†…å­˜# swapç©ºé—´æ€»å®¹é‡ä¸º vm-page-size * vm-pages## With the default of 32-bytes memory pages and 134217728 pages Redis will# use a 4 GB swap file, that will use 16 MB of RAM for the page table.## It&apos;s better to use the smallest acceptable value for your application,# but the default is large in order to work in most conditions.vm-pages 134217728# Max number of VM I/O threads running at the same time.# This threads are used to read/write data from/to swap file, since they# also encode and decode objects from disk to memory or the reverse, a bigger# number of threads can help with big objects even if they can&apos;t help with# I/O itself as the physical device may not be able to couple with many# reads/writes operations at the same time.# è®¾ç½®è®¿é—®swapæ–‡ä»¶çš„I/Oçº¿ç¨‹æ•°ï¼Œæœ€åä¸è¦è¶…è¿‡æœºå™¨çš„æ ¸æ•°ï¼Œå¦‚æœè®¾ç½®ä¸º0ï¼Œé‚£ä¹ˆæ‰€æœ‰å¯¹swapæ–‡ä»¶çš„æ“ä½œéƒ½æ˜¯ä¸²è¡Œçš„ï¼Œå¯èƒ½ä¼šé€ æˆæ¯”è¾ƒé•¿æ—¶é—´çš„å»¶è¿Ÿï¼Œé»˜è®¤å€¼ä¸º4vm-max-threads 4############################### ADVANCED CONFIG ################################ Hashes are encoded in a special way (much more memory efficient) when they# have at max a given numer of elements, and the biggest element does not# exceed a given threshold. You can configure this limits with the following# configuration directives.# æŒ‡å®šåœ¨è¶…è¿‡ä¸€å®šçš„æ•°é‡æˆ–è€…æœ€å¤§çš„å…ƒç´ è¶…è¿‡æŸä¸€ä¸´ç•Œå€¼æ—¶ï¼Œé‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„å“ˆå¸Œç®—æ³•hash-max-zipmap-entries 512hash-max-zipmap-value 64# Similarly to hashes, small lists are also encoded in a special way in order# to save a lot of space. The special representation is only used when# you are under the following limits:list-max-ziplist-entries 512list-max-ziplist-value 64# Sets have a special encoding in just one case: when a set is composed# of just strings that happens to be integers in radix 10 in the range# of 64 bit signed integers.# The following configuration setting sets the limit in the size of the# set in order to use this special memory saving encoding.set-max-intset-entries 512# Similarly to hashes and lists, sorted sets are also specially encoded in# order to save a lot of space. This encoding is only used when the length and# elements of a sorted set are below the following limits:zset-max-ziplist-entries 128zset-max-ziplist-value 64# Active rehashing uses 1 millisecond every 100 milliseconds of CPU time in# order to help rehashing the main Redis hash table (the one mapping top-level# keys to values). The hash table implementation redis uses (see dict.c)# performs a lazy rehashing: the more operation you run into an hash table# that is rhashing, the more rehashing &quot;steps&quot; are performed, so if the# server is idle the rehashing is never complete and some more memory is used# by the hash table.# # The default is to use this millisecond 10 times every second in order to# active rehashing the main dictionaries, freeing memory when possible.## If unsure:# use &quot;activerehashing no&quot; if you have hard latency requirements and it is# not a good thing in your environment that Redis can reply form time to time# to queries with 2 milliseconds delay.# æŒ‡å®šæ˜¯å¦æ¿€æ´»é‡ç½®å“ˆå¸Œï¼Œé»˜è®¤ä¸ºå¼€å¯activerehashing yes################################## INCLUDES #################################### æŒ‡å®šåŒ…å«å…¶ä»–çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨åŒä¸€ä¸»æœºä¸Šå¤šä¸ªRediså®ä¾‹ä¹‹é—´ä½¿ç”¨åŒä¸€ä»½é…ç½®æ–‡ä»¶ï¼Œè€ŒåŒæ—¶å„å®ä¾‹åˆæ‹¥æœ‰è‡ªå·±çš„ç‰¹å®šé…ç½®æ–‡ä»¶# include /path/to/local.conf# include /path/to/other.conf å®Œæˆï¼ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹~]]></content>
      <tags>
        <tag>æ“ä½œç³»ç»Ÿ</tag>
        <tag>è½¯ä»¶æ•™å­¦</tag>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å­¦å¥½åˆ†å¸ƒå¼æ¶æ„=5=-zookeeper]]></title>
    <url>%2F2018%2F07%2F29%2F%E6%88%91%E8%A6%81%E5%AD%A6%E5%A5%BD%E5%88%86%E5%B8%83%E5%BC%8F-zookeeper%2F</url>
    <content type="text"><![CDATA[â€œå­¦å¥½åˆ†å¸ƒå¼æ¶æ„â€èŠ‚ç›®åšåˆ°ç¬¬å››æœŸäº†ï¼ŒğŸ‘ğŸ‘ğŸ‘ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ åˆ†å¸ƒå¼æ¦‚å¿µï¼ˆå‰æˆï¼‰äº†è§£ä¸€ä¸ªæŠ€æœ¯ï¼Œå…ˆè¦æŒæ¡å®ƒçš„ç†è®ºï¼Œç„¶åå¾ªåºæ¸è¿›ã€‚æ‰€ä»¥ï¼Œç†è®ºæ¥äº†~ ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼å‘¢ï¼Ÿç®€å•è¯´ï¼Œåˆ†å¸ƒå¼ç³»ç»ŸèƒŒåæ˜¯ç”±ä¸€ç³»åˆ—çš„è®¡ç®—æœºç»„æˆçš„ï¼Œä½†ç”¨æˆ·æ„ŸçŸ¥ä¸åˆ°èƒŒåçš„é€»è¾‘ï¼Œå°±åƒè®¿é—®å•ä¸ªè®¡ç®—æœºä¸€æ · æœ€åŸºæœ¬çš„ç‰¹ç‚¹åˆ†å¸ƒæ€§æœåŠ¡å™¨çš„ä½ç½®å¯èƒ½åœ¨ä¸ä¸€ä¸ªä½ç½® å¹¶å‘æ€§ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¹¶å‘æ€§æ“ä½œæ˜¯å¾ˆå¸¸è§çš„ã€‚æ¯”å¦‚åŒä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤šä¸ªèŠ‚ç‚¹ï¼ŒåŒæ—¶è®¿é—®ä¸€ä¸ªå…±äº«èµ„æºã€‚æ•°æ®åº“ã€åˆ†å¸ƒå¼å­˜å‚¨ æ— åºæ€§è¿›ç¨‹ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡ï¼Œä¼šå‡ºç°é¡ºåºä¸ä¸€è‡´é—®é¢˜ åˆ†å¸ƒå¼ç¯å¢ƒä¸‹é¢ä¸´çš„é—®é¢˜åˆ†å¸ƒå¼çš„ç‰¹ç‚¹å†³å®šäº†å®ƒä¸€å®šä¼šæœ‰ç›¸åº”çš„é—®é¢˜ ç½‘ç»œé€šä¿¡åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¿¡æ¯é€šè¿‡ç½‘ç»œæ¥ä¼ è¾“çš„ï¼Œè€Œç½‘ç»œæœ¬èº«çš„ä¸å¯é æ€§ï¼Œå› æ­¤ä¼šæ¶‰åŠåˆ°ä¸€äº›ç½‘ç»œé€šä¿¡é—®é¢˜ ç½‘ç»œåˆ†åŒº(è„‘è£‚)ä»€ä¹ˆæ˜¯è„‘è£‚å‘¢ï¼Ÿ åœ¨é«˜å¯ç”¨ï¼ˆHAï¼‰ç³»ç»Ÿä¸­ï¼Œå½“è”ç³»2ä¸ªèŠ‚ç‚¹çš„â€œå¿ƒè·³çº¿â€æ–­å¼€æ—¶ï¼Œæœ¬æ¥ä¸ºä¸€æ•´ä½“ã€åŠ¨ä½œåè°ƒçš„HAç³»ç»Ÿï¼Œå°±åˆ†è£‚æˆä¸º2ä¸ªç‹¬ç«‹çš„ä¸ªä½“ã€‚ç”±äºç›¸äº’å¤±å»äº†è”ç³»ï¼Œéƒ½ä»¥ä¸ºæ˜¯å¯¹æ–¹å‡ºäº†æ•…éšœã€‚ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šçš„HAè½¯ä»¶åƒâ€œè£‚è„‘äººâ€ä¸€æ ·ï¼Œäº‰æŠ¢â€œå…±äº«èµ„æºâ€ã€äº‰èµ·â€œåº”ç”¨æœåŠ¡â€ï¼Œå°±ä¼šå‘ç”Ÿä¸¥é‡åæœâ€”â€”æˆ–è€…å…±äº«èµ„æºè¢«ç“œåˆ†ã€2è¾¹â€œæœåŠ¡â€éƒ½èµ·ä¸æ¥äº†ï¼›æˆ–è€…2è¾¹â€œæœåŠ¡â€éƒ½èµ·æ¥äº†ï¼Œä½†åŒæ—¶è¯»å†™â€œå…±äº«å­˜å‚¨â€ï¼Œå¯¼è‡´æ•°æ®æŸåï¼ˆå¸¸è§å¦‚æ•°æ®åº“è½®è¯¢ç€çš„è”æœºæ—¥å¿—å‡ºé”™ï¼‰ã€‚ è€Œå½“ç½‘ç»œå‘ç”Ÿå¼‚å¸¸å¯¼è‡´åˆ†å¸ƒå¼ç³»ç»Ÿä¸­éƒ¨åˆ†èŠ‚ç‚¹ä¹‹é—´çš„ç½‘ç»œå»¶æ—¶ä¸æ–­å¢å¤§ï¼Œå°±ä¼šäº§ç”Ÿè„‘è£‚ç°è±¡ï¼Œå³ç»„æˆåˆ†å¸ƒå¼æ¶æ„çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œåªæœ‰éƒ¨åˆ†èŠ‚ç‚¹èƒ½å¤Ÿæ­£å¸¸é€šä¿¡ ä¸‰æ€åœ¨æ­£å¸¸çš„å•æœºç¯å¢ƒä¸‹ï¼Œä¸€ä¸ªç¨‹åºè°ƒç”¨ä¸€ä¸ªæ¥å£ï¼Œæ­£å¸¸æƒ…å†µä¸‹åªæœ‰2ä¸ªçŠ¶æ€ï¼ŒæˆåŠŸæ€å’Œå¤±è´¥æ€ã€‚ ä½†æ˜¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œå°±åˆå¤šäº†ä¸€ç§çŠ¶æ€ï¼Œå«åšè¶…æ—¶æ€ï¼ŒæŒ‡çš„å°±æ˜¯åœ¨åˆ†å¸ƒå¼ç½‘è·¯é€šä¿¡æ—¶ï¼Œå› ä¸ºç½‘ç»œæ•…éšœï¼Œæˆ‘çš„æ¶ˆæ¯ä¸€ç›´æ²¡æœ‰æ”¶åˆ°è¿”å›æˆ–è€…æ˜¯æˆ‘çš„æ¶ˆæ¯æ²¡æœ‰å‘é€å‡ºå»ã€‚ åˆ†å¸ƒå¼äº‹åŠ¡åˆ†å¸ƒå¼ä¹Ÿä¼šæœ‰äº‹ç‰©é—®é¢˜ï¼Œå³ACID(åŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§)ã€‚è­¬å¦‚ï¼Œå¦‚æœä¸¤å°åˆ†å¸ƒå¼æ¶æ„çš„æœåŠ¡å™¨æœ‰è¿™ç›¸åŒçš„åŠŸèƒ½ï¼Œå½“ç”¨æˆ·æ“ä½œçš„æ—¶å€™ï¼Œä½ è¦ä¿å­˜è¿™ä¸¤å°æœåŠ¡å™¨çš„åŒæ—¶å‘ç”ŸåŒæ—¶æˆåŠŸï¼Œè¿™å°±å±äºäº‹ç‰©é—®é¢˜ã€‚ 1.åŸå­æ€§ï¼ˆAtomicityï¼‰ â€‹ ä¸€ä¸ªåŸå­äº‹åŠ¡è¦ä¹ˆå®Œæ•´æ‰§è¡Œï¼Œè¦ä¹ˆå¹²è„†ä¸æ‰§è¡Œã€‚è¿™æ„å‘³ç€ï¼Œå·¥ä½œå•å…ƒä¸­çš„æ¯é¡¹ä»»åŠ¡éƒ½å¿…é¡»æ­£ç¡®æ‰§è¡Œã€‚å¦‚æœæœ‰ä»»ä¸€ä»»åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œåˆ™æ•´ä¸ªå·¥ä½œå•å…ƒæˆ–äº‹åŠ¡å°±ä¼šè¢«ç»ˆæ­¢ã€‚å³æ­¤å‰å¯¹æ•°æ®æ‰€ä½œçš„ä»»ä½•ä¿®æ”¹éƒ½å°†è¢«æ’¤é”€ã€‚å¦‚æœæ‰€æœ‰ä»»åŠ¡éƒ½è¢«æˆåŠŸæ‰§è¡Œï¼Œäº‹åŠ¡å°±ä¼šè¢«æäº¤ï¼Œå³å¯¹æ•°æ®æ‰€ä½œçš„ä¿®æ”¹å°†ä¼šæ˜¯æ°¸ä¹…æ€§çš„ã€‚ 2.ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ â€‹ ä¸€è‡´æ€§ä»£è¡¨äº†åº•å±‚æ•°æ®å­˜å‚¨çš„å®Œæ•´æ€§ã€‚å®ƒå¿…é¡»ç”±äº‹åŠ¡ç³»ç»Ÿå’Œåº”ç”¨å¼€å‘äººå‘˜å…±åŒæ¥ä¿è¯ã€‚äº‹åŠ¡ç³»ç»Ÿé€šè¿‡ä¿è¯äº‹åŠ¡çš„åŸå­æ€§ï¼Œéš”ç¦»æ€§å’ŒæŒä¹…æ€§æ¥æ»¡è¶³è¿™ä¸€è¦æ±‚; åº”ç”¨å¼€å‘äººå‘˜åˆ™éœ€è¦ä¿è¯æ•°æ®åº“æœ‰é€‚å½“çš„çº¦æŸ(ä¸»é”®ï¼Œå¼•ç”¨å®Œæ•´æ€§ç­‰)ï¼Œå¹¶ä¸”å·¥ä½œå•å…ƒä¸­æ‰€å®ç°çš„ä¸šåŠ¡é€»è¾‘ä¸ä¼šå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´(å³ï¼Œæ•°æ®é¢„æœŸæ‰€è¡¨è¾¾çš„ç°å®ä¸šåŠ¡æƒ…å†µä¸ç›¸ä¸€è‡´)ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€æ¬¡è½¬è´¦è¿‡ç¨‹ä¸­ï¼Œä»æŸä¸€è´¦æˆ·ä¸­æ‰£é™¤çš„é‡‘é¢å¿…é¡»ä¸å¦ä¸€è´¦æˆ·ä¸­å­˜å…¥çš„é‡‘é¢ç›¸ç­‰ã€‚ 3.éš”ç¦»æ€§ï¼ˆIsolationï¼‰ â€‹ éš”ç¦»æ€§æ„å‘³ç€äº‹åŠ¡å¿…é¡»åœ¨ä¸å¹²æ‰°å…¶ä»–è¿›ç¨‹æˆ–äº‹åŠ¡çš„å‰æä¸‹ç‹¬ç«‹æ‰§è¡Œã€‚æ¢è¨€ä¹‹ï¼Œåœ¨äº‹åŠ¡æˆ–å·¥ä½œå•å…ƒæ‰§è¡Œå®Œæ¯•ä¹‹å‰ï¼Œå…¶æ‰€è®¿é—®çš„æ•°æ®ä¸èƒ½å—ç³»ç»Ÿå…¶ä»–éƒ¨åˆ†çš„å½±å“ã€‚ 4.æŒä¹…æ€§ï¼ˆDurabilityï¼‰ â€‹ æŒä¹…æ€§è¡¨ç¤ºåœ¨æŸä¸ªäº‹åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯¹æ•°æ®æ‰€ä½œçš„æ‰€æœ‰æ”¹åŠ¨éƒ½å¿…é¡»åœ¨äº‹åŠ¡æˆåŠŸç»“æŸå‰ä¿å­˜è‡³æŸç§ç‰©ç†å­˜å‚¨è®¾å¤‡ã€‚è¿™æ ·å¯ä»¥ä¿è¯ï¼Œæ‰€ä½œçš„ä¿®æ”¹åœ¨ä»»ä½•ç³»ç»Ÿç˜«ç—ªæ—¶ä¸è‡³äºä¸¢å¤±ã€‚ ä¸­å¿ƒåŒ–å’Œå»ä¸­å¿ƒåŒ–æ•°æ®åº“å¤‡ä»½ä¸€èˆ¬ä½¿ç”¨å†·å¤‡æˆ–è€…çƒ­å¤‡ çƒ­å¤‡ï¼šä¸€èˆ¬ç”¨äºä¿è¯æœåŠ¡æ­£å¸¸ä¸é—´æ–­è¿è¡Œï¼Œç”¨ä¸¤å°æœºå™¨ä½œä¸ºæœåŠ¡æœºå™¨ï¼Œä¸€å°ç”¨äºå®é™…æ•°æ®åº“æ“ä½œåº”ç”¨,å¦å¤–ä¸€å°å®æ—¶çš„ä»å‰è€…ä¸­è·å–æ•°æ®ä»¥ä¿æŒæ•°æ®ä¸€è‡´.å¦‚æœå½“å‰çš„æœºå™¨ç†„ç«,å¤‡ä»½çš„æœºå™¨ç«‹é©¬å–ä»£å½“å‰çš„æœºå™¨ç»§ç»­æä¾›æœåŠ¡ å†·å¤‡ï¼š.å†·å¤‡ä»½æŒ‡åœ¨æ•°æ®åº“å…³é—­å,è¿›è¡Œå¤‡ä»½,é€‚ç”¨äºæ‰€æœ‰æ¨¡å¼çš„æ•°æ®åº“ åˆ†å¸ƒå¼æ¶æ„é‡Œé¢ï¼Œå¾ˆå¤šçš„æ¶æ„æ€æƒ³é‡‡ç”¨çš„æ˜¯å»ä¸­å¿ƒåŒ–ã€‚å³åœ¨ä¸€ä¸ªåˆ†å¸ƒæœ‰ä¼—å¤šèŠ‚ç‚¹çš„ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å…·æœ‰é«˜åº¦è‡ªæ²»çš„ç‰¹å¾ã€‚èŠ‚ç‚¹ä¹‹é—´å½¼æ­¤å¯ä»¥è‡ªç”±è¿æ¥ï¼Œå½¢æˆæ–°çš„è¿æ¥å•å…ƒã€‚ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹éƒ½å¯èƒ½æˆä¸ºé˜¶æ®µæ€§çš„ä¸­å¿ƒï¼Œä½†ä¸å…·å¤‡å¼ºåˆ¶æ€§çš„ä¸­å¿ƒæ§åˆ¶åŠŸèƒ½ã€‚èŠ‚ç‚¹ä¸èŠ‚ç‚¹ä¹‹é—´çš„å½±å“ï¼Œä¼šé€šè¿‡ç½‘ç»œè€Œå½¢æˆéçº¿æ€§å› æœå…³ç³»ã€‚è¿™ç§å¼€æ”¾å¼ã€æ‰å¹³åŒ–ã€å¹³ç­‰æ€§çš„ç³»ç»Ÿç°è±¡æˆ–ç»“æ„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå»ä¸­å¿ƒåŒ– æœ€å…¸å‹çš„æ˜¯ï¼š zookeeper / etcd ç»å…¸çš„CAPCä¸€è‡´æ€§ ï¼ˆConsistencyï¼‰: æ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„æ•°æ®ï¼Œæ—¶åˆ»ä¿æŒä¸€è‡´ Aå¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ï¼šæ¯ä¸ªè¯·æ±‚éƒ½èƒ½å¤Ÿæ”¶åˆ°ä¸€ä¸ªå“åº”ï¼Œæ— è®ºå“åº”æˆåŠŸæˆ–è€…å¤±è´¥ Påˆ†åŒºå®¹é”™ ï¼ˆPartition-toleranceï¼‰ï¼šè¡¨ç¤ºç³»ç»Ÿå‡ºç°è„‘è£‚ä»¥åï¼Œå¯èƒ½å¯¼è‡´æŸäº›serverä¸é›†ç¾¤ä¸­çš„å…¶ä»–æœºå™¨å¤±å»è”ç³» æ— è®ºå¦‚ä½•ï¼Œéƒ½åªèƒ½ä¿è¯CPæˆ–è€… APã€‚CAPç†è®ºä»…é€‚ç”¨äºåŸå­è¯»å†™çš„Nosqlåœºæ™¯ï¼Œä¸é€‚ç”¨äºæ•°æ®åº“ç³»ç»Ÿ BASEç†è®ºåŸºäºCAPç†è®ºï¼ŒCAPç†è®ºå¹¶ä¸é€‚ç”¨äºæ•°æ®åº“äº‹åŠ¡ï¼ˆå› ä¸ºæ›´æ–°ä¸€äº›é”™è¯¯çš„æ•°æ®è€Œå¯¼è‡´æ•°æ®å‡ºç°ç´Šä¹±ï¼Œæ— è®ºä»€ä¹ˆæ ·çš„æ•°æ®åº“é«˜å¯ç”¨æ–¹æ¡ˆéƒ½æ˜¯å¾’åŠ³ï¼‰ ï¼Œè™½ç„¶XAäº‹åŠ¡å¯ä»¥ä¿è¯æ•°æ®åº“åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸‹çš„ACIDç‰¹æ€§ï¼Œä½†æ˜¯ä¼šå¸¦æ¥æ€§èƒ½æ–¹é¢çš„å½±å“ï¼› eBayå°è¯•äº†ä¸€ç§å®Œå…¨ä¸åŒçš„å¥—è·¯ï¼Œæ”¾å®½äº†å¯¹äº‹åŠ¡ACIDçš„è¦æ±‚ã€‚æå‡ºäº†BASEç†è®ºï¼š Basically available ï¼š æ•°æ®åº“é‡‡ç”¨åˆ†ç‰‡æ¨¡å¼ï¼Œ æŠŠ100Wçš„ç”¨æˆ·æ•°æ®åˆ†å¸ƒåœ¨5ä¸ªå®ä¾‹ä¸Šã€‚å¦‚æœç ´åäº†å…¶ä¸­ä¸€ä¸ªå®ä¾‹ï¼Œä»ç„¶å¯ä»¥ä¿è¯ 80%çš„ç”¨æˆ·å¯ç”¨ soft-stateï¼š åœ¨åŸºäºclient-serveræ¨¡å¼çš„ç³»ç»Ÿä¸­ï¼Œserverç«¯æ˜¯å¦æœ‰çŠ¶æ€ï¼Œå†³å®šäº†ç³»ç»Ÿæ˜¯å¦å…·å¤‡è‰¯å¥½çš„æ°´å¹³æ‰©å±•ã€è´Ÿè½½å‡è¡¡ã€æ•…éšœæ¢å¤ç­‰ç‰¹æ€§ã€‚ Serverç«¯æ‰¿è¯ºä¼šç»´æŠ¤clientç«¯çŠ¶æ€æ•°æ®ï¼Œè¿™ä¸ªçŠ¶æ€ä»…ä»…ç»´æŒä¸€å°æ®µæ—¶é—´, è¿™æ®µæ—¶é—´ä»¥åï¼Œserverç«¯å°±ä¼šä¸¢å¼ƒè¿™ä¸ªçŠ¶æ€ï¼Œæ¢å¤æ­£å¸¸çŠ¶æ€ Eventually consistentï¼šæ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ æ˜¯ Zookeeperï¼ˆæ­£ç‰‡ï¼‰zookeeperæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼æ•°æ®å­˜å‚¨ç³»ç»Ÿï¼Œæä¾›åˆ†å¸ƒå¼æ•°æ®ä¸€è‡´æ€§çš„è§£å†³æ–¹æ¡ˆã€‚æ˜¯ç”±é›…è™åˆ›å»ºçš„ï¼ŒåŸºäºgoogle chubbyã€‚ zookeeperæ˜¯ä»€ä¹ˆåˆ†å¸ƒå¼æ•°æ®ä¸€è‡´æ€§çš„è§£å†³æ–¹æ¡ˆ zookeeperèƒ½åšä»€ä¹ˆæ•°æ®çš„å‘å¸ƒ/è®¢é˜…ï¼ˆé…ç½®ä¸­å¿ƒ:disconfï¼‰ ã€ è´Ÿè½½å‡è¡¡ï¼ˆdubboåˆ©ç”¨äº†zookeeperæœºåˆ¶å®ç°è´Ÿè½½å‡è¡¡ï¼‰ ã€å‘½åæœåŠ¡ã€ masteré€‰ä¸¾(kafkaã€hadoopã€hbase)ã€åˆ†å¸ƒå¼é˜Ÿåˆ—ã€åˆ†å¸ƒå¼é” zookeeperç‰¹æ€§é¡ºåºä¸€è‡´æ€§ä»åŒä¸€ä¸ªå®¢æˆ·ç«¯å‘èµ·çš„äº‹åŠ¡è¯·æ±‚ï¼Œæœ€ç»ˆä¼šä¸¥æ ¼æŒ‰ç…§é¡ºåºè¢«åº”ç”¨åˆ°zookeeperä¸­ åŸå­æ€§æ‰€æœ‰çš„äº‹åŠ¡è¯·æ±‚çš„å¤„ç†ç»“æœåœ¨æ•´ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰æœºå™¨ä¸Šçš„åº”ç”¨æƒ…å†µæ˜¯ä¸€è‡´çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦ä¹ˆæ•´ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰æœºå™¨éƒ½æˆåŠŸåº”ç”¨äº†æŸä¸€äº‹åŠ¡ã€è¦ä¹ˆå…¨éƒ½ä¸åº”ç”¨ å¯é æ€§ä¸€æ—¦æœåŠ¡å™¨æˆåŠŸåº”ç”¨äº†æŸä¸€ä¸ªäº‹åŠ¡æ•°æ®ï¼Œå¹¶ä¸”å¯¹å®¢æˆ·ç«¯åšäº†å“åº”ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®åœ¨æ•´ä¸ªé›†ç¾¤ä¸­ä¸€å®šæ˜¯åŒæ­¥å¹¶ä¸”ä¿ç•™ä¸‹æ¥çš„ å®æ—¶æ€§ä¸€æ—¦ä¸€ä¸ªäº‹åŠ¡è¢«æˆåŠŸåº”ç”¨ï¼Œå®¢æˆ·ç«¯å°±èƒ½å¤Ÿç«‹å³ä»æœåŠ¡å™¨ç«¯è¯»å–åˆ°äº‹åŠ¡å˜æ›´åçš„æœ€æ–°æ•°æ®çŠ¶æ€ï¼›ï¼ˆzookeeperä»…ä»…ä¿è¯åœ¨ä¸€å®šæ—¶é—´å†…ï¼Œè¿‘å®æ—¶ï¼‰ zookeeperé›†ç¾¤ç¯å¢ƒzookeeperé›†ç¾¤, åŒ…å«ä¸‰ç§è§’è‰²: leader / follower /observer observer observer æ˜¯ä¸€ç§ç‰¹æ®Šçš„zookeeperèŠ‚ç‚¹ã€‚å¯ä»¥å¸®åŠ©è§£å†³zookeeperçš„æ‰©å±•æ€§ï¼ˆå¦‚æœå¤§é‡å®¢æˆ·ç«¯è®¿é—®æˆ‘ä»¬zookeeperé›†ç¾¤ï¼Œéœ€è¦å¢åŠ zookeeperé›†ç¾¤æœºå™¨æ•°é‡ã€‚ä»è€Œå¢åŠ zookeeperé›†ç¾¤çš„æ€§èƒ½ã€‚ å¯¼è‡´zookeeperå†™æ€§èƒ½ä¸‹é™ï¼Œ zookeeperçš„æ•°æ®å˜æ›´éœ€è¦åŠæ•°ä»¥ä¸ŠæœåŠ¡å™¨æŠ•ç¥¨é€šè¿‡ã€‚é€ æˆç½‘ç»œæ¶ˆè€—å¢åŠ æŠ•ç¥¨æˆæœ¬ï¼‰ observerä¸å‚ä¸æŠ•ç¥¨ã€‚ åªæ¥æ”¶æŠ•ç¥¨ç»“æœã€‚ä¸å’Œfollowerè”ç³»ã€‚ ä¸å±äºzookeeperçš„å…³é”®éƒ¨ä½ã€‚ å®‰è£…zookeeperå¯ä»¥è™šæ‹Ÿæœºä¸­æ“ä½œï¼Œç³»ç»Ÿcentos7ï¼Œzookeeperå»å®˜æ–¹ç½‘ä¸‹ç¨³å®šç‰ˆã€‚å®‰è£…åï¼š ç¬¬ä¸€æ­¥ï¼š ä¿®æ”¹é…ç½®æ–‡ä»¶zoo.cfgserver.id=host:port:port idçš„å–å€¼èŒƒå›´ï¼š 1~255ï¼› ç”¨idæ¥æ ‡è¯†è¯¥æœºå™¨åœ¨é›†ç¾¤ä¸­çš„æœºå™¨åºå·ï¼› 2888æ˜¯è¡¨ç¤ºfollowerèŠ‚ç‚¹ä¸leaderèŠ‚ç‚¹äº¤æ¢ä¿¡æ¯çš„ç«¯å£å·ï¼Œè¦å®šä¹‰æˆå’Œç³»ç»Ÿæ²¡æœ‰å†²çªçš„ç«¯å£å·ï¼› 3181 è¡¨ç¤ºleaderé€‰ä¸¾çš„ç«¯å£ï¼Œå¦‚æœleaderèŠ‚ç‚¹æŒ‚æ‰äº†, éœ€è¦ä¸€ä¸ªç«¯å£æ¥é‡æ–°é€‰ä¸¾ æ —å­ï¼š server.1=192.168.11.129:2888:3181 server.2=192.168.11.131:2888:3181 server.3=192.168.11.135:2888:3181 å¦‚æœéœ€è¦å¢åŠ observerèŠ‚ç‚¹ï¼Œzoo.cfgä¸­ï¼Œå¢åŠ  ;peerType=observer server.1=192.168.11.129:2888:3181 server.2=192.168.11.135:2888:3181 server.3=192.168.111.136:2888:3181:observer ç¬¬äºŒæ­¥ï¼šåˆ›å»ºmyidåœ¨æ¯ä¸€ä¸ªæœåŠ¡å™¨çš„dataDirç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªmyidçš„æ–‡ä»¶ï¼Œæ–‡ä»¶å°±ä¸€è¡Œæ•°æ®ï¼Œæ•°æ®å†…å®¹æ˜¯æ¯å°æœºå™¨å¯¹åº”çš„server IDçš„æ•°å­— ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨zookeeper å…³æ‰é˜²ç«å¢™ çœ‹åˆ°ç”Ÿæˆzeekeeper.outè¿™æ ·çš„ä¸€ä¸ªæ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨tailå‘½ä»¤æŸ¥çœ‹ Zookeeperä¸­çš„ä¸€äº›æ¦‚å¿µZookeeperé…ç½®è§£æ tickTime=2000 zookeeperä¸­æœ€å°çš„æ—¶é—´å•ä½é•¿åº¦ ï¼ˆmsï¼‰ initLimit=10 followerèŠ‚ç‚¹å¯åŠ¨åä¸leaderèŠ‚ç‚¹å®Œæˆæ•°æ®åŒæ­¥çš„æ—¶é—´ syncLimit=5 leaderèŠ‚ç‚¹å’ŒfollowerèŠ‚ç‚¹è¿›è¡Œå¿ƒè·³æ£€æµ‹çš„æœ€å¤§å»¶æ—¶æ—¶é—´ dataDir=/tmp/zookeeper è¡¨ç¤ºzookeeperæœåŠ¡å™¨å­˜å‚¨å¿«ç…§æ–‡ä»¶çš„ç›®å½• dataLogDir è¡¨ç¤ºé…ç½® zookeeperäº‹åŠ¡æ—¥å¿—çš„å­˜å‚¨è·¯å¾„ï¼Œé»˜è®¤æŒ‡å®šåœ¨dataDirç›®å½•ä¸‹ clientPort è¡¨ç¤ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å»ºç«‹è¿æ¥çš„ç«¯å£å·ï¼š 2181 æ•°æ®æ¨¡å‹zookeeperçš„æ•°æ®æ¨¡å‹å’Œæ–‡ä»¶ç³»ç»Ÿç±»ä¼¼ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹ç§°ä¸ºï¼šznode. æ˜¯zookeeperä¸­çš„æœ€å°æ•°æ®å•å…ƒã€‚æ¯ä¸€ä¸ªznodeä¸Šéƒ½å¯ä»¥ä¿å­˜æ•°æ®å’ŒæŒ‚è½½å­èŠ‚ç‚¹ã€‚ ä»è€Œæ„æˆä¸€ä¸ªå±‚æ¬¡åŒ–çš„å±æ€§ç»“æ„ èŠ‚ç‚¹ç‰¹æ€§æŒä¹…åŒ–èŠ‚ç‚¹ ï¼š èŠ‚ç‚¹åˆ›å»ºåä¼šä¸€ç›´å­˜åœ¨zookeeperæœåŠ¡å™¨ä¸Šï¼Œç›´åˆ°ä¸»åŠ¨åˆ é™¤ æŒä¹…åŒ–æœ‰åºèŠ‚ç‚¹ ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šä¸ºå®ƒçš„ä¸€çº§å­èŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ªé¡ºåº ä¸´æ—¶èŠ‚ç‚¹ ï¼š ä¸´æ—¶èŠ‚ç‚¹çš„ç”Ÿå‘½å‘¨æœŸå’Œå®¢æˆ·ç«¯çš„ä¼šè¯ä¿æŒä¸€è‡´ã€‚å½“å®¢æˆ·ç«¯ä¼šè¯å¤±æ•ˆï¼Œè¯¥èŠ‚ç‚¹è‡ªåŠ¨æ¸…ç† ä¸´æ—¶æœ‰åºèŠ‚ç‚¹ ï¼š åœ¨ä¸´æ—¶èŠ‚ç‚¹ä¸Šå¤šå‹’ä¸€ä¸ªé¡ºåºæ€§ç‰¹æ€§ ä¼šè¯å®¢æˆ·ç«¯å’Œzookeeperä¼šå»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªä¼šè¯ã€‚ ä¼šè¯æœ‰ä»€ä¹ˆè¿‡ç¨‹å‘¢ï¼Ÿ Watcherï¼ˆç›‘å¬ï¼‰zookeeperæä¾›äº†åˆ†å¸ƒå¼æ•°æ®å‘å¸ƒ/è®¢é˜…,zookeeperå…è®¸å®¢æˆ·ç«¯å‘æœåŠ¡å™¨æ³¨å†Œä¸€ä¸ªwatcherç›‘å¬ã€‚å½“æœåŠ¡å™¨ç«¯çš„èŠ‚ç‚¹è§¦å‘æŒ‡å®šäº‹ä»¶çš„æ—¶å€™ï¼Œä¼šè§¦å‘watcherã€‚æœåŠ¡ç«¯ä¼šå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªäº‹ä»¶é€šçŸ¥ watcherçš„é€šçŸ¥æ˜¯ä¸€æ¬¡æ€§ï¼Œä¸€æ—¦è§¦å‘ä¸€æ¬¡é€šçŸ¥åï¼Œè¯¥watcherå°±å¤±æ•ˆ ACLzookeeperæä¾›æ§åˆ¶èŠ‚ç‚¹è®¿é—®æƒé™çš„åŠŸèƒ½ï¼Œç”¨äºæœ‰æ•ˆçš„ä¿è¯zookeeperä¸­æ•°æ®çš„å®‰å…¨æ€§ã€‚é¿å…è¯¯æ“ä½œè€Œå¯¼è‡´ç³»ç»Ÿå‡ºç°é‡å¤§äº‹æ•…ã€‚ æä¾›äº†ï¼šCREATE /READ/WRITE/DELETE/ADMIN Zookeeperå‘½ä»¤æ“ä½œ(å¢åˆ æ”¹æŸ¥) create [-s] -e path data acl -s è¡¨ç¤ºèŠ‚ç‚¹æ˜¯å¦æœ‰åº -e è¡¨ç¤ºæ˜¯å¦ä¸ºä¸´æ—¶èŠ‚ç‚¹ (é»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯æŒä¹…åŒ–èŠ‚ç‚¹) 123create /zoo #åˆ›å»ºzooèŠ‚ç‚¹create /zoo /zoo-1 #åˆ›å»ºzooèŠ‚ç‚¹ä¸‹çš„zoo-1ls /nodes #æ˜¾ç¤ºèŠ‚ç‚¹ get path [watch] è·å¾—æŒ‡å®š pathçš„ä¿¡æ¯ â€‹ 3.set path data [version] ä¿®æ”¹èŠ‚ç‚¹ pathå¯¹åº”çš„data versionè¡¨ç¤ºä¹è§‚é”ï¼ŒåŠæ•°æ®åº“ä¸­æœ‰ä¸€ä¸ªversionå­—æ®µå»æ§åˆ¶æ•°æ®è¡Œçš„ç‰ˆæœ¬å· ä¹è§‚é”ï¼ˆ Optimistic Locking ï¼‰ ç›¸å¯¹æ‚²è§‚é”è€Œè¨€ï¼Œä¹è§‚é”æœºåˆ¶é‡‡å–äº†æ›´åŠ å®½æ¾çš„åŠ é”æœºåˆ¶ã€‚æ‚²è§‚é”å¤§å¤šæ•°æƒ…å†µä¸‹ä¾é æ•°æ®åº“çš„é”æœºåˆ¶å®ç°ï¼Œä»¥ä¿è¯æ“ä½œæœ€å¤§ç¨‹åº¦çš„ç‹¬å æ€§ã€‚ä½†éšä¹‹è€Œæ¥çš„å°±æ˜¯æ•°æ®åº“æ€§èƒ½çš„å¤§é‡å¼€é”€ï¼Œç‰¹åˆ«æ˜¯å¯¹é•¿äº‹åŠ¡è€Œè¨€ï¼Œè¿™æ ·çš„å¼€é”€å¾€å¾€æ— æ³•æ‰¿å—ã€‚è€Œä¹è§‚é”æœºåˆ¶åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚ä¹è§‚é”ï¼Œå¤§å¤šæ˜¯åŸºäºæ•°æ®ç‰ˆæœ¬ï¼ˆ Version ï¼‰è®°å½•æœºåˆ¶å®ç°ã€‚ä½•è°“æ•°æ®ç‰ˆæœ¬ï¼Ÿå³ä¸ºæ•°æ®å¢åŠ ä¸€ä¸ªç‰ˆæœ¬æ ‡è¯†ï¼Œåœ¨åŸºäºæ•°æ®åº“è¡¨çš„ç‰ˆæœ¬è§£å†³æ–¹æ¡ˆä¸­ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ä¸ºæ•°æ®åº“è¡¨å¢åŠ ä¸€ä¸ª â€œversionâ€ å­—æ®µæ¥å®ç°ã€‚è¯»å–å‡ºæ•°æ®æ—¶ï¼Œå°†æ­¤ç‰ˆæœ¬å·ä¸€åŒè¯»å‡ºï¼Œä¹‹åæ›´æ–°æ—¶ï¼Œå¯¹æ­¤ç‰ˆæœ¬å·åŠ ä¸€ã€‚æ­¤æ—¶ï¼Œå°†æäº¤æ•°æ®çš„ç‰ˆæœ¬æ•°æ®ä¸æ•°æ®åº“è¡¨å¯¹åº”è®°å½•çš„å½“å‰ç‰ˆæœ¬ä¿¡æ¯è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæäº¤çš„æ•°æ®ç‰ˆæœ¬å·å¤§äºæ•°æ®åº“è¡¨å½“å‰ç‰ˆæœ¬å·ï¼Œåˆ™äºˆä»¥æ›´æ–°ï¼Œå¦åˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ•°æ®ã€‚ â€‹ 4.delete path [version] åˆ é™¤èŠ‚ç‚¹ èŠ‚ç‚¹çŠ¶æ€statä¿¡æ¯cversion = 0 å­ï¼ˆchildï¼‰èŠ‚ç‚¹çš„ç‰ˆæœ¬å· aclVersion = 0 è¡¨ç¤ºaclçš„ç‰ˆæœ¬å·ï¼Œä¿®æ”¹èŠ‚ç‚¹æƒé™ dataVersion = 1 è¡¨ç¤ºçš„æ˜¯å½“å‰èŠ‚ç‚¹æ•°æ®çš„ç‰ˆæœ¬å· czxid èŠ‚ç‚¹è¢«åˆ›å»ºæ—¶çš„äº‹åŠ¡ID mzxid èŠ‚ç‚¹æœ€åä¸€æ¬¡è¢«æ›´æ–°çš„äº‹åŠ¡ID pzxid å½“å‰èŠ‚ç‚¹ä¸‹çš„å­èŠ‚ç‚¹æœ€åä¸€æ¬¡è¢«ä¿®æ”¹æ—¶çš„äº‹åŠ¡ID ctime = åˆ›å»ºæ—¶é—´ mtime = ä¿®æ”¹æ—¶é—´ ephemeralOwner = 0x0 åˆ›å»ºä¸´æ—¶èŠ‚ç‚¹çš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€ä¸ªsessionId ã€‚ è¯¥å€¼å­˜å‚¨çš„å°±æ˜¯è¿™ä¸ªsessionid ã€‚0X0ä»£è¡¨æ—  dataLength = 3 æ•°æ®å€¼é•¿åº¦ numChildren = 0 å­èŠ‚ç‚¹æ•° åœ¨Javaä¸­ä½¿ç”¨zookeeperå¼•å…¥ä¾èµ– 12345 &lt;dependency&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;version&gt;3.4.9&lt;/version&gt;&lt;/dependency&gt; å›°äº†ï¼Œç¡è§‰ã€‚æ˜å¤©å†ç å­—ã€‚æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚ã€‚ã€‚ å‚è€ƒ èŠèŠåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå†è¯´è¯´è§£å†³æ–¹æ¡ˆ æ„Ÿè°¢ ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹ï¼Œå’±ä»¬ä¸¤ä¸ªæƒ³ä¸ªå·ç ï¼Œ ä¹°ä¸ªå½©ç¥¨ï¼Œå…ˆæŒ£ä»–ä¸ªå‡ ç™¾ä¸‡ğŸ˜]]></content>
      <tags>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>å­¦å¥½åˆ†å¸ƒå¼æ¶æ„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å­¦å¥½åˆ†å¸ƒå¼æ¶æ„=4=-webservice]]></title>
    <url>%2F2018%2F07%2F28%2F%E6%88%91%E8%A6%81%E5%AD%A6%E5%A5%BD%E5%88%86%E5%B8%83%E5%BC%8F-webservice%2F</url>
    <content type="text"><![CDATA[ä»Šå¤©å’±ä»¬ä¸€èµ·æ¢ç´¢ä¸€ä¸‹webserviceè¿™ä¸ªæŠ€æœ¯ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ ä»€ä¹ˆæ˜¯webservicewebserviceä¹Ÿå¯ä»¥å«xml web service webserviceï¼ˆåœ¨javax.jwsï¼‰, è½»é‡çº§çš„ç‹¬ç«‹çš„é€šè®¯æŠ€æœ¯ åŸºäºwebçš„æœåŠ¡ï¼šæœåŠ¡ç«¯æä¾›çš„æœåŠ¡æ¥å£è®©å®¢æˆ·ç«¯è®¿é—® è·¨å¹³å°ã€è·¨è¯­è¨€çš„æ•´åˆæ–¹æ¡ˆ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨webserviceç›¸æ¯”RMIï¼Œå®ƒæ˜¯ä»¥å‰æ¯”è¾ƒå¥½çš„è·¨è¯­è¨€è°ƒç”¨çš„è§£å†³æ–¹æ¡ˆ å°±è­¬å¦‚è¯´ï¼Œä¸€ä¸ªç”µå•†å¹³å°ï¼Œè®¢å•å¯ä»¥æŸ¥çœ‹ç‰©æµçŠ¶æ€ã€‚ï¼Œè¿™å¯èƒ½å°±æ˜¯.netå®ç°çš„webserviceæœåŠ¡æ¥å£ã€‚ webserviceä¸­çš„ä¸€äº›æ¦‚å¿µWSDL(web service definition language webservice å®šä¹‰è¯­è¨€)webserviceæœåŠ¡éœ€è¦é€šè¿‡wsdlæ–‡ä»¶æ¥è¯´æ˜è‡ªå·±æœ‰ä»€ä¹ˆæœåŠ¡å¯ä»¥å¯¹å¤–è°ƒç”¨ã€‚å¹¶ä¸”æœ‰å“ªäº›æ–¹æ³•ã€æ–¹æ³•é‡Œé¢æœ‰å“ªäº›å‚æ•° wsdlåŸºäºXMLï¼ˆå¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼‰å»å®šä¹‰äº† å¯¹åº”ä¸€ä¸ª.wsdlçš„æ–‡ä»¶ç±»å‹ å®šä¹‰äº†webserviceçš„æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯åº”ç”¨è¿›è¡Œäº¤äº’çš„ä¼ é€’æ•°æ®å’Œå“åº”æ•°æ®æ ¼å¼å’Œæ–¹å¼ ä¸€ä¸ªwebserviceå¯¹åº”å”¯ä¸€ä¸€ä¸ªwsdlæ–‡æ¡£ SOAPï¼ˆsimple object access protocalç®€å•å¯¹è±¡è®¿é—®åè®®ï¼‰å·®ä¸å¤šå°±æ˜¯http+xmlï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Ÿwebserviceé€šè¿‡httpåè®®å‘é€å’Œæ¥æ”¶è¯·æ±‚æ—¶ï¼Œ å‘é€çš„å†…å®¹ï¼ˆè¯·æ±‚æŠ¥æ–‡ï¼‰å’Œæ¥æ”¶çš„å†…å®¹ï¼ˆå“åº”æŠ¥æ–‡ï¼‰éƒ½æ˜¯é‡‡ç”¨xmlæ ¼å¼è¿›è¡Œå°è£…ï¼Œè¿™äº›ç‰¹å®šçš„HTTPæ¶ˆæ¯å¤´å’ŒXMLå†…å®¹æ ¼å¼å°±æ˜¯SOAPåè®®ã€‚ ä¸€æ¡ SOAP æ¶ˆæ¯å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ XML æ–‡æ¡£ï¼ŒåŒ…å«ä¸‹åˆ—å…ƒç´ ï¼š â€¢ Envelope å…ƒç´ ï¼Œæ ‡è¯†XML æ–‡æ¡£ä¸€æ¡ SOAP æ¶ˆæ¯ â€¢ Header å…ƒç´ ï¼ŒåŒ…å«å¤´éƒ¨ä¿¡æ¯çš„XMLæ ‡ç­¾ â€¢ Body å…ƒç´ ï¼ŒåŒ…å«æ‰€æœ‰çš„è°ƒç”¨å’Œå“åº”çš„ä¸»ä½“ä¿¡æ¯çš„æ ‡ç­¾ â€¢ Fault å…ƒç´ ï¼Œé”™è¯¯ä¿¡æ¯æ ‡ç­¾ã€‚ æ’ä¸€å¥å˜´ï¼Œç°åœ¨çš„å‘¢ï¼ŒåŸºäºRESTfulæ¥å£çš„éƒ½æ˜¯http+json å›åˆ°ä¸»é¢˜ï¼Œä»€ä¹ˆæ˜¯soapï¼Ÿ ä¸€ç§ç®€å•ã€åŸºäºHTTPå’ŒXMLçš„åè®® soapæ¶ˆæ¯ï¼šè¯·æ±‚å’Œå“åº”æ¶ˆæ¯ http+xmlæŠ¥æ–‡ SEIï¼ˆwebservice endpoint interface webserviceçš„ç»ˆç«¯æ¥å£ï¼‰webserviceæœåŠ¡ç«¯ç”¨æ¥å¤„ç†è¯·æ±‚çš„æ¥å£ï¼Œä¹Ÿå°±æ˜¯å‘å¸ƒå‡ºå»çš„æ¥å£ã€‚ Demoå¦‚ä½•å®ç°å‘¢ï¼Ÿå†™ä¸€ä¸ªå°demo é¦–å…ˆæ˜¯æœåŠ¡ç«¯çš„æ¥å£ 123456@WebService//SEIä»¥åŠå®ç°ç±»public interface ISayHello &#123; @WebMethod//seiä¸­çš„æ–¹æ³• public String sayHello();&#125; å…·ä½“å®ç°ç±» 123456789@WebServicepublic class SayHello implements ISayHello&#123; @Override public String sayHello() &#123; return "hello"; &#125;&#125; å¯åŠ¨ç±» 12345678public class Bootstrap &#123; public static void main(String[] args) &#123; //ç»ˆç«¯å‘å¸ƒ~ Endpoint.publish("http://localhost:8888/tech/hello",new SayHello()); System.out.println("å‘å¸ƒæˆåŠŸ~"); &#125;&#125; æ¥ç€æˆ‘ä»¬å¯åŠ¨ç¨‹åºã€‚åˆ°æµè§ˆå™¨è¾“å…¥url+â€?wsdlâ€å°±å¯ä»¥æŸ¥çœ‹wsdlæ–‡æ¡£äº† æ¥ä¸‹æ¥åœ¨IDEAä¸­æ‰“å¼€terminalæˆ–è€…ç›´æ¥è¿›å…¥cmdï¼Œè°ƒç”¨wsimportå·¥å…·,è¾“å…¥å‘½ä»¤: 1wsimport -keep http://localhost:8888/tech/hello?wsdl è¿™é‡Œç®€ä»‹ä¸€ä¸‹åƒæ•°ï¼š -d è¡¨ç¤ºè¾“å‡ºçš„æ–‡ä»¶å¤¹ã€‚æ–‡ä»¶å¤¹å¿…é¡»äº‹å…ˆå­˜åœ¨ï¼Œå¦åˆ™å¯¼å‡ºå¤±è´¥ã€‚ -keep è¡¨ç¤ºå¯¼å‡ºwebserviceçš„classæ–‡ä»¶æ—¶æ˜¯å¦ä¹Ÿå¯¼å‡ºæºç javaæ–‡ä»¶ã€‚ -verbose verboseè¡¨ç¤ºå…·ä½“ä¿¡æ¯ã€‚ è¿™æ—¶å€™ç”Ÿæˆçš„å®¢æˆ·ç«¯ä»£ç  è¿ç§»åˆ°IDEAæ‰“å¼€ï¼Œæ–°å»ºä¸€ä¸ªdemo 1234567public class Demo &#123; public static void main(String[] args) &#123; SayHelloService service=new SayHelloService(); SayHello sayHello= (SayHello) service.getSayHelloPort(); System.out.println(); &#125;&#125; demoå®Œæˆ~ï¼ å…³äºWSDLæ–‡æ¡£ä¸‹é¢è¯´è¯´wsdlæ–‡æ¡£å„ä¸ªæ ‡ç­¾çš„å«ä¹‰ Typesæ ‡ç­¾å®šä¹‰æ•´æœåŠ¡ç«¯çš„æ•°æ®æŠ¥æ–‡ Schemaæ ‡ç­¾ä¸ºäº†å®ç°æœ€å¤§çš„äº’æ“ä½œæ€§ï¼ˆinteroperabilityï¼‰å’Œå¹³å°ä¸­ç«‹æ€§ï¼ˆneutralityï¼‰ï¼ŒWSDLé€‰ç”¨XML Schema DataTypesï¼Œç®€ç§°XSDä½œä¸ºæ ‡å‡†ç±»å‹ç³»ç»Ÿï¼Œå¹¶å°†å®ƒä½œä¸ºå›ºæœ‰ç±»å‹ç³»ç»Ÿã€‚ å›¾ä¸­çš„æ˜¯æ•°æ®å®šä¹‰éƒ¨åˆ†ï¼Œè¯¥éƒ¨åˆ†å®šä¹‰äº†ä¸¤ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªæ˜¯sayHelloï¼Œä¸€ä¸ªæ˜¯sayHelloResponseï¼š sayHelloï¼šå®šä¹‰äº†ä¸€ä¸ªå¤æ‚ç±»å‹ï¼Œä»…ä»…åŒ…å«ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²ï¼Œå°†æ¥ç”¨æ¥æè¿°æ“ä½œçš„å‚å…¥ä¼ å…¥éƒ¨åˆ†ï¼› sayHelloResponseï¼šå®šä¹‰äº†ä¸€ä¸ªå¤æ‚ç±»å‹ï¼Œä»…ä»…åŒ…å«ä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²ï¼Œå°†æ¥ç”¨æ¥æè¿°æ“ä½œçš„è¿”å›å€¼ï¼› Messageæ ‡ç­¾å®šä¹‰å…ƒç´ æ•°æ®ç±»å‹ Porttypeå®šä¹‰æœåŠ¡å™¨ç«¯çš„SEI input/outputå±æ€§ï¼šæŒ‡å®šè¾“å…¥è¾“å‡ºçš„æ•°æ®ç±»å‹ Bindingæ ‡ç­¾typeå±æ€§ï¼šå¼•ç”¨PortType serviceæ ‡ç­¾è¡¨ç¤ºæœåŠ¡å™¨ç«¯çš„ä¸€ä¸ªwebserviceå®¹å™¨ nameå±æ€§ï¼šåˆ¶å®šå®¢æˆ·ç«¯å±æ€§ protå±æ€§ï¼šæŒ‡å®šå®¢æˆ·ç«¯çš„å®¹å™¨ç±» addressï¼šå¤§éƒ¨åˆ†å…¨éƒ¨webserviceçš„åœ°å€ è¿‡å»çš„Webserviceå·¥å…·å‘ä¸ªåå­—ç•™ä½œå¤‡ä»½ï¼Œå› ä¸ºç°åœ¨æ—©å·²ä¸ç”¨å¤æ‚çš„webserviceäº† cxfceltix+xfire axiså®Œç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹ï¼Œå’±ä»¬ä¸¤ä¸ªæƒ³ä¸ªå·ç ï¼Œ ä¹°ä¸ªå½©ç¥¨ï¼Œå…ˆæŒ£ä»–ä¸ªå‡ ç™¾ä¸‡ğŸ˜]]></content>
      <tags>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>å­¦å¥½åˆ†å¸ƒå¼æ¶æ„</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å­¦å¥½åˆ†å¸ƒå¼æ¶æ„=6=-RMIé€šä¿¡æ¡†æ¶]]></title>
    <url>%2F2018%2F07%2F26%2FRMI%E9%80%9A%E4%BF%A1%E6%A1%86%E6%9E%B6%2F</url>
    <content type="text"><![CDATA[åˆ†å¸ƒå¼æ¡†æ¶æ˜¯æœ€è¿‘å‡ å¹´çš„çƒ­é—¨ã€‚å¯æ˜¯è¦æƒ³ç†è§£åˆ†å¸ƒå¼æ¡†æ¶ç€å®ä¸æ˜“ï¼Œä¸ºäº†åŠªåŠ›è·Ÿä¸Šæ—¶ä»£æ½®æµï¼Œç‰¹æ­¤å¼€äº†ä¸€ä¸ªä¸“é¢˜ï¼Œèµ·åâ€œæˆ‘è¦å­¦å¥½åˆ†å¸ƒå¼â€ï¼Œé€šè¿‡åšå®¢æ¥åˆ†äº«ä¸€ä¸‹æˆ‘çš„å­¦ä¹ è¿‡ç¨‹ï¼ŒåŠ æ·±æˆ‘å¯¹åˆ†å¸ƒå¼æ•´ä½“æ¡†æ¶çš„ç†è§£ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ ä»€ä¹ˆæ˜¯RPCè‹±æ–‡å°±ä¸è¯´äº†ã€‚ä¸­æ–‡åè¿œç¨‹è¿›ç¨‹è°ƒç”¨åè®®ã€‚é¡¾åæ€ä¹‰ï¼Œå®¢æˆ·ç«¯åœ¨ä¸çŸ¥é“ç»†èŠ‚çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è°ƒç”¨è¿œç¨‹è®¡ç®—æœºçš„apiï¼Œå°±åƒæ˜¯è°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·ã€‚ RPCåè®®æ˜¯ä¸€ä¸ªè§„èŒƒã€‚ä¸»æµçš„PRCåè®®æœ‰Dubboã€Thrifã€RMIã€Webserviceã€Hessain ä»–åˆä¸€ä¸ªéå¸¸å¤§çš„ç‰¹ç‚¹ï¼Œç½‘ç»œåè®®å’Œç½‘ç»œIOå¯¹äºè°ƒç”¨ç«¯å’ŒæœåŠ¡ç«¯æ¥è¯´æ˜¯é€æ˜çš„ï¼ˆåŠ¨æ€ä»£ç†ï¼‰ ä¸€ä¸ªRPCæ¡†æ¶åŒ…å«çš„è¦ç´ ï¼š RMIRMI(remote method invocation) , å¯ä»¥è®¤ä¸ºæ˜¯RPCçš„javaç‰ˆæœ¬ RMIä½¿ç”¨çš„æ˜¯JRMPï¼ˆJava Remote Messageing Protocolï¼‰, JRMPæ˜¯ä¸“é—¨ä¸ºjavaå®šåˆ¶çš„é€šä¿¡åè®®ï¼Œæ‰€ä»¥ä»–æ˜¯çº¯javaçš„åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆ ã€‚ RMI Demo å…ˆå†™ä¸ªæµ‹è¯•ç”¨çš„è¿œç¨‹æ¥å£ï¼Œæ³¨æ„æ¥å£è¦æŠ›å¼‚å¸¸ 123public interface ISayHello extends Remote &#123; public String satHello(String name) throws RemoteException;&#125; 2.å®ç°è¿œç¨‹æ¥å£ï¼Œå¹¶ä¸”ç»§æ‰¿ï¼š`UnicastRemoteObject` 123456789public class SayHelloImpl extends UnicastRemoteObject implements ISayHello&#123; protected SayHelloImpl() throws RemoteException &#123; &#125; public String satHello(String name) throws RemoteException &#123; return "hello," + name; &#125;&#125; 3.åˆ›å»ºæœåŠ¡å™¨ç¨‹åºï¼š `createRegistry`æ–¹æ³•æ³¨å†Œè¿œç¨‹å¯¹è±¡ 123456789101112131415161718192021import java.net.MalformedURLException;import java.rmi.AlreadyBoundException;import java.rmi.Naming;import java.rmi.RemoteException;import java.rmi.registry.LocateRegistry;public class HelloServer &#123; public static void main(String[] args) &#123; try &#123; ISayHello sayHello =new SayHelloImpl(); LocateRegistry.createRegistry(8888); Naming.bind("rmi://localhost:8888/sayhello",sayHello); System.out.println("server start success"); &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; catch (MalformedURLException e) &#123; e.printStackTrace(); &#125; catch (AlreadyBoundException e) &#123; e.printStackTrace(); &#125; &#125; 4.åˆ›å»ºå®¢æˆ·ç«¯ç¨‹åº 1234567891011121314public class HelloClient &#123; public static void main(String[] args) &#123; try &#123; ISayHello iSayHello = (ISayHello) Naming.lookup("rmi://localhost:8888/sayhello"); System.out.println("hello"); &#125; catch (NotBoundException e) &#123; e.printStackTrace(); &#125; catch (MalformedURLException e) &#123; e.printStackTrace(); &#125; catch (RemoteException e) &#123; e.printStackTrace(); &#125; &#125;&#125; RMIè°ƒç”¨è¿‡ç¨‹ æµç¨‹ï¼š 1.å»æ³¨å†Œä¸­å¿ƒæ³¨å†Œï¼Œserverç«¯å¯åŠ¨æœåŠ¡ã€‚ 2.æ³¨å†Œä¸­å¿ƒè”ç³»stubï¼ˆå­˜æ ¹ï¼‰ã€‚stubç”¨äºå®¢æˆ·ç«¯ ï¼Œåœ¨j2eeä¸­æ˜¯è¿™ä¹ˆè¯´çš„ï¼šä¸ºå±è”½å®¢æˆ·è°ƒç”¨è¿œç¨‹ä¸»æœºä¸Šçš„å¯¹è±¡ï¼Œå¿…é¡»æä¾›æŸç§æ–¹å¼æ¥æ¨¡æ‹Ÿæœ¬åœ°å¯¹è±¡,è¿™ç§æœ¬åœ°å¯¹è±¡ç§°ä¸ºå­˜æ ¹(stub),å­˜æ ¹è´Ÿè´£æ¥æ”¶æœ¬åœ°æ–¹æ³•è°ƒç”¨,å¹¶å°†å®ƒä»¬å§”æ´¾ç»™å„è‡ªçš„å…·ä½“å®ç°å¯¹è±¡ 3.serveræ³¨å†Œå¯¹è±¡ï¼Œç„¶åè¿”å›æ³¨å†Œå¯¹è±¡ 4.å®¢æˆ·ç«¯è®¿é—®æ³¨å†Œä¸­å¿ƒï¼Œï¼ˆåŠ¨æ€ä»£ç†ï¼‰è¿”å›stubå¯¹è±¡ 5.stubï¼ˆå­˜æ ¹ï¼‰è¿œç¨‹è°ƒç”¨skeleton ï¼ˆéª¨æ¶ ï¼‰ 6.skeleton è°ƒç”¨ç›¸åº”æ¥å£ æºç è®©æˆ‘çœ‹çœ‹æ ¸å¿ƒçš„æ³¨å†ŒæœåŠ¡çš„æºç å®ç° 123456789101112131415161718192021222324public RegistryImpl(final int var1) throws RemoteException &#123; this.bindings = new Hashtable(101); //å®‰å…¨è®¤è¯ if (var1 == 1099 &amp;&amp; System.getSecurityManager() != null) &#123; try &#123; AccessController.doPrivileged(new PrivilegedExceptionAction&lt;Void&gt;() &#123; public Void run() throws RemoteException &#123; LiveRef var1x = new LiveRef(RegistryImpl.id, var1); RegistryImpl.this.setup(new UnicastServerRef(var1x, (var0) -&gt; &#123; return RegistryImpl.registryFilter(var0); &#125;)); return null; &#125; &#125;, (AccessControlContext)null, new SocketPermission("localhost:" + var1, "listen,accept")); &#125; catch (PrivilegedActionException var3) &#123; throw (RemoteException)var3.getException(); &#125; &#125; else &#123; //åˆå§‹åŒ–è¿œç¨‹å¼•ç”¨UnicastServerRefå¯¹è±¡ LiveRef var2 = new LiveRef(id, var1);//ã€Š-------------------------- this.setup(new UnicastServerRef(var2, RegistryImpl::registryFilter)); &#125; &#125; ç‚¹è¿›UnicastServerRefï¼Œæ‰¾å‡ºå®ç°çš„å…³ç³»~ ç‚¹è¿›setupæ–¹æ³•ï¼Œç”¨ideaåç¼–ç  12345678910111213141516171819public Remote exportObject(Remote var1, Object var2, boolean var3) throws RemoteException &#123; Class var4 = var1.getClass(); Remote var5; try &#123; var5 = Util.createProxy(var4, this.getClientRef(), this.forceStubUse);//ã€Š-------------------- &#125; catch (IllegalArgumentException var7) &#123; throw new ExportException("remote object implements illegal remote interface", var7); &#125; if (var5 instanceof RemoteStub) &#123;//ã€Š-------------------------- this.setSkeleton(var1); &#125; Target var6 = new Target(var1, this, var5, this.ref.getObjID(), var3);//ã€Š------------------------ this.ref.exportObject(var6); this.hashToMethod_Map = (Map)hashToMethod_Maps.get(var4); return var5; &#125; å‘ç°åœ¨åˆ›å»ºä»£ç†ï¼Œåˆ¤æ–­å½“å‰çš„varæ˜¯ä¸æ˜¯è¿œç¨‹stubï¼Œå¦‚æœæ˜¯å°±è®¾ç½®éª¨æ¶ã€‚å¦‚æœä¸æ˜¯ï¼Œå°±æ„å»ºtargetå¯¹è±¡ã€‚ç‚¹å¼€ä»£ç† 1234567891011121314151617181920212223242526public static Remote createProxy(Class&lt;?&gt; var0, RemoteRef var1, boolean var2) throws StubNotFoundException &#123; Class var3; try &#123; var3 = getRemoteClass(var0);//ã€Š-------------------------- &#125; catch (ClassNotFoundException var9) &#123; throw new StubNotFoundException("object does not implement a remote interface: " + var0.getName()); &#125; if (var2 || !ignoreStubClasses &amp;&amp; stubClassExists(var3)) &#123; return createStub(var3, var1);//ã€Š-------------------------- &#125; else &#123; final ClassLoader var4 = var0.getClassLoader(); final Class[] var5 = getRemoteInterfaces(var0); final RemoteObjectInvocationHandler var6 = new RemoteObjectInvocationHandler(var1); try &#123; return (Remote)AccessController.doPrivileged(new PrivilegedAction&lt;Remote&gt;() &#123; public Remote run() &#123; return (Remote)Proxy.newProxyInstance(var4, var5, var6); &#125; &#125;); &#125; catch (IllegalArgumentException var8) &#123; throw new StubNotFoundException("unable to create proxy", var8); &#125; &#125; &#125; å‘ç°åœ¨è°ƒç”¨è¿œç¨‹æœåŠ¡ï¼Œç„¶ååˆ›å»ºäº†stubã€‚ç»§ç»­ç‚¹å¼€getRemoteClassï¼ˆï¼‰æ–¹æ³• 123456789101112131415private static Class&lt;?&gt; getRemoteClass(Class&lt;?&gt; var0) throws ClassNotFoundException &#123; while(var0 != null) &#123; Class[] var1 = var0.getInterfaces();//ã€Š-------------------------- for(int var2 = var1.length - 1; var2 &gt;= 0; --var2) &#123; if (Remote.class.isAssignableFrom(var1[var2])) &#123; return var0; &#125; &#125; var0 = var0.getSuperclass(); &#125; throw new ClassNotFoundException("class does not implement java.rmi.Remote"); &#125; å‘ç°ç°åœ¨åœ¨åˆ›å»ºå®ä¾‹ å¥½å§ï¼Œå›åˆ°createProxyæ–¹æ³•ï¼Œå†çœ‹çœ‹é¡ºç€å¾€ä¸‹èµ°ï¼Œçœ‹çœ‹Target var6 = new Target(var1, this, var5, this.ref.getObjID(), var3); this.ref.exportObject(var6);çš„å‡ºå£å¯¹è±¡æ–¹æ³• 123public void exportObject(Target var1) throws RemoteException &#123; this.ep.exportObject(var1); &#125; 123456789public interface Endpoint &#123; Channel getChannel(); void exportObject(Target var1) throws RemoteException; Transport getInboundTransport(); Transport getOutboundTransport();&#125; 123public void exportObject(Target var1) throws RemoteException &#123; this.transport.exportObject(var1); &#125; ä¸€è·¯ç‚¹ä¸‹å»ï¼Œæ‰¾åˆ°äº†tcpå‡ºå£çš„æ–¹æ³•ã€‚è¿™æ˜¯å±äºåè®®å±‚çš„ç©æ„ã€‚ 12345public void exportObject(Target var1) throws RemoteException &#123; synchronized(this) &#123; this.listen(); ++this.exportCount; &#125; ä¸€è·¯ç‚¹ä¸‹å»ï¼Œå‘ç°listenã€‚ 12345678910111213141516171819202122232425private void listen() throws RemoteException &#123; assert Thread.holdsLock(this); TCPEndpoint var1 = this.getEndpoint(); int var2 = var1.getPort(); if (this.server == null) &#123; if (tcpLog.isLoggable(Log.BRIEF)) &#123; tcpLog.log(Log.BRIEF, "(port " + var2 + ") create server socket"); &#125; try &#123; this.server = var1.newServerSocket();//ã€Š-------------------------- Thread var3 = (Thread)AccessController.doPrivileged(new NewThreadAction(new TCPTransport.AcceptLoop(this.server), "TCP Accept-" + var2, true)); var3.start(); &#125; catch (BindException var4) &#123; throw new ExportException("Port already in use: " + var2, var4); &#125; catch (IOException var5) &#123; throw new ExportException("Listen failed on port: " + var2, var5); &#125; &#125; else &#123; SecurityManager var6 = System.getSecurityManager(); if (var6 != null) &#123; var6.checkListen(var2); &#125; &#125; å‘ç°newServerSocketï¼ï¼ï¼ ç»¼ä¸Šï¼Œæ€»ä½“æµç¨‹å’Œä¸Šå›¾ä¸€æ ·ã€‚ RMIç¼ºé™·1.åŸºäºjavaï¼Œæ”¯æŒè¯­è¨€å•ä¸€ 2.æœåŠ¡æ³¨å†Œåªèƒ½æ³¨å†Œåˆ°æˆ‘ä¸Šé¢åˆ†æçš„é‚£ä¸ªæºç ã€‚æ³¨å†Œä¸­å¿ƒæŒ‚äº†ä»¥åå°±å®Œäº† 3.åºåˆ—åŒ–æ˜¯ç”¨javaåŸç”Ÿé‚£ä¸ªæ–¹æ³•ï¼Œæ•ˆç‡ä¸å¥½ 4.æœåŠ¡ç«¯åº•å±‚æ˜¯bioæ–¹å¼ï¼Œæ€§èƒ½ä¸å¥½ æ‰‹å†™ä¸ªRMIï¼Ÿæ­¥éª¤ï¼š ç¼–å†™æœåŠ¡å™¨ç¨‹åºï¼Œæš´éœ²ä¸€ä¸ªç›‘å¬ï¼Œ å¯ä»¥ä½¿ç”¨socket ç¼–å†™å®¢æˆ·ç«¯ç¨‹åºï¼Œé€šè¿‡ipå’Œç«¯å£è¿æ¥åˆ°æŒ‡å®šçš„æœåŠ¡å™¨ï¼Œå¹¶ä¸”å°†æ•°æ®åšå°è£…ï¼ˆåºåˆ—åŒ–ï¼‰ æœåŠ¡å™¨ç«¯æ”¶åˆ°è¯·æ±‚ï¼Œå…ˆååºåˆ—åŒ–ã€‚å†è¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚æŠŠè¿”å›ç»“æœåºåˆ—åŒ–è¿”å› æºç ï¼šhttps://github.com/tengshe789/ForRMI æŠŠæºç å‘å¸ƒåˆ°GitHubäº†ï¼Œåœ¨æŠŠæºç ç²˜è´´å¤ªéº»çƒ¦äº†ã€‚ ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹~]]></content>
      <tags>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>å­¦å¥½åˆ†å¸ƒå¼æ¶æ„</tag>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…³æ‰X5å†…æ ¸è®©å¾®ä¿¡å˜å¾—é£å¿«~]]></title>
    <url>%2F2018%2F07%2F26%2F%E5%85%B3%E6%8E%89X5%E5%86%85%E6%A0%B8%E8%AE%A9%E5%BE%AE%E4%BF%A1%E5%8F%98%E5%BE%97%E9%A3%9E%E5%BF%AB%2F</url>
    <content type="text"><![CDATA[å‰è¨€æˆ‘æ¢æ‰‹æœºäº†ã€‚ã€‚ã€‚ ä»¥å‰çš„å°S8å–æ‰äº†ï¼ˆæ—¥å¸¸æ“ä½œğŸ˜ï¼‰ç­‰ä»·æ¢äº†ä¸ªğŸ‘‡ æ–°æ‰‹æœºæµ‹è¯•å®ŒåŠŸèƒ½ï¼Œä¸‹å¥½å¾®ä¿¡ä»¥åï¼Œå‘ç°æµè§ˆæŠ€æœ¯å…¬ä¼—å·æ¯”è€æ‰‹æœºæ…¢äº†å¾ˆå¤šï¼Œçº³é—·ã€‚åæ¥æ‰æƒ³åˆ°å¿˜äº†æ¢å†…æ ¸äº†ã€‚ æ“ä½œæ­¥éª¤WebView æ˜¯Androidå¼€å‘ä¸­ç»å¸¸ä¼šç”¨åˆ°çš„åŠŸèƒ½ï¼Œæ˜¯ä¸€ä¸ªåŸºäºwebkitå¼•æ“ï¼Œç”¨äºæ˜¾ç¤ºæ¥è‡ªæœ¬åœ°ã€æœåŠ¡å™¨webé¡µé¢çš„æ§ä»¶ï¼Œå¯ä»¥å¾ˆå¥½çš„æå‡åº”ç”¨æ‰©å±•æ€§ã€‚æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š å¯ä»¥ç›´æ¥æ˜¾ç¤ºå’Œæ¸²æŸ“webé¡µé¢ webviewå¯ä»¥ç›´æ¥ç”¨htmlæ–‡ä»¶ï¼ˆç½‘ç»œä¸Šæˆ–æœ¬åœ°assetsä¸­ï¼‰ä½œå¸ƒå±€ å’ŒJavaScriptäº¤äº’è°ƒç”¨ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†webviewæ›´æ–°åˆ°æœ€æ–°ã€‚ ç„¶åæ‰“å¼€å¾®ä¿¡ï¼Œåœ¨ä»»æ„èŠå¤©ç•Œé¢ï¼Œè¾“å…¥ debugtbs.qq.com ç‚¹å‡»ç¦ç”¨å†…æ ¸ï¼Œé‡å¯å¾®ä¿¡åï¼Œåœ¨ç‚¹å‡»æ¸…é™¤tbs æ“ä½œå®Œæˆï¼Œç»“æŸï¼ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹~]]></content>
      <tags>
        <tag>çªé—¨</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å®‰åˆ©è½¯ä»¶-å¦‚ä½•åœ¨Windowsè°ƒæ•´å¤šæ ¸å¿ƒCPUè´Ÿè½½å¹¶ä¼˜åŒ–ï¼Ÿ]]></title>
    <url>%2F2018%2F07%2F25%2F%E6%95%99%E4%BD%A0%E5%A6%82%E4%BD%95%E5%9C%A8Winddows%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%A4%9A%E6%A0%B8%E5%BF%83CPU%E8%B4%9F%E8%BD%BD%E4%BC%98%E5%8C%96%2F</url>
    <content type="text"><![CDATA[hexoä¸çŸ¥é“å’‹åœ°äº†ï¼Œmarkdownè½¬htmlç”Ÿæˆé™æ€èµ„æºçš„æ—¶å€™ï¼Œå›¾ç‰‡å®Œå…¨ä¸å†™è¿›htmlï¼Œå‰é¢å‡ ç¯‡æºç åˆ†æçš„å›¾å…¨æ˜¾ç¤ºä¸å‡ºæ¥äº†ã€‚è„‘é˜”ç–¼~ ç”±äºæš‚æ—¶æ²¡æœ‰è§£å†³é™æ€èµ„æºçš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘æœ¬ç¯‡ä¸æ”¾å›¾ï¼Œæ¥ä¸€åœºæ²¡æœ‰ç¡çƒŸçš„æˆ˜äº‰ã€‚æˆ‘ä¼šå°½é‡è®©æ­¤æ–‡ç« é€šä¿—æ˜“æ‡‚ï¼Œå¾…æˆ‘è§£å†³é—®é¢˜æ—¶ï¼Œå†é‡æ–°ç¼–è¾‘ä¸€ä¸‹ï¼ˆåæ­£è¿™ä¸ªåšå®¢æ²¡äººçœ‹ï¼‰ã€‚ ä»Šå¤©æˆ‘æ¥åˆ†äº«ä¸€ä¸ªè½¯ä»¶ï¼Œåå­—æ˜¯Process Lasso Proã€‚è¿™ä¸ªè½¯ä»¶çš„ä½œç”¨æ˜¯ä¼˜åŒ–è¿›ç¨‹è°ƒåº¦ï¼Œé™ä½é«˜CPUå ç”¨ç‡è¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Œä¿è¯å‰å°è¿›ç¨‹å’Œç³»ç»Ÿæ‹¥æœ‰æœ€é«˜çš„å“åº”é€Ÿåº¦ï¼Œç®€å•è¯´å°±æ˜¯å°½å¯èƒ½ä¿è¯ç”µè„‘åœ¨é«˜CPUå ç”¨ç‡çš„æƒ…å†µä¸å¡ã€‚æ³¨æ„ï¼Œè½¯ä»¶å¦‚æœæ˜¯å®¶ç”¨å°±æ˜¯å…è´¹çš„ï¼Œä¸“ä¸šç‰ˆæœ‰é«˜çº§åŠŸèƒ½ï¼Œä¸è¿‡åŸºæœ¬ç”¨ä¸åˆ°ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ ä¸»è¦ç‰¹æ€§å…ˆæ¥çœ‹çœ‹å®˜æ–¹å‘çš„äº§å“ç‰¹æ€§ã€‚ ProBalanceï¼šå®‰å…¨æœ‰æ•ˆåœ°å¹³è¡¡è¿›ç¨‹ä¼˜å…ˆçº§ï¼Œä»è€Œä½¿ç”µè„‘åœ¨é«˜è´Ÿè·çš„æ—¶å€™æé«˜ç³»ç»Ÿçš„å“åº”é€Ÿåº¦å’Œé˜²æ­¢ç³»ç»Ÿå¤±é€Ÿå’Œååº”æ»åã€‚æˆ‘ä»¬çš„æŠ€æœ¯å¹¶ä¸åšé¢å¤–çš„å‰å°æ¨è¿›è€Œæ˜¯é€‚å½“é™ä½äº†åå°è¿›ç¨‹ä¼˜å…ˆçº§ã€‚æˆ‘ä»¬å¤šå¹´çš„ç»éªŒä½¿æˆ‘ä»¬çš„ç®—æ³•é«˜åº¦ä¼˜åŒ–ã€ç‹¬ä¸€æ— äºŒã€‚ æŒä¹…çš„ä¼˜å…ˆçº§å’Œäº²å’ŒåŠ›ï¼šä¸ºæ‚¨çš„è¿›ç¨‹è®¾ç½®â€œé»˜è®¤â€çš„ä¼˜å…ˆçº§å’ŒCPUäº²å’ŒåŠ›ï¼Œè®©æ‚¨å¯ä»¥è°ƒæ•´å®ƒä»¬çš„æ‰§è¡Œæ–¹å¼ã€‚ è‡ªåŠ¨ç»ˆæ­¢ï¼šå¯¹äºæ‚¨æ‰€é€‰æ‹©çš„ç‰¹å®šè¿›ç¨‹ï¼Œå®ƒä¸€æ—¦è¿è¡Œï¼ŒProcess Lassoå°†è‡ªåŠ¨ç»ˆæ­¢å®ƒã€‚ è¿›ç¨‹çœ‹å®ˆï¼šå½“è¾¾åˆ°æŒ‡å®šçš„é˜ˆå€¼çš„æ—¶å€™ï¼Œå°†ç»ˆæ­¢ã€é‡æ–°å¯åŠ¨æˆ–æ›´æ”¹CPUäº²å’ŒåŠ›ã€‚ å®ä¾‹æ•°é‡é™åˆ¶ï¼šå°†è¿›ç¨‹å®ä¾‹æ•°é‡é™åˆ¶åœ¨æŒ‡å®šçš„èŒƒå›´å†…ã€‚ å¤šæ ¸ä¼˜åŒ–ï¼šé€šè¿‡é¢„è®¾çš„CPUäº²å’ŒåŠ›å’ŒProBalanceäº²å’ŒåŠ›çš„è°ƒæ•´ï¼Œå¯ä»¥ä¼˜åŒ–å¤šæ ¸å¤„ç†å™¨ï¼Œæé«˜CPUè¿è¡Œæ•ˆç‡ã€‚å®ƒè¿˜é¿å…ä½¿ç”¨é€»è¾‘æ ¸å¿ƒï¼Œä»è€Œåœ¨è¶…çº¿ç¨‹CPUä¸‹æé«˜æé«˜æŸäº›åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚ I/Oä¼˜å…ˆçº§ï¼šWindows VistaåŠWindows 7ä¸‹å¯ä»¥è®¾ç½®è¿›ç¨‹çš„å½“å‰çš„/é»˜è®¤çš„/æŒç»­çš„I / Oä¼˜å…ˆçº§ ç”µæºæ¨¡å¼è‡ªåŠ¨åŒ–ï¼šè®¾ç½®ç”µæºæ¨¡å¼ï¼Œå½“æŸäº›è¿›ç¨‹æ­£åœ¨è¿è¡Œæ—¶è‡ªåŠ¨æ›´æ”¹ä¸ºâ€œé«˜æ€§èƒ½â€ï¼Œå½“è¿›ç¨‹é€€å‡ºåå†æ¢åˆ°åŸå…ˆçš„æ¨¡å¼ï¼ˆè¾ƒæ–°ç‰ˆæœ¬åŠŸèƒ½æ›´å¼ºå¤§ï¼Œå¯ä»¥æ›´æ”¹åˆ°ä»»ä½•ç”µæºæ¨¡å¼ï¼‰ã€‚ èŠ‚çº¦ç”µèƒ½ï¼šæˆ–å½“éœ€è¦æ—¶æé«˜æ€§èƒ½ï¼ ç³»ç»Ÿå“åº”æ ‡ï¼šæˆ‘ä»¬å°†ä»¥ç‹¬ç‰¹çš„ç®—æ³•ï¼Œä»¥æƒŠäººçš„å‡†ç¡®ç‡ç›‘æµ‹ç³»ç»Ÿå“åº” ç‹¬ç«‹çš„æ ¸å¿ƒå¼•æ“ï¼šè¿™ä¸ªç‹¬ç«‹çš„åå°è¿›ç¨‹å¯ä»¥ä¸€ä¸ªæ™®é€šçš„è¿‡ç¨‹æˆ–æœåŠ¡å½¢å¼è¿è¡Œã€‚è¿™ä¸ªâ€œæ ¸å¿ƒå¼•æ“â€è¢«å‘½å ProcessGovernor.exeï¼Œå®ƒå®é™…ä¸Šå¯ä»¥å¼ºåˆ¶æ‰§è¡Œè¿›ç¨‹è§„åˆ™å’ŒProBalanceã€‚å®ƒæ ¹æœ¬ä¸éœ€è¦GUIï¼ˆä¸»çª—å£ï¼‰çš„å­˜åœ¨ã€‚è¿™å¯ä»¥å®ç°æœ€å°çš„èµ„æºåˆ©ç”¨ç‡ã€‚ æœ€å°çš„èµ„æºåˆ©ç”¨ï¼šåœ¨å®ç°æœ€å°çš„èµ„æºåˆ©ç”¨æ–¹é¢ï¼Œæ²¡æœ‰ä»»ä½•ä¸€ä¸ªç¨‹åºå¯ä»¥ä¸Process Lassoç›¸æ¯”ã€‚å®ƒæ˜¯ç”¨åŸç”Ÿçš„C + +ç¼–å†™çš„ï¼Œå¹¶ä¸æ–­æ”¹è¿›ä»¥è·å¾—æœ€å¤§çš„æ•ˆç‡ã€‚æˆ‘ä»¬ä¹Ÿæä¾›åŸç”Ÿçš„64ä½ç‰ˆæœ¬ã€‚æœ¬ç¨‹åºçš„å†…å­˜ä½¿ç”¨é‡é€šå¸¸åœ¨1MBä»¥ä¸‹ï¼ï¼ˆä¾ç³»ç»Ÿè€Œå®šï¼‰ å®‰è£…é¦–å…ˆï¼Œé€‰æ‹©X64å®‰è£…åŒ…ï¼Œä¸€è·¯nextåˆ°åº•ã€‚ GUIä½¿ç”¨å®‰è£…å®Œæ¯•ï¼Œåœ¨ä¸»ç•Œé¢ä¸Šï¼Œå¯ä»¥çœ‹åˆ°å½“å‰æ‰€æœ‰çš„æ´»åŠ¨è¿›ç¨‹ï¼Œè¿™ä¸ªå’Œç³»ç»Ÿçš„èµ„æºç®¡ç†å™¨å¾ˆç›¸ä¼¼ã€‚Process Lassoåœ¨é»˜è®¤è®¾ç½®ä¸‹å·²ç»å¯ä»¥ç”Ÿæ•ˆï¼Œå®ƒä¼šç›‘è§†åå°è¿›ç¨‹ï¼Œå¦‚æœæŸä¸ªè¿›ç¨‹è¶…è¿‡äº†CPUå ç”¨ç‡çš„é˜ˆå€¼ï¼Œå°±ä¼šå¯¹ä»–è¿›è¡Œé™åˆ¶ï¼Œé™ä½CPUå¯¹è¿™ä¸ªè¿›ç¨‹çš„å“åº”ä¼˜å…ˆçº§ï¼Œè®©CPUç€åŠ›äºå‰å°è¿›ç¨‹ï¼ˆå¦‚æ¸¸æˆç­‰ï¼‰ã€‚ å³å‡»è¾ƒä¸ºå CPUä½¿ç”¨æ—¶é—´çš„æ¸¸æˆã€è§†é¢‘ç­‰çš„è¿›ç¨‹ï¼Œå‹¾é€‰â€œå½’ç±»ä¸ºæ¸¸æˆæˆ–å¤šåª’ä½“è¿›ç¨‹â€ ã€‚è¿™æ—¶ï¼ŒProcess Lassoä¼šæ’é™¤å¯¹è¿™ä¸ªè¿›ç¨‹çš„â€œæŠ‘åˆ¶â€ï¼Œå¹¶åœ¨è¿è¡Œè¿™ä¸ªè¿›ç¨‹æ—¶è°ƒèŠ‚ç”µæºæ–¹æ¡ˆä¸ºâ€œé«˜æ€§èƒ½â€ï¼Œå……åˆ†è°ƒåŠ¨CPUèµ„æºã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œé‡ç‚¹å°±æ˜¯ä¼˜åŒ–å¤šæ ¸å¿ƒCPUçš„åˆ©ç”¨ç‡äº†ï¼Œè¿˜æ˜¯å³é”®å•å‡»è¦ä¼˜åŒ–æ‰§è¡Œçš„è¿›ç¨‹ï¼Œé€‰ä¸­â€œCPUäº²å’ŒåŠ›ï¼ˆé™åˆ¶CPUä½¿ç”¨ï¼‰â€“&gt;æ€»æ˜¯â€“&gt;é€‰æ‹©CPUäº²å’ŒåŠ›â€ï¼ŒæŒ‰ç…§è‡ªå·±çš„éœ€æ±‚å‹¾é€‰éœ€è¦ä½¿ç”¨çš„CPUæ ¸å¿ƒ(ä¸€èˆ¬æ¥è¯´ï¼ŒCPU 0æ€§èƒ½æœ€å¼ºï¼ŒCPU 1æ€§èƒ½ç¬¬äºŒå¼ºâ€¦â€¦.CPU næ€§èƒ½æœ€å¼±)ï¼Œè¿™æ ·è¿™ä¸ªè¿›ç¨‹å…³é—­åå†è¿è¡Œä¹Ÿæ˜¯æŒ‰ç…§è¿™ä¸ªè®¾ç½®è°ƒç”¨CPUèµ„æºã€‚ æ³¨æ„äº‹é¡¹ ä¸æ¨èå¯¹Process Lassoè‡ªèº«/å®‰å…¨è½¯ä»¶/æ€æ¯’è½¯ä»¶/ç³»ç»Ÿå…³é”®æœåŠ¡è¿›ç¨‹ç­‰è¿›è¡Œç»“æŸè¿›ç¨‹ã€é™ä½å†…å­˜æˆ–I/Oä¼˜å…ˆçº§è‡³éå¸¸ä½ã€ç¡¬èŠ‚æµç­‰æ“ä½œï¼Œä¸”éƒ¨åˆ†æ€æ¯’ã€å®‰å…¨è½¯ä»¶æœ‰è‡ªæˆ‘ä¿æŠ¤åŠŸèƒ½ï¼Œç»“æŸè¿›ç¨‹ã€CPUä¼˜å…ˆçº§ã€I/Oä¼˜å…ˆçº§ ç½®å¯èƒ½ä¼šå¤±æ•ˆ èœå•-&gt;é€‰é¡¹-&gt;æ—¥å¿—è®¾ç½®-&gt;å‹¾é€‰â€œé€€å‡ºæ—¶æ¸…é™¤æ—¥å¿—â€â€œä¿æŒæ—¥å¿—ä¿®å‰ªâ€å¯ä»¥æœ‰æ•ˆé™ä½æ—¥å¿—æ•°é‡ å»ºè®®ä¿æŒProcess Lassoå¼€æœºå¯åŠ¨(åŒ…æ‹¬æœåŠ¡)ï¼Œéƒ¨åˆ†å¼€æœºåŠ é€Ÿä¼˜åŒ–è½¯ä»¶ä¼šç¦æ­¢Process Lassoå¯åŠ¨ï¼Œè¿™å°†å¯¼è‡´Process Lassoæ— æ³•å®æ—¶ä¼˜åŒ–ç³»ç»Ÿ Process Lassoåœ¨ç•Œé¢è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œç”±äºæœ‰å¤§é‡ä¿¡æ¯éœ€è¦è·å–å¹¶å®æ—¶æ˜¾ç¤ºï¼Œå¯èƒ½ä¼šçœ‹åˆ°Process Lassoå›¾å½¢ç•Œé¢æˆ–æ ¸å¿ƒå¼•æ“è¿›ç¨‹CPUä½¿ç”¨ç‡è¾¾åˆ°15%~40%ï¼Œè¿™å±äºæ­£å¸¸ç°è±¡ã€‚éšè—æˆ–å…³é—­æ­¤ç•Œé¢åProcess Lassoçš„èµ„æºå ç”¨ç‡å°†ä¼šå˜å¾—éå¸¸å°ï¼Œä¸ä¼šæ‹–æ…¢ç”µè„‘é€Ÿåº¦ã€‚ æ€»ç»“å…ˆå–Šä¸€å¥å£å·ï¼ŒProcess Lassoç‰›é€¼ï¼ ä¸è¿‡ç»™å¤§å®¶ä¸¾ä¾‹çš„ä¸è¿‡æ˜¯å®ƒçš„çš®æ¯›è€Œå·²ï¼Œæ›´å¤šä¼˜åŒ–è®¾ç½®å¯ä»¥é€šè¿‡è‡ªå·±çš„å°è¯•è°ƒæ•´è·å¾—ï¼Œå¸Œæœ›å¤§å®¶å¯ä»¥å¤šå¤šç ”ç©¶ï¼Œå‘ç°æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ç©æ³•å¯ä»¥ç§èŠæˆ‘ã€‚ å¯¹äº†ï¼Œè¿™ä¸ªè½¯ä»¶æœ‰æ”¶è´¹Proç‰ˆå’Œå…è´¹ç‰ˆï¼Œæ”¶è´¹ç‰ˆæœ‰å¾ˆå¤šæ–°åŠŸèƒ½ï¼Œæ¯”å¦‚å¼ºåˆ¶æ€§å¯¹è¿›ç¨‹çš„CPUå ç”¨ç‡è¿›è¡ŒåŠ¨æ€è°ƒæ•´ï¼Œèƒ½å¤Ÿæ˜æ˜¾æå‡éƒ¨åˆ†åº”ç”¨çš„æ‰§è¡Œæ•ˆç‡ã€‚åŸåˆ™ä¸Šæˆ‘ä¸æ¨èä»»ä½•ç”¨æˆ·ä½¿ç”¨ç›—ç‰ˆè½¯ä»¶çš„ã€‚]]></content>
      <tags>
        <tag>æ—¥å¸¸</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Windows10</tag>
        <tag>è½¯ä»¶æ•™å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é‚£äº›å¹´æ•°ç»„çš„æ’åº]]></title>
    <url>%2F2018%2F07%2F24%2F%E9%82%A3%E4%BA%9B%E5%B9%B4%E6%95%B0%E7%BB%84%E7%9A%84%E6%8E%92%E5%BA%8F%2F</url>
    <content type="text"><![CDATA[ä»Šå¤©æ¥å›é¡¾ä¸€ä¸‹ç®€å•çš„æ’åºæ€æƒ³ï¼Œç•™ä½œä»Šåçš„å¤ä¹ å’Œå¤‡ä»½ç”¨ã€‚æœ¬ç¯‡æ˜¯éå¸¸éå¸¸åŸºç¡€çš„ï¼Œç”šè‡³éƒ½ä¸ä¼šè®²å®é™…é¡¹ç›®çœŸæ­£èƒ½ç”¨çš„æ’åºæ–¹æ³•ï¼Œè­¬å¦‚åŒè½´å¿«é€Ÿæ’åº ã€‚å†™çš„ä¸å¥½è¯·å¤šå¤šè°…è§£ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ å‡†å¤‡é˜¶æ®µç›¸å…³åŠŸèƒ½å‡½æ•°ä¸ºäº†ä¿æŒä»£ç çš„æ•´æ´ï¼Œå…ˆåˆ›é€ å¥½å¯¹æ•°å™¨å’Œç›¸å…³åŠŸèƒ½æ€§å‡½æ•°ã€‚ äº¤æ¢å™¨ä¸¤ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ æ¯”è¾ƒæ’åºè¿‡ç¨‹ä¸­ï¼Œä¸€å®šä¼šæœ‰å…ƒç´ çš„äº¤æ¢æ“ä½œã€‚ä¸ºäº†ä¿æŒä»£ç çš„æ•´æ´ï¼Œå…ˆå†™å‡ºäº¤æ¢æ“ä½œçš„å‡½æ•°ã€‚ 12345public static void swap(int[] arr, int i, int j) &#123; arr[i] = arr[i] ^ arr[j]; arr[j] = arr[i] ^ arr[j]; arr[i] = arr[i] ^ arr[j]; &#125; éšæœºæ ·æœ¬äº§ç”Ÿå™¨è‡ªå·±ç¼–æ•°ç»„å¤ªéº»çƒ¦äº†ï¼Œè®©ä»–è‡ªå·±ç”Ÿäº§å§ 1234567public static int[] generateRandomArray(int maxSize, int maxValue) &#123; int[] arr = new int[(int) ((maxSize + 1) * Math.random())]; for (int i = 0; i &lt; arr.length; i++) &#123; arr[i] = (int) ((maxValue + 1) * Math.random()) - (int) (maxValue * Math.random()); &#125; return arr; &#125; å¯¹æ•°å™¨å¯¹æ•°å™¨å…¶å®å°±æ˜¯ä¸€ä¸ªç»å¯¹æ­£ç¡®ä½†æ˜¯å¤æ‚åº¦ä¸å¥½çš„æ–¹æ³•ã€‚ 123public static void comparator(int[] arr) &#123; Arrays.sort(arr); &#125; è¯´è¯´Arrays.sort()çš„é€»è¾‘å§ã€‚æ•°ç»„è¿›å…¥æ–¹æ³•ï¼Œå…ˆåˆ¤æ–­ã€‚å¦‚æœæ•°ç»„çš„é•¿åº¦å°äºQUICKSORT_THRESHOLDï¼ˆé»˜è®¤å€¼æ˜¯286ï¼‰çš„è¯ï¼Œå†åˆ¤æ–­ï¼Œå¦‚æœæ•°ç»„é•¿åº¦å°äºINSERTION_SORT_THRESHOLD(å€¼ä¸º47)çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šç”¨æ’å…¥æ’åº ï¼Œå¦åˆ™å°±ä¼šä½¿ç”¨åŒè½´å¿«é€Ÿæ’åºã€‚ å¦‚æœå¤§äº286å‘¢ï¼Œå®ƒå°±ä¼šåšæŒæ•°ç»„çš„è¿ç»­å‡åºå’Œè¿ç»­é™åºæ€§å¥½ä¸å¥½ï¼Œå¦‚æœå¥½çš„è¯å°±ç”¨å½’å¹¶æ’åºï¼Œä¸å¥½çš„è¯å°±ç”¨å¿«é€Ÿæ’åºã€‚ æ¯”è¾ƒå™¨æ¯”è¾ƒä¸¤ä¸ªæ•°ç»„ä¸€ä¸ä¸€æ ·~ 1234567891011121314151617public static boolean isEqual(int[] arr1, int[] arr2) &#123; if ((arr1 == null &amp;&amp; arr2 != null) || (arr1 != null &amp;&amp; arr2 == null)) &#123; return false; &#125; if (arr1 == null &amp;&amp; arr2 == null) &#123; return true; &#125; if (arr1.length != arr2.length) &#123; return false; &#125; for (int i = 0; i &lt; arr1.length; i++) &#123; if (arr1[i] != arr2[i]) &#123; return false; &#125; &#125; return true; &#125; æ‰“å°å™¨123456789public static void printArray(int[] arr) &#123; if (arr == null) &#123; return; &#125; for (int i = 0; i &lt; arr.length; i++) &#123; System.out.print(arr[i] + " "); &#125; System.out.println();&#125; å¤åˆ¶å™¨12345678910public static int[] copyArray(int[] arr) &#123; if (arr == null) &#123; return null; &#125; int[] res = new int[arr.length]; for (int i = 0; i &lt; arr.length; i++) &#123; res[i] = arr[i]; &#125; return res; &#125; ä¸»å‡½æ•°12345678910111213141516171819202122public static void main(String[] args) &#123; int testTime = 500000; int maxSize = 100; int maxValue = 100; boolean succeed = true; for (int i = 0; i &lt; testTime; i++) &#123; int[] arr1 = generateRandomArray(maxSize, maxValue); int[] arr2 = copyArray(arr1); bubbleSort(arr1); comparator(arr2); if (!isEqual(arr1, arr2)) &#123; succeed = false; break; &#125; &#125; System.out.println(succeed ? "ç‰›é€¼ï¼Œç®—æ³•å¯¹äº†!" : "âŒ!"); int[] arr = generateRandomArray(maxSize, maxValue); printArray(arr); bubbleSort(arr);//æµ‹è¯•çš„ç®—æ³• printArray(arr);&#125; è„‘å­è„‘é˜”ç–¼ æ­£ç¯‡åŸºäºæ¯”è¾ƒçš„æ’åºå†’æ³¡æ’åºåŸç†å†’æ³¡æ’åºç®—æ³•çš„åŸç†å¦‚ä¸‹ï¼š æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢ä»–ä»¬ä¸¤ä¸ªã€‚æ­¤æ—¶è¿™ä¸¤ä¸ªæ•°ï¼Œæ°¸è¿œæ˜¯åé¢çš„æ•°å¤§ã€‚ ç¬¬ä¸€å›åˆå°†æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ åšåŒæ ·çš„å·¥ä½œã€‚å›åˆç»“æŸåï¼Œæœ€åçš„å…ƒç´ æ˜¯æ•´ä¸ªæ•°ç»„æœ€å¤§çš„æ•°ã€‚ ç¬¬äºŒå›åˆâ€¦ç¬¬nå›åˆè¿‡ç¨‹ä¸­ï¼Œå¯¹é™¤äº†æœ€åä¸€ä¸ªå…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ã€‚ å®ç°123456789101112public static void bubbleSort(int[] arr) &#123; if (arr == null || arr.length &lt; 2) &#123; return; &#125; for (int end = arr.length - 1; end &gt; 0; end--) &#123;//endæœ€åçš„æ•° for (int i = 0; i &lt; e; i++) &#123; if (arr[i] &gt; arr[i + 1]) &#123; swap(arr, i, i + 1);//äº¤æ¢ &#125; &#125; &#125; &#125; å¤æ‚åº¦æ—¶é—´å¤æ‚åº¦ï¼šO(NÂ²) é¢å¤–ç©ºé—´å¤æ‚åº¦ï¼šO(1) é€‰æ‹©æ’åºåŸç†1.ç¬¬ä¸€å›åˆï¼Œå°†æŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå°†ç¬¬ä¸€ä¸ªå…ƒç´ å’Œå‰©ä½™çš„å…ƒç´ æ¯”è¾ƒï¼Œæœ€å°çš„å…ƒç´ æ”¾åˆ°ä¸€å·ä½ç½®ã€‚ 2.ç¬¬äºŒå›åˆâ€¦ç¬¬nå›åˆè¿‡ç¨‹ä¸­ï¼ŒæŒ‡é’ˆåŠ ä¸€ã€‚å¯¹é™¤äº†ç¬¬ä¸€ä¸ªå…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ã€‚ å®ç°123456789101112public static void selectionSort(int[] arr) &#123; if (arr == null || arr.length &lt; 2) &#123; return; &#125; for (int i = 0; i &lt; arr.length - 1; i++) &#123; int minIndex = i; for (int j = i + 1; j &lt; arr.length; j++) &#123; minIndex = arr[j] &lt; arr[minIndex] ? j : minIndex; &#125; swap(arr, i, minIndex); &#125;&#125; å¤æ‚åº¦æ—¶é—´å¤æ‚åº¦ï¼šO(NÂ²) é¢å¤–ç©ºé—´å¤æ‚åº¦ï¼šO(1) æ’å…¥æ’åºçš„åŸç†1.ç¬¬ä¸€å›åˆï¼Œæ¯”è¾ƒç¬¬ä¸€ä¸ªå…ƒç´ å’Œç¬¬äºŒä¸ªå…ƒç´ å¤§å°ï¼Œå¤§çš„æ”¾åœ¨ç¬¬äºŒä¸ªä½ç½®ä¸Š 2.ç¬¬äºŒå›åˆï¼Œå°†ç¬¬ä¸‰ä¸ªå…ƒç´ ä¸ç¬¬äºŒã€ç¬¬ä¸€ä¸ªå…ƒç´ æ¯”è¾ƒï¼Œå¤§çš„æ”¾åœ¨ç¬¬ä¸‰ä¸ªä½ç½®ä¸Š 3.è½®å› å®ç°12345678910public static void insertionSort(int[] arr) &#123; if (arr == null || arr.length &lt; 2) &#123; return; &#125; for (int i = 1; i &lt; arr.length; i++) &#123; for (int j = i - 1; j &gt;= 0 &amp;&amp; arr[j] &gt; arr[j + 1]; j--) &#123; swap(arr, j, j + 1); &#125; &#125;&#125; å¤æ‚åº¦æ—¶é—´å¤æ‚åº¦ï¼šO(NÂ²) é¢å¤–ç©ºé—´å¤æ‚åº¦ï¼šO(1) å †æ’åºå †å…¶å®å°±æ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œçœ‹å †è¦é¦–å…ˆçŸ¥é“å¤§é¡¶å †ã€å°é¡¶å †ã€‚ æ¯ä¸ªç»“ç‚¹çš„å€¼éƒ½å¤§äºæˆ–ç­‰äºå…¶å·¦å³å­©å­ç»“ç‚¹çš„å€¼ï¼Œç§°ä¸ºå¤§é¡¶å †ï¼›æˆ–è€…æ¯ä¸ªç»“ç‚¹çš„å€¼éƒ½å°äºæˆ–ç­‰äºå…¶å·¦å³å­©å­ç»“ç‚¹çš„å€¼ï¼Œç§°ä¸ºå°é¡¶å †ã€‚ å¤§é¡¶å †ï¼šarr[i] &gt;= arr[2i+1] &amp;&amp; arr[i] &gt;= arr[2i+2] å°é¡¶å †ï¼šarr[i] &lt;= arr[2i+1] &amp;&amp; arr[i] &lt;= arr[2i+2] åŸç†å°†å¾…æ’åºåºåˆ—æ„é€ æˆä¸€ä¸ªå¤§é¡¶å †ï¼ˆå‡åºé‡‡ç”¨å¤§é¡¶å †ï¼Œé™åºé‡‡ç”¨å°é¡¶å †ï¼‰ï¼Œæ­¤æ—¶ï¼Œæ•´ä¸ªåºåˆ—çš„æœ€å¤§å€¼å°±æ˜¯å †é¡¶çš„æ ¹èŠ‚ç‚¹ã€‚å°†å…¶ä¸æœ«å°¾å…ƒç´ è¿›è¡Œäº¤æ¢ï¼Œæ­¤æ—¶æœ«å°¾å°±ä¸ºæœ€å¤§å€¼ã€‚ç„¶åå°†å‰©ä½™n-1ä¸ªå…ƒç´ é‡æ–°æ„é€ æˆä¸€ä¸ªå †ï¼Œè¿™æ ·ä¼šå¾—åˆ°nä¸ªå…ƒç´ çš„æ¬¡å°å€¼ã€‚å¦‚æ­¤åå¤æ‰§è¡Œï¼Œä¾¿èƒ½å¾—åˆ°ä¸€ä¸ªæœ‰åºåºåˆ—äº† ä»£ç 123456789101112131415161718192021222324252627282930313233343536public static void heapSort(int[] arr) &#123; if (arr == null || arr.length &lt; 2) &#123; return; &#125; //0-iä¹‹é—´ç”Ÿæˆå¤§æ ¹å †è¿™ç§ç»“æ„ for (int i = 0; i &lt; arr.length; i++) &#123; heapInsert(arr, i); &#125; int size = arr.length;//å®šä¹‰æ•°ç»„å¤§å°ï¼Œå¯ä»¥åˆ¤æ–­æ˜¯å¦è¶Šç•Œ swap(arr, 0, --size); while (size &gt; 0) &#123; heapify(arr, 0, size); swap(arr, 0, --size); &#125; &#125; //ç”Ÿæˆå¤§æ ¹å †è¿™ç§ç»“æ„ public static void heapInsert(int[] arr, int index) &#123; while (arr[index] &gt; arr[(index - 1) / 2]) &#123;//å¦‚æœæˆ‘è¿™ä¸ªèŠ‚ç‚¹æ¯”çˆ¶èŠ‚ç‚¹å¤§ swap(arr, index, (index - 1) / 2);//äº¤æ¢ index = (index - 1) / 2;//å›åˆ°çˆ¶ä½ç½®ç»§ç»­ &#125; &#125; //å°†æ•°å€¼å°çš„å…ƒç´ å¾€ä¸‹æ²‰ public static void heapify(int[] arr, int index, int size) &#123; int left = index * 2 + 1; while (left &lt; size) &#123;//å·¦å­©å­åœ¨å †ä¸Šï¼Œæ²¡è¶Šç•Œ int largest = left + 1 &lt; size &amp;&amp; arr[left + 1] &gt; arr[left] ? left + 1 : left;//æ‰¾å‡ºå·¦å³å­©å­ä¸­æœ€å¤§çš„æ•° largest = arr[largest] &gt; arr[index] ? largest : index;//å’Œçˆ¶æ¯”è¾ƒ if (largest == index) &#123; break; &#125; swap(arr, largest, index); index = largest;//å›åˆ°è¾ƒå¤§èŠ‚ç‚¹ left = index * 2 + 1; &#125; &#125; å¤æ‚åº¦å¦‚æœåªæ˜¯å»ºç«‹å †çš„è¿‡ç¨‹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(N) æ—¶é—´å¤æ‚åº¦O(N*logN) é¢å¤–ç©ºé—´å¤æ‚åº¦O(1) å¿«é€Ÿæ’åºå¿«é€Ÿæ’åºä¸æ˜¯ä¸€ç§ç¨³å®šçš„æ’åºç®—æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¤šä¸ªç›¸åŒçš„å€¼çš„ç›¸å¯¹ä½ç½®ä¹Ÿè®¸ä¼šåœ¨ç®—æ³•ç»“æŸæ—¶äº§ç”Ÿå˜åŠ¨ã€‚ å‡å®šåœ¨å¾…æ’åºçš„è®°å½•åºåˆ—ä¸­ï¼Œå­˜åœ¨å¤šä¸ªå…·æœ‰ç›¸åŒçš„å…³é”®å­—çš„è®°å½•ï¼Œè‹¥ç»è¿‡æ’åºï¼Œè¿™äº›è®°å½•çš„ç›¸å¯¹æ¬¡åºä¿æŒä¸å˜ï¼Œå³åœ¨åŸåºåˆ—ä¸­ï¼Œr[i]=r[j]ï¼Œä¸”r[i]åœ¨r[j]ä¹‹å‰ï¼Œè€Œåœ¨æ’åºåçš„åºåˆ—ä¸­ï¼Œr[i]ä»åœ¨r[j]ä¹‹å‰ï¼Œåˆ™ç§°è¿™ç§æ’åºç®—æ³•æ˜¯ç¨³å®šçš„ï¼›å¦åˆ™ç§°ä¸ºä¸ç¨³å®šçš„ã€‚ åŸç†æˆ‘å…ˆè¯´è¯´ç»å…¸å¿«æ’çš„æ€è·¯å§ã€‚ å°†æ•°ç»„åˆ†æˆä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯å°äºç­‰äºæŸä¸ªæ•°çš„ï¼Œä¸€éƒ¨åˆ†æ˜¯å¤§äºç­‰äºæŸä¸ªæ•°çš„ã€‚è¿™ä¸¤éƒ¨åˆ†åˆå§‹æŒ‡é’ˆåœ¨æ•°ç»„çš„å·¦(L)å³(R)ä¸¤å¤´ï¼Œæ­¤æ—¶Lå’ŒRåˆ†åˆ«æ˜¯ä¸€ä¸ªè¾¹ç•Œç‚¹ã€‚ 1.å…ˆå®šä¹‰lessåŒºåŸŸå’ŒmoreåŒºåŸŸï¼Œä»£è¡¨æ¯”æ•°ç»„ä¸­æŸä¸€ä¸ªæ•°æ›´å°æ›´å¤§çš„åŒºåŸŸã€‚åˆå§‹lessåŒºåŸŸæ˜¯L-1ä»¥å·¦çš„éƒ¨åˆ†ï¼ŒmoreåŒºåŸŸæ˜¯Rä»¥å³çš„åŒºåŸŸ 2.ç¬¬ä¸€å›åˆï¼Œä»æ•°ç»„å·¦è¾¹å¼€å§‹ã€‚è‹¥LæŒ‡é’ˆæŒ‡çš„èŠ‚ç‚¹å€¼å°äºæŸä¸ªæ•°å€¼ï¼ŒlessåŒºåŸŸå‘å³ç§»åŠ¨ä¸€ä¸ªä½ç½® swap(arr,++less,L++);ï¼ŒLèŠ‚ç‚¹ä½ç½®+1å‡†å¤‡ä¸‹ä¸€ä¸ªå›åˆï¼›è‹¥å®ƒå¤§äºè¿™ä¸ªæ•°å€¼ï¼ŒmoreåŒºåŸŸå‘å·¦æ‰©å¼ ä¸€æ ¼ï¼Œç„¶åå°†è¿™ä¸ªèŠ‚ç‚¹æ”¾åˆ°moreåŒºåŸŸswap(arr,--more,L++);ï¼ŒLèŠ‚ç‚¹ä½ç½®+1å‡†å¤‡ä¸‹ä¸€ä¸ªå›åˆï¼›è‹¥ä»–ç­‰äºè¿™ä¸ªæ•°å€¼ï¼Œä»€ä¹ˆä¹Ÿä¸ç®¡ï¼Œåªæ˜¯LèŠ‚ç‚¹ä½ç½®+1å‡†å¤‡ä¸‹ä¸€ä¸ªå›åˆã€‚ 3.é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œå¾—åˆ°äº†ä¸€ä¸ªæ•°ç»„ï¼Œä»–çš„LæŒ‡é’ˆå³è¾¹æ—¶å°äºæŸä¸ªæ•°çš„ï¼ŒRçš„å³è¾¹æ—¶å¤§äºæŸä¸ªæ•°çš„ã€‚[L,R]è¿™ä¸ªåŒºé—´æ˜¯ç­‰äºæŸä¸ªæ•°çš„ã€‚ 4.è¿”å›è¿™ä¸ªéƒ½æ˜¯ç›¸åŒæ•°çš„æ•°ç»„çš„å·¦è¾¹ç•Œã€å³è¾¹ç•Œ 5.ä¸æ–­é€’å½’ ç»å…¸å¿«æ’æœ‰ä¸€ä¸ªå¼Šç«¯ã€‚å·¦éƒ¨åˆ†å’Œå³éƒ¨åˆ†çš„è§„æ¨¡ä¸ä¸€æ ·æˆ–è€…æœ‰ä¸€ä¸ªéƒ¨åˆ†è§„æ¨¡ç‰¹åˆ«å¤§ï¼Œç®—æ³•æ•ˆç‡ä¼šå˜å·®ã€‚ä¸¾ä¸ªæ —å­ï¼Œå¦‚æœæˆ‘æœ‰ä¸ªæ•°ç»„[1,1,3,4,7,6,1,2,1,5,1,7]ï¼Œæˆ‘æŒ‡å®šçš„æŸä¸ªæ•°å­—æ˜¯7ï¼Œé‚£ä¹ˆé‚£ä¹ˆæ’åºåå°±å˜æˆäº†[1ï¼Œ1ï¼Œ1ï¼Œ1ï¼Œ1,2,3,4,5,6,7],ç»å…¸å¿«æ’ç»“æŸååªæå®šäº†ä¸€ä¸ªä¸€ä¸ªåŒºé—´ï¼ˆ&lt;7çš„åŒºé—´ï¼‰ï¼Œå¤æ‚åº¦å°±ä»ç†æƒ³çŠ¶æ€ä¸‹çš„Oï¼ˆNï¼‰å˜æˆäº†Oï¼ˆNÂ²ï¼‰ ç„¶åå°±æœ‰äº†æ”¹è¿›åçš„éšæœºå¿«æ’ã€‚ éšæœºå¿«æ’æ¯”ç»å…¸å¿«æ’å¤šäº†ä¸€ä¸ªé€‰éšæœºæ•°çš„è¿‡ç¨‹ swap(arr, L + (int) (Math.random() * (R - L + 1)), R);ã€‚å°±æ˜¯éšæœºç”ŸæˆæŸä¸ªæ•°ï¼Œè¿™æ ·ç”Ÿæˆçš„åŒºé—´è™½ç„¶ä¹Ÿä¼šå‡ºç°ä¸Šè¿°ç»å…¸å¿«æ’çš„æ¶åŠ£æƒ…å†µï¼Œä½†æ˜¯æ­¤æ—¶çš„å¤æ‚åº¦å°±ä»åŸæ¥çš„æ¶åŠ£äº‹ä»¶å˜æˆäº†æœ‰æ¦‚ç‡æ¶åŠ£äº‹ä»¶ï¼Œä½†æ€»ä½“æœŸæœ›æ˜¯å¥½çš„ã€‚è¿™å°±å˜æˆäº†ä¸€ä¸ªæ¦‚ç‡é—®é¢˜ã€‚ ä»£ç ä»¥ä¸‹ä¸ºéšæœºå¿«æ’ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364public static void main(String[] args) &#123; int[] nums = &#123;9,10,45,36,98,1,3,5,8,6,4&#125;; quickSort(nums); for (int num : nums) &#123; System.out.print(num+","); &#125;&#125;/** * å¿«é€Ÿæ’åºï¼Œä½¿å¾—æ•´æ•°æ•°ç»„ arr æœ‰åº */public static void quickSort(int[] arr) &#123; if (arr == null || arr.length &lt; 2) &#123; return; &#125; quickSort(arr, 0, arr.length - 1);&#125;/** * å¿«é€Ÿæ’åºï¼Œä½¿å¾—æ•´æ•°æ•°ç»„ arr çš„ [L, R] éƒ¨åˆ†æœ‰åº */public static void quickSort(int[] arr, int L, int R) &#123; if(L &lt; R) &#123; // æŠŠæ•°ç»„ä¸­éšæœºçš„ä¸€ä¸ªå…ƒç´ ä¸æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼Œè¿™æ ·ä»¥æœ€åä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†å€¼å®é™…ä¸Šå°±æ˜¯ä»¥æ•°ç»„ä¸­éšæœºçš„ä¸€ä¸ªå…ƒç´ ä½œä¸ºåŸºå‡†å€¼ swap(arr, new Random().nextInt(R - L + 1) + L, R); int[] p = partition(arr, L, R); quickSort(arr, L, p[0] - 1); quickSort(arr, p[1] + 1, R); &#125;&#125;/** * åˆ†åŒºçš„è¿‡ç¨‹ï¼Œæ•´æ•°æ•°ç»„ arr çš„[L, R]éƒ¨åˆ†ä¸Šï¼Œä½¿å¾—ï¼š * å¤§äº arr[R] çš„å…ƒç´ ä½äº[L, R]éƒ¨åˆ†çš„å³è¾¹ï¼Œä½†è¿™éƒ¨åˆ†æ•°æ®ä¸ä¸€å®šæœ‰åº * å°äº arr[R] çš„å…ƒç´ ä½äº[L, R]éƒ¨åˆ†çš„å·¦è¾¹ï¼Œä½†è¿™éƒ¨åˆ†æ•°æ®ä¸ä¸€å®šæœ‰åº * ç­‰äº arr[R] çš„å…ƒç´ ä½äº[L, R]éƒ¨åˆ†çš„ä¸­é—´ * è¿”å›ç­‰äºéƒ¨åˆ†çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡å’Œæœ€åä¸€ä¸ªä¸‹æ ‡ç»„æˆçš„æ•´æ•°æ•°ç»„ */public static int[] partition(int[] arr, int L, int R) &#123; int basic = arr[R]; int less = L - 1; int more = R + 1; while(L &lt; more) &#123; if(arr[L] &lt; basic) &#123; swap(arr, ++less, L++); &#125; else if (arr[L] &gt; basic) &#123; swap(arr, --more, L); &#125; else &#123; L++; &#125; &#125; return new int[] &#123; less + 1, more - 1 &#125;;&#125;/* * äº¤æ¢æ•°ç»„ arr ä¸­ä¸‹æ ‡ä¸º i å’Œä¸‹æ ‡ä¸º j ä½ç½®çš„å…ƒç´  */public static void swap(int[] arr, int i, int j) &#123; int temp = arr[i]; arr[i] = arr[j]; arr[j] = temp;&#125; å¤æ‚åº¦ç§‘å­¦å®¶æ•°å­¦è¯æ˜ï¼Œé•¿æœŸæœŸæœ›çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(logN*N) å¿«é€Ÿæ’åºå¯ä»¥åšåˆ°ç¨³å®šæ€§é—®é¢˜ï¼Œéå¸¸éš¾ï¼Œè¦çŸ¥é“çš„å¯ä»¥è°·æ­Œâ€œ01 stable sortâ€ ï¼Œåæ­£æˆ‘ä¸ä¼šã€‚ å½’å¹¶æ’åºåŸç†1.å’Œä¸Šé¢˜ä¸€æ ·ï¼Œå…ˆå®šä¹‰å·¦è¾¹ç•ŒLå³è¾¹ç•ŒRæ•°ç»„ä¸­ï¼Œç„¶åå®šä¹‰ä¸€ä¸ªä¸­é—´å€¼mid = (r-l)/2 2.é€’å½’ï¼Œåœ¨è¾¹ç•Œå†…éƒ¨ä¸æ–­çš„æ‰¾ä¸­é—´å€¼mid å®ç°1234567891011121314151617//å½’å¹¶æ’åºpublic static void mergeSort(int[] arr)&#123; if (arr==null || arr.length &lt;2)&#123; return; &#125; mergeSort(arr,0,arr.length-1);&#125;private static void mergeSort(int[] arr, int l, int r) &#123; if (l == r)&#123; return; &#125; int mid = l + ((r - l) &gt;&gt; 1); //(r-l)/2 mergeSort(arr,l,mid); mergeSort(arr,mid+1,r); merge(arr, l, mid, r);&#125; å¤æ‚åº¦æ—¶é—´å¤æ‚åº¦O(N*logN) é¢å¤–ç©ºé—´å¤æ‚åº¦O(N)ï¼Œå½’å¹¶æ’åºçš„é¢å¤–ç©ºé—´å¤æ‚åº¦å¯ä»¥å˜æˆO(1)ï¼Œä½†æ˜¯éå¸¸éš¾ï¼Œæˆ‘æ²¡èŠ±æ—¶é—´ç ”ç©¶ï¼Œè¦çŸ¥é“çš„å¯ä»¥è°·æ­Œâ€œå½’å¹¶æ’åº å†…éƒ¨ç¼“å­˜æ³•â€ è¿™é‡Œçš„æ—¶é—´å¤æ‚åº¦æ€ä¹ˆç®—å‡ºæ¥çš„å‘¢ï¼Ÿæœ‰ä¸€ä¸ªmasterå®šç†ï¼š T(N) = a*T(N/b) + O(N^d) å…¶ä¸­ a &gt;= 1 and b &gt; 1 æ˜¯å¸¸é‡ï¼Œå…¶è¡¨ç¤ºçš„æ„ä¹‰æ˜¯nè¡¨ç¤ºé—®é¢˜çš„è§„æ¨¡ï¼Œaè¡¨ç¤ºé€’å½’çš„æ¬¡æ•°ä¹Ÿå°±æ˜¯ç”Ÿæˆçš„å­é—®é¢˜æ•°ï¼Œbè¡¨ç¤ºæ¯æ¬¡é€’å½’æ˜¯åŸæ¥çš„1/bä¹‹ä¸€ä¸ªè§„æ¨¡ã€‚ å¦‚ä¸‹ï¼š 1) log(b,a) &gt; d -&gt; å¤æ‚åº¦ä¸ºO(N^log(b,a)) 2) log(b,a) = d -&gt; å¤æ‚åº¦ä¸ºO(N^d * logN) 3) log(b,a) &lt; d -&gt; å¤æ‚åº¦ä¸ºO(N^d) è¿™é‡Œï¼Œå½’å¹¶æ’åºä¸­b=2ï¼Œa=2. éåŸºäºæ¯”è¾ƒçš„æ’åºéåŸºäºæ¯”è¾ƒçš„æ’åºï¼Œä¸è¢«æ’åºçš„æ ·æœ¬çš„å®é™…æ•°æ®çŠ¶å†µå¾ˆæœ‰å…³ç³»ï¼Œæ‰€ä»¥å®é™…ä¸­å¹¶ä¸ç»å¸¸ä½¿ç”¨ æ¡¶æ’åºåŸç†1.æ‰¾åˆ°ä¸€ä¸ªæ•°ç»„ä¸­æœ€å¤§æ•°çš„å€¼ 2.å®šä¹‰ï¼ˆæœ€å¤§æ•°+1ï¼‰ä¸ªæ¡¶ 3.å°†æ•°ç»„çš„æ•°æ”¾åˆ°å¯¹åº”ç¼–å·ç›¸åŒçš„æ¡¶ä¸­ï¼Œæ¯æ”¾è¿›ä¸€ä¸ªæ•°ï¼Œæ¡¶é‡Œé¢çš„æ•°å€¼åŠ ä¸€ 4.ä¾æ¬¡ä»å°è¾“å‡ºè¿™ä¸ªæ¡¶ï¼Œæ¡¶é‡Œçš„å…ƒç´ å‡ºç°å‡ æ¬¡å°±è¾“å‡ºå‡ ä¸ªæ¡¶çš„ç¼–å· ä»£ç 1234567891011121314151617181920// only for 0~200 value public static void bucketSort(int[] arr) &#123; if (arr == null || arr.length &lt; 2) &#123; return; &#125; int max = Integer.MIN_VALUE; for (int i = 0; i &lt; arr.length; i++) &#123; max = Math.max(max, arr[i]); &#125; int[] bucket = new int[max + 1]; for (int i = 0; i &lt; arr.length; i++) &#123; bucket[arr[i]]++; &#125; int i = 0; for (int j = 0; j &lt; bucket.length; j++) &#123; while (bucket[j]-- &gt; 0) &#123; arr[i++] = j; &#125; &#125; &#125; å¤æ‚åº¦æ—¶é—´å¤æ‚åº¦O(N) é¢å¤–ç©ºé—´å¤æ‚åº¦O(N) ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹~]]></content>
      <tags>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>æ•°æ®ç»“æ„ä¸ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…³äºTreeMapçš„ä¸ªäººç†è§£]]></title>
    <url>%2F2018%2F07%2F23%2FTreeMap%2F</url>
    <content type="text"><![CDATA[ç¾¤é‡Œçš„å¤§å“¥è¯´äº†ï¼Œè¦æƒ³æ‡‚çº¢é»‘æ ‘çš„åº”ç”¨ï¼Œå…ˆè¦çœ‹TreeMapã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®https://blog.tengshe789.tech/ OKï¼Œç°åœ¨å¼€å§‹ï¼š çº¢é»‘æ ‘ç®€ä»‹çº¢é»‘æ ‘åˆç§°çº¢-é»‘äºŒå‰æ ‘ï¼Œå®ƒé¦–å…ˆæ˜¯ä¸€é¢—äºŒå‰æ ‘ï¼Œå®ƒå…·ä½“äºŒå‰æ ‘æ‰€æœ‰çš„ç‰¹æ€§ã€‚åŒæ—¶çº¢é»‘æ ‘æ›´æ˜¯ä¸€é¢—è‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘ã€‚ â€‹ ä¸€èˆ¬çš„äºŒå‰æ ‘ä»–ä»¬éƒ½éœ€è¦æ»¡è¶³ä¸€ä¸ªåŸºæœ¬æ€§è´¨â€“å³æ ‘ä¸­çš„ä»»ä½•èŠ‚ç‚¹çš„å€¼å¤§äºå®ƒçš„å·¦å­èŠ‚ç‚¹ï¼Œä¸”å°äºå®ƒçš„å³å­èŠ‚ç‚¹ã€‚å› ä¸ºæŒ‰ç…§è¿™ä¸ªåŸºæœ¬æ€§è´¨ä½¿å¾—æ ‘çš„æ£€ç´¢æ•ˆç‡å¤§å¤§æé«˜ã€‚ä½†æˆ‘ä»¬çŸ¥é“åœ¨ç”ŸæˆäºŒå‰æ ‘çš„è¿‡ç¨‹æ˜¯éå¸¸å®¹æ˜“å¤±è¡¡çš„ï¼Œæœ€åçš„æƒ…å†µå°±æ˜¯ä¸€è¾¹å€’ï¼ˆåªæœ‰å³/å·¦å­æ ‘ï¼‰ï¼Œè¿™æ ·åŠ¿å¿…ä¼šå¯¼è‡´äºŒå‰æ ‘çš„æ£€ç´¢æ•ˆç‡å¤§å¤§é™ä½ï¼ˆO(n)ï¼‰ï¼Œæ‰€ä»¥ä¸ºäº†ç»´æŒäºŒå‰æ ‘çš„å¹³è¡¡ï¼Œå¤§ç‰›ä»¬æå‡ºäº†å„ç§å®ç°çš„ç®—æ³•ï¼Œå¦‚ï¼šAVLï¼ŒSBTï¼Œä¼¸å±•æ ‘ï¼ŒTREAP ï¼Œçº¢é»‘æ ‘ç­‰ç­‰ã€‚ â€‹ å¹³è¡¡äºŒå‰æ ‘å¿…é¡»å…·å¤‡å¦‚ä¸‹ç‰¹æ€§ï¼šå®ƒæ˜¯ä¸€æ£µç©ºæ ‘æˆ–å®ƒçš„å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡1ï¼Œå¹¶ä¸”å·¦å³ä¸¤ä¸ªå­æ ‘éƒ½æ˜¯ä¸€æ£µå¹³è¡¡äºŒå‰æ ‘ã€‚ä¹Ÿå°±æ˜¯è¯´è¯¥äºŒå‰æ ‘çš„ä»»ä½•ä¸€ä¸ªç­‰ç­‰å­èŠ‚ç‚¹ï¼Œå…¶å·¦å³å­æ ‘çš„é«˜åº¦éƒ½ç›¸è¿‘ã€‚ çº¢é»‘æ ‘é¡¾åæ€ä¹‰å°±æ˜¯èŠ‚ç‚¹æ˜¯çº¢è‰²æˆ–è€…é»‘è‰²çš„å¹³è¡¡äºŒå‰æ ‘ï¼Œå®ƒé€šè¿‡é¢œè‰²çš„çº¦æŸæ¥ç»´æŒç€äºŒå‰æ ‘çš„å¹³è¡¡ã€‚å¯¹äºä¸€æ£µæœ‰æ•ˆçš„çº¢é»‘æ ‘äºŒå‰æ ‘è€Œè¨€æˆ‘ä»¬å¿…é¡»å¢åŠ å¦‚ä¸‹è§„åˆ™ï¼š â€‹ 1ã€æ¯ä¸ªèŠ‚ç‚¹éƒ½åªèƒ½æ˜¯çº¢è‰²æˆ–è€…é»‘è‰² â€‹ 2ã€æ ¹èŠ‚ç‚¹æ˜¯é»‘è‰² â€‹ 3ã€æ¯ä¸ªå¶èŠ‚ç‚¹ï¼ˆNILèŠ‚ç‚¹ï¼Œç©ºèŠ‚ç‚¹ï¼‰æ˜¯é»‘è‰²çš„ã€‚ â€‹ 4ã€å¦‚æœä¸€ä¸ªç»“ç‚¹æ˜¯çº¢çš„ï¼Œåˆ™å®ƒä¸¤ä¸ªå­èŠ‚ç‚¹éƒ½æ˜¯é»‘çš„ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€æ¡è·¯å¾„ä¸Šä¸èƒ½å‡ºç°ç›¸é‚»çš„ä¸¤ä¸ªçº¢è‰²ç»“ç‚¹ã€‚ â€‹ 5ã€ä»ä»»ä¸€èŠ‚ç‚¹åˆ°å…¶æ¯ä¸ªå¶å­çš„æ‰€æœ‰è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²èŠ‚ç‚¹ã€‚ â€‹ è¿™äº›çº¦æŸå¼ºåˆ¶äº†çº¢é»‘æ ‘çš„å…³é”®æ€§è´¨: ä»æ ¹åˆ°å¶å­çš„æœ€é•¿çš„å¯èƒ½è·¯å¾„ä¸å¤šäºæœ€çŸ­çš„å¯èƒ½è·¯å¾„çš„ä¸¤å€é•¿ã€‚ç»“æœæ˜¯è¿™æ£µæ ‘å¤§è‡´ä¸Šæ˜¯å¹³è¡¡çš„ã€‚å› ä¸ºæ“ä½œæ¯”å¦‚æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾æŸä¸ªå€¼çš„æœ€åæƒ…å†µæ—¶é—´éƒ½è¦æ±‚ä¸æ ‘çš„é«˜åº¦æˆæ¯”ä¾‹ï¼Œè¿™ä¸ªåœ¨é«˜åº¦ä¸Šçš„ç†è®ºä¸Šé™å…è®¸çº¢é»‘æ ‘åœ¨æœ€åæƒ…å†µä¸‹éƒ½æ˜¯é«˜æ•ˆçš„ï¼Œè€Œä¸åŒäºæ™®é€šçš„äºŒå‰æŸ¥æ‰¾æ ‘ã€‚æ‰€ä»¥çº¢é»‘æ ‘å®ƒæ˜¯å¤æ‚è€Œé«˜æ•ˆçš„ï¼Œå…¶æ£€ç´¢æ•ˆç‡O(log n)ã€‚ä¸‹å›¾ä¸ºä¸€é¢—å…¸å‹çš„çº¢é»‘äºŒå‰æ ‘ã€‚ å…³äºTreeMapæˆ‘æ²¡çœ‹æ‡‚å•Šå•Šå•Šå•Šï¼Œæˆ‘çœ‹æ‡‚äº†åœ¨æ›´æ–°(ç«‹FLAGğŸš©)]]></content>
      <tags>
        <tag>æºç </tag>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[A æ­»é” ã® ç‰©è¯­(Ë‰â–½Ë‰ï¼›)...]]></title>
    <url>%2F2018%2F07%2F23%2FA-%E6%AD%BB%E9%94%81%2F</url>
    <content type="text"><![CDATA[1234567891011121314151617181920212223242526272829303132333435363738394041/** * @author tengshe789 */public class DeadLock &#123; public static String obj1 = "obj1"; public static String obj2 = "obj2"; public static void main(String[] args)&#123; new Thread(()-&gt;&#123; try&#123; System.out.println("Lock1 running"); while(true)&#123; synchronized(DeadLock.obj1)&#123; System.out.println("Lock1 lock obj1"); Thread.sleep(3000);//è·å–obj1åå…ˆç­‰ä¸€ä¼šå„¿ï¼Œè®©Lock2æœ‰è¶³å¤Ÿçš„æ—¶é—´é”ä½obj2 synchronized(DeadLock.obj2)&#123; System.out.println("Lock1 lock obj2"); &#125; &#125; &#125; &#125;catch(Exception e)&#123; e.printStackTrace(); &#125; &#125;).start();//first thread with lambda new Thread(()-&gt;&#123; try&#123; System.out.println("Lock2 running"); while(true)&#123; synchronized(DeadLock.obj2)&#123; System.out.println("Lock2 lock obj2"); Thread.sleep(3000); synchronized(DeadLock.obj1)&#123; System.out.println("Lock2 lock obj1"); &#125; &#125; &#125; &#125;catch(Exception e)&#123; e.printStackTrace(); &#125; &#125;).start();//second thread &#125;&#125; ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹~]]></content>
      <tags>
        <tag>æ—¥å¸¸</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…³äºLinkedHashmapçš„ä¸ªäººç†è§£]]></title>
    <url>%2F2018%2F07%2F18%2F%E5%85%B3%E4%BA%8ELinkedHashmap%E7%9A%84%E4%B8%AA%E4%BA%BA%E7%90%86%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåªè¦ä¸æ¶‰åŠçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼ŒMapåŸºæœ¬éƒ½å¯ä»¥ä½¿ç”¨HashMapï¼Œä¸è¿‡HashMapæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯è¿­ä»£HashMapçš„é¡ºåºå¹¶ä¸æ˜¯HashMapæ”¾ç½®çš„é¡ºåºã€‚HashMapçš„è¿™ä¸€ç¼ºç‚¹å¾€å¾€ä¼šå¸¦æ¥å›°æ‰°ï¼Œå› ä¸ºæœ‰äº›åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæœ‰åºçš„Mapã€‚LinkedHashMapå°±å¯ä»¥åšåˆ°ï¼Œå®ƒè™½ç„¶å¢åŠ äº†æ—¶é—´å’Œç©ºé—´ä¸Šçš„å¼€é”€ï¼Œä½†æ˜¯é€šè¿‡ç»´æŠ¤ä¸€ä¸ªè¿è¡Œäºæ‰€æœ‰æ¡ç›®çš„åŒå‘é“¾è¡¨ï¼ŒLinkedHashMapä¿è¯äº†å…ƒç´ è¿­ä»£çš„é¡ºåºã€‚æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®https://blog.tengshe789.tech/ æ•°æ®ç»“æ„æ‰“å¼€æºç å¯ä»¥çœ‹åˆ°ï¼š 123456789/** * HashMap.Node subclass for normal LinkedHashMap entries. */ static class Entry&lt;K,V&gt; extends HashMap.Node&lt;K,V&gt; &#123; Entry&lt;K,V&gt; before, after; Entry(int hash, K key, V value, Node&lt;K,V&gt; next) &#123; super(hash, key, value, next); &#125; &#125; LinkedHashMapç»§æ‰¿äº†HashMapçš„Entryï¼Œå¹¶æ–°å¢åŠ äº†ä¸¤ä¸ªæŒ‡é’ˆ å‚ç…§ä¸€ä¸‹ç½‘ç»œä¸Šæœåˆ®çš„å›¾ç‰‡ï¼Œå¯ä»¥çœ‹å‡ºæ•°æ®ç»“æ„ä¸ºæ•°ç»„ + å•é“¾è¡¨ + çº¢é»‘æ ‘ + åŒé“¾è¡¨ï¼Œæ¯”HashMapå¤šäº†ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œå°±æ˜¯åˆ©ç”¨äº†å¤´èŠ‚ç‚¹å’Œå…¶ä½™çš„å„ä¸ªèŠ‚ç‚¹ä¹‹é—´é€šè¿‡ Entry ä¸­çš„ after å’Œ before æŒ‡é’ˆè¿›è¡Œå…³è”ã€‚ æ„é€ æ–¹æ³•çœ‹ä¸€ä¸‹æ„é€ æ–¹æ³•ã€‚ 12345678910111213141516171819202122public LinkedHashMap(int initialCapacity, float loadFactor) &#123; super(initialCapacity, loadFactor); accessOrder = false; &#125; public LinkedHashMap(int initialCapacity) &#123; super(initialCapacity); accessOrder = false; &#125; public LinkedHashMap() &#123; super(); accessOrder = false; &#125; public LinkedHashMap(Map&lt;? extends K, ? extends V&gt; m) &#123; super(); accessOrder = false; putMapEntries(m, false); &#125; æœ‰å››ä¸ªæ„é€ æ–¹æ³•ï¼Œæ¯ä¸€ä¸ªçš„æ„é€ æ–¹æ³•ç¬¬ä¸€å¥è¯åŸºæœ¬éƒ½æ˜¯è°ƒç”¨çˆ¶ç±»HashMapæ–¹æ³•ã€‚ä¼°è®¡æ˜¯ç”¨å¤šæ€æ¥å®ç°çš„ç›¸å…³åŠŸèƒ½ã€‚æ¯” HashMap å¤šäº†ä¸€ä¸ª accessOrder çš„å‚æ•°ï¼Œç”¨æ¥æŒ‡å®šæŒ‰ç…§ LRU æ’åˆ—æ–¹å¼è¿˜æ˜¯é¡ºåºæ’å…¥çš„æ’åºæ–¹å¼ æ·»åŠ çœ‹ LinkedHashMap çš„ put() æ–¹æ³•ä¹‹å‰å…ˆçœ‹çœ‹ HashMap çš„ putVal æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) &#123; Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); else &#123; Node&lt;K,V&gt; e; K k; if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; else if (p instanceof TreeNode) e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); else &#123; for (int binCount = 0; ; ++binCount) &#123; if ((e = p.next) == null) &#123; p.next = newNode(hash, key, value, null); if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; &#125; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; p = e; &#125; &#125; if (e != null) &#123; // existing mapping for key V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; /* =============================æ•²é»‘æ¿========================================== */ afterNodeAccess(e); return oldValue; &#125; &#125; ++modCount; if (++size &gt; threshold) resize(); afterNodeInsertion(evict); return null; &#125; å…¶å®è¿™ç¯‡å·²ç»æ˜¯æˆ‘æ—©æœ‰å‡†å¤‡çš„ï¼Œç¬¬ä¸€æ¬¡çœ‹æºç çš„æ—¶å€™å·²ç»æƒŠäº†ã€‚LinkedHashMap è‡ªå·±æ²¡æœ‰é‡å†™putæ–¹æ³•ï¼Œå…¨æ˜¯ç…§ç€ä»–çˆ¹æ¬è¿‡æ¥çš„ï¼Œæ— èµ– å•Šã€‚ä»£ç ä¸­æ•²é»‘æ¿ä½ç½®ï¼Œæ˜¯LinkedHashMap é‡å†™äº† afterNodeAccess() è¿™ä¸ªæ–¹æ³•ã€‚ 12345678910111213141516171819202122232425262728//å°†æœ€è¿‘ä½¿ç”¨çš„Node eï¼Œæ”¾åœ¨é“¾è¡¨çš„æœ€æœ«å°¾void afterNodeAccess(Node&lt;K,V&gt; e) &#123; // move node to last LinkedHashMap.Entry&lt;K,V&gt; last; //ä»…å½“æŒ‰ç…§LRUåŸåˆ™ä¸”eä¸åœ¨æœ€æœ«å°¾ï¼Œæ‰æ‰§è¡Œä¿®æ”¹é“¾è¡¨ï¼Œå°†eç§»åˆ°é“¾è¡¨æœ€æœ«å°¾çš„æ“ä½œ //accessOrderä¸ºtrueåˆ™è¡¨ç¤ºæŒ‰ç…§åŸºäºè®¿é—®çš„é¡ºåºæ¥æ’åˆ— if (accessOrder &amp;&amp; (last = tail) != e) &#123; //å°†eèµ‹å€¼ä¸´æ—¶èŠ‚ç‚¹pï¼Œ bæ˜¯eçš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œ aæ˜¯eçš„åä¸€ä¸ªèŠ‚ç‚¹ LinkedHashMap.Entry&lt;K,V&gt; p = (LinkedHashMap.Entry&lt;K,V&gt;)e, b = p.before, a = p.after; //èŠ‚ç‚¹ç§»åŠ¨è¿‡ç¨‹ p.after = null; if (b == null) head = a; else b.after = a; if (a != null) a.before = b; else last = b; if (last == null) head = p; else &#123; p.before = last; last.after = p; &#125; tail = p; ++modCount; &#125; ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼ŒjuejinåŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹~]]></content>
      <tags>
        <tag>æºç </tag>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…³äºConcurrentHashMap1.8çš„ä¸ªäººç†è§£]]></title>
    <url>%2F2018%2F07%2F17%2FConcurrentHashMap1-8%2F</url>
    <content type="text"><![CDATA[ConcurrenHashMap ã€‚ä¸‹é¢åˆ†äº«ä¸€ä¸‹æˆ‘å¯¹ConcurrentHashMap çš„ç†è§£ï¼Œä¸»è¦ç”¨äºä¸ªäººå¤‡å¿˜ã€‚å¦‚æœæœ‰ä¸å¯¹ï¼Œè¯·æ‰¹è¯„ã€‚ HashMapâ€œä¸¥é‡â€çš„å‹¾èµ·äº†æˆ‘å¯¹HashMapå®¶æ—çš„å¥½å¥‡å¿ƒï¼Œä¸‹é¢åˆ†äº«ä¸€ä¸‹æˆ‘å¯¹ConcurrentHashMap çš„ç†è§£ï¼Œä¸»è¦ç”¨äºä¸ªäººå¤‡å¿˜ã€‚å¦‚æœæœ‰ä¸å¯¹ï¼Œè¯·æ‰¹è¯„ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®https://blog.tengshe789.tech/ æ€»èµ·HashMapæ˜¯æˆ‘ä»¬å¹³æ—¶å¼€å‘è¿‡ç¨‹ä¸­ç”¨çš„æ¯”è¾ƒå¤šçš„é›†åˆï¼Œä½†å®ƒæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œåœ¨æ¶‰åŠåˆ°å¤šçº¿ç¨‹å¹¶å‘çš„æƒ…å†µï¼Œè¿›è¡Œgetæ“ä½œæœ‰å¯èƒ½ä¼šå¼•èµ·æ­»å¾ªç¯ï¼Œå¯¼è‡´CPUåˆ©ç”¨ç‡æ¥è¿‘100%ã€‚ å› æ­¤éœ€è¦æ”¯æŒçº¿ç¨‹å®‰å…¨çš„å¹¶å‘å®¹å™¨ ConcurrentHashMap ã€‚ æ•°æ®ç»“æ„ é‡è¦æˆå‘˜å˜é‡12345/** * The array of bins. Lazily initialized upon first insertion. * Size is always a power of two. Accessed directly by iterators. */ transient volatile Node&lt;K,V&gt;[] table; tableä»£è¡¨æ•´ä¸ªå“ˆå¸Œè¡¨ã€‚ é»˜è®¤ä¸ºnullï¼Œåˆå§‹åŒ–å‘ç”Ÿåœ¨ç¬¬ä¸€æ¬¡æ’å…¥æ“ä½œï¼Œé»˜è®¤å¤§å°ä¸º16çš„æ•°ç»„ï¼Œç”¨æ¥å­˜å‚¨NodeèŠ‚ç‚¹æ•°æ®ï¼Œæ‰©å®¹æ—¶å¤§å°æ€»æ˜¯2çš„å¹‚æ¬¡æ–¹ã€‚ 1234/** * The next table to use; non-null only while resizing. */ private transient volatile Node&lt;K,V&gt;[] nextTable; nextTableæ˜¯ä¸€ä¸ªè¿æ¥è¡¨ï¼Œç”¨äºå“ˆå¸Œè¡¨æ‰©å®¹ï¼Œé»˜è®¤ä¸ºnullï¼Œæ‰©å®¹æ—¶æ–°ç”Ÿæˆçš„æ•°ç»„ï¼Œå…¶å¤§å°ä¸ºåŸæ•°ç»„çš„ä¸¤å€ã€‚ 123456/** * Base counter value, used mainly when there is no contention, * but also as a fallback during table initialization * races. Updated via CAS. */ private transient volatile long baseCount; baseCountä¿å­˜ç€æ•´ä¸ªå“ˆå¸Œè¡¨ä¸­å­˜å‚¨çš„æ‰€æœ‰çš„ç»“ç‚¹çš„ä¸ªæ•°æ€»å’Œï¼Œæœ‰ç‚¹ç±»ä¼¼äº HashMap çš„ size å±æ€§ã€‚ è¿™ä¸ªæ•°é€šè¿‡CASç®—æ³•æ›´æ–° 123456789/** * Table initialization and resizing control. When negative, the * table is being initialized or resized: -1 for initialization, * else -(1 + the number of active resizing threads). Otherwise, * when table is null, holds the initial table size to use upon * creation, or 0 for default. After initialization, holds the * next element count value upon which to resize the table. */ private transient volatile int sizeCtl; åˆå§‹åŒ–å“ˆå¸Œè¡¨å’Œæ‰©å®¹ rehash çš„è¿‡ç¨‹ï¼Œéƒ½éœ€è¦ä¾èµ–sizeCtlã€‚è¯¥å±æ€§æœ‰ä»¥ä¸‹å‡ ç§å–å€¼ï¼š 0ï¼šé»˜è®¤å€¼ -1ï¼šä»£è¡¨å“ˆå¸Œè¡¨æ­£åœ¨è¿›è¡Œåˆå§‹åŒ– å¤§äº0ï¼šç›¸å½“äº HashMap ä¸­çš„ thresholdï¼Œè¡¨ç¤ºé˜ˆå€¼ å°äº-1ï¼šä»£è¡¨æœ‰å¤šä¸ªçº¿ç¨‹æ­£åœ¨è¿›è¡Œæ‰©å®¹ã€‚ï¼ˆè­¬å¦‚ï¼š-N è¡¨ç¤ºæœ‰N-1ä¸ªçº¿ç¨‹æ­£åœ¨è¿›è¡Œæ‰©å®¹æ“ä½œ ï¼‰ æ„é€ æ–¹æ³•1234567891011121314public ConcurrentHashMap() &#123; &#125;public ConcurrentHashMap(int initialCapacity) &#123; if (initialCapacity &lt; 0) throw new IllegalArgumentException(); int cap = ((initialCapacity &gt;= (MAXIMUM_CAPACITY &gt;&gt;&gt; 1)) ? MAXIMUM_CAPACITY : tableSizeFor(initialCapacity + (initialCapacity &gt;&gt;&gt; 1) + 1));//MAXIMUM_CAPACITY = 1 &lt;&lt; 30 this.sizeCtl = cap;//ConcurrentHashMapåœ¨æ„é€ å‡½æ•°ä¸­åªä¼šåˆå§‹åŒ–sizeCtlå€¼ï¼Œå¹¶ä¸ä¼šç›´æ¥åˆå§‹åŒ–tableï¼Œè€Œæ˜¯å»¶ç¼“åˆ°ç¬¬ä¸€æ¬¡putæ“ä½œã€‚ &#125;public ConcurrentHashMap(Map&lt;? extends K, ? extends V&gt; m) &#123; this.sizeCtl = DEFAULT_CAPACITY;//DEFAULT_CAPACITY = 16 putAll(m); &#125; æ„é€ æ–¹æ³•æ˜¯ä¸‰ä¸ªã€‚é‡ç‚¹æ˜¯ç¬¬äºŒä¸ªï¼Œå¸¦å‚çš„æ„é€ æ–¹æ³•ã€‚è¿™ä¸ªå¸¦å‚çš„æ„é€ æ–¹æ³•ä¼šè°ƒç”¨tableSizeFor()æ–¹æ³•ï¼Œç¡®ä¿tableçš„å¤§å°æ€»æ˜¯2çš„å¹‚æ¬¡æ–¹ï¼ˆå‡è®¾å‚æ•°ä¸º100ï¼Œæœ€ç»ˆä¼šè°ƒæ•´æˆ256ï¼‰ã€‚ç®—æ³•å¦‚ä¸‹ï¼š 12345678910111213/** * Returns a power of two table size for the given desired capacity. * See Hackers Delight, sec 3.2 */ private static final int tableSizeFor(int c) &#123; int n = c - 1; n |= n &gt;&gt;&gt; 1; n |= n &gt;&gt;&gt; 2; n |= n &gt;&gt;&gt; 4; n |= n &gt;&gt;&gt; 8; n |= n &gt;&gt;&gt; 16; return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1; &#125; PUT()æ–¹æ³•put()è°ƒç”¨putVal()æ–¹æ³•ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576final V putVal(K key, V value, boolean onlyIfAbsent) &#123; //å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œåˆæ³•æ€§åˆ¤æ–­ if (key == null || value == null) throw new NullPointerException(); int hash = spread(key.hashCode());//è®¡ç®—é”®æ‰€å¯¹åº”çš„ hash å€¼ int binCount = 0; for (Node&lt;K,V&gt;[] tab = table;;) &#123; Node&lt;K,V&gt; f; int n, i, fh; //å¦‚æœå“ˆå¸Œè¡¨è¿˜æœªåˆå§‹åŒ–ï¼Œé‚£ä¹ˆåˆå§‹åŒ–å®ƒ if (tab == null || (n = tab.length) == 0) tab = initTable(); //æ ¹æ®hashå€¼è®¡ç®—å‡ºåœ¨tableé‡Œé¢çš„ä½ç½® else if ((f = tabAt(tab, i = (n - 1) &amp; hash)) == null) &#123; //å¦‚æœè¿™ä¸ªä½ç½®æ²¡æœ‰å€¼ ï¼Œé‚£ä¹ˆä»¥CASæ— é”å¼å‘è¯¥ä½ç½®æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹ if (casTabAt(tab, i, null, new Node&lt;K,V&gt;(hash, key, value, null))) break; // no lock when adding to empty bin &#125; //æ£€æµ‹åˆ°æ¡¶ç»“ç‚¹æ˜¯ ForwardingNode ç±»å‹ï¼ŒååŠ©æ‰©å®¹ï¼ˆMOVED = -1; // hash for forwarding nodesï¼‰ else if ((fh = f.hash) == MOVED) tab = helpTransfer(tab, f); //æ¡¶ç»“ç‚¹æ˜¯æ™®é€šçš„ç»“ç‚¹ï¼Œé”ä½è¯¥æ¡¶å¤´ç»“ç‚¹å¹¶è¯•å›¾åœ¨è¯¥é“¾è¡¨çš„å°¾éƒ¨æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹ else &#123; V oldVal = null; synchronized (f) &#123; if (tabAt(tab, i) == f) &#123; //å‘æ™®é€šçš„é“¾è¡¨ä¸­æ·»åŠ å…ƒç´  if (fh &gt;= 0) &#123; binCount = 1; //éå†é“¾è¡¨æ‰€æœ‰çš„ç»“ç‚¹ for (Node&lt;K,V&gt; e = f;; ++binCount) &#123; K ek; //å¦‚æœhashå€¼å’Œkeyå€¼ç›¸åŒï¼Œåˆ™ä¿®æ”¹å¯¹åº”ç»“ç‚¹çš„valueå€¼ if (e.hash == hash &amp;&amp; ((ek = e.key) == key || (ek != null &amp;&amp; key.equals(ek)))) &#123; oldVal = e.val; if (!onlyIfAbsent) e.val = value; break; &#125; Node&lt;K,V&gt; pred = e; //å¦‚æœéå†åˆ°äº†æœ€åä¸€ä¸ªç»“ç‚¹ï¼Œé‚£ä¹ˆå°±è¯æ˜æ–°çš„èŠ‚ç‚¹éœ€è¦æ’å…¥é“¾è¡¨å°¾éƒ¨ if ((e = e.next) == null) &#123; pred.next = new Node&lt;K,V&gt;(hash, key, value, null); break; &#125; &#125; &#125; //å¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ˜¯æ ‘èŠ‚ç‚¹ï¼Œå°±æŒ‰ç…§æ ‘çš„æ–¹å¼æ’å…¥å€¼ else if (f instanceof TreeBin) &#123; Node&lt;K,V&gt; p; binCount = 2; if ((p = ((TreeBin&lt;K,V&gt;)f).putTreeVal(hash, key, value)) != null) &#123; oldVal = p.val; if (!onlyIfAbsent) p.val = value; &#125; &#125; &#125; &#125; if (binCount != 0) &#123; //å¦‚æœé“¾è¡¨é•¿åº¦å·²ç»è¾¾åˆ°ä¸´ç•Œå€¼8ï¼Œå°±éœ€è¦æŠŠé“¾è¡¨è½¬æ¢ä¸ºæ ‘ç»“æ„ï¼ˆTREEIFY_THRESHOLD = 8ï¼‰ if (binCount &gt;= TREEIFY_THRESHOLD) treeifyBin(tab, i); if (oldVal != null) return oldVal; break; &#125; &#125; &#125; //CAS å¼æ›´æ–°baseCountï¼Œå¹¶åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ addCount(1L, binCount); return null; &#125; å…¶å®putVal()ä¹Ÿå¤šå¤šå°‘å°‘æ‰ç”¨äº†å…¶ä»–æ–¹æ³•ï¼Œè®©æˆ‘ä»¬ç»§ç»­æ¢ç©¶ä¸€ä¸‹ã€‚ CASï¼ˆcompare and swapï¼‰ç§‘æ™®compare and swapï¼Œè§£å†³å¤šçº¿ç¨‹å¹¶è¡Œæƒ…å†µä¸‹ä½¿ç”¨é”é€ æˆæ€§èƒ½æŸè€—çš„ä¸€ç§æœºåˆ¶ï¼ŒCASæ“ä½œåŒ…å«ä¸‰ä¸ªæ“ä½œæ•°â€”â€”å†…å­˜ä½ç½®ï¼ˆVï¼‰ã€é¢„æœŸåŸå€¼ï¼ˆAï¼‰å’Œæ–°å€¼(B)ã€‚å¦‚æœå†…å­˜ä½ç½®çš„å€¼ä¸é¢„æœŸåŸå€¼ç›¸åŒ¹é…ï¼Œé‚£ä¹ˆå¤„ç†å™¨ä¼šè‡ªåŠ¨å°†è¯¥ä½ç½®å€¼æ›´æ–°ä¸ºæ–°å€¼ã€‚å¦åˆ™ï¼Œå¤„ç†å™¨ä¸åšä»»ä½•æ“ä½œã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œå®ƒéƒ½ä¼šåœ¨CASæŒ‡ä»¤ä¹‹å‰è¿”å›è¯¥ä½ç½®çš„å€¼ã€‚CASæœ‰æ•ˆåœ°è¯´æ˜äº†â€œæˆ‘è®¤ä¸ºä½ç½®Våº”è¯¥åŒ…å«å€¼Aï¼›å¦‚æœåŒ…å«è¯¥å€¼ï¼Œåˆ™å°†Bæ”¾åˆ°è¿™ä¸ªä½ç½®ï¼›å¦åˆ™ï¼Œä¸è¦æ›´æ”¹è¯¥ä½ç½®ï¼Œåªå‘Šè¯‰æˆ‘è¿™ä¸ªä½ç½®ç°åœ¨çš„å€¼å³å¯ã€‚ spreadé¦–å…ˆï¼Œç¬¬å››è¡Œå‡ºç°çš„int hash = spread(key.hashCode());è¿™æ˜¯ä¼ ç»Ÿçš„è®¡ç®—hashçš„æ–¹æ³•ã€‚keyçš„hashå€¼é«˜16ä½ä¸å˜ï¼Œä½16ä½ä¸é«˜16ä½å¼‚æˆ–ä½œä¸ºkeyçš„æœ€ç»ˆhashå€¼ã€‚ï¼ˆh &gt;&gt;&gt; 16ï¼Œè¡¨ç¤ºæ— ç¬¦å·å³ç§»16ä½ï¼Œé«˜ä½è¡¥0ï¼Œä»»ä½•æ•°è·Ÿ0å¼‚æˆ–éƒ½æ˜¯å…¶æœ¬èº«ï¼Œå› æ­¤keyçš„hashå€¼é«˜16ä½ä¸å˜ã€‚ï¼‰ 123static final int spread(int h) &#123; return (h ^ (h &gt;&gt;&gt; 16)) &amp; HASH_BITS; &#125; initTableç¬¬åè¡Œï¼Œ tab = initTable();è¿™ä¸ªæ–¹æ³•çš„äº®ç‚¹æ˜¯ï¼Œå¯ä»¥è®©putå¹¶å‘æ‰§è¡Œï¼Œå®ç°tableåªåˆå§‹åŒ–ä¸€æ¬¡ ã€‚ initTable()æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼Œåªå…è®¸ä¸€ä¸ªçº¿ç¨‹å¯¹è¡¨è¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚æœæœ‰å…¶ä»–çº¿ç¨‹è¿›æ¥äº†ï¼Œé‚£ä¹ˆä¼šè®©å…¶ä»–çº¿ç¨‹äº¤å‡º CPU ç­‰å¾…ä¸‹æ¬¡ç³»ç»Ÿè°ƒåº¦ã€‚è¿™æ ·ï¼Œä¿è¯äº†è¡¨åŒæ—¶åªä¼šè¢«ä¸€ä¸ªçº¿ç¨‹åˆå§‹åŒ–ã€‚ 12345678910111213141516171819202122232425262728private final Node&lt;K,V&gt;[] initTable() &#123; Node&lt;K,V&gt;[] tab; int sc; //å¦‚æœè¡¨ä¸ºç©ºæ‰è¿›è¡Œåˆå§‹åŒ–æ“ä½œ while ((tab = table) == null || tab.length == 0) &#123; //å¦‚æœä¸€ä¸ªçº¿ç¨‹å‘ç°sizeCtl&lt;0ï¼Œæ„å‘³ç€å¦å¤–çš„çº¿ç¨‹æ‰§è¡ŒCASæ“ä½œæˆåŠŸï¼Œå½“å‰çº¿ç¨‹åªéœ€è¦è®©å‡ºcpuæ—¶é—´ç‰‡ï¼ˆæ”¾å¼ƒ CPU çš„ä½¿ç”¨ï¼‰ if ((sc = sizeCtl) &lt; 0) Thread.yield(); // lost initialization race; just spin //å¦åˆ™è¯´æ˜è¿˜æœªæœ‰çº¿ç¨‹å¯¹è¡¨è¿›è¡Œåˆå§‹åŒ–ï¼Œé‚£ä¹ˆæœ¬çº¿ç¨‹å°±æ¥åšè¿™ä¸ªå·¥ä½œ else if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) &#123; try &#123; if ((tab = table) == null || tab.length == 0) &#123; //sc å¤§äºé›¶è¯´æ˜å®¹é‡å·²ç»åˆå§‹åŒ–äº†ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤å®¹é‡ int n = (sc &gt; 0) ? sc : DEFAULT_CAPACITY; @SuppressWarnings("unchecked") Node&lt;K,V&gt;[] nt = (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[n]; table = tab = nt; //è®¡ç®—é˜ˆå€¼ï¼Œç­‰æ•ˆäº n*0.75 sc = n - (n &gt;&gt;&gt; 2); &#125; &#125; finally &#123; //è®¾ç½®é˜ˆå€¼ sizeCtl = sc; &#125; break; &#125; &#125; return tab; &#125; æ¥ä¸‹æ¥ï¼Œç¬¬19è¡Œã€‚ tab = helpTransfer(tab, f);è¿™å¥è¯ã€‚è¦äº†è§£è¿™ä¸ªï¼Œé¦–å…ˆéœ€è¦çŸ¥é“ForwardingNode è¿™ä¸ªèŠ‚ç‚¹ç±»å‹ã€‚å®ƒä¸€ä¸ªç”¨äºè¿æ¥ä¸¤ä¸ªtableçš„èŠ‚ç‚¹ç±»ã€‚å®ƒåŒ…å«ä¸€ä¸ªnextTableæŒ‡é’ˆï¼Œç”¨äºæŒ‡å‘ä¸‹ä¸€å¼ hashè¡¨ã€‚è€Œä¸”è¿™ä¸ªèŠ‚ç‚¹çš„keyã€valueã€nextæŒ‡é’ˆå…¨éƒ¨ä¸ºnullï¼Œå®ƒçš„hashå€¼ä¸ºMOVEDï¼ˆstatic final int MOVED = -1ï¼‰ã€‚ 123456789101112131415161718192021222324252627282930313233static final class ForwardingNode&lt;K,V&gt; extends Node&lt;K,V&gt; &#123; final Node&lt;K,V&gt;[] nextTable; ForwardingNode(Node&lt;K,V&gt;[] tab) &#123; super(MOVED, null, null, null); this.nextTable = tab; &#125; //findçš„æ–¹æ³•æ˜¯ä»nextTableé‡Œè¿›è¡ŒæŸ¥è¯¢èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯ä»¥è‡ªèº«ä¸ºå¤´èŠ‚ç‚¹è¿›è¡ŒæŸ¥æ‰¾ Node&lt;K,V&gt; find(int h, Object k) &#123; // loop to avoid arbitrarily deep recursion on forwarding nodes outer: for (Node&lt;K,V&gt;[] tab = nextTable;;) &#123; Node&lt;K,V&gt; e; int n; if (k == null || tab == null || (n = tab.length) == 0 || (e = tabAt(tab, (n - 1) &amp; h)) == null) return null; for (;;) &#123; int eh; K ek; if ((eh = e.hash) == h &amp;&amp; ((ek = e.key) == k || (ek != null &amp;&amp; k.equals(ek)))) return e; if (eh &lt; 0) &#123; if (e instanceof ForwardingNode) &#123; tab = ((ForwardingNode&lt;K,V&gt;)e).nextTable; continue outer; &#125; else return e.find(h, k); &#125; if ((e = e.next) == null) return null; &#125; &#125; &#125; &#125; helpTransferåœ¨æ‰©å®¹æ“ä½œä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªæ¡¶ä¸­çš„ç»“ç‚¹è¿›è¡Œåˆ†ç¦»å’Œè½¬ç§»ã€‚å¦‚æœæŸä¸ªæ¡¶ç»“ç‚¹ä¸­æ‰€æœ‰èŠ‚ç‚¹éƒ½å·²ç»è¿ç§»å®Œæˆäº†ï¼ˆå·²ç»è¢«è½¬ç§»åˆ°æ–°è¡¨ nextTable ä¸­äº†ï¼‰ï¼Œé‚£ä¹ˆä¼šåœ¨åŸ table è¡¨çš„è¯¥ä½ç½®æŒ‚ä¸Šä¸€ä¸ª ForwardingNode ç»“ç‚¹ï¼Œè¯´æ˜æ­¤æ¡¶å·²ç»å®Œæˆè¿ç§»ã€‚ helpTransferä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿæ˜¯æ£€æµ‹åˆ°å½“å‰å“ˆå¸Œè¡¨æ­£åœ¨æ‰©å®¹ï¼Œç„¶åè®©å½“å‰çº¿ç¨‹å»ååŠ©æ‰©å®¹ ï¼ 123456789101112131415161718192021final Node&lt;K,V&gt;[] helpTransfer(Node&lt;K,V&gt;[] tab, Node&lt;K,V&gt; f) &#123; Node&lt;K,V&gt;[] nextTab; int sc; if (tab != null &amp;&amp; (f instanceof ForwardingNode) &amp;&amp; (nextTab = ((ForwardingNode&lt;K,V&gt;)f).nextTable) != null) &#123;//æ–°çš„tableï¼ŒnextTabå·²ç»å­˜åœ¨å‰æä¸‹æ‰èƒ½å¸®åŠ©æ‰©å®¹ int rs = resizeStamp(tab.length);//è¿”å›ä¸€ä¸ª 16 ä½é•¿åº¦çš„æ‰©å®¹æ ¡éªŒæ ‡è¯† while (nextTab == nextTable &amp;&amp; table == tab &amp;&amp; (sc = sizeCtl) &lt; 0) &#123;//sizeCtl å¦‚æœå¤„äºæ‰©å®¹çŠ¶æ€çš„è¯ if ((sc &gt;&gt;&gt; RESIZE_STAMP_SHIFT) != rs || sc == rs + 1 || sc == rs + MAX_RESIZERS || transferIndex &lt;= 0) //å‰ 16 ä½æ˜¯æ•°æ®æ ¡éªŒæ ‡è¯†ï¼Œå 16 ä½æ˜¯å½“å‰æ­£åœ¨æ‰©å®¹çš„çº¿ç¨‹æ€»æ•° //è¿™é‡Œåˆ¤æ–­æ ¡éªŒæ ‡è¯†æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœæ ¡éªŒç¬¦ä¸ç­‰æˆ–è€…æ‰©å®¹æ“ä½œå·²ç»å®Œæˆäº†ï¼Œç›´æ¥é€€å‡ºå¾ªç¯ï¼Œä¸ç”¨ååŠ©å®ƒä»¬æ‰©å®¹äº† break; if (U.compareAndSwapInt(this, SIZECTL, sc, sc + 1)) &#123;//sc + 1 æ ‡è¯†å¢åŠ äº†ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œæ‰©å®¹ transfer(tab, nextTab);//è°ƒç”¨æ‰©å®¹æ–¹æ³• break; &#125; &#125; return nextTab; &#125; return table; &#125; helpTransferç²¾é«“çš„æ˜¯å¯ä»¥è°ƒç”¨å¤šä¸ªå·¥ä½œçº¿ç¨‹ä¸€èµ·å¸®åŠ©è¿›è¡Œæ‰©å®¹ï¼Œè¿™æ ·çš„æ•ˆç‡å°±ä¼šæ›´é«˜ï¼Œè€Œä¸æ˜¯åªæœ‰æ£€æŸ¥åˆ°è¦æ‰©å®¹çš„é‚£ä¸ªçº¿ç¨‹è¿›è¡Œæ‰©å®¹æ“ä½œï¼Œå…¶ä»–çº¿ç¨‹å°±è¦ç­‰å¾…æ‰©å®¹æ“ä½œå®Œæˆæ‰èƒ½å·¥ä½œã€‚ transferæ—¢ç„¶è¿™é‡Œæ¶‰åŠåˆ°æ‰©å®¹çš„æ“ä½œï¼Œæˆ‘ä»¬ä¹Ÿä¸€èµ·æ¥çœ‹çœ‹æ‰©å®¹æ–¹æ³•transferï¼ˆï¼‰ ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147private final void transfer(Node&lt;K,V&gt;[] tab, Node&lt;K,V&gt;[] nextTab) &#123; int n = tab.length, stride; //è®¡ç®—å•ä¸ªçº¿ç¨‹å…è®¸å¤„ç†çš„æœ€å°‘tableæ¡¶é¦–èŠ‚ç‚¹ä¸ªæ•°ï¼Œä¸èƒ½å°äº 16 if ((stride = (NCPU &gt; 1) ? (n &gt;&gt;&gt; 3) / NCPU : n) &lt; MIN_TRANSFER_STRIDE) stride = MIN_TRANSFER_STRIDE; // subdivide range //åˆšå¼€å§‹æ‰©å®¹ï¼Œåˆå§‹åŒ– nextTab if (nextTab == null) &#123; // initiating try &#123; @SuppressWarnings("unchecked") Node&lt;K,V&gt;[] nt = (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[n &lt;&lt; 1]; nextTab = nt; &#125; catch (Throwable ex) &#123; // try to cope with OOME sizeCtl = Integer.MAX_VALUE; return; &#125; nextTable = nextTab; //transferIndex æŒ‡å‘æœ€åä¸€ä¸ªæ¡¶ï¼Œæ–¹ä¾¿ä»åå‘å‰éå† transferIndex = n; &#125; int nextn = nextTab.length; //å®šä¹‰ ForwardingNode ç”¨äºæ ‡è®°è¿ç§»å®Œæˆçš„æ¡¶ ForwardingNode&lt;K,V&gt; fwd = new ForwardingNode&lt;K,V&gt;(nextTab); boolean advance = true; boolean finishing = false; // to ensure sweep before committing nextTab //i æŒ‡å‘å½“å‰æ¡¶ï¼Œbound æŒ‡å‘å½“å‰çº¿ç¨‹éœ€è¦å¤„ç†çš„æ¡¶ç»“ç‚¹çš„åŒºé—´ä¸‹é™ for (int i = 0, bound = 0;;) &#123; Node&lt;K,V&gt; f; int fh; //éå†å½“å‰çº¿ç¨‹æ‰€åˆ†é…åˆ°çš„æ¡¶ç»“ç‚¹ while (advance) &#123; int nextIndex, nextBound; if (--i &gt;= bound || finishing) advance = false; //transferIndex &lt;= 0 è¯´æ˜å·²ç»æ²¡æœ‰éœ€è¦è¿ç§»çš„æ¡¶äº† else if ((nextIndex = transferIndex) &lt;= 0) &#123; i = -1; advance = false; &#125; //æ›´æ–° transferIndex //ä¸ºå½“å‰çº¿ç¨‹åˆ†é…ä»»åŠ¡ï¼Œå¤„ç†çš„æ¡¶ç»“ç‚¹åŒºé—´ä¸ºï¼ˆnextBound,nextIndexï¼‰ else if (U.compareAndSwapInt (this, TRANSFERINDEX, nextIndex, nextBound = (nextIndex &gt; stride ? nextIndex - stride : 0))) &#123; bound = nextBound; i = nextIndex - 1; advance = false; &#125; &#125; //å½“å‰çº¿ç¨‹æ‰€æœ‰ä»»åŠ¡å®Œæˆ if (i &lt; 0 || i &gt;= n || i + n &gt;= nextn) &#123; int sc; if (finishing) &#123; nextTable = null; table = nextTab; sizeCtl = (n &lt;&lt; 1) - (n &gt;&gt;&gt; 1); return; &#125; if (U.compareAndSwapInt(this, SIZECTL, sc = sizeCtl, sc - 1)) &#123; if ((sc - 2) != resizeStamp(n) &lt;&lt; RESIZE_STAMP_SHIFT) return; finishing = advance = true; i = n; // recheck before commit &#125; &#125; //å¾…è¿ç§»æ¡¶ä¸ºç©ºï¼Œé‚£ä¹ˆåœ¨æ­¤ä½ç½® CAS æ·»åŠ  ForwardingNode ç»“ç‚¹æ ‡è¯†è¯¥æ¡¶å·²ç»è¢«å¤„ç†è¿‡äº† else if ((f = tabAt(tab, i)) == null) advance = casTabAt(tab, i, null, fwd); //å¦‚æœæ‰«æåˆ° ForwardingNodeï¼Œè¯´æ˜æ­¤æ¡¶å·²ç»è¢«å¤„ç†è¿‡äº†ï¼Œè·³è¿‡å³å¯ else if ((fh = f.hash) == MOVED) advance = true; // already processed else &#123; synchronized (f) &#123; if (tabAt(tab, i) == f) &#123; Node&lt;K,V&gt; ln, hn; //é“¾è¡¨çš„è¿ç§»æ“ä½œ if (fh &gt;= 0) &#123; int runBit = fh &amp; n; Node&lt;K,V&gt; lastRun = f; //æ•´ä¸ª for å¾ªç¯ä¸ºäº†æ‰¾åˆ°æ•´ä¸ªæ¡¶ä¸­æœ€åè¿ç»­çš„ fh &amp; n ä¸å˜çš„ç»“ç‚¹ for (Node&lt;K,V&gt; p = f.next; p != null; p = p.next) &#123; int b = p.hash &amp; n; if (b != runBit) &#123; runBit = b; lastRun = p; &#125; &#125; if (runBit == 0) &#123; ln = lastRun; hn = null; &#125; else &#123; hn = lastRun; ln = null; &#125; for (Node&lt;K,V&gt; p = f; p != lastRun; p = p.next) &#123; int ph = p.hash; K pk = p.key; V pv = p.val; if ((ph &amp; n) == 0) ln = new Node&lt;K,V&gt;(ph, pk, pv, ln); else hn = new Node&lt;K,V&gt;(ph, pk, pv, hn); &#125; setTabAt(nextTab, i, ln); setTabAt(nextTab, i + n, hn); setTabAt(tab, i, fwd); advance = true; &#125; //çº¢é»‘æ ‘çš„å¤åˆ¶ç®—æ³•ï¼Œ else if (f instanceof TreeBin) &#123; TreeBin&lt;K,V&gt; t = (TreeBin&lt;K,V&gt;)f; TreeNode&lt;K,V&gt; lo = null, loTail = null; TreeNode&lt;K,V&gt; hi = null, hiTail = null; int lc = 0, hc = 0; for (Node&lt;K,V&gt; e = t.first; e != null; e = e.next) &#123; int h = e.hash; TreeNode&lt;K,V&gt; p = new TreeNode&lt;K,V&gt; (h, e.key, e.val, null, null); if ((h &amp; n) == 0) &#123; if ((p.prev = loTail) == null) lo = p; else loTail.next = p; loTail = p; ++lc; &#125; else &#123; if ((p.prev = hiTail) == null) hi = p; else hiTail.next = p; hiTail = p; ++hc; &#125; &#125; ln = (lc &lt;= UNTREEIFY_THRESHOLD) ? untreeify(lo) : (hc != 0) ? new TreeBin&lt;K,V&gt;(lo) : t; hn = (hc &lt;= UNTREEIFY_THRESHOLD) ? untreeify(hi) : (lc != 0) ? new TreeBin&lt;K,V&gt;(hi) : t; setTabAt(nextTab, i, ln); setTabAt(nextTab, i + n, hn); setTabAt(tab, i, fwd); advance = true; &#125; &#125; &#125; &#125; &#125; &#125; è‡³æ­¤ï¼Œputæ–¹æ³•è®²å®Œäº† å‚è€ƒèµ„æ–™~å‚è€ƒèµ„æ–™ æ„Ÿè°¢ ç»“æŸ æ­¤ç‰‡å®Œäº†~ æƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ æœ¬ç¯‡ä¸ºåŸåˆ›å†…å®¹ï¼Œå·²åœ¨ä¸ªäººåšå®¢ç‡å…ˆå‘è¡¨ï¼ŒéšåCSDNï¼Œsegmentfaultï¼Œæ˜é‡‘ï¼Œç®€ä¹¦ï¼Œå¼€æºä¸­å›½åŒæ­¥å‘å‡ºã€‚å¦‚æœ‰é›·åŒï¼Œç¼˜åˆ†å‘¢å…„å¼Ÿã€‚èµ¶å¿«åŠ ä¸ªå¥½å‹~]]></content>
      <tags>
        <tag>æºç </tag>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HashSetåŸç†]]></title>
    <url>%2F2018%2F07%2F17%2FHashSet%E5%8E%9F%E7%90%86%2F</url>
    <content type="text"><![CDATA[HashSetHashSet æ˜¯ä¸€ä¸ªä¸å…è®¸å­˜å‚¨é‡å¤å…ƒç´ çš„é›†åˆã€‚ HashSetå®ç°Setæ¥å£ï¼Œç”±å“ˆå¸Œè¡¨ï¼ˆå®é™…ä¸Šæ˜¯ä¸€ä¸ªHashMapå®ä¾‹ï¼‰æ”¯æŒã€‚å®ƒä¸ä¿è¯set çš„è¿­ä»£é¡ºåºï¼›ç‰¹åˆ«æ˜¯å®ƒä¸ä¿è¯è¯¥é¡ºåºæ’ä¹…ä¸å˜ã€‚æ­¤ç±»å…è®¸ä½¿ç”¨nullå…ƒç´ ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®https://blog.tengshe789.tech/ HashSetå’ŒHashMapæ¯”è¾ƒHashSetï¼š HashSetå®ç°äº†Setæ¥å£ï¼Œå®ƒä¸å…è®¸é›†åˆä¸­å‡ºç°é‡å¤å…ƒç´ ã€‚å½“æˆ‘ä»¬æåˆ°HashSetæ—¶ï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯åœ¨å°†å¯¹è±¡å­˜å‚¨åœ¨ HashSetä¹‹å‰ï¼Œè¦ç¡®ä¿é‡å†™hashCodeï¼ˆï¼‰æ–¹æ³•å’Œequalsï¼ˆï¼‰æ–¹æ³•ï¼Œè¿™æ ·æ‰èƒ½æ¯”è¾ƒå¯¹è±¡çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œç¡®ä¿é›†åˆä¸­æ²¡æœ‰ å‚¨å­˜ç›¸åŒçš„å¯¹è±¡ã€‚å¦‚æœä¸é‡å†™ä¸Šè¿°ä¸¤ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆå°†ä½¿ç”¨ä¸‹é¢æ–¹æ³•é»˜è®¤å®ç°ï¼š public boolean add(Object obj)æ–¹æ³•ç”¨åœ¨Setæ·»åŠ å…ƒç´ æ—¶ï¼Œå¦‚æœå…ƒç´ å€¼é‡å¤æ—¶è¿”å› â€œfalseâ€ï¼Œå¦‚æœæ·»åŠ æˆåŠŸåˆ™è¿”å›â€trueâ€ HashMapï¼š HashMapå®ç°äº†Mapæ¥å£ï¼ŒMapæ¥å£å¯¹é”®å€¼å¯¹è¿›è¡Œæ˜ å°„ã€‚Mapä¸­ä¸å…è®¸å‡ºç°é‡å¤çš„é”®ï¼ˆKeyï¼‰ã€‚Mapæ¥å£æœ‰ä¸¤ä¸ªåŸºæœ¬çš„å®ç° TreeMapå’ŒHashMapã€‚TreeMapä¿å­˜äº†å¯¹è±¡çš„æ’åˆ—æ¬¡åºï¼Œè€ŒHashMapä¸èƒ½ã€‚HashMapå¯ä»¥æœ‰ç©ºçš„é”®å€¼å¯¹ï¼ˆKeyï¼ˆnullï¼‰-Valueï¼ˆnullï¼‰ï¼‰ HashMapæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼ˆéSynchronizeï¼‰ï¼Œè¦æƒ³å®ç°çº¿ç¨‹å®‰å…¨ï¼Œé‚£ä¹ˆéœ€è¦è°ƒç”¨collectionsç±»çš„é™æ€æ–¹æ³•synchronizeMapï¼ˆï¼‰å®ç°ã€‚ public Object put(Object Key,Object value)æ–¹æ³•ç”¨æ¥å°†å…ƒç´ æ·»åŠ åˆ°mapä¸­ã€‚ æˆå‘˜å˜é‡é¦–å…ˆäº†è§£ä¸‹ HashSet çš„æˆå‘˜å˜é‡: 12345//ç”¨transientå…³é”®å­—æ ‡è®°çš„æˆå‘˜å˜é‡ä¸å‚ä¸åºåˆ—åŒ–è¿‡ç¨‹private transient HashMap&lt;E,Object&gt; map;// Dummy value to associate with an Object in the backing Mapprivate static final Object PRESENT = new Object(); å‘ç°ä¸»è¦å°±ä¸¤ä¸ªå˜é‡: map ï¼šç”¨äºå­˜æ”¾æœ€ç»ˆæ•°æ®çš„ã€‚ PRESENT ï¼šæ˜¯æ‰€æœ‰å†™å…¥ map çš„ value å€¼ã€‚ æ„é€ å‡½æ•°1234567public HashSet() &#123; map = new HashMap&lt;&gt;();&#125;public HashSet(int initialCapacity, float loadFactor) &#123; map = new HashMap&lt;&gt;(initialCapacity, loadFactor);&#125; æ„é€ å‡½æ•°å¾ˆç®€å•ï¼Œåˆ©ç”¨äº† HashMap åˆå§‹åŒ–äº† map ã€‚ add123public boolean add(E e) &#123; return map.put(e, PRESENT)==null;&#125; æ¯”è¾ƒå…³é”®çš„å°±æ˜¯è¿™ä¸ª add() æ–¹æ³•ã€‚ å¯ä»¥çœ‹å‡ºå®ƒæ˜¯å°†å­˜æ”¾çš„å¯¹è±¡å½“åšäº† HashMap çš„å¥ï¼Œvalue éƒ½æ˜¯ç›¸åŒçš„ PRESENT ã€‚ç”±äº HashMap çš„ key æ˜¯ä¸èƒ½é‡å¤çš„ï¼Œæ‰€ä»¥æ¯å½“æœ‰é‡å¤çš„å€¼å†™å…¥åˆ° HashSet æ—¶ï¼Œvalue ä¼šè¢«è¦†ç›–ï¼Œä½† key ä¸ä¼šæ”¶åˆ°å½±å“ï¼Œè¿™æ ·å°±ä¿è¯äº† HashSet ä¸­åªèƒ½å­˜æ”¾ä¸é‡å¤çš„å…ƒç´ ã€‚ æ€»ç»“HashSet çš„åŸç†æ¯”è¾ƒç®€å•ï¼Œå‡ ä¹å…¨éƒ¨å€ŸåŠ©äº HashMap æ¥å®ç°çš„ã€‚ æ‰€ä»¥ HashMap ä¼šå‡ºç°çš„é—®é¢˜ HashSet ä¾ç„¶ä¸èƒ½é¿å…ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢]]></content>
      <tags>
        <tag>æºç </tag>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åˆ†äº«ä¸€ä¸ªç®€å•åˆå¤æ‚çš„ç¨‹åºé€‰æ‹©é¢˜]]></title>
    <url>%2F2018%2F07%2F11%2F%E5%88%86%E4%BA%AB%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E5%8F%88%E5%A4%8D%E6%9D%82%E7%9A%84%E7%A8%8B%E5%BA%8F%E9%80%89%E6%8B%A9%E9%A2%98%2F</url>
    <content type="text"><![CDATA[ä»Šå¤©åœ¨ç‰›å®¢ç½‘åˆ·é¢˜ï¼Œçœ‹è§ä¸€ä¸ªéå¸¸ç®€å•åˆå¾ˆå¤æ‚çš„é¢˜ç›®ï¼Œæˆ‘ç°åœ¨æ¥åˆ†äº«ä¸€ä¸‹ã€‚ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ é¢˜ç›®æ˜¯è¿™æ ·çš„ï¼š 123456789101112131415161718192021222324252627282930313233343536public class Main &#123; public static void main(String [] args)&#123; System.out.println(new B().getValue()); &#125; static class A&#123; protected int value; public A(int v) &#123; setValue(v); &#125; public void setValue(int value)&#123; this.value = value; &#125; public int getValue()&#123; try&#123; value++; return value; &#125; catch(Exception e)&#123; System.out.println(e.toString()); &#125; finally &#123; this.setValue(value); System.out.println(value); &#125; return value; &#125; &#125; static class B extends A&#123; public B() &#123; super(5); setValue(getValue() - 3); &#125; @Override public void setValue(int value)&#123; super.setValue(2 * value); &#125; &#125; &#125; é¢˜ç›®è®©å†™å‡ºä¸Šè¿°ä»£ç æ‰§è¡Œå®Œæˆåçš„è¾“å‡ºç»“æœ è¿™é“é¢˜è€ƒçš„å…¶å®å°±æ˜¯ä»£ç æ‰§è¡Œé¡ºåºçš„çŸ¥è¯†ï¼Œæ¯”è¾ƒåŸºç¡€çš„ä¸œè¥¿ã€‚é¦–å…ˆï¼Œç”¨IDEAæ‰“ä¸€ä¸‹æ–­ç‚¹ï¼Œå¦‚å›¾ï¼š é¦–å…ˆèµ°ä¸»å‡½æ•°ï¼Œnew Bï¼Œè¿›å…¥Bçš„æ„é€ æ–¹æ³• å¹¶å°†çˆ¶ç±»Aä¼ å…¥5ï¼ˆå½“å­ç±»æ„é€ å™¨ä¸­æ²¡æœ‰ä½¿ç”¨â€super(å‚æ•°æˆ–æ— å‚æ•°)â€æŒ‡å®šè°ƒç”¨çˆ¶ç±»æ„é€ å™¨æ—¶ï¼Œæ˜¯é»˜è®¤è°ƒç”¨çˆ¶ç±»çš„æ— å‚æ„é€ å™¨ï¼Œå¦‚æœçˆ¶ç±»ä¸­åŒ…å«æœ‰å‚æ„é€ å™¨ï¼Œå´æ²¡æœ‰æ— å‚æ„é€ å™¨ï¼Œåˆ™åœ¨å­ç±»æ„é€ å™¨ä¸­ä¸€å®šè¦ä½¿ç”¨â€œsuper(å‚æ•°)â€æŒ‡å®šè°ƒç”¨çˆ¶ç±»çš„æœ‰å‚æ„é€ å™¨ï¼Œä¸ç„¶å°±ä¼šæŠ¥é”™ã€‚ ï¼‰ è°ƒç”¨çˆ¶ç±»çš„setValueæ–¹æ³•ï¼Œç”±äºå­ç±»å·²å°†å…¶é‡å†™ï¼Œæ‰€ä»¥ç›´æ¥åˆ°å­ç±»{ æ•²é»‘æ¿ï¼š 1.çˆ¶ç±»ï¼Œå­ç±»ä¹‹é—´è½¬å‹çš„é—®é¢˜ï¼Œå½“çˆ¶ç±»å£°æ˜æŒ‡å‘å­ç±»å¯¹è±¡ï¼Œä¼šå‘ç”Ÿéšå¼å‘ä¸Šè½¬å‹ã€‚ 2.ç¼–è¯‘æ—¶æ‰€å‚è€ƒçš„å¯¹è±¡ç±»å‹æ˜¯å£°æ˜å¯¹è±¡æ‰€ç”¨çš„ç±»å‹ï¼Œè€Œè¿è¡Œæ—¶åˆ™æ˜¯å‚è€ƒå¯¹è±¡å®ä¾‹åŒ–çš„ç±»å‹ã€‚ 3.å½“å­ç±»é‡å†™äº†çˆ¶ç±»çš„æŸä¸ªæ–¹æ³•æ—¶ï¼Œä¼šå°†çˆ¶ç±»çš„æ–¹æ³•è¿›è¡Œéšè—ï¼Œå› æ­¤è¿™è¾¹æœ€åè°ƒåˆ°çš„éƒ½æ˜¯å­ç±»é‡å†™çš„æ–¹æ³•ã€‚ } ç°åœ¨å›åˆ°value=10 ç°åœ¨valueæ˜¯10ï¼Œå‡†å¤‡è¿›å…¥geiValueé˜¶æ®µ è¿˜æ˜¯10 åœ¨è¿™é‡Œè¿”å›valueï¼Œæ­¤æ—¶valueæ˜¯11 try{}catch{}æ‰§è¡Œå®Œä¸€å®šè¦èµ°finnally valueæ˜¯22äº† ç»ˆäºå¼€å§‹æ‰“å°äº†ï¼Œæ‰“å°ç¬¬ä¸€ä¸ªæ•°å­—ï¼š22 è¿”å›value =22 å›åˆ°åˆšåˆšBé‚£é‡Œï¼Œç¬¬ä¸€æ¬¡è¿”å›çš„valueæ˜¯11ï¼Œå°†11-3=8 å°†8*2=16å¾—åˆ°value å›åˆ°ä¸»æ–¹æ³• å†èµ°ä¸€è¾¹getValueï¼ˆï¼‰ è¿›å…¥finallyï¼Œå†å°†value*2=34 ç¬¬äºŒä¸ªæ•°å­—å‡ºæ¥äº†ï¼Œæ‰“å°34ï¼Œç„¶åè¿”å›3 åˆ°è¿™é‡Œä¸»å‡½æ•°æ‰§è¡Œå®Œæˆï¼Œä½†æ˜¯æ³¨æ„äº†ã€‚ç¬¬äºŒæ¬¡è¿”å›å€¼æ˜¯17ï¼Œç¬¬ä¸‰æ¬¡æ˜¯34ã€‚åˆ°äº†æœ€ååˆè¾“å‡ºäº†getValueï¼ˆï¼‰ç¬¬äºŒæ¬¡çš„è¿”å›å€¼ï¼Œä¹Ÿå°±æ˜¯17 æ‰€ä»¥æ•´ä¸ªè¿‡ç¨‹æ‰§è¡Œå®Œåçš„è¾“å‡ºç»“æœæ˜¯22ã€34ã€17ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ è¿™ä¸ªé¢˜æœ‰äº›è¯­å¥æœ‰ç‚¹å¤šä½™ï¼Œè­¬å¦‚finallyä»£ç å—åé¢returnæ°¸è¿œç”¨ä¸ä¸Šã€‚ è¿™é“é¢˜è™½ç„¶é¥¶äº†å¾ˆå¤šå¼¯ï¼Œä½†ç»†ç»†å“å‘³åå…¶å®å¹¶æ²¡é‚£ä¹ˆéš¾ï¼Œè€ƒç‚¹æ˜¯ï¼š 1.è‡ªç±»ç»§æ‰¿çˆ¶ç±»ï¼Œè°ƒç”¨æ–¹æ³•æ—¶å…ˆæ˜¯è°ƒç”¨å­ç±»ä¸­çš„æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰å°±è°ƒç”¨çˆ¶ç±»ä¸­çš„æ–¹æ³•ã€‚ 2.try{ }ã€catch{ }ã€finally{ }è¿”å›å€¼çš„é—®é¢˜ï¼Œä¸€æ—¦try{ }ä¸­è¿”å›äº†æŸä¸€ä¸ªå€¼ï¼Œå¦‚æœfinallyæœ‰è¿”å›å€¼ï¼Œfinallyä¸­çš„è¿”å›å€¼ä¼šè¦†ç›–tryçš„è¿”å›å€¼ï¼Œå¦‚æœfinallyæ²¡æœ‰è¿”å›å€¼ï¼Œå°±æ˜¯tryä¸­çš„è¿”å›å€¼ã€‚]]></content>
      <tags>
        <tag>java</tag>
        <tag>é”™é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…³äºHashmapçš„ä¸ªäººç†è§£]]></title>
    <url>%2F2018%2F07%2F08%2F%E5%85%B3%E4%BA%8EHashmap%E7%9A%84%E4%B8%AA%E4%BA%BA%E7%90%86%E8%A7%A3%2F</url>
    <content type="text"><![CDATA[åˆšåˆšçœ‹åˆ°QQç¾¤æœ‰äººå¹Hashmapï¼Œä¸€æƒ³æˆ‘å•¥éƒ½ä¸æ‡‚ï¼Œå°±èµ¶å¿«è¡¥äº†ä¸€æ³¢ã€‚ä¸‹é¢åˆ†äº«ä¸€ä¸‹æˆ‘å¯¹Hashmapçš„ç†è§£ï¼Œä¸»è¦ç”¨äºä¸ªäººå¤‡å¿˜ã€‚å¦‚æœæœ‰ä¸å¯¹ï¼Œè¯·æ‰¹è¯„ã€‚æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®https://blog.tengshe789.tech/ æ€»èµ·Hashmapæ˜¯æ•£åˆ—è¡¨ï¼Œå­˜å‚¨ç»“æ„æ˜¯é”®å€¼å¯¹å½¢å¼ã€‚æ ¹æ®å¥çš„Hashcodeå€¼å­˜å‚¨æ•°æ®ï¼Œæœ‰è¾ƒå¿«çš„è®¿é—®é€Ÿåº¦ã€‚ å®ƒçš„çº¿ç¨‹æ˜¯ä¸å®‰å…¨çš„ï¼Œåœ¨ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å°è¯•æ‰©å®¹HashMapæ—¶ï¼Œå¯èƒ½å°†ä¸€ä¸ªé“¾è¡¨å½¢æˆç¯å½¢çš„é“¾è¡¨ï¼Œæ‰€æœ‰çš„nextéƒ½ä¸ä¸ºç©ºï¼Œè¿›å…¥æ­»å¾ªç¯ï¼›è¦æƒ³è®©å®ƒå®‰å…¨ï¼Œå¯ä»¥ç”¨ Collectionsçš„synchronizedMap æ–¹æ³•ä½¿ HashMapå…·æœ‰çº¿ç¨‹å®‰å…¨çš„èƒ½åŠ›ï¼Œæˆ–è€…ä½¿ç”¨ConcurrentHashMap ã€‚ ä»–çš„é”®å€¼å¯¹éƒ½å¯ä»¥ä¸ºç©ºï¼Œæ˜ å°„ä¸æ˜¯æœ‰åºçš„ã€‚ Hashmapæœ‰ä¸¤ä¸ªå‚æ•°å½±å“æ€§èƒ½ï¼šåˆå§‹å®¹é‡ï¼ŒåŠ è½½å› å­ã€‚ Hashmapå­˜å‚¨ç»“æ„JDK1.8ä¸­Hashmapæ˜¯ç”±é“¾è¡¨ã€çº¢é»‘æ ‘ã€æ•°ç»„å®ç°çš„ 12345678910111213141516171819202122232425262728293031323334353637383940//ç”¨æ¥å®ç°æ•°ç»„ã€é“¾è¡¨çš„æ•°æ®ç»“æ„static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; &#123; final int hash;//ä¿å­˜èŠ‚ç‚¹çš„Hash final K key;//ä¿å­˜èŠ‚ç‚¹çš„é”®å€¼ V value;//ä¿å­˜èŠ‚ç‚¹çš„å€¼ Node&lt;K,V&gt; next;//æŒ‡å‘é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ Node(int hash, K key, V value, Node&lt;K,V&gt; next) &#123; this.hash = hash; this.key = key; this.value = value; this.next = next; &#125; public final K getKey() &#123; return key; &#125; public final V getValue() &#123; return value; &#125; public final String toString() &#123; return key + "=" + value; &#125; public final int hashCode() &#123; return Objects.hashCode(key) ^ Objects.hashCode(value); &#125; public final V setValue(V newValue) &#123; V oldValue = value; value = newValue; return oldValue; &#125; public final boolean equals(Object o) &#123; if (o == this) return true; if (o instanceof Map.Entry) &#123; Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o; if (Objects.equals(key, e.getKey()) &amp;&amp; Objects.equals(value, e.getValue())) return true; &#125; return false; &#125; &#125; Hashmapæ„é€ æ–¹æ³•HashMapæœ‰4ä¸ªæ„é€ æ–¹æ³•ã€‚ ä»£ç ï¼š 1234567891011121314151617181920212223242526272829//æ–¹æ³•1.åˆ¶å®šåˆå§‹å®¹é‡å’Œè´Ÿè½½å› å­public HashMap(int initialCapacity, float loadFactor) &#123; if (initialCapacity &lt; 0) throw new IllegalArgumentException("Illegal initial capacity: " + initialCapacity); if (initialCapacity &gt; MAXIMUM_CAPACITY) initialCapacity = MAXIMUM_CAPACITY; if (loadFactor &lt;= 0 || Float.isNaN(loadFactor)) throw new IllegalArgumentException("Illegal load factor: " + loadFactor); this.loadFactor = loadFactor; this.threshold = tableSizeFor(initialCapacity); &#125;//æ–¹æ³•2.æŒ‡å®šåˆå§‹å®¹é‡ public HashMap(int initialCapacity) &#123; this(initialCapacity, DEFAULT_LOAD_FACTOR); &#125;//æ–¹æ³•ä¸‰ã€‚æ— å‚æ„é€ ã€‚ HashMap() &#123; this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted &#125;//æ–¹æ³•å››ã€‚å°†å¦ä¸€ä¸ª Map ä¸­çš„æ˜ å°„æ‹·è´ä¸€ä»½åˆ°è‡ªå·±çš„å­˜å‚¨ç»“æ„ä¸­æ¥ï¼Œè¿™ä¸ªæ–¹æ³•ä¸æ˜¯å¾ˆå¸¸ç”¨ public HashMap(Map&lt;? extends K, ? extends V&gt; m) &#123; this.loadFactor = DEFAULT_LOAD_FACTOR; putMapEntries(m, false); &#125; Hashmapå˜é‡æˆå‘˜12345678910111213141516//æœªæŒ‡å®šå®¹é‡çš„æ—¶å€™ï¼Œæ•°ç»„çš„åˆå§‹å®¹é‡ã€‚åˆå§‹å®¹é‡æ˜¯16//ä¸ºä»€ä¹ˆä¸ç›´æ¥å†™16ï¼Ÿå› ä¸ºé€Ÿåº¦å¿«ã€‚è®¡ç®—æœºé‡Œé¢è¦è½¬æ¢äºŒè¿›åˆ¶ã€‚//å¿…é¡»2çš„næ¬¡å¹‚static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16//è´Ÿè½½å› å­ã€‚å½“hashmapå®¹é‡è¶…è¿‡ å®¹é‡*è´Ÿè½½å› å­ æ—¶ï¼Œè¿›è¡Œæ‰©å®¹æ“ä½œï¼ˆresizeï¼ˆï¼‰ï¼‰static final float DEFAULT_LOAD_FACTOR = 0.75f;//ç¡®å®šä½•æ—¶å°†hashå†²çªçš„é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘static final int TREEIFY_THRESHOLD = 8;//ç”¨æ¥ç¡®ä½•æ—¶å°†çº¢é»‘æ ‘è½¬æ¢æˆé“¾è¡¨static final int UNTREEIFY_THRESHOLD = 6;//å½“é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘æ—¶ï¼Œéœ€è¦åˆ¤æ–­æ•°ç»„å®¹é‡ã€‚è‹¥æ•°ç»„å®¹é‡å¤ªå°å¯¼è‡´hashå†²çªå¤ªå¤šï¼Œåˆ™ä¸è¿›è¡Œçº¢é»‘æ ‘æ“ä½œï¼Œè½¬è€Œåˆ©ç”¨reseizeæ‰©å®¹static final int MIN_TREEIFY_CAPACITY = 64; åˆå§‹å®¹é‡ã€è´Ÿè½½å› å­ã€é˜ˆå€¼.ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½¿ç”¨æ— å‚æ„é€ æ–¹æ³•åˆ›å»º HashMapã€‚ä½†å½“æˆ‘ä»¬å¯¹æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦æœ‰è¦æ±‚çš„æ—¶å€™ï¼Œä½¿ç”¨é»˜è®¤å€¼æœ‰æ—¶å¯èƒ½è¾¾ä¸åˆ°æˆ‘ä»¬çš„è¦æ±‚ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦æ‰‹åŠ¨è°ƒå‚ã€‚ åœ¨ HashMap æ„é€ æ–¹æ³•ä¸­ï¼Œå¯ä¾›æˆ‘ä»¬è°ƒæ•´çš„å‚æ•°æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯åˆå§‹å®¹é‡initialCapacityï¼Œå¦ä¸€ä¸ªè´Ÿè½½å› å­loadFactorã€‚é€šè¿‡è¿™ä¸¤ä¸ªè®¾å®šè¿™ä¸¤ä¸ªå‚æ•°ï¼Œå¯ä»¥è¿›ä¸€æ­¥å½±å“é˜ˆå€¼å¤§å°ã€‚ä½†åˆå§‹é˜ˆå€¼ threshold ä»…ç”±initialCapacity ç»è¿‡ç§»ä½æ“ä½œè®¡ç®—å¾—å‡ºã€‚ åç§° ç”¨é€” initialCapacity HashMap åˆå§‹å®¹é‡ loadFactor è´Ÿè½½å› å­ threshold å½“å‰ HashMap æ‰€èƒ½å®¹çº³é”®å€¼å¯¹æ•°é‡çš„æœ€å¤§å€¼ï¼Œè¶…è¿‡è¿™ä¸ªå€¼ï¼Œåˆ™éœ€æ‰©å®¹ é»˜è®¤æƒ…å†µä¸‹ï¼ŒHashMap åˆå§‹å®¹é‡æ˜¯16ï¼Œè´Ÿè½½å› å­ä¸º 0.75ã€‚ æ³¨é‡Šä¸­æœ‰è¯´æ˜ï¼Œé˜ˆå€¼å¯ç”±å®¹é‡ä¹˜ä¸Šè´Ÿè½½å› å­è®¡ç®—è€Œæ¥ ï¼Œå³threshold = capacity * loadFactor 123456789static final int tableSizeFor(int cap) &#123; int n = cap - 1; n |= n &gt;&gt;&gt; 1; n |= n &gt;&gt;&gt; 2; n |= n &gt;&gt;&gt; 4; n |= n &gt;&gt;&gt; 8; n |= n &gt;&gt;&gt; 16; return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1; &#125; è¿™æ®µä»£ç æœ‰ç‚¹éš¾ï¼Œæ ¹æ®å¤§ç¥çš„è¯´æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„æ„æ€æ˜¯ï¼Œæ‰¾åˆ°å¤§äºæˆ–ç­‰äº cap çš„æœ€å°2çš„å¹‚ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ tableSizeFor æ–¹æ³•çš„å›¾è§£ ï¼š å›¾ä¸­å®¹é‡æ˜¯229+1ï¼Œè®¡ç®—åæ˜¯230 å¼•ç”¨ä¸€ä¸‹å•Šå¤§ç¥è¯´çš„ï¼š å¯¹äº HashMap æ¥è¯´ï¼Œè´Ÿè½½å› å­æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„å‚æ•°ï¼Œè¯¥å‚æ•°ååº”äº† HashMap æ¡¶æ•°ç»„çš„ä½¿ç”¨æƒ…å†µï¼ˆå‡è®¾é”®å€¼å¯¹èŠ‚ç‚¹å‡åŒ€åˆ†å¸ƒåœ¨æ¡¶æ•°ç»„ä¸­ï¼‰ã€‚é€šè¿‡è°ƒèŠ‚è´Ÿè½½å› å­ï¼Œå¯ä½¿ HashMap æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦ä¸Šæœ‰ä¸åŒçš„è¡¨ç°ã€‚å½“æˆ‘ä»¬è°ƒä½è´Ÿè½½å› å­æ—¶ï¼ŒHashMap æ‰€èƒ½å®¹çº³çš„é”®å€¼å¯¹æ•°é‡å˜å°‘ã€‚æ‰©å®¹æ—¶ï¼Œé‡æ–°å°†é”®å€¼å¯¹å­˜å‚¨æ–°çš„æ¡¶æ•°ç»„é‡Œï¼Œé”®çš„é”®ä¹‹é—´äº§ç”Ÿçš„ç¢°æ’ä¼šä¸‹é™ï¼Œé“¾è¡¨é•¿åº¦å˜çŸ­ã€‚æ­¤æ—¶ï¼ŒHashMap çš„å¢åˆ æ”¹æŸ¥ç­‰æ“ä½œçš„æ•ˆç‡å°†ä¼šå˜é«˜ï¼Œè¿™é‡Œæ˜¯å…¸å‹çš„æ‹¿ç©ºé—´æ¢æ—¶é—´ã€‚ç›¸åï¼Œå¦‚æœå¢åŠ è´Ÿè½½å› å­ï¼ˆè´Ÿè½½å› å­å¯ä»¥å¤§äº1ï¼‰ï¼ŒHashMap æ‰€èƒ½å®¹çº³çš„é”®å€¼å¯¹æ•°é‡å˜å¤šï¼Œç©ºé—´åˆ©ç”¨ç‡é«˜ï¼Œä½†ç¢°æ’ç‡ä¹Ÿé«˜ã€‚è¿™æ„å‘³ç€é“¾è¡¨é•¿åº¦å˜é•¿ï¼Œæ•ˆç‡ä¹Ÿéšä¹‹é™ä½ï¼Œè¿™ç§æƒ…å†µæ˜¯æ‹¿æ—¶é—´æ¢ç©ºé—´ã€‚è‡³äºè´Ÿè½½å› å­æ€ä¹ˆè°ƒèŠ‚ï¼Œè¿™ä¸ªçœ‹ä½¿ç”¨åœºæ™¯äº†ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”¨é»˜è®¤å€¼å°±å¯ä»¥äº†ã€‚ æ’å…¥PUTè¿‡ç¨‹ï¼š å¯¹Keyæ±‚hashå€¼ï¼Œç„¶åè®¡ç®—ä¸‹æ ‡ å¦‚æœæ²¡æœ‰ç¢°æ’ï¼Œå°±æ”¾å…¥æ¡¶ä¸­ å¦‚æœç¢°æ’äº†ï¼Œå°±ä»¥é“¾è¡¨å½¢å¼æ”¾åˆ°åé¢ å¦‚æœé“¾è¡¨é•¿åº¦è¶…è¿‡é˜ˆå€¼ï¼Œå°±æŠŠé“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘ å¦‚æœé“¾è¡¨å­˜åœ¨åˆ™æ›¿æ¢æ—§å€¼ å¦‚æœæ¡¶æ»¡äº†ï¼ˆå®¹é‡*è´Ÿè½½å› å­ï¼‰ï¼Œåˆ™é‡æ–°resize 1234public V put(K key, V value) &#123; //è°ƒç”¨æ ¸å¿ƒæ–¹æ³• return putVal(hash(key), key, value, false, true); &#125; putValæ ¸å¿ƒç®—æ³•åœ¨putValï¼ˆï¼‰ä¸­ã€‚è¦æƒ³ç†è§£ï¼Œå…ˆè¦æ˜ç™½æ¡¶æ’åº(Bucket Sort) å®ƒæ˜¯è¿„ä»Šä¸ºæ­¢æœ€å¿«çš„ä¸€ç§æ’åºæ³•ï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä»…ä¸ºÎŸ(n)ï¼Œä¹Ÿå°±æ˜¯çº¿æ€§å¤æ‚åº¦ã€‚ æ¡¶æ’åºæ ¸å¿ƒæ€æƒ³æ˜¯ï¼šæ ¹æ®æ•°æ®è§„æ¨¡nåˆ’åˆ†ï¼Œmä¸ªç›¸åŒå¤§å°çš„åŒºé—´ ï¼ˆæ¯ä¸ªåŒºé—´ä¸ºä¸€ä¸ªæ¡¶ï¼Œæ¡¶å¯ç†è§£ä¸ºå®¹å™¨ï¼‰ ã€‚å°†nä¸ªå…ƒç´ æŒ‰ç…§è§„å®šèŒƒå›´åˆ†å¸ƒåˆ°å„ä¸ªæ¡¶ä¸­å» ï¼Œå†å¯¹æ¯ä¸ªæ¡¶ä¸­çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œæ’åºæ–¹æ³•å¯æ ¹æ®éœ€è¦ï¼Œé€‰æ‹©å¿«é€Ÿæ’åºï¼Œæˆ–è€…å½’å¹¶æ’åºï¼Œæˆ–è€…æ’å…¥æ’åº ï¼Œç„¶åä¾æ¬¡ä»æ¯ä¸ªæ¡¶ä¸­å–å‡ºå…ƒç´ ï¼ŒæŒ‰é¡ºåºæ”¾å…¥åˆ°æœ€åˆçš„è¾“å‡ºåºåˆ—ä¸­(ç›¸å½“äºæŠŠæ‰€æœ‰çš„æ¡¶ä¸­çš„å…ƒç´ åˆå¹¶åˆ°ä¸€èµ·) ã€‚ ä¸‹é¢æ˜¯ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) &#123; //næ˜¯æ•°ç»„é•¿åº¦ Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; //åˆ¤æ–­æ¡¶æ•°ç»„æ˜¯å¦æ˜¯ç©º if ((tab = table) == null || (n = tab.length) == 0) //æ˜¯å°±ç”¨resizeï¼ˆï¼‰åˆå§‹åŒ– n = (tab = resize()).length; //æ ¹æ® hash å€¼ç¡®å®šèŠ‚ç‚¹åœ¨æ•°ç»„ä¸­çš„æ’å…¥ä½ç½® //è‹¥æ­¤ä½ç½®æ²¡æœ‰å…ƒç´ åˆ™è¿›è¡Œæ’å…¥ï¼Œæ³¨æ„ç¡®å®šæ’å…¥ä½ç½®æ‰€ç”¨çš„è®¡ç®—æ–¹æ³•ä¸º (n - 1) &amp; hash,ç”±äº n ä¸€å®šæ˜¯ï¼’çš„å¹‚æ¬¡ï¼Œè¿™ä¸ªæ“ä½œç›¸å½“äºhash % n if ((p = tab[i = (n - 1) &amp; hash]) == null) //å°†æ–°èŠ‚ç‚¹å¼•å…¥æ¡¶ä¸­ tab[i] = newNode(hash, key, value, null); else &#123; //ä¸´æ—¶å˜é‡eè¿›è¡Œè®°å½•ã€‚å¦‚æœæœ‰å€¼ï¼Œè¯´æ˜ä»…ä»…æ˜¯å€¼çš„è¦†ç›–ã€‚ Node&lt;K,V&gt; e; K k; // å¦‚æœé”®çš„å€¼ä»¥åŠèŠ‚ç‚¹ hash ç­‰äºé“¾è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªé”®å€¼å¯¹èŠ‚ç‚¹æ—¶ï¼Œåˆ™å°† e æŒ‡å‘è¯¥é”®å€¼å¯¹ if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; else if (p instanceof TreeNode)// å¦‚æœæ¡¶ä¸­çš„å¼•ç”¨ç±»å‹ä¸º TreeNodeï¼Œåˆ™è°ƒç”¨çº¢é»‘æ ‘çš„æ’å…¥æ–¹æ³• e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); else &#123;// å¯¹é“¾è¡¨è¿›è¡Œéå†ï¼Œå¹¶ç»Ÿè®¡é“¾è¡¨é•¿åº¦ for (int binCount = 0; ; ++binCount) &#123; if ((e = p.next) == null) &#123; p.next = newNode(hash, key, value, null); // é“¾è¡¨ä¸­ä¸åŒ…å«è¦æ’å…¥çš„é”®å€¼å¯¹èŠ‚ç‚¹æ—¶ï¼Œåˆ™å°†è¯¥èŠ‚ç‚¹æ¥åœ¨é“¾è¡¨çš„æœ€å if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; &#125; if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; p = e; &#125; &#125; //ä¸´æ—¶å˜é‡eä¸ä¸ºç©ºæ—¶ï¼Œè¯´æ˜å·²ç»æœ‰å€¼è¿›è¡Œæ›¿æ¢äº† if (e != null) &#123; // existing mapping for key V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); //è¿”å›è€å€¼ return oldValue; &#125; &#125; ++modCount; //æ‰©å®¹ if (++size &gt; threshold) resize(); afterNodeInsertion(evict); return null; &#125; HASHhashç®—æ³•ï¼Œé«˜åå…­ä½ä¸ä½åå…­è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ä½¿å¾—åˆ°ç»“æœä¼šå°½å¯èƒ½ä¸åŒã€‚ 1234static final int hash(Object key) &#123; int h; return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16); &#125; resize HashMap çš„æ‰©å®¹æœºåˆ¶ä¸å…¶ä»–å˜é•¿é›†åˆçš„å¥—è·¯ä¸å¤ªä¸€æ ·ï¼ŒHashMap æŒ‰å½“å‰æ¡¶æ•°ç»„é•¿åº¦çš„2å€è¿›è¡Œæ‰©å®¹ï¼Œé˜ˆå€¼ä¹Ÿå˜ä¸ºåŸæ¥çš„2å€ï¼ˆå¦‚æœè®¡ç®—è¿‡ç¨‹ä¸­ï¼Œé˜ˆå€¼æº¢å‡ºå½’é›¶ï¼Œåˆ™æŒ‰é˜ˆå€¼å…¬å¼é‡æ–°è®¡ç®—ï¼‰ã€‚æ‰©å®¹ä¹‹åï¼Œè¦é‡æ–°è®¡ç®—é”®å€¼å¯¹çš„ä½ç½®ï¼Œå¹¶æŠŠå®ƒä»¬ç§»åŠ¨åˆ°åˆé€‚çš„ä½ç½®ä¸Šå»ã€‚ resizeæ€»å…±åšäº†3ä»¶äº‹ï¼Œåˆ†åˆ«æ˜¯ï¼š è®¡ç®—æ–°æ¡¶æ•°ç»„çš„å®¹é‡ newCap å’Œæ–°é˜ˆå€¼ newThr æ ¹æ®è®¡ç®—å‡ºçš„ newCap åˆ›å»ºæ–°çš„æ¡¶æ•°ç»„ï¼Œæ¡¶æ•°ç»„ table ä¹Ÿæ˜¯åœ¨è¿™é‡Œè¿›è¡Œåˆå§‹åŒ–çš„ å°†é”®å€¼å¯¹èŠ‚ç‚¹é‡æ–°æ˜ å°„åˆ°æ–°çš„æ¡¶æ•°ç»„é‡Œã€‚å¦‚æœèŠ‚ç‚¹æ˜¯ TreeNode ç±»å‹ï¼Œåˆ™éœ€è¦æ‹†åˆ†çº¢é»‘æ ‘ã€‚å¦‚æœæ˜¯æ™®é€šèŠ‚ç‚¹ï¼Œåˆ™èŠ‚ç‚¹æŒ‰åŸé¡ºåºè¿›è¡Œåˆ†ç»„ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394//resizeï¼ˆï¼‰å‡½æ•°åœ¨size &gt; thresholdæ—¶è¢«è°ƒç”¨final Node&lt;K,V&gt;[] resize() &#123; Node&lt;K,V&gt;[] oldTab = table; int oldCap = (oldTab == null) ? 0 : oldTab.length; int oldThr = threshold; int newCap, newThr = 0; //oldCapå¤§äº 0 ä»£è¡¨åŸæ¥çš„ table éç©º if (oldCap &gt; 0) &#123; // å½“ table å®¹é‡è¶…è¿‡å®¹é‡æœ€å¤§å€¼ï¼Œåˆ™ä¸å†æ‰©å®¹ if (oldCap &gt;= MAXIMUM_CAPACITY) &#123; //é˜ˆå€¼è®¾ä¸ºæ•´å½¢æœ€å¤§å€¼ threshold = Integer.MAX_VALUE; return oldTab; &#125;// æŒ‰æ—§å®¹é‡å’Œé˜ˆå€¼çš„2å€è®¡ç®—æ–°å®¹é‡å’Œé˜ˆå€¼çš„å¤§å° else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY) newThr = oldThr &lt;&lt; 1; // double threshold &#125; else if (oldThr &gt; 0) // initial capacity was placed in threshold /* *oldCap å°äºç­‰äº 0 ä¸” oldThr å¤§äº0ï¼Œä»£è¡¨ç”¨æˆ·åˆ›å»ºäº†ä¸€ä¸ª HashMapï¼Œä½†æ˜¯ä½¿ç”¨çš„æ„é€ å‡½æ•°ä¸º * HashMap(int initialCapacity, float loadFactor) æˆ– HashMap(int initialCapacity) * æˆ– HashMap(Map&lt;? extends K, ? extends V&gt; m)ï¼Œå¯¼è‡´ oldTab ä¸º nullï¼ŒoldCap ä¸º0ï¼Œ * oldThr ä¸ºç”¨æˆ·æŒ‡å®šçš„ HashMapçš„åˆå§‹å®¹é‡ */ newCap = oldThr; else &#123; //è®¾ç½®æ–°å®¹é‡å’Œæ–°é˜ˆå€¼å¤§å° newCap = DEFAULT_INITIAL_CAPACITY; newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); &#125; // newThr ä¸º 0 æ—¶ï¼ŒæŒ‰é˜ˆå€¼è®¡ç®—å…¬å¼è¿›è¡Œè®¡ç®— if (newThr == 0) &#123; //è®¡ç®—æ–°é˜ˆå€¼ float ft = (float)newCap * loadFactor; newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE); &#125; //å‡†å¤‡åˆå§‹åŒ–è¿‡ç¨‹ threshold = newThr; @SuppressWarnings(&#123;"rawtypes","unchecked"&#125;) Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap]; table = newTab; if (oldTab != null) &#123; //éå†ã€‚æŠŠ oldTab ä¸­çš„èŠ‚ç‚¹ reHash åˆ° newTab ä¸­å» for (int j = 0; j &lt; oldCap; ++j) &#123; Node&lt;K,V&gt; e; //åˆ¤æ–­è€æ•°ç»„æ˜¯å¦ä¸ºç©º if ((e = oldTab[j]) != null) &#123; //ä¸ä¸ºç©ºï¼Œè®¾æˆç©º oldTab[j] = null; //è‹¥èŠ‚ç‚¹æ˜¯å•ä¸ªèŠ‚ç‚¹ï¼Œç›´æ¥é‡æ–°åˆ†é…å®šä½ if (e.next == null) newTab[e.hash &amp; (newCap - 1)] = e; //è‹¥èŠ‚ç‚¹æ˜¯ TreeNode èŠ‚ç‚¹ï¼Œè¦è¿›è¡Œ çº¢é»‘æ ‘çš„ rehash æ“ä½œ else if (e instanceof TreeNode) ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap); //è‹¥æ˜¯é“¾è¡¨ï¼Œè¿›è¡Œé“¾è¡¨çš„ rehash æ“ä½œ else &#123; // preserve order Node&lt;K,V&gt; loHead = null, loTail = null; Node&lt;K,V&gt; hiHead = null, hiTail = null; Node&lt;K,V&gt; next; // éå†é“¾è¡¨ï¼Œå¹¶å°†é“¾è¡¨èŠ‚ç‚¹æŒ‰åŸé¡ºåºè¿›è¡Œåˆ†ç»„ do &#123; next = e.next; if ((e.hash &amp; oldCap) == 0) &#123; if (loTail == null) loHead = e; else loTail.next = e; loTail = e; &#125; else &#123; if (hiTail == null) hiHead = e; else hiTail.next = e; hiTail = e; &#125; &#125; while ((e = next) != null); if (loTail != null) &#123; loTail.next = null; newTab[j] = loHead; &#125; if (hiTail != null) &#123; hiTail.next = null; // rehash åèŠ‚ç‚¹æ–°çš„ä½ç½®ä¸€å®šä¸ºåŸæ¥åŸºç¡€ä¸ŠåŠ ä¸Š oldCap newTab[j + oldCap] = hiHead; &#125; &#125; &#125; &#125; &#125; return newTab; &#125; å…³äºHashMapåœ¨ä»€ä¹ˆæ—¶å€™æ—¶é—´å¤æ‚åº¦æ˜¯Oï¼ˆ1ï¼‰ï¼Œä»€ä¹ˆæ—¶å€™æ˜¯Oï¼ˆnï¼‰ï¼Œä»€ä¹ˆæ—¶å€™åˆæ˜¯Oï¼ˆlognï¼‰çš„é—®é¢˜Oï¼ˆ1ï¼‰ï¼šé“¾è¡¨çš„é•¿åº¦å°½å¯èƒ½çŸ­ï¼Œç†æƒ³çŠ¶æ€ä¸‹é“¾è¡¨é•¿åº¦éƒ½ä¸º1 Oï¼ˆnï¼‰ï¼šå½“ Hash å†²çªä¸¥é‡æ—¶ï¼Œå¦‚æœæ²¡æœ‰çº¢é»‘æ ‘ï¼Œé‚£ä¹ˆåœ¨æ¡¶ä¸Šå½¢æˆçš„é“¾è¡¨ä¼šå˜çš„è¶Šæ¥è¶Šé•¿ï¼Œè¿™æ ·åœ¨æŸ¥è¯¢æ—¶çš„æ•ˆç‡å°±ä¼šè¶Šæ¥è¶Šä½ï¼›æ—¶é—´å¤æ‚åº¦ä¸ºO(N)ã€‚ Oï¼ˆlognï¼‰ï¼šé‡‡ç”¨çº¢é»‘æ ‘ä¹‹åå¯ä»¥ä¿è¯æŸ¥è¯¢æ•ˆç‡O(logn) æ‰‹å†™123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186/** * @author tengshe789 */public class æ‰‹å†™HashMap &#123; public static class Node&lt;K,V&gt;&#123; K key; V value; Node&lt;K,V&gt; next; public Node(K key, V value, Node&lt;K, V&gt; next) &#123; this.key = key; this.value = value; this.next = next; &#125; public K getKey() &#123; return this.key; &#125; public V getValue() &#123; return this.value; &#125; public V setValue(V value) &#123; this.value=value; return this.value; &#125; &#125; public static class HashMap&lt;K, V&gt;&#123; /*æ•°æ®å­˜å‚¨çš„ç»“æ„==&gt;æ•°ç»„+é“¾è¡¨*/ Node&lt;K,V&gt;[] array=null; /* å“ˆå¸Œæ¡¶çš„é•¿åº¦ */ private static int defaultLength=16; /*åŠ è½½å› å­/æ‰©å®¹å› å­*/ private static double factor=0.75D; /*é›†åˆä¸­çš„å…ƒç´ ä¸ªæ•°*/ private int size; /*æ‰“å°å‡½æ•°*/ public void print() &#123; System.out.println("==============================="); if(array!=null) &#123; Node&lt;K, V&gt; node=null; for (int i = 0; i &lt; array.length; i++) &#123; node=array[i]; System.out.print("ä¸‹æ ‡["+i+"]"); //éå†é“¾è¡¨ while(node!=null) &#123; System.out.print("["+node.getKey()+":"+node.getValue()+"]"); if(node.next!=null) &#123; node=node.next; &#125;else &#123; //åˆ°å°¾éƒ¨å…ƒç´  node=null; &#125; &#125; System.out.println(); &#125; &#125; &#125; //putå…ƒç´ æ–¹æ³• public V put(K k, V v) &#123; //1.æ‡’åŠ è½½æœºåˆ¶ï¼Œä½¿ç”¨çš„æ—¶å€™è¿›è¡Œåˆ†é… if(array==null) &#123; array=new Node[defaultLength]; &#125; //2.é€šè¿‡hashç®—æ³•ï¼Œè®¡ç®—å‡ºå…·ä½“æ’å…¥çš„ä½ç½® int index=position(k,defaultLength); //æ‰©å®¹ã€‚åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ //æ‰©å®¹çš„å‡†åˆ™ï¼Œå…ƒç´ çš„ä¸ªæ•° å¤§äº æ¡¶çš„å°ºå¯¸*åŠ è½½å› å­ if(size &gt; defaultLength*factor) &#123; resize(); &#125; //3.æ”¾å…¥è¦æ’å…¥çš„å…ƒç´  Node&lt;K, V&gt; node=array[index]; if(node==null) &#123; array[index]=new Node&lt;K,V&gt;(k,v,null); size++; &#125;else &#123; if(k.equals(node.getKey()) || k==node.getKey()) &#123; return node.setValue(v); &#125;else &#123; array[index]=new Node&lt;K,V&gt;(k,v,node); size++; &#125; &#125; return null; &#125; //æ‰©å®¹ï¼Œå¹¶ä¸”é‡æ–°æ’åˆ—å…ƒç´  private void resize() &#123; //ç¿»å€æ‰©å®¹ //1.åˆ›å»ºæ–°çš„arrayä¸´æ—¶å˜é‡,ç›¸å½“äºdefaultlength*2 Node&lt;K, V&gt;[] temp=new Node[defaultLength &lt;&lt; 1]; //2.é‡æ–°è®¡ç®—æ•£åˆ—å€¼ï¼Œæ’å…¥åˆ°æ–°çš„arrayä¸­å»ã€‚ code=key % defaultLength ==&gt; code=key % defaultLength*2 Node&lt;K, V&gt; node=null; for (int i = 0; i &lt; array.length; i++) &#123; node=array[i]; while(node!=null) &#123; //é‡æ–°æ•£åˆ— int index=position(node.getKey(),temp.length); //æ’å…¥å¤´éƒ¨ Node&lt;K, V&gt; next = node.next; //3 node.next=temp[index]; //1 temp[index]=node; //2 node=next; &#125; &#125; //3.æ›¿æ¢æ‰è€array array=temp; defaultLength=temp.length; temp=null; &#125; private int position(K k,int length) &#123; int code=k.hashCode(); //å–æ¨¡ç®—æ³• return code % (length-1); //æ±‚ä¸ç®—æ³• //return code &amp; (defaultLength-1); &#125; public V get(K k) &#123; if(array!=null) &#123; int index=position(k,defaultLength); Node&lt;K, V&gt; node=array[index]; //éå†é“¾è¡¨ while(node!=null) &#123; //å¦‚æœkeyå€¼ç›¸åŒè¿”å›value if(node.getKey()==k) &#123; return node.getValue(); &#125; else //å¦‚æœkeyå€¼ä¸åŒåˆ™è°ƒåˆ°ä¸‹ä¸€ä¸ªå…ƒç´  &#123; node=node.next; &#125; &#125; &#125; return null; &#125; &#125; public static void main(String[] args) &#123; HashMap&lt;String, String&gt; map=new HashMap&lt;String, String&gt;(); map.put("001å·", "001"); map.put("002å·", "002"); map.put("003å·", "003"); map.put("004å·", "004"); map.put("005å·", "005"); map.put("006å·", "006"); map.put("007å·", "007"); map.put("008å·", "008"); map.put("009å·", "009"); map.put("010å·", "010"); map.put("011å·", "011"); map.print(); System.out.println("========&gt;"+map.get("009å·")); &#125; &#125; å‚è€ƒèµ„æ–™coolblog é˜¿é‡Œæ¶æ„å¸ˆå¸¦ä½ åˆ†æHashMapæºç å®ç°åŸç† æ„Ÿè°¢ï¼ ä»¥ä¸‹æ¥è‡ªnå¤©åçš„æˆ‘ï¼š è¡¥å……ä¸€ä¸‹çœ‹åˆ°ä¸€ä¸ªéå¸¸å¥½çš„ï¼šç‚¹å‡»é“¾æ¥ï¼Œå€¼å¾—å­¦ä¹ ]]></content>
      <tags>
        <tag>æºç </tag>
        <tag>java</tag>
        <tag>æŠ€æœ¯</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¤šç»ˆç«¯åŒæ­¥Hexo]]></title>
    <url>%2F2018%2F07%2F07%2F%E5%A4%9A%E7%BB%88%E7%AB%AF%E5%90%8C%E6%AD%A5Hexo%2F</url>
    <content type="text"><![CDATA[æ”¾å¯’å‡äº†ï¼Œç©æ¸¸æˆï¼ å‘¸å‘¸å‘¸ æˆ‘æ˜¯é‚£ç§äººä¹ˆï¼Ÿï¼Ÿï¼Ÿ æ”¾å‡äº†è¦å¥½å¥½å­¦ä¹ ï¼Œè€Œä¸”å­¦ä»€ä¹ˆè¦è®°å½•ä¸€ä¸‹ï¼Œæ¯å¤©å†™ç‚¹åšå®¢è®°å½•ä¸€ä¸‹è‡ªå·±çš„ç‚¹ç‚¹æ»´æ»´å•Š~ï¼å¯åƒåœ¾ç¬”è®°æœ¬å±å¹•å¤ªå°äº†ï¼Œçœ‹çš„çœ¼ç–¼ï¼Œæ²¡æœ‰åŠæ³•åœ¨åŸå…ˆæœ¬æœ¬ä¸Šå†™MDåšå®¢ è‚¿ä¹ˆåŠï¼Ÿ ä¸æ…Œï¼Œå¯ä»¥åˆ©ç”¨Gitåœ¨å¤šå¹³å°ä¸ŠåŒæ­¥Hexoï¼ ä¸‹é¢æˆ‘å°±åˆ†äº«ä¸€ä¸‹æ­¥éª¤~ å‡†å¤‡ç¯å¢ƒæˆ‘å°±ä¸è¯´äº†ï¼ŒNode.jsï¼ŒGitï¼ŒHexoï¼Œè¿™äº›éƒ½æ˜¯æœ€åŸºæœ¬çš„ ä¸‹è½½Gitä¸‹è½½ git OSX ç‰ˆ:git-scm.com/download/maâ€¦ä¸‹è½½ git Windows ç‰ˆ:git-scm.com/download/wiâ€¦ä¸‹è½½ git Linux ç‰ˆ:git-scm.com/download/liâ€¦ å®‰è£…GitLinux$ sudo yum install gitæˆ–è€…$ sudo apt-get install gitMacç›´æ¥åœ¨ Terminal æ‰§è¡Œ git å‘½ä»¤, å¦‚æœæ²¡æœ‰ä¼šæç¤ºå®‰è£…æ–¹æ³•. ç¬”è®°æœ¬ç«¯ï¼ˆéœ€è¦å¤‡ä»½çš„ä¸€ç«¯ï¼‰è¿›å…¥æˆ‘åšå®¢çš„åŸå§‹æ–‡ä»¶å¤¹å†…ï¼Œæ‰¾åˆ°.gitignoreï¼ˆGitå°±ä¼šè‡ªåŠ¨å¿½ç•¥æ–‡ä»¶æ€»æ±‡ï¼‰æ–‡ä»¶ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€~ æ·»åŠ å¦‚ä¸‹ 123public/.deploy*/node_modules/ #npm installäº§ç”Ÿçš„node_modulesç”±äºè·¯å¾„è¿‡é•¿ä¸å¥½å¤„ç† æ·»åŠ å®Œæˆåï¼Œå³é”® Git Bashï¼Œè¾“å…¥ä»¥ä¸‹ä»£ç ï¼š 1234567git init #åˆå§‹åŒ–æœ¬åœ°ä»“åº“git add . #å°†å¿…è¦çš„æ–‡ä»¶ä¾æ¬¡æ·»åŠ git commit -m "æ›´æ–°è¯´æ˜" #å¼•å·é‡Œé¢éšä¾¿æ”¹å“¦~git branch hexo #æ–°å»ºhexoåˆ†æ”¯ï¼Œå½“ç„¶ï¼Œåˆ†æ”¯åå­—â€œhexoâ€ä¹Ÿå¯ä»¥éšä¾¿æ”¹å“¦~git checkout hexo #åˆ‡æ¢åˆ°hexoåˆ†æ”¯ä¸Šgit remote add origin git@github.com:tengshe789/tengshe789.github.io.git #å°†æœ¬åœ°ä¸Githubé¡¹ç›®å¯¹æ¥ï¼Œtengshe789ä¸ºæˆ‘çš„ç”¨æˆ·ågit push origin hexo #pushåˆ°Githubé¡¹ç›®çš„hexoåˆ†æ”¯ä¸Š å®Œæˆååˆå½±~ è¿™é‡Œæœ‰å¾ˆå¤šéšç§æ–‡ä»¶å¤¹ï¼Œè­¬å¦‚config.yml,db.jsonâ€¦..æˆ‘ä¹Ÿä¸€ä¸€ä¸Šä¼ äº†ï¼Œå› ä¸ºæˆ‘æ˜¯ä¸ªä¸æ€•æš´æ¼éšç§çš„äººå“ˆå“ˆå“ˆå“ˆã€‚è¦æƒ³é¿å…è¿™ä¸ªæƒ…å†µåªå°†sourceæ·»åŠ å³å¯ å°å¼æœºç«¯ï¼ˆéœ€è¦è¿˜åŸçš„ä¸€ç«¯ï¼‰12345678git clone -b hexo git@github.com:tengshe789/tengshe789.github.io.git #å°†Githubä¸­hexoåˆ†æ”¯cloneåˆ°æœ¬åœ°cd tengshe789.github.io #åˆ‡æ¢åˆ°åˆšåˆšcloneçš„æ–‡ä»¶å¤¹å†…npm install #æ³¨æ„ï¼Œè¿™é‡Œä¸€å®šè¦åˆ‡æ¢åˆ°åˆšåˆšcloneçš„æ–‡ä»¶å¤¹å†…æ‰§è¡Œï¼Œå®‰è£…å¿…è¦çš„æ‰€éœ€ç»„ä»¶ï¼Œä¸ç”¨å†initnpm install hexo-cli -g # å¦‚æœä¸åŒæœºå™¨nodeç‰ˆæœ¬å‡çº§äº†ï¼Œéœ€è¦é‡æ–°è¿è¡Œè¿™ä¸ªnpm install https://github.com/CodeFalling/hexo-asset-image --save #å›¾ç‰‡æ’ä»¶npm install --save hexo-pdf #pdfæ’ä»¶npm install hexo-deployer-git #éƒ¨ç½²npm install hexo-generator-restful --save #ç”Ÿæˆ restful é£æ ¼çš„ json æ•°æ® https://github.com/yscoder/hexo-generator-restful å®Œæˆï¼ æ¥ä¸‹æ¥å†™ä¸€ç¯‡åšå®¢åº†ç¥ä¸€ä¸‹~ 1hexo new post "new blog name" #æ–°å»ºä¸€ä¸ª.mdæ–‡ä»¶ï¼Œå¹¶ç¼–è¾‘å®Œæˆè‡ªå·±çš„åšå®¢å†…å®¹ å†™å®Œï¼Œå¤‡ä»½ä¸€ä¸‹ï¼Œå†åŒæ­¥åˆ°githubï¼ 1234git add source #æ¯æ¬¡åªè¦æ›´æ–°sorcererä¸­çš„æ–‡ä»¶åˆ°Githubä¸­å³å¯ï¼Œå› ä¸ºåªæ˜¯æ–°å»ºäº†ä¸€ç¯‡æ–°åšå®¢git commit -m "æ›´æ–°è¯´æ˜"git push origin hexo #æ›´æ–°åˆ†æ”¯hexo d -g #pushæ›´æ–°å®Œåˆ†æ”¯ä¹‹åå°†è‡ªå·±å†™çš„åšå®¢å¯¹æ¥åˆ°è‡ªå·±æ­çš„åšå®¢ç½‘ç«™ä¸Šï¼ŒåŒæ—¶åŒæ­¥äº†Githubä¸­çš„master ç•ªå¤–ï¼šç¬”è®°æœ¬æ€ä¹ˆåŒæ­¥ï¼Ÿè¿›å…¥æˆ‘åšå®¢çš„åŸå§‹æ–‡ä»¶å¤¹å†… 1git pull origin hexo #å…ˆpullå®Œæˆæœ¬åœ°ä¸è¿œç«¯çš„èåˆ Hexoå¼‚å¸¸ï¼šfatal:inunpopulatedsubmoduleâ€™.deploy_gitâ€™æ€ä¹ˆè§£å†³å®åœ¨ä¸è¡Œï¼Œå°±æŠŠå®ƒåˆ æ‰ï¼Œç„¶åé‡æ–°ç”Ÿæˆå’Œéƒ¨ç½²ã€‚ 1`rm -rf .deploy_git``hexo g``hexo d` Gitå‘½ä»¤æ•´ç†Gité…ç½®git config â€“global user.name â€œrobbinâ€git config â€“global user.email â€œrandyvan007@hotmail.comâ€œgit config â€“global color.ui truegit config â€“global alias.co checkoutgit config â€“global alias.ci commitgit config â€“global alias.st statusgit config â€“global alias.br branchgit config â€“global core.editor â€œmate -wâ€ # è®¾ç½®Editorä½¿ç”¨textmategit config -l # åˆ—ä¸¾æ‰€æœ‰é…ç½®ç”¨æˆ·çš„gité…ç½®æ–‡ä»¶~/.gitconfig Gitå¸¸ç”¨å‘½ä»¤æŸ¥çœ‹ã€æ·»åŠ ã€æäº¤ã€åˆ é™¤ã€æ‰¾å›ï¼Œé‡ç½®ä¿®æ”¹æ–‡ä»¶ 12345678910111213141516171819202122232425git help &lt;command&gt; # æ˜¾ç¤ºcommandçš„helpgit show # æ˜¾ç¤ºæŸæ¬¡æäº¤çš„å†…å®¹git show $idgit co -- &lt;file&gt; # æŠ›å¼ƒå·¥ä½œåŒºä¿®æ”¹git co . # æŠ›å¼ƒå·¥ä½œåŒºä¿®æ”¹git add &lt;file&gt; # å°†å·¥ä½œæ–‡ä»¶ä¿®æ”¹æäº¤åˆ°æœ¬åœ°æš‚å­˜åŒºgit add . # å°†æ‰€æœ‰ä¿®æ”¹è¿‡çš„å·¥ä½œæ–‡ä»¶æäº¤æš‚å­˜åŒºgit rm &lt;file&gt; # ä»ç‰ˆæœ¬åº“ä¸­åˆ é™¤æ–‡ä»¶git rm &lt;file&gt; --cached # ä»ç‰ˆæœ¬åº“ä¸­åˆ é™¤æ–‡ä»¶ï¼Œä½†ä¸åˆ é™¤æ–‡ä»¶git reset &lt;file&gt; # ä»æš‚å­˜åŒºæ¢å¤åˆ°å·¥ä½œæ–‡ä»¶git reset -- . # ä»æš‚å­˜åŒºæ¢å¤åˆ°å·¥ä½œæ–‡ä»¶git reset --hard # æ¢å¤æœ€è¿‘ä¸€æ¬¡æäº¤è¿‡çš„çŠ¶æ€ï¼Œå³æ”¾å¼ƒä¸Šæ¬¡æäº¤åçš„æ‰€æœ‰æœ¬æ¬¡ä¿®æ”¹git ci &lt;file&gt;git ci .git ci -a # å°†git add, git rmå’Œgit ciç­‰æ“ä½œéƒ½åˆå¹¶åœ¨ä¸€èµ·åšgit ci -am "some comments"git ci --amend # ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤è®°å½•git revert &lt;$id&gt; # æ¢å¤æŸæ¬¡æäº¤çš„çŠ¶æ€ï¼Œæ¢å¤åŠ¨ä½œæœ¬èº«ä¹Ÿåˆ›å»ºäº†ä¸€æ¬¡æäº¤å¯¹è±¡git revert HEAD # æ¢å¤æœ€åä¸€æ¬¡æäº¤çš„çŠ¶æ€ æŸ¥çœ‹æ–‡ä»¶diff1234567git diff &lt;file&gt; # æ¯”è¾ƒå½“å‰æ–‡ä»¶å’Œæš‚å­˜åŒºæ–‡ä»¶å·®å¼‚git diffgit diff &lt;$id1&gt; &lt;$id2&gt; # æ¯”è¾ƒä¸¤æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚git diff &lt;branch1&gt;..&lt;branch2&gt; # åœ¨ä¸¤ä¸ªåˆ†æ”¯ä¹‹é—´æ¯”è¾ƒgit diff --staged # æ¯”è¾ƒæš‚å­˜åŒºå’Œç‰ˆæœ¬åº“å·®å¼‚git diff --cached # æ¯”è¾ƒæš‚å­˜åŒºå’Œç‰ˆæœ¬åº“å·®å¼‚git diff --stat # ä»…ä»…æ¯”è¾ƒç»Ÿè®¡ä¿¡æ¯ æŸ¥çœ‹æäº¤è®°å½•1234567git loggit log &lt;file&gt; # æŸ¥çœ‹è¯¥æ–‡ä»¶æ¯æ¬¡æäº¤è®°å½•git log -p &lt;file&gt; # æŸ¥çœ‹æ¯æ¬¡è¯¦ç»†ä¿®æ”¹å†…å®¹çš„diffgit log -p -2 # æŸ¥çœ‹æœ€è¿‘ä¸¤æ¬¡è¯¦ç»†ä¿®æ”¹å†…å®¹çš„diffgit log --stat # æŸ¥çœ‹æäº¤ç»Ÿè®¡ä¿¡æ¯tigMacä¸Šå¯ä»¥ä½¿ç”¨tigä»£æ›¿diffå’Œlogï¼Œbrew install tig Git æœ¬åœ°åˆ†æ”¯ç®¡ç†æŸ¥çœ‹ã€åˆ‡æ¢ã€åˆ›å»ºå’Œåˆ é™¤åˆ†æ”¯ 123456789101112131415git br -r # æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯git br &lt;new_branch&gt; # åˆ›å»ºæ–°çš„åˆ†æ”¯git br -v # æŸ¥çœ‹å„ä¸ªåˆ†æ”¯æœ€åæäº¤ä¿¡æ¯git br --merged # æŸ¥çœ‹å·²ç»è¢«åˆå¹¶åˆ°å½“å‰åˆ†æ”¯çš„åˆ†æ”¯git br --no-merged # æŸ¥çœ‹å°šæœªè¢«åˆå¹¶åˆ°å½“å‰åˆ†æ”¯çš„åˆ†æ”¯git co &lt;branch&gt; # åˆ‡æ¢åˆ°æŸä¸ªåˆ†æ”¯git co -b &lt;new_branch&gt; # åˆ›å»ºæ–°çš„åˆ†æ”¯ï¼Œå¹¶ä¸”åˆ‡æ¢è¿‡å»git co -b &lt;new_branch&gt; &lt;branch&gt; # åŸºäºbranchåˆ›å»ºæ–°çš„new_branchgit co $id # æŠŠæŸæ¬¡å†å²æäº¤è®°å½•checkoutå‡ºæ¥ï¼Œä½†æ— åˆ†æ”¯ä¿¡æ¯ï¼Œåˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯ä¼šè‡ªåŠ¨åˆ é™¤git co $id -b &lt;new_branch&gt; # æŠŠæŸæ¬¡å†å²æäº¤è®°å½•checkoutå‡ºæ¥ï¼Œåˆ›å»ºæˆä¸€ä¸ªåˆ†æ”¯git br -d &lt;branch&gt; # åˆ é™¤æŸä¸ªåˆ†æ”¯git br -D &lt;branch&gt; # å¼ºåˆ¶åˆ é™¤æŸä¸ªåˆ†æ”¯ (æœªè¢«åˆå¹¶çš„åˆ†æ”¯è¢«åˆ é™¤çš„æ—¶å€™éœ€è¦å¼ºåˆ¶) åˆ†æ”¯åˆå¹¶å’Œrebase12345git merge &lt;branch&gt; # å°†branchåˆ†æ”¯åˆå¹¶åˆ°å½“å‰åˆ†æ”¯git merge origin/master --no-ff # ä¸è¦Fast-Fowardåˆå¹¶ï¼Œè¿™æ ·å¯ä»¥ç”Ÿæˆmergeæäº¤git rebase master &lt;branch&gt; # å°†master rebaseåˆ°branchï¼Œç›¸å½“äºï¼šgit co &lt;branch&gt; &amp;&amp; git rebase master &amp;&amp; git co master &amp;&amp; git merge &lt;branch&gt; Gitè¡¥ä¸ç®¡ç†(æ–¹ä¾¿åœ¨å¤šå°æœºå™¨ä¸Šå¼€å‘åŒæ­¥æ—¶ç”¨)123git diff &gt; ../sync.patch # ç”Ÿæˆè¡¥ä¸git apply ../sync.patch # æ‰“è¡¥ä¸git apply --check ../sync.patch # æµ‹è¯•è¡¥ä¸èƒ½å¦æˆåŠŸ Gitæš‚å­˜ç®¡ç†1234git stash # æš‚å­˜git stash list # åˆ—æ‰€æœ‰stashgit stash apply # æ¢å¤æš‚å­˜çš„å†…å®¹git stash drop # åˆ é™¤æš‚å­˜åŒº Gitè¿œç¨‹åˆ†æ”¯ç®¡ç†12345678910111213git pull # æŠ“å–è¿œç¨‹ä»“åº“æ‰€æœ‰åˆ†æ”¯æ›´æ–°å¹¶åˆå¹¶åˆ°æœ¬åœ°git pull --no-ff # æŠ“å–è¿œç¨‹ä»“åº“æ‰€æœ‰åˆ†æ”¯æ›´æ–°å¹¶åˆå¹¶åˆ°æœ¬åœ°ï¼Œä¸è¦å¿«è¿›åˆå¹¶git fetch origin # æŠ“å–è¿œç¨‹ä»“åº“æ›´æ–°git merge origin/master # å°†è¿œç¨‹ä¸»åˆ†æ”¯åˆå¹¶åˆ°æœ¬åœ°å½“å‰åˆ†æ”¯git co --track origin/branch # è·Ÿè¸ªæŸä¸ªè¿œç¨‹åˆ†æ”¯åˆ›å»ºç›¸åº”çš„æœ¬åœ°åˆ†æ”¯git co -b &lt;local_branch&gt; origin/&lt;remote_branch&gt; # åŸºäºè¿œç¨‹åˆ†æ”¯åˆ›å»ºæœ¬åœ°åˆ†æ”¯ï¼ŒåŠŸèƒ½åŒä¸Šgit push # pushæ‰€æœ‰åˆ†æ”¯git push origin master # å°†æœ¬åœ°ä¸»åˆ†æ”¯æ¨åˆ°è¿œç¨‹ä¸»åˆ†æ”¯git push -u origin master # å°†æœ¬åœ°ä¸»åˆ†æ”¯æ¨åˆ°è¿œç¨‹(å¦‚æ— è¿œç¨‹ä¸»åˆ†æ”¯åˆ™åˆ›å»ºï¼Œç”¨äºåˆå§‹åŒ–è¿œç¨‹ä»“åº“)git push origin &lt;local_branch&gt; # åˆ›å»ºè¿œç¨‹åˆ†æ”¯ï¼Œ originæ˜¯è¿œç¨‹ä»“åº“ågit push origin &lt;local_branch&gt;:&lt;remote_branch&gt; # åˆ›å»ºè¿œç¨‹åˆ†æ”¯git push origin :&lt;remote_branch&gt; #å…ˆåˆ é™¤æœ¬åœ°åˆ†æ”¯(git br -d &lt;branch&gt;)ï¼Œç„¶åå†pushåˆ é™¤è¿œç¨‹åˆ†æ”¯ Gitè¿œç¨‹ä»“åº“ç®¡ç†12345git remote -v # æŸ¥çœ‹è¿œç¨‹æœåŠ¡å™¨åœ°å€å’Œä»“åº“åç§°git remote show origin # æŸ¥çœ‹è¿œç¨‹æœåŠ¡å™¨ä»“åº“çŠ¶æ€git remote add origin git@github:robbin/robbin_site.git # æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€git remote set-url origin git@github.com:robbin/robbin_site.git # è®¾ç½®è¿œç¨‹ä»“åº“åœ°å€(ç”¨äºä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€)git remote rm &lt;repository&gt; # åˆ é™¤è¿œç¨‹ä»“åº“ åˆ›å»ºè¿œç¨‹ä»“åº“ 12345678910111213git clone --bare robbin_site robbin_site.git # ç”¨å¸¦ç‰ˆæœ¬çš„é¡¹ç›®åˆ›å»ºçº¯ç‰ˆæœ¬ä»“åº“scp -r my_project.git git@git.csdn.net:~ # å°†çº¯ä»“åº“ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šmkdir robbin_site.git &amp;&amp; cd robbin_site.git &amp;&amp; git --bare init # åœ¨æœåŠ¡å™¨åˆ›å»ºçº¯ä»“åº“git remote add origin git@github.com:robbin/robbin_site.git # è®¾ç½®è¿œç¨‹ä»“åº“åœ°å€git push -u origin master # å®¢æˆ·ç«¯é¦–æ¬¡æäº¤git push -u origin develop # é¦–æ¬¡å°†æœ¬åœ°developåˆ†æ”¯æäº¤åˆ°è¿œç¨‹developåˆ†æ”¯ï¼Œå¹¶ä¸”trackgit remote set-head origin master # è®¾ç½®è¿œç¨‹ä»“åº“çš„HEADæŒ‡å‘masteråˆ†æ”¯ä¹Ÿå¯ä»¥å‘½ä»¤è®¾ç½®è·Ÿè¸ªè¿œç¨‹åº“å’Œæœ¬åœ°åº“git branch --set-upstream master origin/mastergit branch --set-upstream develop origin/develop HappyEndingå®Œæˆï¼Œç»§ç»­ç©æ¸¸æˆï¼ å‚è€ƒé“¾æ¥1 å‚è€ƒé“¾æ¥2 æ„Ÿè°¢ï¼ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢]]></content>
      <tags>
        <tag>æ—¥å¸¸</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Windows10</tag>
        <tag>Hexo</tag>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[WIN10 1809éšè—å¤§æ€å™¨--å“è¶Šæ¨¡å¼]]></title>
    <url>%2F2018%2F07%2F06%2FWIN10-1809%E9%9A%90%E8%97%8F%E5%A4%A7%E6%9D%80%E5%99%A8-%E5%8D%93%E8%B6%8A%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[é“›é“›é“› å¼€ç®±å¿«é€’æ¥äº†ï¼æ–°cpuåˆ°äº†å…¶å®ä¹Ÿä¸ç®—æ–°cpuï¼Œæ¯•ç«Ÿè¿™ä¸ªcpuå·²ç»å‡ºäº†6å¹´äº†ã€‚ æ”¾æš‘å‡äº†ï¼Œæ€»è¦å¨±ä¹ä¸€ä¸‹ã€‚å¥ˆä½•å®¶é‡Œçš„è€ç”µè„‘cpuæ€§èƒ½ä¸å¤§å¤Ÿï¼ˆäºŒä»£i5 @2.9ghzï¼‰ï¼Œå¹²å•¥å•¥ä¸ç—›å¿«ï¼Œå¾ˆæ˜¯è‹¦æ¼ã€‚æ­£å¥½ï¼Œè¶ç€i7 9900Kå°†è¦å‘å”®çš„æ—¶å€™ï¼Œèµ¶å¿«ä¹°äº†ä¸ªE3-1240V2å……å€¼ä¿¡ä»°ï¼ å…ˆæ¥å›é¡¾ä¸€ä¸‹æ–°ä¹°cpuçš„å‚æ•°ã€‚ åŸºæœ¬å‚æ•°CPUç³»åˆ— Xeon E3 v2ç³»åˆ—åˆ¶ä½œå·¥è‰º 22çº³ç±³æ ¸å¿ƒä»£å· Ivy Bridge æ€§èƒ½å‚æ•°æ ¸å¿ƒæ•°é‡ å››æ ¸å¿ƒçº¿ç¨‹æ•°é‡ å…«çº¿ç¨‹CPUä¸»é¢‘ 3.4GHzåŠ¨æ€åŠ é€Ÿé¢‘ç‡ 3.8GHzL3ç¼“å­˜ 8MBæ€»çº¿è§„æ ¼ DMI 5GT/sçƒ­è®¾è®¡åŠŸè€—(TDP) 69W å†…å­˜è§„æ ¼æ”¯æŒæœ€å¤§å†…å­˜å®¹é‡ 32GBå†…å­˜ç±»å‹ DDR3 1333/1600MHzå†…å­˜æè¿° åŒé€šé“DDR3-1333/1600MHz å°è£…è§„æ ¼æ’æ§½ç±»å‹ LGA 1155å°è£…å¤§å° 37.5Ã—37.5mmæœ€å¤§CPUé…ç½® 1é¢— æŠ€æœ¯å‚æ•°ç¿é¢‘åŠ é€ŸæŠ€æœ¯ æ”¯æŒï¼Œ2.0è¶…çº¿ç¨‹æŠ€æœ¯ æ”¯æŒè™šæ‹ŸåŒ–æŠ€æœ¯ Intel VT-xæŒ‡ä»¤é›† AVXï¼ŒSSE4.1ï¼ŒSSE4.264ä½å¤„ç†å™¨ æ”¯æŒå…¶å®ƒæŠ€æœ¯ æ”¯æŒåšé”æŠ€æœ¯ï¼Œå®šå‘I/Oè™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œå¢å¼ºå‹SpeedStepæŠ€æœ¯ï¼ŒæŒ‰éœ€é…ç”µæŠ€æœ¯ï¼Œæ¸©åº¦ç›‘è§†æŠ€æœ¯ï¼Œèº«ä»½ä¿æŠ¤æŠ€æœ¯ï¼Œæ•°æ®ä¿æŠ¤æŠ€æœ¯ï¼Œå¹³å°ä¿æŠ¤æŠ€æœ¯é›†æˆæ˜¾å¡ ä¸æ”¯æŒ è¿™ä¸ªcpuç°åœ¨æ¥çœ‹å‚æ•°ä¸æ€ä¹ˆæ ·ï¼Œæ€§èƒ½ä¹Ÿå¤§æ¦‚æ¯”i3-8100é«˜ä¸€ç‚¹ï¼Œä½†æ˜¯è¿™çš„ç¡®æ˜¯LGA1155å¹³å°ä¸Šæ€§èƒ½æ¯”è¾ƒé«˜çš„äº†ã€‚ä¸å¸¦é›†æˆæ˜¾å¡ï¼Œè§„æ ¼ä¸»é¢‘å’Œi7 3770kå·®ä¸å¤šï¼Œç”±äºæˆ‘è¿™è¾¹è€ä¸»æ¿æ˜¯b75ï¼Œä¸èƒ½ç»™i7è¶…é¢‘ï¼Œæ‰€ä»¥ä¹Ÿå°±æ²¡é€‰ã€‚ è£…æœºè£…æœºè¿‡ç¨‹æ²¡æœ‰æ‹æ‘„ï¼Œä¸Šä¸€ç»„è£…æœºæˆåŠŸçš„BIOSæˆªå›¾å§ã€‚ä¸€æ¬¡æˆåŠŸç‚¹äº®ï¼ç”±äºæˆ‘ä¹°çš„1240v2æ˜¯äºŒå­—å¤´ï¼Œä½“è´¨å¥½ï¼Œå¯ä»¥è°ƒé¢‘ã€‚æœæ–­æŠŠc1ã€c3ã€c6å…³æ‰ï¼ŒèŠ‚ç”µå…³æ‰ï¼Œå†…å­˜è¶…å¯¼1600ï¼Œæ—¶åºé™ä½ä¸€ç‚¹è®¾ç½®æˆå•æ ¸3.8ghzï¼Œæœ€ä½3.6ghz æ¸¸æˆæµ‹è¯•æµ‹è¯•ä¸€ä¸‹æˆ‘æœ€è¿‘å–œæ¬¢ç©çš„æ¸¸æˆï¼ŒæƒŠé­‚5ï¼Œç”»è´¨å…¨é«˜ å®é™…è¿è¡Œè¡¨æ˜ï¼Œæœ€é«˜å¸§81ï¼Œæœ€ä½62ï¼Œå¯ä»¥æµç•…è¿è¡Œã€‚è€Œè€å¹³å°æœ€ä½51ï¼Œæœ€é«˜72ã€‚æµç•…æ€§æœ‰æ˜¾è‘—æå‡ã€‚ win10ç”µæºç®¡ç†â€“å“è¶Šæ¨¡å¼æ¥ä¸‹æ¥æ˜¯æ ‡é¢˜å†…å®¹äº†~ è¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼ŒWin10æ›´æ–°1803ä»¥æ¥ï¼Œå¾®è½¯ä¸ä»…å¸¦æ¥äº†ä¸€äº›æ–°åŠŸèƒ½ï¼ˆå’ŒBUGï¼‰ï¼Œè¿˜æ‚„æ‚„åœ°åŠ å…¥äº†ä¸€ä¸ªâ€œå“è¶Šæ€§èƒ½æ¨¡å¼â€ï¼Œå¼€äº†å®ƒï¼ŒCPUç”µå‹ä¼šæ¯”é«˜æ€§èƒ½æ¨¡å¼æ›´ä½ï¼Œä»è€Œå¸¦æ¥ç›¸å¯¹æ›´ä½ä¸€äº›çš„æ¸©åº¦ä»¥åŠç¨³å®šæ€§ï¼Œå¹¶ä¸”å¯¹å†…å­˜è¶…é¢‘ä¹Ÿæœ‰ä¸€å®šå¸®åŠ© å¼€å¯é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æŒ‰Winé”®æœç´¢å¹¶å³é”®ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€[ Windows Powershell ]ï¼Œ ç„¶åè¾“å…¥powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61ï¼š é‚£ä¹ˆæ­å–œä½ ï¼Œä½ çš„ç”µè„‘å·²ç»æˆåŠŸå¼€å¯äº†â€œå“è¶Šæ€§èƒ½æ¨¡å¼â€ï¼Œåœ¨ç”µæºé€‰é¡¹ä¸­è½»æ¾æ‰¾åˆ°å®ƒå•¦~ ç»“æŸæ­¤ç‰‡å®Œäº†~ å¼€å¯å“è¶Šæ¨¡å¼çš„æ–‡ç« ç½‘ä¸Šä¸€å¤§å †ä¸€å¤§å †çš„ï¼Œè¿™æ¬¡å‘¢é‡ç‚¹è¿˜æ˜¯ä¸»è¦åˆ†äº«ä¸€ä¸‹æˆ‘æ¢cpuçš„æ•…äº‹ã€‚å½“ç„¶ï¼Œâ€œå“è¶Šæ€§èƒ½â€åŸºæœ¬å¯ä»¥ä»£æ›¿â€œé«˜æ€§èƒ½â€æ¨¡å¼ä½¿ç”¨ï¼Œæ¯•ç«Ÿæœ‰äº†ï¼ˆçœ‹èµ·æ¥ï¼‰æ›´å¥½çš„è‡ªç„¶å°±é€‰æ‹©æ›´å¥½çš„äº†ã€‚å¹¶ä¸”éå¸¸æ¨èå–œæ¬¢è¶…è¶…é¢‘ã€ç©ç¡¬ä»¶çš„ç”¨æˆ·ä½¿ç”¨ï¼Œå› ä¸ºç¡®å®æœ‰æ€§èƒ½æå‡ï¼Œèƒ½å¼€å°±å¼€å§ã€‚]]></content>
      <tags>
        <tag>æ—¥å¸¸</tag>
        <tag>æŠ€æœ¯</tag>
        <tag>Windows10</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[=_=æˆ‘çš„ä¸Šä¸€ä¸ªåšå®¢è¢«æ”»å‡»ç˜«ç—ªäº†=_=]]></title>
    <url>%2F2018%2F07%2F04%2FHelloWorld%2F</url>
    <content type="text"><![CDATA[åˆšåˆšç»“æŸæœŸæœ«è€ƒè¯•ï¼Œå‘¼å‘¼(_ _)ã‚œzï½šï¼ºï¼Œç´¯æ­»äº†ã€‚ ä¸€æƒ³åˆ°åŸæ¥çš„åšå®¢æ²¡æœ‰äº†ï¼Œ è¿˜è¦åœ¨æ­ä¸€ä¸ªï¼Œå°±æ›´ç´¯äº†ï¼ ä¸‡äº‹å¼€å¤´éš¾ï¼ŒhelloWorldä¸èƒ½ä¸å†™ã€‚è€Œä¸”å› ä¸ºä¸æ˜¯ç¬¬ä¸€æ¬¡å†™HelloWorldäº†ï¼Œæ‰€ä»¥è¿™æ¬¡å†™çš„ç®€å•ç‚¹å§ã€‚ å“¦ï¼Œå¿˜äº†äº¤ä»£äº†ï¼Œæˆ‘çš„ä¸Šä¸€ä¸ªåšå®¢æŒ‚æ‰äº†ï¼Œ è¢«DDOSæ”»å‡»æ”»å‡»ï¼Œæ”»å‡»å®Œäº†æš‚ä¸”ä¸è¯´ï¼Œç™»é™†å¯†ç åˆè¢«æš´åŠ›ç ´è§£äº†ã€‚å“ï¼Œéš¾å—ï¼Œå›¾çœé’±ä¹°çš„OpenVZæœåŠ¡å™¨ï¼Œæ”»å‡»ååœ¨æ•°æ®ä¸­å¿ƒç®¡ç†å‘˜çš„å‡ ç»ç¡®è®¤ä¸‹ï¼Œè¢«åˆ¤å®šæ­»äº¡ã€‚æ•°æ®æ— æ³•ä¿®å¤ï¼Œå†…æ ¸è¢«ç ´åï¼Œæ— æ³•å¯åŠ¨ã€‚ è€Œæˆ‘ä¹Ÿæ²¡æœ‰è®¾ç½®å¤‡ä»½ï¼ˆè¿˜ä¸æ˜¯å› ä¸ºæ‡’ï¼ï¼‰ï¼Œé›ªä¸ŠåŠ éœœï¼ ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜• æœ¬çˆ¶äº²å¥½éš¾å—ï¼ ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜•ğŸ˜• è¿™æ¬¡æˆ‘å­¦ä¹–äº†ï¼Œæ–°çš„åšå®¢æ­å»ºåœ¨GithubPageä¸Šï¼Œé»‘å®¢ä½ ä»¬éšä¾¿æ”»å‡»ï¼Œå¤§ä¸äº†å°±æ²¡æœ‰æµé‡ã€‚å¾…è€å¤«æœ‰é’±äº†ï¼Œå°±å»æ¶ˆè´¹ä¸ªCDNï¼Œçˆ±å’‹åœ°åœ¨åœ°ã€‚ è¡Œï¼Œå°±è¿™æ ·å§ï¼Œ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢]]></content>
      <tags>
        <tag>æ—¥å¸¸</tag>
        <tag>åˆ</tag>
      </tags>
  </entry>
</search>
