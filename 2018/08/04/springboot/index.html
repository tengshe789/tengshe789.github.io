<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">




  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="google-site-verification" content="A1lh6qh2KG4qHp1egv4rR8POayZtKMsUVAbq3sk2XOc">



  <meta name="msvalidate.01" content="0EF0AB564911357C367CABC34BA94C40">












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=1.0.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png?v=1.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png?v=1.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png?v=1.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=1.0.0" color="#222">





  <meta name="keywords" content="æŠ€æœ¯,java,Spring,">





  <link rel="alternate" href="/atom.xml" title="tEngSHe789ã®å°ç«™" type="application/atom+xml">






<meta name="description" content="æœ€è¿‘å†ç ”ç©¶springbootçš„åŸç†ğŸ˜‹é¢‡æœ‰æ”¶è·ï¼Œç°åœ¨è®©æˆ‘åˆ†äº«ä¸€ä¸‹springbootå¦‚ä½•ä½¿ç”¨å§~ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ å•¥æ˜¯Springbootå’Œä¹¦ä¸Šç†è§£çš„ä¸åŒï¼Œæˆ‘è®¤ä¸ºSpringbootæ˜¯ä¸€ä¸ªä¼˜ç§€çš„å¿«é€Ÿæ­å»ºæ¡†æ¶ï¼Œä»–é€šè¿‡mavenç»§æ‰¿æ–¹å¼æ·»åŠ ä¾èµ–æ¥æ•´åˆå¾ˆå¤šç¬¬ä¸‰æ–¹å·¥å…·ï¼Œå¯ä»¥é¿å…å„ç§éº»çƒ¦çš„é…ç½®ï¼Œæœ‰å„ç§å†…åµŒå®¹å™¨ç®€åŒ–Webé¡¹ç›®ï¼Œè¿˜èƒ½é¿å…ä¾èµ–çš„å¹²æ‰°ï¼Œå®ƒå†…ç½®tomcatï¼Œjettyå®¹å™¨ï¼Œä½¿ç”¨çš„">
<meta name="keywords" content="æŠ€æœ¯,java,Spring">
<meta property="og:type" content="article">
<meta property="og:title" content="è¿™æ˜¯ä¸€ç¯‡ä¼˜é›…çš„Springboot2.0ä½¿ç”¨æ‰‹å†Œ">
<meta property="og:url" content="https://tengshe789.github.io/2018/08/04/springboot/index.html">
<meta property="og:site_name" content="tEngSHe789ã®å°ç«™">
<meta property="og:description" content="æœ€è¿‘å†ç ”ç©¶springbootçš„åŸç†ğŸ˜‹é¢‡æœ‰æ”¶è·ï¼Œç°åœ¨è®©æˆ‘åˆ†äº«ä¸€ä¸‹springbootå¦‚ä½•ä½¿ç”¨å§~ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ å•¥æ˜¯Springbootå’Œä¹¦ä¸Šç†è§£çš„ä¸åŒï¼Œæˆ‘è®¤ä¸ºSpringbootæ˜¯ä¸€ä¸ªä¼˜ç§€çš„å¿«é€Ÿæ­å»ºæ¡†æ¶ï¼Œä»–é€šè¿‡mavenç»§æ‰¿æ–¹å¼æ·»åŠ ä¾èµ–æ¥æ•´åˆå¾ˆå¤šç¬¬ä¸‰æ–¹å·¥å…·ï¼Œå¯ä»¥é¿å…å„ç§éº»çƒ¦çš„é…ç½®ï¼Œæœ‰å„ç§å†…åµŒå®¹å™¨ç®€åŒ–Webé¡¹ç›®ï¼Œè¿˜èƒ½é¿å…ä¾èµ–çš„å¹²æ‰°ï¼Œå®ƒå†…ç½®tomcatï¼Œjettyå®¹å™¨ï¼Œä½¿ç”¨çš„">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://tengshe789.github.io/2018/08/04/springboot/1.png">
<meta property="og:image" content="https://tengshe789.github.io/2018/08/04/springboot/2.png">
<meta property="og:image" content="https://tengshe789.github.io/2018/08/04/springboot/3.png">
<meta property="og:image" content="https://tengshe789.github.io/2018/08/04/springboot/8.jpg">
<meta property="og:image" content="https://tengshe789.github.io/2018/08/04/springboot/4.png">
<meta property="og:image" content="https://tengshe789.github.io/2018/08/04/springboot/5.png">
<meta property="og:image" content="https://tengshe789.github.io/2018/08/04/springboot/6.jpg">
<meta property="og:image" content="https://tengshe789.github.io/2018/08/04/springboot/7.png">
<meta property="og:updated_time" content="2019-11-20T13:39:40.738Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è¿™æ˜¯ä¸€ç¯‡ä¼˜é›…çš„Springboot2.0ä½¿ç”¨æ‰‹å†Œ">
<meta name="twitter:description" content="æœ€è¿‘å†ç ”ç©¶springbootçš„åŸç†ğŸ˜‹é¢‡æœ‰æ”¶è·ï¼Œç°åœ¨è®©æˆ‘åˆ†äº«ä¸€ä¸‹springbootå¦‚ä½•ä½¿ç”¨å§~ æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®æˆ‘çš„åšå®¢ å•¥æ˜¯Springbootå’Œä¹¦ä¸Šç†è§£çš„ä¸åŒï¼Œæˆ‘è®¤ä¸ºSpringbootæ˜¯ä¸€ä¸ªä¼˜ç§€çš„å¿«é€Ÿæ­å»ºæ¡†æ¶ï¼Œä»–é€šè¿‡mavenç»§æ‰¿æ–¹å¼æ·»åŠ ä¾èµ–æ¥æ•´åˆå¾ˆå¤šç¬¬ä¸‰æ–¹å·¥å…·ï¼Œå¯ä»¥é¿å…å„ç§éº»çƒ¦çš„é…ç½®ï¼Œæœ‰å„ç§å†…åµŒå®¹å™¨ç®€åŒ–Webé¡¹ç›®ï¼Œè¿˜èƒ½é¿å…ä¾èµ–çš„å¹²æ‰°ï¼Œå®ƒå†…ç½®tomcatï¼Œjettyå®¹å™¨ï¼Œä½¿ç”¨çš„">
<meta name="twitter:image" content="https://tengshe789.github.io/2018/08/04/springboot/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '1.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://tengshe789.github.io/2018/08/04/springboot/">


<!-- è°·æ­ŒAdSense -->
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-7659349864173199",
    enable_page_level_ads: true
  });
</script>
<!-- å¿ƒæ™ºå¤©æ°” -->
<script>(function(T,h,i,n,k,P,a,g,e){g=function(){P=h.createElement(i);a=h.getElementsByTagName(i)[0];P.src=k;P.charset="utf-8";P.async=1;a.parentNode.insertBefore(P,a)};T["ThinkPageWeatherWidgetObject"]=n;T[n]||(T[n]=function(){(T[n].q=T[n].q||[]).push(arguments)});T[n].l=+new Date();if(T.attachEvent){T.attachEvent("onload",g)}else{T.addEventListener("load",g,false)}}(window,document,"script","tpwidget","//widget.seniverse.com/widget/chameleon.js"))</script>
<script>tpwidget("init", {
    "flavor": "bubble",
    "location": "WWMT5Q64CR3G",
    "geolocation": "enabled",
    "position": "bottom-right",
    "margin": "10px 10px",
    "language": "zh-chs",
    "unit": "c",
    "theme": "chameleon",
    "uid": "UFA58EE03C",
    "hash": "f8aaef53e1c80162af9fcce01022efec"
});
tpwidget("show");</script>

  <title>è¿™æ˜¯ä¸€ç¯‡ä¼˜é›…çš„Springboot2.0ä½¿ç”¨æ‰‹å†Œ | tEngSHe789ã®å°ç«™</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">tEngSHe789ã®å°ç«™</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">éšæ€§è€Œè¡Œï¼Œä¸è¡Œæ‹‰å€’</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>
            
            å…¬ç›Š404
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            æœç´¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="æœç´¢..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-7659349864173199",
    enable_page_level_ads: true
  });
</script>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://tengshe789.github.io/2018/08/04/springboot/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="tEngSHe789">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tEngSHe789ã®å°ç«™">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">è¿™æ˜¯ä¸€ç¯‡ä¼˜é›…çš„Springboot2.0ä½¿ç”¨æ‰‹å†Œ</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-08-04T21:58:47+08:00">
                2018-08-04
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/08/04/springboot/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2018/08/04/springboot/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2018/08/04/springboot/" class="leancloud_visitors" data-flag-title="è¿™æ˜¯ä¸€ç¯‡ä¼˜é›…çš„Springboot2.0ä½¿ç”¨æ‰‹å†Œ">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">å­—æ•°ç»Ÿè®¡&#58;</span>
                
                <span title="å­—æ•°ç»Ÿè®¡">
                  12,031
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
                
                <span title="é˜…è¯»æ—¶é•¿">
                  55
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        <p>æœ€è¿‘å†ç ”ç©¶springbootçš„åŸç†ğŸ˜‹é¢‡æœ‰æ”¶è·ï¼Œç°åœ¨è®©æˆ‘åˆ†äº«ä¸€ä¸‹springbootå¦‚ä½•ä½¿ç”¨å§~</p>
<p>æƒ³è¦è§£é”æ›´å¤šæ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®<a href="https://blog.tengshe789.tech/" target="_blank" rel="noopener">æˆ‘çš„åšå®¢</a></p>
<h2 id="å•¥æ˜¯Springboot"><a href="#å•¥æ˜¯Springboot" class="headerlink" title="å•¥æ˜¯Springboot"></a>å•¥æ˜¯Springboot</h2><p>å’Œä¹¦ä¸Šç†è§£çš„ä¸åŒï¼Œæˆ‘è®¤ä¸ºSpringbootæ˜¯ä¸€ä¸ªä¼˜ç§€çš„å¿«é€Ÿæ­å»ºæ¡†æ¶ï¼Œä»–é€šè¿‡mavenç»§æ‰¿æ–¹å¼æ·»åŠ ä¾èµ–æ¥æ•´åˆå¾ˆå¤šç¬¬ä¸‰æ–¹å·¥å…·ï¼Œå¯ä»¥é¿å…å„ç§éº»çƒ¦çš„é…ç½®ï¼Œæœ‰å„ç§å†…åµŒå®¹å™¨ç®€åŒ–Webé¡¹ç›®ï¼Œè¿˜èƒ½é¿å…ä¾èµ–çš„å¹²æ‰°ï¼Œå®ƒå†…ç½®tomcatï¼Œjettyå®¹å™¨ï¼Œä½¿ç”¨çš„æ˜¯java appè¿è¡Œç¨‹åºï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„ç”¨æŠŠwaræ”¾åœ¨tomcatç­‰å®¹å™¨ä¸­è¿è¡Œ</p>
<h3 id="å’ŒJFinalçš„åŒºåˆ«"><a href="#å’ŒJFinalçš„åŒºåˆ«" class="headerlink" title="å’ŒJFinalçš„åŒºåˆ«"></a>å’ŒJFinalçš„åŒºåˆ«</h3><p>JFinalæ˜¯å›½äººå‡ºå“çš„ä¸€ä¸ªweb + orm æ¡†æ¶ ï¼Œ<a href="http://www.jfinal.com/" target="_blank" rel="noopener">JFinal</a>ï¼Œä¼˜ç‚¹æ˜¯å¼€å‘è¿…é€Ÿã€ä»£ç é‡å°‘ã€å­¦ä¹ ç®€å•ã€åŠŸèƒ½å¼ºå¤§ã€è½»é‡çº§ã€æ˜“æ‰©å±•ã€‚æ ¸å¿ƒå°±æ˜¯æè‡´ç®€æ´ã€‚ä»–æ²¡æœ‰å•†ä¸šæœºæ„çš„æ”¯æŒï¼Œæ‰€ä»¥å®£ä¼ ä¸åˆ°ä½ï¼Œå°‘æœ‰äººçŸ¥ã€‚</p>
<p>Springbootç›¸æ¯”ä¸JFinalæœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯æ”¯æŒçš„åŠŸèƒ½éå¸¸å¤šï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„å°†springçš„å„ç§æ¡†æ¶å¦‚springframework , spring-mvc, spring-security, spring-data-jpa, spring-cacheç­‰ç­‰é›†æˆèµ·æ¥è¿›è¡Œè‡ªåŠ¨åŒ–é…ç½® ï¼Œè€Œä¸”ç”Ÿæ€ æ¯”è¾ƒå¥½ï¼Œå¾ˆå¤šäº§å“éƒ½å¯¹Springbootåšå‡ºä¸€å®šæ”¯æŒã€‚</p>
<h3 id="ä¸Springcloudçš„åŒºåˆ«"><a href="#ä¸Springcloudçš„åŒºåˆ«" class="headerlink" title="ä¸Springcloudçš„åŒºåˆ«"></a>ä¸Springcloudçš„åŒºåˆ«</h3><p>å¯ä»¥è¿™ä¹ˆç†è§£ï¼ŒSpringbooté‡Œé¢åŒ…å«äº†Springcloudï¼ŒSpringcloudåªæ˜¯Springbooté‡Œé¢çš„ä¸€ä¸ªç»„ä»¶è€Œå·²ã€‚</p>
<p>Springcloudæä¾›äº†ç›¸å½“å®Œæ•´çš„å¾®æœåŠ¡æ¶æ„ã€‚è€Œå¾®æœåŠ¡æ¶æ„ï¼Œæœ¬è´¨æ¥è¯´å°±æ˜¯åˆ†å¸ƒå¼æ¶æ„ï¼Œæ„å‘³ç€ä½ è¦å°†åŸæ¥æ˜¯ä¸€ä¸ªæ•´ä½“çš„é¡¹ç›®æ‹†åˆ†æˆä¸€ä¸ªä¸ªçš„å°å‹é¡¹ç›®ï¼Œç„¶ååˆ©ç”¨æŸç§æœºåˆ¶å°†å…¶è”åˆèµ·æ¥ï¼Œä¾‹å¦‚æœåŠ¡æ²»ç†ã€é€šä¿¡æ¡†æ¶ç­‰åŸºç¡€è®¾æ–½ã€‚</p>
<h3 id="SpringBootå’ŒSpringMVCåŒºåˆ«"><a href="#SpringBootå’ŒSpringMVCåŒºåˆ«" class="headerlink" title="SpringBootå’ŒSpringMVCåŒºåˆ«"></a>SpringBootå’ŒSpringMVCåŒºåˆ«</h3><p>SpringBootçš„Webç»„ä»¶ï¼Œé»˜è®¤é›†æˆçš„æ˜¯SpringMVCæ¡†æ¶ã€‚</p>
<h2 id="å¿«é€Ÿä½¿ç”¨"><a href="#å¿«é€Ÿä½¿ç”¨" class="headerlink" title="å¿«é€Ÿä½¿ç”¨"></a>å¿«é€Ÿä½¿ç”¨</h2><p>è¦å¾€ä¸‹çœ‹çš„è¯ï¼Œæ³¨æ„äº†ğŸ‘‡</p>
<ul>
<li>Springboot 2.x è¦æ±‚ JDK 1.8 ç¯å¢ƒåŠä»¥ä¸Šç‰ˆæœ¬ã€‚å¦å¤–ï¼ŒSpringboot  2.x åªå…¼å®¹ Spring Framework 5.0 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚</li>
<li>ä¸º Springboot 2.x æä¾›äº†ç›¸å…³ä¾èµ–æ„å»ºå·¥å…·æ˜¯ Mavenï¼Œç‰ˆæœ¬éœ€è¦ 3.2 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ä½¿ç”¨ Gradle åˆ™éœ€è¦ 1.12 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚</li>
<li>å»ºè®®ç”¨IntelliJ IDEA IntelliJ IDEA ï¼ˆç®€ç§° IDEAï¼‰</li>
</ul>
<h3 id="å»ºç«‹é¡¹ç›®"><a href="#å»ºç«‹é¡¹ç›®" class="headerlink" title="å»ºç«‹é¡¹ç›®"></a>å»ºç«‹é¡¹ç›®</h3><p>æˆ‘å·²ç»å¥½ä¹…æ²¡ç”¨Eclipseäº†ï¼Œè¦çŸ¥é“Eclipseæ˜¯åˆ›å»ºä¸€ä¸ªmavené¡¹ç›®åœ¨å¼•å…¥Springbootä¾èµ–åˆ›å»ºçš„ã€‚</p>
<p>ä¸‹é¢æˆ‘åˆ†äº«ä¸€ä¸‹ç”¨IDEAåˆ›å»ºSpringbootçš„æ–¹æ³•ã€‚</p>
<p><img src="/2018/08/04/springboot/1.png" alt="1533536250534"></p>
<p>å¾ˆç®€å•ï¼Œåœ¨è¿™ä¸ªç•Œé¢é‡Œé¢å°±å¯ä»¥åˆ›å»ºSpringbootäº†ã€‚æ¥ä¸‹æ¥åœ¨æ·»åŠ ä¸€äº›ç»„ä»¶ã€‚</p>
<p><img src="/2018/08/04/springboot/2.png" alt="1533536423232"></p>
<p>å¤§åŠŸå‘Šæˆï¼</p>
<h3 id="å†™ä¸€ä¸ªDEMO"><a href="#å†™ä¸€ä¸ªDEMO" class="headerlink" title="å†™ä¸€ä¸ªDEMO"></a>å†™ä¸€ä¸ªDEMO</h3><p>è¿™é‡Œç”¨æˆ‘å†™çš„ä¸€ä¸ªç§’æ€é¡¹ç›®ä½œä¸ºå‚è€ƒæ —å­ã€‚<a href="https://github.com/tengshe789/-miaosha" target="_blank" rel="noopener">ç§’æ€å•†åŸ</a></p>
<p>åˆ›å»ºä¸€ä¸ªconntrolleråŒ…ï¼Œç¼–å†™ä¸€ä¸ªæ ·åˆ—ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.tengshe789.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/demo"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SampleController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello World"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥åœ¨ä»–<strong>åŒçº§åŒ…</strong>æˆ–è€…<strong>ä¸Šä¸€çº§çš„åŒ…</strong>å†…ï¼Œåˆ›å»ºä¸€ä¸ªä¸»æ–¹æ³•<code>MainApplication</code>ã€‚æ–¹æ³•å†…å®¹;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableAsync</span></span><br><span class="line"><span class="comment">//@ComponentScan("cn.tengshe789.controller")</span></span><br><span class="line"><span class="comment">//@EnableAutoConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(MainApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨æµè§ˆå™¨è¾“å…¥<a href="http://127.0.0.1:8080/demo/hello/ï¼Œå°±å¯ä»¥å¯åŠ¨äº†ï¼" target="_blank" rel="noopener">http://127.0.0.1:8080/demo/hello/ï¼Œå°±å¯ä»¥å¯åŠ¨äº†ï¼</a></p>
<h4 id="SpringApplication-run"><a href="#SpringApplication-run" class="headerlink" title="SpringApplication.run"></a>SpringApplication.<em>run</em></h4><p>Springbootå°†ä»–æ ‡è¯†ä¸ºå¯åŠ¨ç±»ï¼Œç”¨å®ƒå¯åŠ¨Springbooté¡¹ç›®</p>
<h3 id="åŸºç¡€æ³¨è§£è§£é‡Š"><a href="#åŸºç¡€æ³¨è§£è§£é‡Š" class="headerlink" title="åŸºç¡€æ³¨è§£è§£é‡Š"></a>åŸºç¡€æ³¨è§£è§£é‡Š</h3><h4 id="RestController"><a href="#RestController" class="headerlink" title="@RestController"></a>@RestController</h4><p>åœ¨ä¸ŠåŠ ä¸ŠRestController è¡¨ç¤ºä¿®é¥°è¯¥Controlleræ‰€æœ‰çš„æ–¹æ³•è¿”å›JSONæ ¼å¼,ç›´æ¥å¯ä»¥ç¼–å†™Restfulæ¥å£ã€‚å°±ç›¸å½“äº<code>@Controller</code>+<code>@ResponseBody</code>è¿™ç§å®ç°</p>
<h4 id="SpringBootApplication"><a href="#SpringBootApplication" class="headerlink" title="@SpringBootApplication"></a>@SpringBootApplication</h4><p>ç”¨åœ¨å¯åŠ¨Springbootä¸­ï¼Œç›¸å½“äº<code>@ComponentScan</code>+<code>@EnableAutoConfiguration</code>+<code>@Configuration</code></p>
<h4 id="ComponentScan-â€œcn-tengshe789-controllerâ€"><a href="#ComponentScan-â€œcn-tengshe789-controllerâ€" class="headerlink" title="@ComponentScan(â€œcn.tengshe789.controllerâ€)"></a>@ComponentScan(â€œcn.tengshe789.controllerâ€)</h4><p>æ§åˆ¶å™¨æ‰«åŒ…èŒƒå›´ã€‚</p>
<h4 id="EnableAutoConfiguration"><a href="#EnableAutoConfiguration" class="headerlink" title="@EnableAutoConfiguration"></a>@EnableAutoConfiguration</h4><p>ä»–è®© Spring Boot æ ¹æ®å’±åº”ç”¨æ‰€å£°æ˜çš„ä¾èµ–æ¥å¯¹ Spring æ¡†æ¶è¿›è¡Œè‡ªåŠ¨é…ç½®ã€‚æ„æ€æ˜¯ï¼Œåˆ›å»ºé¡¹ç›®æ—¶æ·»åŠ çš„spring-boot-starter-webæ·»åŠ äº†Tomcatå’ŒSpring MVCï¼Œæ‰€ä»¥auto-configurationå°†å‡å®šä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªwebåº”ç”¨å¹¶ç›¸åº”åœ°å¯¹Springè¿›è¡Œè®¾ç½®ã€‚</p>
<h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><h3 id="properties"><a href="#properties" class="headerlink" title="properties"></a>properties</h3><p>è§„åˆ™ï¼š</p>
<p>1ã€åç”¨å¤§å†™æ¯”è¾ƒè§„èŒƒ</p>
<p>2ã€=ä¸¤è¾¹åˆ«æ‰“ç©ºæ ¼</p>
<p>3ã€åå€¼å¯¹å†™å®Œååˆ«æ‰“åˆ†å·</p>
<h4 id="è‡ªå®šä¹‰å‚æ•°"><a href="#è‡ªå®šä¹‰å‚æ•°" class="headerlink" title="è‡ªå®šä¹‰å‚æ•°"></a>è‡ªå®šä¹‰å‚æ•°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=tengshe789</span><br></pre></td></tr></table></figure>
<h4 id="å¤šç¯å¢ƒé…ç½®"><a href="#å¤šç¯å¢ƒé…ç½®" class="headerlink" title="å¤šç¯å¢ƒé…ç½®"></a>å¤šç¯å¢ƒé…ç½®</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spring.profiles.active=pre</span><br><span class="line"></span><br><span class="line">application-dev.propertiesï¼šå¼€å‘ç¯å¢ƒ</span><br><span class="line">application-test.propertiesï¼šæµ‹è¯•ç¯å¢ƒ</span><br><span class="line">application-prod.propertiesï¼šç”Ÿäº§ç¯å¢ƒ</span><br></pre></td></tr></table></figure>
<h4 id="ä¿®æ”¹ç«¯å£å·"><a href="#ä¿®æ”¹ç«¯å£å·" class="headerlink" title="ä¿®æ”¹ç«¯å£å·"></a>ä¿®æ”¹ç«¯å£å·</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server.port=8888 </span><br><span class="line">server.context-path=/tengshe789</span><br></pre></td></tr></table></figure>
<h3 id="yaml"><a href="#yaml" class="headerlink" title="yaml"></a>yaml</h3><p>è§„åˆ™ï¼š</p>
<ol>
<li>ä½¿ç”¨ç©ºæ ¼ Space ç¼©è¿›è¡¨ç¤ºåˆ†å±‚ï¼Œä¸åŒå±‚æ¬¡ä¹‹é—´çš„ç¼©è¿›å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç©ºæ ¼æ•°ç›®ï¼Œä½†æ˜¯åŒå±‚å…ƒç´ ä¸€å®šå·¦å¯¹é½ï¼Œå³å‰é¢ç©ºæ ¼æ•°ç›®ç›¸åŒï¼ˆä¸èƒ½ä½¿ç”¨ Tabï¼Œå„ä¸ªç³»ç»Ÿ Tabå¯¹åº”çš„ Space æ•°ç›®å¯èƒ½ä¸åŒï¼Œå¯¼è‡´å±‚æ¬¡æ··ä¹±ï¼‰</li>
<li>â€˜#â€™è¡¨ç¤ºæ³¨é‡Šï¼Œåªèƒ½å•è¡Œæ³¨é‡Šï¼Œä»#å¼€å§‹å¤„åˆ°è¡Œå°¾</li>
<li>ç ´æŠ˜å·åé¢è·Ÿä¸€ä¸ªç©ºæ ¼ï¼ˆa dash and spaceï¼‰è¡¨ç¤ºåˆ—è¡¨</li>
<li>ç”¨å†’å·å’Œç©ºæ ¼è¡¨ç¤ºé”®å€¼å¯¹ key: value</li>
<li>ç®€å•æ•°æ®ï¼ˆscalarsï¼Œæ ‡é‡æ•°æ®ï¼‰å¯ä»¥ä¸ä½¿ç”¨å¼•å·æ‹¬èµ·æ¥ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²æ•°æ®ã€‚ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·æ‹¬èµ·æ¥çš„è¢«å½“ä½œå­—ç¬¦ä¸²æ•°æ®ï¼Œåœ¨å•å¼•å·æˆ–åŒå¼•å·ä¸­ä½¿ç”¨Cé£æ ¼çš„è½¬ä¹‰å­—ç¬¦</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line"><span class="attr">  port:</span>  <span class="number">8080</span></span><br><span class="line"><span class="attr">  context-path:</span> <span class="string">/springboot</span></span><br></pre></td></tr></table></figure>
<h3 id="xml"><a href="#xml" class="headerlink" title="xml"></a>xml</h3><p>Springbootå®˜æ–¹ä¸æ¨èxmlï¼Œç•¥</p>
<h2 id="Webå¼€å‘"><a href="#Webå¼€å‘" class="headerlink" title="Webå¼€å‘"></a>Webå¼€å‘</h2><p>ä¸€ä¸ªé¡¹ç›®ç”¨Springbootï¼Œåæœ‰å…«ä¹å°±æ˜¯ç”¨äºWebå¼€å‘ã€‚é¦–å…ˆè®©æˆ‘ä»¬çœ‹çœ‹Springbootæ€ä¹ˆå¿«é€Ÿå¼€å‘WebæŠŠ</p>
<h3 id="å¦‚ä½•è®¿é—®é™æ€èµ„æº"><a href="#å¦‚ä½•è®¿é—®é™æ€èµ„æº" class="headerlink" title="å¦‚ä½•è®¿é—®é™æ€èµ„æº"></a>å¦‚ä½•è®¿é—®é™æ€èµ„æº</h3><p>è¯·åœ¨resourcesç›®å½•ä¸‹åˆ›å»ºstaticæ–‡ä»¶å¤¹ï¼Œåœ¨è¯¥ä½ç½®æ”¾ç½®ä¸€ä¸ªé™æ€èµ„æºã€‚</p>
<p>ç›®å½•ï¼šsrc/main/resources/static</p>
<p><img src="/2018/08/04/springboot/3.png" alt="1533537772267"></p>
<p>å¯åŠ¨ç¨‹åºåï¼Œå°è¯•è®¿é—®<a href="http://localhost:8080/img.xxx/ã€‚å°±å¯ä»¥è®¿é—®äº†ã€‚" target="_blank" rel="noopener">http://localhost:8080/img.xxx/ã€‚å°±å¯ä»¥è®¿é—®äº†ã€‚</a></p>
<h3 id="å…³äºæ¸²æŸ“Webé¡µé¢"><a href="#å…³äºæ¸²æŸ“Webé¡µé¢" class="headerlink" title="å…³äºæ¸²æŸ“Webé¡µé¢"></a>å…³äºæ¸²æŸ“Webé¡µé¢</h3><p>åœ¨ä¹‹å‰çš„å¿«é€Ÿä½¿ç”¨çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯é€šè¿‡æ·»åŠ <code>@RestController</code>æ¥å¤„ç†è¯·æ±‚ï¼Œæ‰€ä»¥è¿”å›çš„å†…å®¹ä¸º<code>json</code>å¯¹è±¡ã€‚é‚£ä¹ˆå¦‚æœéœ€è¦æ¸²æŸ“htmlé¡µé¢çš„æ—¶å€™ï¼Œè¦å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p>
<h4 id="æ¨¡æ¿å¼•æ“æ–¹æ³•"><a href="#æ¨¡æ¿å¼•æ“æ–¹æ³•" class="headerlink" title="æ¨¡æ¿å¼•æ“æ–¹æ³•"></a>æ¨¡æ¿å¼•æ“æ–¹æ³•</h4><p>Springbootä¾ç„¶å¯ä»¥å®ç°åŠ¨æ€HTMLï¼Œå¹¶ä¸”æä¾›äº†å¤šç§æ¨¡æ¿å¼•æ“çš„é»˜è®¤é…ç½®æ”¯æŒï¼ŒSpringbootå®˜æ–¹æ–‡æ¡£æœ‰å¦‚ä¸‹æ¨èçš„æ¨¡æ¿å¼•æ“ï¼š</p>
<p>Â·         Thymeleaf</p>
<p>Â·         FreeMarker</p>
<p>Â·         Velocity</p>
<p>Â·         Groovy</p>
<p>Â·         Mustache</p>
<p>Springbootå®˜æ–¹å»ºè®®é¿å…ä½¿ç”¨JSPï¼Œè‹¥ä¸€å®šè¦ä½¿ç”¨JSPå°†æ— æ³•å®ç°Spring Bootçš„å¤šç§ç‰¹æ€§ã€‚</p>
<p>åœ¨Springbootä¸­ï¼Œé»˜è®¤çš„æ¨¡æ¿é…ç½®è·¯å¾„éƒ½æ—¶ï¼šsrc/main/resources/templatesã€‚å½“ç„¶ä¹Ÿå¯ä»¥ä¿®æ”¹è¿™ä¸ªè·¯å¾„ï¼Œå…·ä½“å¦‚ä½•ä¿®æ”¹ï¼Œå¯åœ¨å„æ¨¡æ¿å¼•æ“çš„é…ç½®å±æ€§ä¸­æŸ¥è¯¢å¹¶ä¿®æ”¹ã€‚</p>
<h3 id="Thymeleafï¼ˆèƒ¸è…ºï¼‰"><a href="#Thymeleafï¼ˆèƒ¸è…ºï¼‰" class="headerlink" title="Thymeleafï¼ˆèƒ¸è…ºï¼‰"></a>Thymeleafï¼ˆèƒ¸è…ºï¼‰</h3><p>è¿™é‡Œè¿˜æ˜¯ç”¨æˆ‘å†™çš„ä¸€ä¸ªç§’æ€é¡¹ç›®ä½œä¸ºå‚è€ƒæ —å­ã€‚<a href="https://github.com/tengshe789/-miaosha" target="_blank" rel="noopener">ç§’æ€å•†åŸ</a></p>
<h4 id="POM"><a href="#POM" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®æ–‡ä»¶-1"><a href="#é…ç½®æ–‡ä»¶-1" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><p>åœ¨<code>application.properties</code>ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#thymeleaf</span><br><span class="line">spring.thymeleaf.prefix=classpath:/templates/</span><br><span class="line">spring.thymeleaf.suffix=.html</span><br><span class="line">spring.thymeleaf.cache=false</span><br><span class="line">spring.thymeleaf.servlet.content-type=text/html</span><br><span class="line">spring.thymeleaf.enabled=true</span><br><span class="line">spring.thymeleaf.encoding=UTF-8</span><br><span class="line"># ä¸€ä»£å¡« spring.thymeleaf.mode=HTML5</span><br><span class="line">spring.thymeleaf.mode=HTML</span><br></pre></td></tr></table></figure>
<h4 id="åå°"><a href="#åå°" class="headerlink" title="åå°"></a>åå°</h4><p>åœ¨src/main/resources/åˆ›å»ºä¸€ä¸ªtemplatesæ–‡ä»¶å¤¹,æ–°ç½‘é¡µåç¼€ä¸º*.html</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/to_list"</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">list</span><span class="params">(Model model,MiaoshaUser user)</span> </span>&#123;</span><br><span class="line">   	model.addAttribute(<span class="string">"user"</span>, user);</span><br><span class="line">   	<span class="comment">//æŸ¥è¯¢å•†å“åˆ—è¡¨</span></span><br><span class="line">   	List&lt;GoodsVo&gt; goodsList = goodsService.listGoodsVo();</span><br><span class="line">   	model.addAttribute(<span class="string">"goodsList"</span>, goodsList);</span><br><span class="line">       <span class="keyword">return</span> <span class="string">"goods_list"</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h4 id="å‰å°"><a href="#å‰å°" class="headerlink" title="å‰å°"></a>å‰å°</h4><p>è¿™é‡Œæ³¨æ„Thymeleafè¯­æ³•ï¼ŒThymeleafå¾ˆåƒHTMLï¼Œä¸åŒä¹‹å¤„åœ¨æ ‡ç­¾åŠ äº†ä¸€ä¸ªthå‰ç¼€</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns:th</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>å•†å“åˆ—è¡¨<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- jquery --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">th:src</span>=<span class="string">"@&#123;/js/jquery.min.js&#125;"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-default"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span>ç§’æ€å•†å“åˆ—è¡¨<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table"</span> <span class="attr">id</span>=<span class="string">"goodslist"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>å•†å“åç§°<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>å•†å“å›¾ç‰‡<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>å•†å“åŸä»·<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>ç§’æ€ä»·<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>åº“å­˜æ•°é‡<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">td</span>&gt;</span>è¯¦æƒ…<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>  <span class="attr">th:each</span>=<span class="string">"goods,goodsStat : $&#123;goodsList&#125;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;goods.goodsName&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> &gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">th:src</span>=<span class="string">"@&#123;$&#123;goods.goodsImg&#125;&#125;"</span> <span class="attr">width</span>=<span class="string">"100"</span> <span class="attr">height</span>=<span class="string">"100"</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;goods.goodsPrice&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;goods.miaoshaPrice&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">"$&#123;goods.stockCount&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">th:href</span>=<span class="string">"'/goods_detail.htm?goodsId='+$&#123;goods.id&#125;"</span>&gt;</span>è¯¦æƒ…<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Freemarker-è‡ªç”±æ ‡è®°"><a href="#Freemarker-è‡ªç”±æ ‡è®°" class="headerlink" title="Freemarker(è‡ªç”±æ ‡è®°)"></a>Freemarker(è‡ªç”±æ ‡è®°)</h3><h4 id="POM-1"><a href="#POM-1" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®æ–‡ä»¶-2"><a href="#é…ç½®æ–‡ä»¶-2" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><p>åœ¨<code>application.properties</code>ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#Freemarker</span><br><span class="line">spring.freemarker.allow-request-override=false</span><br><span class="line">spring.freemarker.cache=true</span><br><span class="line">spring.freemarker.check-template-location=true</span><br><span class="line">spring.freemarker.charset=UTF-8</span><br><span class="line">spring.freemarker.content-type=text/html</span><br><span class="line">spring.freemarker.expose-request-attributes=false</span><br><span class="line">spring.freemarker.expose-session-attributes=false</span><br><span class="line">spring.freemarker.expose-spring-macro-helpers=false</span><br><span class="line">#spring.freemarker.prefix=</span><br><span class="line">#spring.freemarker.request-context-attribute=</span><br><span class="line">#spring.freemarker.settings.*=</span><br><span class="line">spring.freemarker.suffix=.ftl</span><br><span class="line">spring.freemarker.template-loader-path=classpath:/templates/</span><br><span class="line">#comma-separated list</span><br><span class="line">#spring.freemarker.view-names= # whitelist of view names that can be resolved</span><br></pre></td></tr></table></figure>
<h4 id="åå°-1"><a href="#åå°-1" class="headerlink" title="åå°"></a>åå°</h4><p>åœ¨src/main/resources/åˆ›å»ºä¸€ä¸ªtemplatesæ–‡ä»¶å¤¹,æ–°ç½‘é¡µåç¼€ä¸º*.ftl</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/freemarkerIndex"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">(Map&lt;String, Object&gt; result)</span> </span>&#123;</span><br><span class="line">		result.put(<span class="string">"nickname"</span>, <span class="string">"tEngSHe789"</span>);</span><br><span class="line">        result.put(<span class="string">"old"</span>, <span class="string">"18"</span>);</span><br><span class="line">		result.put(<span class="string">"my Blog"</span>, <span class="string">"HTTPS://blog.tengshe789.tech/"</span>);</span><br><span class="line">		List&lt;String&gt; listResult = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">		listResult.add(<span class="string">"guanyu"</span>);</span><br><span class="line">		listResult.add(<span class="string">"zhugeliang"</span>);</span><br><span class="line">		result.put(<span class="string">"listResult"</span>, listResult);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"index"</span>;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å‰å°-1"><a href="#å‰å°-1" class="headerlink" title="å‰å°"></a>å‰å°</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>é¦–é¡µ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	  $&#123;nickname&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">#if</span> <span class="attr">old</span>==<span class="string">"18"</span>&gt;</span></span><br><span class="line">            å¤ªå‡äº†å§å“¥ä»¬</span><br><span class="line">      <span class="tag">&lt;<span class="name">#elseif</span> <span class="attr">old</span>==<span class="string">"21"</span>&gt;</span></span><br><span class="line">            ä½ æ˜¯çœŸçš„21å²</span><br><span class="line">     <span class="tag">&lt;<span class="name">#else</span>&gt;</span></span><br><span class="line">        å…¶ä»–      </span><br><span class="line">	  </span><br><span class="line">	  <span class="tag">&lt;/<span class="name">#if</span>&gt;</span>	  </span><br><span class="line">	 <span class="tag">&lt;<span class="name">#list</span> <span class="attr">userlist</span> <span class="attr">as</span> <span class="attr">user</span>&gt;</span></span><br><span class="line">	   $&#123;user&#125;</span><br><span class="line">	 <span class="tag">&lt;/<span class="name">#list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h3><p>ä¸å»ºè®®ç”¨Springbootæ•´åˆJSPï¼Œè¦çš„è¯ä¸€å®šè¦ä¸ºwarç±»å‹ï¼Œå¦åˆ™ä¼šæ‰¾ä¸åˆ°é¡µé¢.,è€Œä¸”ä¸è¦æŠŠJSPé¡µé¢å­˜æ”¾åœ¨resources// jsp ä¸èƒ½è¢«è®¿é—®åˆ°</p>
<h4 id="POM-2"><a href="#POM-2" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- SpringBoot web æ ¸å¿ƒç»„ä»¶ --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- SpringBoot å¤–éƒ¨tomcatæ”¯æŒ --&gt;</span>	</span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat.embed<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-embed-jasper<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®æ–‡ä»¶-3"><a href="#é…ç½®æ–‡ä»¶-3" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><p>åœ¨<code>application.properties</code>ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.mvc.view.prefix=/WEB-INF/jsp/</span><br><span class="line">spring.mvc.view.suffix=.jsp</span><br></pre></td></tr></table></figure>
<h4 id="åå°-2"><a href="#åå°-2" class="headerlink" title="åå°"></a>åå°</h4><p>åœ¨src/main/resources/åˆ›å»ºä¸€ä¸ªtemplatesæ–‡ä»¶å¤¹,æ–°ç½‘é¡µåç¼€ä¸º*.jsp</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"index"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å‰å°-2"><a href="#å‰å°-2" class="headerlink" title="å‰å°"></a>å‰å°</h3><p>ç•¥ç•¥ç•¥ğŸ˜</p>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</p>
<h2 id="é¢å‘æµç¼–ç¨‹"><a href="#é¢å‘æµç¼–ç¨‹" class="headerlink" title="é¢å‘æµç¼–ç¨‹"></a>é¢å‘æµç¼–ç¨‹</h2><p>è¦äº†è§£ WebFlux ,é¦–å…ˆäº†è§£ä¸‹ä»€ä¹ˆæ˜¯Reactiveå“åº”å¼(ååº”å¼ã€å¼‚æ­¥ã€é¢å‘æµ)ç¼–ç¨‹ ï¼Œä»–æ˜¯ä¸€ç§æ–°çš„ç¼–ç¨‹é£æ ¼ï¼Œå…¶ç‰¹ç‚¹æ˜¯å¼‚æ­¥æˆ–å¹¶å‘ã€äº‹ä»¶é©±åŠ¨ã€æ¨é€PUSHæœºåˆ¶ä»¥åŠè§‚å¯Ÿè€…æ¨¡å¼çš„è¡ç”Ÿã€‚reactiveåº”ç”¨(å“åº”å¼åº”ç”¨)å…è®¸å¼€å‘äººå‘˜æ„å»ºäº‹ä»¶é©±åŠ¨ï¼ˆevent-drivenï¼‰ï¼Œå¯æ‰©å±•æ€§ï¼Œå¼¹æ€§çš„ååº”ç³»ç»Ÿï¼šæä¾›é«˜åº¦æ•æ„Ÿçš„å®æ—¶çš„ç”¨æˆ·ä½“éªŒæ„Ÿè§‰ï¼Œå¯ä¼¸ç¼©æ€§å’Œå¼¹æ€§çš„åº”ç”¨ç¨‹åºæ ˆçš„æ”¯æŒï¼Œéšæ—¶å¯ä»¥éƒ¨ç½²åœ¨å¤šæ ¸å’Œäº‘è®¡ç®—æ¶æ„ã€‚</p>
<h3 id="Spring-Webflux"><a href="#Spring-Webflux" class="headerlink" title="Spring Webflux"></a>Spring Webflux</h3><p>Spring Boot Webflux å°±æ˜¯åŸºäº Reactor å®ç°çš„ã€‚Spring Boot 2.0 åŒ…æ‹¬ä¸€ä¸ªæ–°çš„ spring-webflux æ¨¡å—ã€‚è¯¥æ¨¡å—åŒ…å«å¯¹å“åº”å¼ HTTP å’Œ WebSocket å®¢æˆ·ç«¯çš„æ”¯æŒï¼Œä»¥åŠå¯¹ RESTï¼ŒHTML å’Œ WebSocket äº¤äº’ç­‰ç¨‹åºçš„æ”¯æŒã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒSpring MVC ç”¨äºåŒæ­¥å¤„ç†ï¼ŒSpring Webflux ç”¨äºå¼‚æ­¥å¤„ç†ã€‚ </p>
<p>Spring Boot Webflux æœ‰ä¸¤ç§ç¼–ç¨‹æ¨¡å‹å®ç°ï¼Œä¸€ç§ç±»ä¼¼ Spring MVC æ³¨è§£æ–¹å¼ï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨å…¶åŠŸèƒ½æ€§ç«¯ç‚¹æ–¹å¼ã€‚ </p>
<p><img src="/2018/08/04/springboot/8.jpg" alt="img"> </p>
<p>WebFlux æ”¯æŒçš„å®¹å™¨æœ‰ Tomcatã€Jettyï¼ˆNon-Blocking IO APIï¼‰ ï¼Œä¹Ÿå¯ä»¥åƒ Netty å’Œ Undertow çš„æœ¬èº«å°±æ”¯æŒå¼‚æ­¥å®¹å™¨ã€‚åœ¨å®¹å™¨ä¸­ Spring WebFlux ä¼šå°†è¾“å…¥æµé€‚é…æˆ Mono æˆ–è€… Flux æ ¼å¼è¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚ </p>
<h4 id="POM-3"><a href="#POM-3" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="å®˜æ–¹å®ä¾‹"><a href="#å®˜æ–¹å®ä¾‹" class="headerlink" title="å®˜æ–¹å®ä¾‹"></a>å®˜æ–¹å®ä¾‹</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonController</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> PersonRepository repository;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PersonController</span><span class="params">(PersonRepository repository)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.repository = repository;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/person"</span>)</span><br><span class="line">    <span class="function">Mono&lt;Void&gt; <span class="title">create</span><span class="params">(@RequestBody Publisher&lt;Person&gt; personStream)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.repository.save(personStream).then();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/person"</span>)</span><br><span class="line">    <span class="function">Flux&lt;Person&gt; <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.repository.findAll();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/person/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function">Mono&lt;Person&gt; <span class="title">findById</span><span class="params">(@PathVariable String id)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.repository.findOne(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Controllerå±‚"><a href="#Controllerå±‚" class="headerlink" title="Controllerå±‚"></a>Controllerå±‚</h4><p>Spring Boot 2.0 è¿™é‡Œæœ‰ä¸¤æ¡ä¸åŒçš„çº¿åˆ†åˆ«æ˜¯ï¼š</p>
<ol>
<li>Spring Web MVC -&gt; Spring Data</li>
<li>Spring WebFlux -&gt; Spring Data Reactive</li>
</ol>
<p>å¦‚æœä½¿ç”¨ Spring Data Reactive ï¼ŒåŸæ¥çš„ Spring é’ˆå¯¹ Spring Data ï¼ˆJDBCç­‰ï¼‰çš„äº‹åŠ¡ç®¡ç†ä¼šä¸èµ·ä½œç”¨ã€‚å› ä¸ºåŸæ¥çš„ Spring äº‹åŠ¡ç®¡ç†ï¼ˆSpring Data JPAï¼‰éƒ½æ˜¯åŸºäº ThreadLocal ä¼ é€’äº‹åŠ¡çš„ï¼Œå…¶æœ¬è´¨æ˜¯åŸºäº é˜»å¡ IO æ¨¡å‹ï¼Œä¸æ˜¯å¼‚æ­¥çš„ã€‚</p>
<p>ä½† Reactive æ˜¯è¦æ±‚å¼‚æ­¥çš„ï¼Œä¸åŒçº¿ç¨‹é‡Œé¢ ThreadLocal è‚¯å®šå–ä¸åˆ°å€¼äº†ã€‚è‡ªç„¶ï¼Œæˆ‘ä»¬å¾—æƒ³æƒ³å¦‚ä½•åœ¨ä½¿ç”¨ Reactive ç¼–ç¨‹æ˜¯åšåˆ°äº‹åŠ¡ï¼Œæœ‰ä¸€ç§æ–¹å¼æ˜¯ å›è°ƒ æ–¹å¼ï¼Œä¸€ç›´ä¼ é€’ <code>conn ï¼šnewTransaction(conn -&gt;{})</code></p>
<p>å› ä¸ºæ¯æ¬¡æ“ä½œæ•°æ®åº“ä¹Ÿæ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥ connection åœ¨ Reactive ç¼–ç¨‹ä¸­æ— æ³•é  ThreadLocal ä¼ é€’äº†ï¼Œåªèƒ½æ”¾åœ¨å‚æ•°ä¸Šé¢ä¼ é€’ã€‚è™½ç„¶ä¼šæœ‰ä¸€å®šçš„ä»£ç ä¾µå…¥è¡Œã€‚è¿›ä¸€æ­¥ï¼Œä¹Ÿå¯ä»¥ kotlin åç¨‹ï¼Œå»åšåˆ°é€æ˜çš„äº‹åŠ¡ç®¡ç†ï¼Œå³æŠŠ conn æ”¾åˆ° åç¨‹çš„å±€éƒ¨å˜é‡ä¸­å»ã€‚<br>é‚£ Spring Data Reactive Repositories ä¸æ”¯æŒ MySQLï¼Œè¿›ä¸€æ­¥ä¹Ÿä¸æ”¯æŒ MySQL äº‹åŠ¡ï¼Œæ€ä¹ˆåŠï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯ï¼Œè¿™ä¸ªé—®é¢˜å…¶å®å’Œç¬¬ä¸€ä¸ªé—®é¢˜ä¹Ÿç›¸å…³ã€‚ ä¸ºå•¥ä¸æ”¯æŒ MySQLï¼Œå³ JDBC ä¸æ”¯æŒã€‚å¤§å®¶å¯ä»¥çœ‹åˆ° JDBC æ˜¯æ‰€å± Spring Data çš„ã€‚æ‰€ä»¥å¯ä»¥ç­‰å¾… Spring Data Reactive Repositories å‡çº§ IO æ¨¡å‹ï¼Œå»æ”¯æŒ MySQLã€‚ä¹Ÿå¯ä»¥å’Œä¸Šé¢ä¹Ÿè®²åˆ°äº†ï¼Œå¦‚ä½•ä½¿ç”¨ Reactive ç¼–ç¨‹æ”¯æŒäº‹åŠ¡ã€‚</p>
<p>å¦‚æœåº”ç”¨åªèƒ½ä½¿ç”¨ä¸å¼ºä¾èµ–æ•°æ®äº‹åŠ¡ï¼Œä¾æ—§ä½¿ç”¨ MySQL ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å®ç°ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="Service-å±‚"><a href="#Service-å±‚" class="headerlink" title="Service å±‚"></a>Service å±‚</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CityService</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åŸå¸‚ä¿¡æ¯åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">List&lt;City&gt; <span class="title">findAllCity</span><span class="params">()</span></span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®åŸå¸‚ ID,æŸ¥è¯¢åŸå¸‚ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">City <span class="title">findCityById</span><span class="params">(Long id)</span></span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢åŸå¸‚ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> city</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Long <span class="title">saveCity</span><span class="params">(City city)</span></span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°åŸå¸‚ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> city</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Long <span class="title">updateCity</span><span class="params">(City city)</span></span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®åŸå¸‚ ID,åˆ é™¤åŸå¸‚ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Long <span class="title">deleteCity</span><span class="params">(Long id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…·ä½“æ¡ˆä¾‹åœ¨æˆ‘å‚è€ƒåšä¸»çš„<a href="https://github.com/JeffLi1993/springboot-learning-example" target="_blank" rel="noopener"> Github</a> </p>
<h4 id="è·¯ç”±å™¨ç±»-Router"><a href="#è·¯ç”±å™¨ç±»-Router" class="headerlink" title="è·¯ç”±å™¨ç±» Router"></a>è·¯ç”±å™¨ç±» Router</h4><p>åˆ›å»ºä¸€ä¸ª Route ç±»æ¥å®šä¹‰ RESTful HTTP è·¯ç”± </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è¯·å‚è€ƒ<a href="https://gitbook.cn/gitchat/activity/59e09f788c3a1a4f21a5b445" target="_blank" rel="noopener">èŠèŠ Spring Boot 2.x é‚£äº›äº‹å„¿</a></p>
<h3 id="Async"><a href="#Async" class="headerlink" title="@Async"></a>@Async</h3><p>éœ€è¦æ‰§è¡Œå¼‚æ­¥æ–¹æ³•æ—¶ï¼Œåœ¨æ–¹æ³•ä¸ŠåŠ ä¸Š<code>@Async</code>ä¹‹åï¼Œåº•å±‚ä½¿ç”¨å¤šçº¿ç¨‹æŠ€æœ¯ ã€‚å¯åŠ¨åŠ ä¸Šéœ€è¦<code>@EnableAsync</code> </p>
<h2 id="æ•°æ®è®¿é—®"><a href="#æ•°æ®è®¿é—®" class="headerlink" title="æ•°æ®è®¿é—®"></a>æ•°æ®è®¿é—®</h2><h3 id="æ•´åˆJdbcTemplate"><a href="#æ•´åˆJdbcTemplate" class="headerlink" title="æ•´åˆJdbcTemplate"></a>æ•´åˆJdbcTemplate</h3><p>ä½¿ç”¨è¿™ä¸ªéœ€è¦spring-boot-starter-parentç‰ˆæœ¬è¦åœ¨1.5ä»¥ä¸Š</p>
<h4 id="POM-4"><a href="#POM-4" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   	 <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	 <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®æ–‡ä»¶-4"><a href="#é…ç½®æ–‡ä»¶-4" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><p>åœ¨<code>application.properties</code>ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># jdbcæ¨¡æ¿</span><br><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/test</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=123456</span><br><span class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br></pre></td></tr></table></figure>
<h4 id="åå°-3"><a href="#åå°-3" class="headerlink" title="åå°"></a>åå°</h4><p>åˆ›å»ºä¸€ä¸ªService</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createUser</span><span class="params">(String name, Integer age)</span> </span>&#123;</span><br><span class="line">		jdbcTemplate.update(<span class="string">"insert into users values(null,?,?);"</span>, name, age);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ•´åˆMybatis"><a href="#æ•´åˆMybatis" class="headerlink" title="æ•´åˆMybatis"></a>æ•´åˆMybatis</h3><p>è¿™é‡Œç”¨æˆ‘å†™çš„ä¸€ä¸ªç§’æ€é¡¹ç›®ä½œä¸ºå‚è€ƒæ —å­ã€‚<a href="https://github.com/tengshe789/-miaosha" target="_blank" rel="noopener">ç§’æ€å•†åŸ</a></p>
<h4 id="POM-5"><a href="#POM-5" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®æ–‡ä»¶-5"><a href="#é…ç½®æ–‡ä»¶-5" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><p>åœ¨<code>application.properties</code>ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#mybatis</span><br><span class="line">mybatis.type-aliases-package=cn.tengshe789.domain</span><br><span class="line">mybatis.configuration.map-underscore-to-camel-case=true</span><br><span class="line">mybatis.configuration.default-fetch-size=100</span><br><span class="line">mybatis.configuration.default-statement-timeout=3000</span><br><span class="line">mybatis.mapperLocations = classpath:cn/tengshe789/dao/*.xml</span><br></pre></td></tr></table></figure>
<h4 id="åå°-4"><a href="#åå°-4" class="headerlink" title="åå°"></a>åå°</h4><p>åˆ›å»ºä¸€ä¸ªDaoï¼ˆMapper ä»£ç ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">GoodsDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select g.*,mg.stock_count, mg.start_date, mg.end_date,mg.miaosha_price from miaosha_goods mg left join goods g on mg.goods_id = g.id"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;GoodsVo&gt; <span class="title">listGoodsVo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºservice</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GoodsService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    GoodsDao goodsDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * å±•ç¤ºå•†å“åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;GoodsVo&gt; <span class="title">listGoodsVo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> goodsDao.listGoodsVo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Mybatisæ•´åˆåˆ†é¡µæ’ä»¶PageHelper"><a href="#Mybatisæ•´åˆåˆ†é¡µæ’ä»¶PageHelper" class="headerlink" title="Mybatisæ•´åˆåˆ†é¡µæ’ä»¶PageHelper"></a>Mybatisæ•´åˆåˆ†é¡µæ’ä»¶PageHelper</h3><p>PageHelper æ˜¯ä¸€æ¬¾å¥½ç”¨çš„å¼€æºå…è´¹çš„ Mybatis ç¬¬ä¸‰æ–¹ç‰©ç†åˆ†é¡µæ’ä»¶</p>
<h4 id="POM-6"><a href="#POM-6" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®æ–‡ä»¶-6"><a href="#é…ç½®æ–‡ä»¶-6" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><p>åœ¨<code>application.properties</code>ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># é…ç½®æ—¥å¿—</span><br><span class="line">logging.level.cn.tengshe789.dao=DEBUG</span><br><span class="line"># Pagehelper</span><br><span class="line">pagehelper.helperDialect=mysql</span><br><span class="line">pagehelper.reasonable=true</span><br><span class="line">pagehelper.supportMethodsArguments=true</span><br><span class="line">pagehelper.params=count=countSql</span><br><span class="line">pagehelper.page-size-zero=true</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…åœ¨<code>application.yml</code>ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸mybatisæ•´åˆ</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line"><span class="attr">  config-location:</span> <span class="attr">classpath:mybatis.xml</span></span><br><span class="line"><span class="attr">  mapper-locations:</span></span><br><span class="line"><span class="attr">  - classpath:</span><span class="string">cn/tengshe789/dao/*.xml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†é¡µé…ç½®</span></span><br><span class="line"><span class="attr">pagehelper:</span></span><br><span class="line"><span class="attr">  helper-dialect:</span> <span class="string">mysql</span></span><br><span class="line"><span class="attr">  reasonable:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  support-methods-arguments:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  params:</span> <span class="string">count=countSql</span></span><br></pre></td></tr></table></figure>
<h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h4><h5 id="å®ä½“å±‚é¢"><a href="#å®ä½“å±‚é¢" class="headerlink" title="å®ä½“å±‚é¢"></a>å®ä½“å±‚é¢</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Daoå±‚"><a href="#Daoå±‚" class="headerlink" title="Daoå±‚"></a>Daoå±‚</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Select</span>(<span class="string">"SELECT * FROM USERS "</span>)</span><br><span class="line">	<span class="function">List&lt;User&gt; <span class="title">findUserList</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Serviceå±‚"><a href="#Serviceå±‚" class="headerlink" title="Serviceå±‚"></a>Serviceå±‚</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UserMapper userDao;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * page å½“å‰é¡µæ•°&lt;br&gt;</span></span><br><span class="line"><span class="comment">	 * size å½“å‰å±•ç¤ºçš„æ•°æ®&lt;br&gt;	</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> PageInfo&lt;User&gt; <span class="title">findUserList</span><span class="params">(<span class="keyword">int</span> page, <span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// å¼€å¯åˆ†é¡µæ’ä»¶,æ”¾åœ¨æŸ¥è¯¢è¯­å¥ä¸Šé¢</span></span><br><span class="line">		PageHelper.startPage(page, size);</span><br><span class="line">		List&lt;User&gt; listUser = userDao.findUserList();</span><br><span class="line">		<span class="comment">// å°è£…åˆ†é¡µä¹‹åçš„æ•°æ®</span></span><br><span class="line">		PageInfo&lt;User&gt; pageInfoUser = <span class="keyword">new</span> PageInfo&lt;User&gt;(listUser);</span><br><span class="line">		<span class="keyword">return</span> pageInfoUser;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ•´åˆSpringJPA"><a href="#æ•´åˆSpringJPA" class="headerlink" title="æ•´åˆSpringJPA"></a>æ•´åˆSpringJPA</h3><p>spring-data-jpaä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>å£°æ˜æŒä¹…å±‚çš„æ¥å£ï¼Œè¯¥æ¥å£ç»§æ‰¿ Repositoryï¼ˆæˆ–Repositoryçš„å­æ¥å£ï¼Œå…¶ä¸­å®šä¹‰äº†ä¸€äº›å¸¸ç”¨çš„å¢åˆ æ”¹æŸ¥ï¼Œä»¥åŠåˆ†é¡µç›¸å…³çš„æ–¹æ³•ï¼‰ã€‚</li>
<li>åœ¨æ¥å£ä¸­å£°æ˜éœ€è¦çš„ä¸šåŠ¡æ–¹æ³•ã€‚Spring Data å°†æ ¹æ®ç»™å®šçš„ç­–ç•¥ç”Ÿæˆå®ç°ä»£ç ã€‚</li>
<li>åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­å¢åŠ ä¸€è¡Œå£°æ˜ï¼Œè®© Spring ä¸ºå£°æ˜çš„æ¥å£åˆ›å»ºä»£ç†å¯¹è±¡ã€‚é…ç½®äº† <a href="jpa:repositories" target="_blank" rel="noopener">jpa:repositories</a> åï¼ŒSpring åˆå§‹åŒ–å®¹å™¨æ—¶å°†ä¼šæ‰«æ base-package æŒ‡å®šçš„åŒ…ç›®å½•åŠå…¶å­ç›®å½•ï¼Œä¸ºç»§æ‰¿ Repository æˆ–å…¶å­æ¥å£çš„æ¥å£åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œå¹¶å°†ä»£ç†å¯¹è±¡æ³¨å†Œä¸º Spring Beanï¼Œä¸šåŠ¡å±‚ä¾¿å¯ä»¥é€šè¿‡ Spring è‡ªåŠ¨å°è£…çš„ç‰¹æ€§æ¥ç›´æ¥ä½¿ç”¨è¯¥å¯¹è±¡ã€‚</li>
</ol>
<p>è¯¦æƒ…ï¼š<a href="http://projects.spring.io/spring-data-jpa/" target="_blank" rel="noopener">JPAå®˜æ–¹ç½‘ç«™</a></p>
<h4 id="POM-7"><a href="#POM-7" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®æ–‡ä»¶-7"><a href="#é…ç½®æ–‡ä»¶-7" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><p>Springboot é»˜è®¤ä½¿ç”¨hibernateä½œä¸ºJPAçš„å®ç° ã€‚éœ€è¦åœ¨<code>application.properties</code>ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># hibernate</span><br><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/test?useSSL=false</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=root</span><br><span class="line">spring.datasource.tomcat.max-active=100</span><br><span class="line">spring.datasource.tomcat.max-idle=200</span><br><span class="line">spring.datasource.tomcat.initialSize=20</span><br><span class="line">spring.jpa.database-platform=org.hibernate.dialect.MySQL5Dialect</span><br></pre></td></tr></table></figure>
<h4 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><h5 id="Domain"><a href="#Domain" class="headerlink" title="Domain"></a>Domain</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Entity</span>(name = <span class="string">"users"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserEntity</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="meta">@Column</span>(name = <span class="string">"name"</span>)</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="meta">@Column</span>(name = <span class="string">"age"</span>)</span><br><span class="line">	<span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  æ³¨è§£çš„æ„æ€ï¼š</p>
<p><code>@Entity</code>ä¼šè¢«springæ‰«æå¹¶åŠ è½½ï¼Œ</p>
<p><code>@Id</code>æ³¨è§£åœ¨ä¸»é”®ä¸Š</p>
<p><code>@Column name=&quot;call_phone&quot;</code> æŒ‡è¯¥å­—æ®µå¯¹åº”çš„æ•°æ®åº“çš„å­—æ®µåï¼Œå¦‚æœç›¸åŒå°±ä¸éœ€è¦å®šä¹‰ã€‚æ•°æ®åº“ä¸‹åˆ’çº¿é—´éš”å’Œä»£ç ä¸­çš„é©¼å³°æ³•è§†ä¸ºç›¸åŒï¼Œå¦‚æ•°æ®åº“å­—æ®µcreate_timeç­‰ä»·äºJavaç±»ä¸­çš„createTimeï¼Œå› æ­¤ä¸éœ€è¦ç”¨@Columnæ³¨è§£ã€‚</p>
<h5 id="Daoå±‚-1"><a href="#Daoå±‚-1" class="headerlink" title="Daoå±‚"></a>Daoå±‚</h5><p>æ­¤æ—¶éœ€è¦ç»§æ‰¿Repositoryæ¥å£~</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> <span class="keyword">extends</span> <span class="title">JpaRepository</span>&lt;<span class="title">User</span>, <span class="title">Integer</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> UserDao userDao;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/jpaFindUser"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">jpaIndex</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">		Optional&lt;User&gt; userOptional = userDao.findById(user.getId());</span><br><span class="line">		User result = userOptional.get();</span><br><span class="line">		<span class="keyword">return</span> reusltUser == <span class="keyword">null</span> ? <span class="string">"æ²¡æœ‰æŸ¥è¯¢åˆ°æ•°æ®"</span> : result;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¤šæ•°æ®æº"><a href="#å¤šæ•°æ®æº" class="headerlink" title="å¤šæ•°æ®æº"></a>å¤šæ•°æ®æº</h3><p>å¾ˆå¤šå…¬å¸éƒ½ä¼šä½¿ç”¨å¤šæ•°æ®åº“ï¼Œä¸€ä¸ªæ•°æ®åº“å­˜æ”¾å…±åŒçš„é…ç½®æˆ–æ–‡ä»¶ï¼Œå¦ä¸€ä¸ªæ•°æ®åº“æ˜¯æ”¾å‚ç›´ä¸šåŠ¡çš„æ•°æ®ã€‚æ‰€ä»¥è¯´éœ€è¦ä¸€ä¸ªé¡¹ç›®ä¸­æœ‰å¤šä¸ªæ•°æ®æº</p>
<p>è¿™ç©æ„åŸç†å¾ˆç®€å•ï¼Œæ ¹æ®ä¸åŒåŒ…åï¼ŒåŠ è½½ä¸åŒæ•°æ®æºã€‚</p>
<h4 id="é…ç½®æ–‡ä»¶-8"><a href="#é…ç½®æ–‡ä»¶-8" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><p>åœ¨<code>application.properties</code>ä¸­æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># datasource1</span><br><span class="line">spring.datasource.test1.driver-class-name = com.mysql.jdbc.Driver</span><br><span class="line">spring.datasource.test1.jdbc-url =jdbc:mysql://localhost:3306/test01?useUnicode=true&amp;characterEncoding=utf-8</span><br><span class="line">spring.datasource.test1.username = root</span><br><span class="line">spring.datasource.test1.password = 123456</span><br><span class="line"># datasource2</span><br><span class="line">spring.datasource.test2.driver-class-name = com.mysql.jdbc.Driver</span><br><span class="line">spring.datasource.test2.jdbc-url =jdbc:mysql://localhost:3306/test02?useUnicode=true&amp;characterEncoding=utf-8</span><br><span class="line">spring.datasource.test2.username = root</span><br><span class="line">spring.datasource.test2.password = 123456</span><br></pre></td></tr></table></figure>
<h4 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><h5 id="æ·»åŠ é…ç½®"><a href="#æ·»åŠ é…ç½®" class="headerlink" title="æ·»åŠ é…ç½®"></a>æ·»åŠ é…ç½®</h5><p>æ•°æ®åº“1çš„</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//DataSource01</span></span><br><span class="line"><span class="meta">@Configuration</span> <span class="comment">// æ³¨å†Œåˆ°springbootå®¹å™¨ä¸­</span></span><br><span class="line"><span class="meta">@MapperScan</span>(basePackages = <span class="string">"tech.tengshe789.test01"</span>, sqlSessionFactoryRef = <span class="string">"test1SqlSessionFactory"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSource1Config</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@methodDesc</span>: åŠŸèƒ½æè¿°:(é…ç½®test1æ•°æ®åº“)</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@author</span>: tEngSHe789</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Bean</span>(name = <span class="string">"test1DataSource"</span>)</span><br><span class="line">	<span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.datasource.test1"</span>)</span><br><span class="line">	<span class="meta">@Primary</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> DataSource <span class="title">testDataSource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> DataSourceBuilder.create().build();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@methodDesc</span>: åŠŸèƒ½æè¿°:(test1 sqlä¼šè¯å·¥å‚)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Bean</span>(name = <span class="string">"test1SqlSessionFactory"</span>)</span><br><span class="line">	<span class="meta">@Primary</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> SqlSessionFactory <span class="title">testSqlSessionFactory</span><span class="params">(@Qualifier(<span class="string">"test1DataSource"</span>)</span> DataSource dataSource)</span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		SqlSessionFactoryBean bean = <span class="keyword">new</span> SqlSessionFactoryBean();</span><br><span class="line">		bean.setDataSource(dataSource);</span><br><span class="line">        <span class="comment">//åŠ è½½mapperï¼ˆä¸éœ€è¦ï¼‰</span></span><br><span class="line">		bean.setMapperLocations(</span><br><span class="line">		 <span class="keyword">new</span> PathMatchingResourcePatternResolver().getResources(<span class="string">"classpath:mybatis/mapper/test1/*.xml"</span>));</span><br><span class="line">		<span class="keyword">return</span> bean.getObject();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@methodDesc</span>: åŠŸèƒ½æè¿°:(test1 äº‹ç‰©ç®¡ç†)</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Bean</span>(name = <span class="string">"test1TransactionManager"</span>)</span><br><span class="line">	<span class="meta">@Primary</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> DataSourceTransactionManager <span class="title">testTransactionManager</span><span class="params">(@Qualifier(<span class="string">"test1DataSource"</span>)</span> DataSource dataSource) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> DataSourceTransactionManager(dataSource);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Bean</span>(name = <span class="string">"test1SqlSessionTemplate"</span>)</span><br><span class="line">	<span class="meta">@Primary</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> SqlSessionTemplate <span class="title">testSqlSessionTemplate</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			@Qualifier(<span class="string">"test1SqlSessionFactory"</span>)</span> SqlSessionFactory sqlSessionFactory) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> SqlSessionTemplate(sqlSessionFactory);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ•°æ®åº“2çš„åŒç†ã€‚</p>
<h5 id="Dao"><a href="#Dao" class="headerlink" title="Dao"></a>Dao</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">User1Dao</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Insert</span>(<span class="string">"insert into users values(null,#&#123;name&#125;,#&#123;age&#125;);"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addUser</span><span class="params">(@Param(<span class="string">"name"</span>)</span> String name, @<span class="title">Param</span><span class="params">(<span class="string">"age"</span>)</span> Integer age)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h4><p>åœ¨å¤šæ•°æ®æºçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨<code>@Transactional</code>æ³¨è§£æ—¶ï¼Œåº”è¯¥æŒ‡å®šäº‹åŠ¡ç®¡ç†è€…<code>@Transactional(transactionManager = &quot;test1TransactionManager&quot;)</code></p>
<h2 id="äº‹ç‰©ç®¡ç†"><a href="#äº‹ç‰©ç®¡ç†" class="headerlink" title="äº‹ç‰©ç®¡ç†"></a>äº‹ç‰©ç®¡ç†</h2><p>æ€ä¹ˆè¿›è¡Œäº‹ç‰©ç®¡ç†å‘¢ï¼Œç®€å•ï¼Œå¾€ä¸‹çœ‹ã€‚</p>
<h3 id="å£°æ˜å¼äº‹åŠ¡"><a href="#å£°æ˜å¼äº‹åŠ¡" class="headerlink" title="å£°æ˜å¼äº‹åŠ¡"></a><strong>å£°æ˜å¼äº‹åŠ¡</strong></h3><p>æ‰¾åˆ°serviceå®ç°ç±»ï¼ŒåŠ ä¸Š<code>@Transactional</code> æ³¨è§£å°±è¡Œï¼Œæ­¤<code>@Transactional</code>æ³¨è§£æ¥è‡ª<code>org.springframework.transaction.annotation</code>åŒ… ï¼Œä¸æ˜¯æ¥è‡ª<code>javax.transaction</code> ã€‚è€Œä¸”<code>@Transactional</code>ä¸ä»…å¯ä»¥æ³¨è§£åœ¨æ–¹æ³•ä¸Šï¼Œä¹Ÿå¯ä»¥æ³¨è§£åœ¨ç±»ä¸Šã€‚å½“æ³¨è§£åœ¨ç±»ä¸Šçš„æ—¶å€™æ„å‘³ç€æ­¤ç±»çš„æ‰€æœ‰publicæ–¹æ³•éƒ½æ˜¯å¼€å¯äº‹åŠ¡çš„ã€‚å¦‚æœç±»çº§åˆ«å’Œæ–¹æ³•çº§åˆ«åŒæ—¶ä½¿ç”¨äº†<code>@Transactional</code>æ³¨è§£ï¼Œåˆ™ä½¿ç”¨åœ¨ç±»çº§åˆ«çš„æ³¨è§£ä¼šé‡è½½æ–¹æ³•çº§åˆ«çš„æ³¨è§£ã€‚ </p>
<p>æ³¨æ„ï¼šSpringbootæä¾›äº†ä¸€ä¸ª<code>@EnableTransactionManagement</code>æ³¨è§£åœ¨é…ç½®ç±»ä¸Šæ¥å¼€å¯å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒã€‚æ³¨è§£<code>@EnableTransactionManagement</code>æ˜¯é»˜è®¤æ‰“å¼€çš„ï¼Œæƒ³è¦å…³é—­äº‹åŠ¡ç®¡ç†ï¼Œæƒ³è¦åœ¨ç¨‹åºå…¥å£å°†è¿™ä¸ªæ³¨è§£æ”¹ä¸ºfalse</p>
<h3 id="åˆ†å¸ƒå¼äº‹ç‰©ç®¡ç†"><a href="#åˆ†å¸ƒå¼äº‹ç‰©ç®¡ç†" class="headerlink" title="åˆ†å¸ƒå¼äº‹ç‰©ç®¡ç†"></a>åˆ†å¸ƒå¼äº‹ç‰©ç®¡ç†</h3><p>å•¥æ˜¯åˆ†å¸ƒå¼äº‹åŠ¡å‘¢ï¼Œæ¯”å¦‚æˆ‘ä»¬åœ¨æ‰§è¡Œä¸€ä¸ªä¸šåŠ¡é€»è¾‘çš„æ—¶å€™æœ‰ä¸¤æ­¥åˆ†åˆ«æ“ä½œAæ•°æ®æºå’ŒBæ•°æ®æºï¼Œå½“æˆ‘ä»¬åœ¨Aæ•°æ®æºæ‰§è¡Œæ•°æ®æ›´æ”¹åï¼Œåœ¨Bæ•°æ®æºæ‰§è¡Œæ—¶å‡ºç°è¿è¡Œæ—¶å¼‚å¸¸ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¿…é¡»è¦è®©Bæ•°æ®æºçš„æ“ä½œå›æ»šï¼Œå¹¶å›æ»šå¯¹Aæ•°æ®æºçš„æ“ä½œã€‚è¿™ç§æƒ…å†µåœ¨æ”¯ä»˜ä¸šåŠ¡æ—¶å¸¸å¸¸å‡ºç°ï¼Œæ¯”å¦‚ä¹°ç¥¨ä¸šåŠ¡åœ¨æœ€åæ”¯ä»˜å¤±è´¥ï¼Œé‚£ä¹‹å‰çš„æ“ä½œå¿…é¡»å…¨éƒ¨å›æ»šï¼Œå¦‚æœä¹‹å‰çš„æ“ä½œåˆ†å¸ƒåœ¨å¤šä¸ªæ•°æ®æºä¸­ï¼Œé‚£ä¹ˆè¿™å°±æ˜¯å…¸å‹çš„åˆ†å¸ƒå¼äº‹åŠ¡å›æ»š</p>
<p>äº†è§£äº†ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œé‚£åˆ†å¸ƒå¼äº‹åŠ¡åœ¨javaçš„è§£å†³æ–¹æ¡ˆå°±æ˜¯JTA(å³Java Transaction API)ã€‚</p>
<p>springbootå®˜æ–¹æä¾›äº† <a href="http://www.atomikos.com/" target="_blank" rel="noopener">Atomikos</a> ï¼Œ <a href="https://github.com/bitronix/btm" target="_blank" rel="noopener">Bitronix</a> ï¼Œ<a href="http://www.narayana.io/" target="_blank" rel="noopener">Narayana</a> çš„<a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-jta.html" target="_blank" rel="noopener">ç±»äº‹åŠ¡ç®¡ç†å™¨ </a></p>
<h4 id="ç±»äº‹åŠ¡ç®¡ç†å™¨Atomikos"><a href="#ç±»äº‹åŠ¡ç®¡ç†å™¨Atomikos" class="headerlink" title="ç±»äº‹åŠ¡ç®¡ç†å™¨Atomikos"></a>ç±»äº‹åŠ¡ç®¡ç†å™¨Atomikos</h4><h5 id="POM-8"><a href="#POM-8" class="headerlink" title="POM"></a>POM</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jta-atomikos<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="é…ç½®æ–‡ä»¶-9"><a href="#é…ç½®æ–‡ä»¶-9" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># Mysql 1</span><br><span class="line">mysql.datasource.test1.url = jdbc:mysql://localhost:3306/test01?useUnicode=true&amp;characterEncoding=utf-8</span><br><span class="line">mysql.datasource.test1.username = root</span><br><span class="line">mysql.datasource.test1.password = 123456</span><br><span class="line"></span><br><span class="line">mysql.datasource.test1.minPoolSize = 3</span><br><span class="line">mysql.datasource.test1.maxPoolSize = 25</span><br><span class="line">mysql.datasource.test1.maxLifetime = 20000</span><br><span class="line">mysql.datasource.test1.borrowConnectionTimeout = 30</span><br><span class="line">mysql.datasource.test1.loginTimeout = 30</span><br><span class="line">mysql.datasource.test1.maintenanceInterval = 60</span><br><span class="line">mysql.datasource.test1.maxIdleTime = 60</span><br><span class="line"></span><br><span class="line"># Mysql 2</span><br><span class="line">mysql.datasource.test2.url =jdbc:mysql://localhost:3306/test02?useUnicode=true&amp;characterEncoding=utf-8</span><br><span class="line">mysql.datasource.test2.username =root</span><br><span class="line">mysql.datasource.test2.password =123456</span><br><span class="line"></span><br><span class="line">mysql.datasource.test2.minPoolSize = 3</span><br><span class="line">mysql.datasource.test2.maxPoolSize = 25</span><br><span class="line">mysql.datasource.test2.maxLifetime = 20000</span><br><span class="line">mysql.datasource.test2.borrowConnectionTimeout = 30</span><br><span class="line">mysql.datasource.test2.loginTimeout = 30</span><br><span class="line">mysql.datasource.test2.maintenanceInterval = 60</span><br><span class="line">mysql.datasource.test2.maxIdleTime = 60</span><br></pre></td></tr></table></figure>
<h5 id="è¯»å–é…ç½®æ–‡ä»¶ä¿¡æ¯"><a href="#è¯»å–é…ç½®æ–‡ä»¶ä¿¡æ¯" class="headerlink" title="è¯»å–é…ç½®æ–‡ä»¶ä¿¡æ¯"></a>è¯»å–é…ç½®æ–‡ä»¶ä¿¡æ¯</h5><p>ä»¥ä¸‹æ˜¯è¯»å–æ•°æ®åº“1çš„é…ç½®æ–‡ä»¶</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"mysql.datasource.test1"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBConfig1</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String url;</span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="keyword">private</span> String password;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> minPoolSize;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> maxPoolSize;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> maxLifetime;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> borrowConnectionTimeout;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> loginTimeout;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> maintenanceInterval;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> maxIdleTime;</span><br><span class="line">	<span class="keyword">private</span> String testQuery;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯»å–æ•°æ®åº“2çš„é…ç½®æ–‡ä»¶ç•¥</p>
<h5 id="åˆ›å»ºæ•°æ®æº"><a href="#åˆ›å»ºæ•°æ®æº" class="headerlink" title="åˆ›å»ºæ•°æ®æº"></a>åˆ›å»ºæ•°æ®æº</h5><p>æ•°æ®æº1ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">// basePackages æœ€å¥½åˆ†å¼€é…ç½® å¦‚æœæ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹å¯èƒ½ä¼šæŠ¥é”™</span></span><br><span class="line"><span class="meta">@MapperScan</span>(basePackages = <span class="string">"tech.tengshe789.test01"</span>, sqlSessionTemplateRef = <span class="string">"testSqlSessionTemplate"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisConfig1</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// é…ç½®æ•°æ®æº</span></span><br><span class="line">	<span class="meta">@Primary</span></span><br><span class="line">	<span class="meta">@Bean</span>(name = <span class="string">"testDataSource"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> DataSource <span class="title">testDataSource</span><span class="params">(DBConfig1 testConfig)</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">		MysqlXADataSource mysqlXaDataSource = <span class="keyword">new</span> MysqlXADataSource();</span><br><span class="line">		mysqlXaDataSource.setUrl(testConfig.getUrl());</span><br><span class="line">		mysqlXaDataSource.setPinGlobalTxToPhysicalConnection(<span class="keyword">true</span>);</span><br><span class="line">		mysqlXaDataSource.setPassword(testConfig.getPassword());</span><br><span class="line">		mysqlXaDataSource.setUser(testConfig.getUsername());</span><br><span class="line">		mysqlXaDataSource.setPinGlobalTxToPhysicalConnection(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">		AtomikosDataSourceBean xaDataSource = <span class="keyword">new</span> AtomikosDataSourceBean();</span><br><span class="line">		xaDataSource.setXaDataSource(mysqlXaDataSource);</span><br><span class="line">		xaDataSource.setUniqueResourceName(<span class="string">"testDataSource"</span>);</span><br><span class="line"></span><br><span class="line">		xaDataSource.setMinPoolSize(testConfig.getMinPoolSize());</span><br><span class="line">		xaDataSource.setMaxPoolSize(testConfig.getMaxPoolSize());</span><br><span class="line">		xaDataSource.setMaxLifetime(testConfig.getMaxLifetime());</span><br><span class="line">		xaDataSource.setBorrowConnectionTimeout(testConfig.getBorrowConnectionTimeout());</span><br><span class="line">		xaDataSource.setLoginTimeout(testConfig.getLoginTimeout());</span><br><span class="line">		xaDataSource.setMaintenanceInterval(testConfig.getMaintenanceInterval());</span><br><span class="line">		xaDataSource.setMaxIdleTime(testConfig.getMaxIdleTime());</span><br><span class="line">		xaDataSource.setTestQuery(testConfig.getTestQuery());</span><br><span class="line">		<span class="keyword">return</span> xaDataSource;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Primary</span></span><br><span class="line">	<span class="meta">@Bean</span>(name = <span class="string">"testSqlSessionFactory"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> SqlSessionFactory <span class="title">testSqlSessionFactory</span><span class="params">(@Qualifier(<span class="string">"testDataSource"</span>)</span> DataSource dataSource)</span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		SqlSessionFactoryBean bean = <span class="keyword">new</span> SqlSessionFactoryBean();</span><br><span class="line">		bean.setDataSource(dataSource);</span><br><span class="line">		<span class="keyword">return</span> bean.getObject();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Primary</span></span><br><span class="line">	<span class="meta">@Bean</span>(name = <span class="string">"testSqlSessionTemplate"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> SqlSessionTemplate <span class="title">testSqlSessionTemplate</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">			@Qualifier(<span class="string">"testSqlSessionFactory"</span>)</span> SqlSessionFactory sqlSessionFactory) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> SqlSessionTemplate(sqlSessionFactory);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ•°æ®åº“2ç•¥</p>
<h5 id="å¦‚ä½•å¯åŠ¨"><a href="#å¦‚ä½•å¯åŠ¨" class="headerlink" title="å¦‚ä½•å¯åŠ¨"></a>å¦‚ä½•å¯åŠ¨</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableConfigurationProperties</span>(value = &#123; DBConfig1.class, DBConfig2.class &#125;)</span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(MainApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h2 id="å®šæ—¶ä»»åŠ¡"><a href="#å®šæ—¶ä»»åŠ¡" class="headerlink" title="å®šæ—¶ä»»åŠ¡"></a>å®šæ—¶ä»»åŠ¡</h2><p>åœ¨åšé¡¹ç›®æ—¶æœ‰æ—¶å€™ä¼šæœ‰å®šæ—¶å™¨ä»»åŠ¡çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æŸæŸæ—¶é—´åº”è¯¥åšä»€ä¹ˆï¼Œå¤šå°‘ç§’åº”è¯¥æ€ä¹ˆæ ·ä¹‹ç±»çš„ã€‚</p>
<p>springæ”¯æŒå¤šç§å®šæ—¶ä»»åŠ¡çš„å®ç°ã€‚æˆ‘ä»¬æ¥ä»‹ç»ä¸‹ä½¿ç”¨Quartz å’ŒScheduler</p>
<h3 id="Spring-Schedule"><a href="#Spring-Schedule" class="headerlink" title="Spring Schedule"></a>Spring Schedule</h3><p>Spring Schedule å®ç°å®šæ—¶ä»»åŠ¡æœ‰ä¸¤ç§æ–¹å¼ 1. ä½¿ç”¨XMLé…ç½®å®šæ—¶ä»»åŠ¡ï¼Œ 2. ä½¿ç”¨ @Scheduled æ³¨è§£ã€‚ </p>
<h4 id="ä»£ç -3"><a href="#ä»£ç -3" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><p>å›ºå®šç­‰å¾…æ—¶é—´ <code>@Scheduled(fixedDelay = æ—¶é—´é—´éš” )</code></p>
<p>å›ºå®šé—´éš”æ—¶é—´ <code>@Scheduled(fixedRate = æ—¶é—´é—´éš” )</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScheduleJobs</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> SECOND = <span class="number">1</span> * <span class="number">1000</span>;</span><br><span class="line">    FastDateFormat fdf = FastDateFormat.getInstance(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Scheduled</span>(fixedDelay = SECOND * <span class="number">2</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fixedDelayJob</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">2</span>);</span><br><span class="line">        System.out.println(<span class="string">"[FixedDelayJob Execute]"</span>+fdf.format(<span class="keyword">new</span> Date()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Cornè¡¨è¾¾å¼ <code>@Scheduled(cron = Cornè¡¨è¾¾å¼)</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScheduleJobs</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> SECOND = <span class="number">1</span> * <span class="number">1000</span>;</span><br><span class="line">    FastDateFormat fdf = FastDateFormat.getInstance(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Scheduled</span>(cron = <span class="string">"0/4 * * * * ?"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cronJob</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"[CronJob Execute]"</span>+fdf.format(<span class="keyword">new</span> Date()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h4><p>è¦åœ¨ä¸»æ–¹æ³•ä¸ŠåŠ ä¸Š<code>@EnableScheduling</code></p>
<h3 id="Quartz"><a href="#Quartz" class="headerlink" title="Quartz"></a>Quartz</h3><h4 id="POM-9"><a href="#POM-9" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-quartz-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®æ–‡ä»¶-10"><a href="#é…ç½®æ–‡ä»¶-10" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># spring boot 2.x å·²é›†æˆQuartzï¼Œæ— éœ€è‡ªå·±é…ç½®</span><br><span class="line">spring.quartz.job-store-type=jdbc</span><br><span class="line">spring.quartz.properties.org.quartz.scheduler.instanceName=clusteredScheduler</span><br><span class="line">spring.quartz.properties.org.quartz.scheduler.instanceId=AUTO</span><br><span class="line">spring.quartz.properties.org.quartz.jobStore.class=org.quartz.impl.jdbcjobstore.JobStoreTX</span><br><span class="line">spring.quartz.properties.org.quartz.jobStore.driverDelegateClass=org.quartz.impl.jdbcjobstore.StdJDBCDelegate</span><br><span class="line">spring.quartz.properties.org.quartz.jobStore.tablePrefix=QRTZ_</span><br><span class="line">spring.quartz.properties.org.quartz.jobStore.isClustered=true</span><br><span class="line">spring.quartz.properties.org.quartz.jobStore.clusterCheckinInterval=10000</span><br><span class="line">spring.quartz.properties.org.quartz.jobStore.useProperties=false</span><br><span class="line">spring.quartz.properties.org.quartz.threadPool.class=org.quartz.simpl.SimpleThreadPool</span><br><span class="line">spring.quartz.properties.org.quartz.threadPool.threadCount=10</span><br><span class="line">spring.quartz.properties.org.quartz.threadPool.threadPriority=5</span><br><span class="line">spring.quartz.properties.org.quartz.threadPool.threadsInheritContextClassLoaderOfInitializingThread=true</span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®ç±»"><a href="#é…ç½®ç±»" class="headerlink" title="é…ç½®ç±»"></a>é…ç½®ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuartzConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JobDetail <span class="title">uploadTaskDetail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> JobBuilder.newJob(UploadTask.class).withIdentity(<span class="string">"uploadTask"</span>).storeDurably().build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Trigger <span class="title">uploadTaskTrigger</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        CronScheduleBuilder scheduleBuilder = CronScheduleBuilder.cronSchedule(<span class="string">"*/5 * * * * ?"</span>);</span><br><span class="line">        <span class="keyword">return</span> TriggerBuilder.newTrigger().forJob(uploadTaskDetail())</span><br><span class="line">                .withIdentity(<span class="string">"uploadTask"</span>)</span><br><span class="line">                .withSchedule(scheduleBuilder)</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å®ç°ç±»"><a href="#å®ç°ç±»" class="headerlink" title="å®ç°ç±»"></a>å®ç°ç±»</h4><p>åˆ›å»ºä¸€ä¸ªé…ç½®ç±»ï¼Œåˆ†åˆ«åˆ¶å®šå…·ä½“ä»»åŠ¡ç±»å’Œè§¦å‘çš„è§„åˆ™ </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@DisallowConcurrentExecution</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UploadTask</span> <span class="keyword">extends</span> <span class="title">QuartzJobBean</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> TencentYunService tencentYunService;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">executeInternal</span><span class="params">(JobExecutionContext jobExecutionContext)</span> <span class="keyword">throws</span> JobExecutionException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"ä»»åŠ¡å¼€å§‹"</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">6000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"ä»»åŠ¡ç»“æŸ"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>@DisallowConcurrentExecution</code>ç¦æ­¢å¹¶å‘æ‰§è¡Œ </p>
<p>å¹¶å‘æ‰§è¡Œæ–¹é¢ï¼Œç³»ç»Ÿé»˜è®¤ä¸ºtrue,å³ç¬¬ä¸€ä¸ªä»»åŠ¡è¿˜æœªæ‰§è¡Œå®Œæ•´ï¼Œç¬¬äºŒä¸ªä»»åŠ¡å¦‚æœåˆ°äº†æ‰§è¡Œæ—¶é—´ï¼Œåˆ™ä¼šç«‹é©¬å¼€å¯æ–°çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œè¿™æ ·å¦‚æœæˆ‘ä»¬æ˜¯ä»æ•°æ®åº“è¯»å–ä¿¡æ¯ï¼Œä¸¤æ¬¡é‡å¤è¯»å–å¯èƒ½å‡ºç°é‡å¤æ‰§è¡Œä»»åŠ¡çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªå€¼è®¾ç½®ä¸ºfalseï¼Œè¿™æ ·ç¬¬äºŒä¸ªä»»åŠ¡ä¼šå¾€åæ¨è¿Ÿï¼Œåªæœ‰åœ¨ç¬¬ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåæ‰ä¼šæ‰§è¡Œç¬¬äºŒä¸ªä»»åŠ¡ </p>
<h2 id="æ—¥å¿—ç®¡ç†"><a href="#æ—¥å¿—ç®¡ç†" class="headerlink" title="æ—¥å¿—ç®¡ç†"></a>æ—¥å¿—ç®¡ç†</h2><h3 id="log4j"><a href="#log4j" class="headerlink" title="log4j"></a>log4j</h3><h4 id="POM-10"><a href="#POM-10" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- spring boot start --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!-- æ’é™¤è‡ªå¸¦çš„logbackä¾èµ– --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- springboot-log4j --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.8.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®æ–‡ä»¶-11"><a href="#é…ç½®æ–‡ä»¶-11" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><p>æ–‡ä»¶åç§°<code>log4j.properties</code> </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#log4j.rootLogger=CONSOLE,info,error,DEBUG</span></span><br><span class="line"><span class="string">log4j.rootLogger=info,error,CONSOLE,DEBUG</span></span><br><span class="line"><span class="string">log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender</span>     </span><br><span class="line"><span class="string">log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout</span>     </span><br><span class="line"><span class="string">log4j.appender.CONSOLE.layout.ConversionPattern=%d&#123;yyyy-MM-dd-HH-mm&#125;</span> <span class="string">[%t]</span> <span class="string">[%c]</span> <span class="string">[%p]</span> <span class="bullet">-</span> <span class="string">%m%n</span>     </span><br><span class="line"><span class="string">log4j.logger.info=info</span></span><br><span class="line"><span class="string">log4j.appender.info=org.apache.log4j.DailyRollingFileAppender</span></span><br><span class="line"><span class="string">log4j.appender.info.layout=org.apache.log4j.PatternLayout</span>     </span><br><span class="line"><span class="string">log4j.appender.info.layout.ConversionPattern=%d&#123;yyyy-MM-dd-HH-mm&#125;</span> <span class="string">[%t]</span> <span class="string">[%c]</span> <span class="string">[%p]</span> <span class="bullet">-</span> <span class="string">%m%n</span>  </span><br><span class="line"><span class="string">log4j.appender.info.datePattern='.'yyyy-MM-dd</span></span><br><span class="line"><span class="string">log4j.appender.info.Threshold</span> <span class="string">=</span> <span class="string">info</span>   </span><br><span class="line"><span class="string">log4j.appender.info.append=true</span>   </span><br><span class="line"><span class="comment">#log4j.appender.info.File=/home/admin/pms-api-services/logs/info/api_services_info</span></span><br><span class="line"><span class="string">log4j.appender.info.File=/Users/dddd/Documents/testspace/pms-api-services/logs/info/api_services_info</span></span><br><span class="line"><span class="string">log4j.logger.error=error</span>  </span><br><span class="line"><span class="string">log4j.appender.error=org.apache.log4j.DailyRollingFileAppender</span></span><br><span class="line"><span class="string">log4j.appender.error.layout=org.apache.log4j.PatternLayout</span>     </span><br><span class="line"><span class="string">log4j.appender.error.layout.ConversionPattern=%d&#123;yyyy-MM-dd-HH-mm&#125;</span> <span class="string">[%t]</span> <span class="string">[%c]</span> <span class="string">[%p]</span> <span class="bullet">-</span> <span class="string">%m%n</span>  </span><br><span class="line"><span class="string">log4j.appender.error.datePattern='.'yyyy-MM-dd</span></span><br><span class="line"><span class="string">log4j.appender.error.Threshold</span> <span class="string">=</span> <span class="string">error</span>   </span><br><span class="line"><span class="string">log4j.appender.error.append=true</span>   </span><br><span class="line"><span class="comment">#log4j.appender.error.File=/home/admin/pms-api-services/logs/error/api_services_error</span></span><br><span class="line"><span class="string">log4j.appender.error.File=/Users/dddd/Documents/testspace/pms-api-services/logs/error/api_services_error</span></span><br><span class="line"><span class="string">log4j.logger.DEBUG=DEBUG</span></span><br><span class="line"><span class="string">log4j.appender.DEBUG=org.apache.log4j.DailyRollingFileAppender</span></span><br><span class="line"><span class="string">log4j.appender.DEBUG.layout=org.apache.log4j.PatternLayout</span>     </span><br><span class="line"><span class="string">log4j.appender.DEBUG.layout.ConversionPattern=%d&#123;yyyy-MM-dd-HH-mm&#125;</span> <span class="string">[%t]</span> <span class="string">[%c]</span> <span class="string">[%p]</span> <span class="bullet">-</span> <span class="string">%m%n</span>  </span><br><span class="line"><span class="string">log4j.appender.DEBUG.datePattern='.'yyyy-MM-dd</span></span><br><span class="line"><span class="string">log4j.appender.DEBUG.Threshold</span> <span class="string">=</span> <span class="string">DEBUG</span>   </span><br><span class="line"><span class="string">log4j.appender.DEBUG.append=true</span>   </span><br><span class="line"><span class="comment">#log4j.appender.DEBUG.File=/home/admin/pms-api-services/logs/debug/api_services_debug</span></span><br><span class="line"><span class="string">log4j.appender.DEBUG.File=/Users/dddd/Documents/testspace/pms-api-services/logs/debug/api_services_debug</span></span><br></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(IndexController.class);</span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨AOPç»Ÿä¸€å¤„ç†Webè¯·æ±‚æ—¥å¿—"><a href="#ä½¿ç”¨AOPç»Ÿä¸€å¤„ç†Webè¯·æ±‚æ—¥å¿—" class="headerlink" title="ä½¿ç”¨AOPç»Ÿä¸€å¤„ç†Webè¯·æ±‚æ—¥å¿—"></a>ä½¿ç”¨AOPç»Ÿä¸€å¤„ç†Webè¯·æ±‚æ—¥å¿—</h3><h4 id="POM-11"><a href="#POM-11" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="ä»£ç -4"><a href="#ä»£ç -4" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebLogAspect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(WebLogAspect.class);</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Pointcut</span>(<span class="string">"execution(public * tech.tengshe789.controller.*.*(..))"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">webLog</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Before</span>(<span class="string">"webLog()"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doBefore</span><span class="params">(JoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		<span class="comment">// æ¥æ”¶åˆ°è¯·æ±‚ï¼Œè®°å½•è¯·æ±‚å†…å®¹</span></span><br><span class="line">		ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();</span><br><span class="line">		HttpServletRequest request = attributes.getRequest();</span><br><span class="line">		<span class="comment">// è®°å½•ä¸‹è¯·æ±‚å†…å®¹</span></span><br><span class="line">		logger.info(<span class="string">"URL : "</span> + request.getRequestURL().toString());</span><br><span class="line">		logger.info(<span class="string">"HTTP_METHOD : "</span> + request.getMethod());</span><br><span class="line">		logger.info(<span class="string">"IP : "</span> + request.getRemoteAddr());</span><br><span class="line">		Enumeration&lt;String&gt; enu = request.getParameterNames();</span><br><span class="line">		<span class="keyword">while</span> (enu.hasMoreElements()) &#123;</span><br><span class="line">			String name = (String) enu.nextElement();</span><br><span class="line">			logger.info(<span class="string">"name:&#123;&#125;,value:&#123;&#125;"</span>, name, request.getParameter(name));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@AfterReturning</span>(returning = <span class="string">"ret"</span>, pointcut = <span class="string">"webLog()"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfterReturning</span><span class="params">(Object ret)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		<span class="comment">// å¤„ç†å®Œè¯·æ±‚ï¼Œè¿”å›å†…å®¹</span></span><br><span class="line">		logger.info(<span class="string">"RESPONSE : "</span> + ret);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="lombok-æ’ä»¶"><a href="#lombok-æ’ä»¶" class="headerlink" title="lombok æ’ä»¶"></a>lombok æ’ä»¶</h3><p>éå¸¸ç®€å•çš„åŠæ³•</p>
<h4 id="POM-12"><a href="#POM-12" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="ä»£ç -5"><a href="#ä»£ç -5" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><p>ç±»ä¸­æ·»åŠ <code>@Slf4j</code> æ³¨è§£å³å¯ã€‚ä½¿ç”¨æ˜¯ç›´æ¥è¾“å…¥logå…¨å±€å˜é‡</p>
<h4 id="Lombokçš„å…¶ä»–ç”¨æ³•"><a href="#Lombokçš„å…¶ä»–ç”¨æ³•" class="headerlink" title="Lombokçš„å…¶ä»–ç”¨æ³•"></a>Lombokçš„å…¶ä»–ç”¨æ³•</h4><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Data æ ‡ç­¾ï¼Œç”Ÿæˆgetter/setter toString()ç­‰æ–¹æ³• </span><br><span class="line">@NonNull : <span class="type"></span>è®©ä½ ä¸åœ¨æ‹…å¿§å¹¶ä¸”çˆ±ä¸ŠNullPointerException </span><br><span class="line">@CleanUp : <span class="type"></span>è‡ªåŠ¨èµ„æºç®¡ç†ï¼šä¸ç”¨å†åœ¨finallyä¸­æ·»åŠ èµ„æºçš„closeæ–¹æ³• </span><br><span class="line">@Setter/@Getter : <span class="type"></span>è‡ªåŠ¨ç”Ÿæˆ<span class="keyword">set</span>å’Œ<span class="keyword">get</span>æ–¹æ³• </span><br><span class="line">@ToString : <span class="type"></span>è‡ªåŠ¨ç”ŸæˆtoStringæ–¹æ³• </span><br><span class="line">@EqualsAndHashcode : <span class="type"></span>ä»å¯¹è±¡çš„å­—æ®µä¸­ç”ŸæˆhashCodeå’Œequalsçš„å®ç° </span><br><span class="line">@NoArgsConstructor/@RequiredArgsConstructor/@AllArgsConstructor </span><br><span class="line">è‡ªåŠ¨ç”Ÿæˆæ„é€ æ–¹æ³• </span><br><span class="line">@Data : <span class="type"></span>è‡ªåŠ¨ç”Ÿæˆ<span class="keyword">set</span>/<span class="keyword">get</span>æ–¹æ³•ï¼ŒtoStringæ–¹æ³•ï¼Œequalsæ–¹æ³•ï¼ŒhashCodeæ–¹æ³•ï¼Œä¸å¸¦å‚æ•°çš„æ„é€ æ–¹æ³• </span><br><span class="line">@Value : <span class="type"></span>ç”¨äºæ³¨è§£finalç±» </span><br><span class="line">@Builder : <span class="type"></span>äº§ç”Ÿå¤æ‚çš„æ„å»ºå™¨apiç±»</span><br><span class="line">@SneakyThrows : <span class="type"></span>å¼‚å¸¸å¤„ç†ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰ </span><br><span class="line">@Synchronized : <span class="type"></span>åŒæ­¥æ–¹æ³•å®‰å…¨çš„è½¬åŒ– </span><br><span class="line">@Getter(lazy=<span class="literal">true</span>) : <span class="type"></span></span><br><span class="line"><span class="type"></span>@Log : <span class="type"></span>æ”¯æŒå„ç§loggerå¯¹è±¡ï¼Œä½¿ç”¨æ—¶ç”¨å¯¹åº”çš„æ³¨è§£ï¼Œå¦‚ï¼š@Log4</span><br></pre></td></tr></table></figure>
<h2 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h2><p>æ‹¦æˆªå™¨ï¼Œåœ¨AOP(Aspect-Oriented Programming)ä¸­ç”¨äºåœ¨æŸä¸ªæ–¹æ³•æˆ–å­—æ®µè¢«è®¿é—®ä¹‹å‰ï¼Œè¿›è¡Œæ‹¦æˆªï¼Œç„¶ååœ¨ä¹‹å‰æˆ–ä¹‹ååŠ å…¥æŸäº›æ“ä½œã€‚æ‹¦æˆªæ˜¯AOPçš„ä¸€ç§å®ç°ç­–ç•¥ã€‚ </p>
<p>ï¼ˆ1ï¼‰æ‹¦æˆªå™¨æ˜¯åŸºäºjavaçš„åå°„æœºåˆ¶çš„ï¼Œè€Œè¿‡æ»¤å™¨æ˜¯åŸºäºå‡½æ•°å›è°ƒã€‚</p>
<p>ï¼ˆ2ï¼‰æ‹¦æˆªå™¨ä¸ä¾èµ–äºservletå®¹å™¨ï¼Œè€Œè¿‡æ»¤å™¨ä¾èµ–äºservletå®¹å™¨ã€‚</p>
<p>ï¼ˆ3ï¼‰æ‹¦æˆªå™¨åªèƒ½å¯¹Controllerè¯·æ±‚èµ·ä½œç”¨ï¼Œè€Œè¿‡æ»¤å™¨åˆ™å¯ä»¥å¯¹å‡ ä¹æ‰€æœ‰çš„è¯·æ±‚èµ·ä½œç”¨ã€‚</p>
<p>ï¼ˆ4ï¼‰åœ¨Controllerçš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œæ‹¦æˆªå™¨å¯ä»¥å¤šæ¬¡è¢«è°ƒç”¨ï¼Œè€Œè¿‡æ»¤å™¨åªèƒ½åœ¨å®¹å™¨åˆå§‹åŒ–æ—¶è¢«è°ƒç”¨ä¸€æ¬¡ã€‚</p>
<p>è¿‡æ»¤å™¨ï¼ˆfilterï¼‰å’Œæ‹¦æˆªå™¨ï¼ˆinterceptorï¼‰æ˜¯æœ‰åŒºåˆ«çš„ï¼Œ<a href="http://blog.csdn.net/xiaodanjava/article/details/32125687" target="_blank" rel="noopener">è¯¦æƒ…</a> ï¼Œä»–ä»¬çš„æ‰§è¡Œé¡ºåºï¼š å…ˆfilter å interceptor</p>
<p>-&gt;è¿‡æ»¤å™¨åº”ç”¨åœºæ™¯:è®¾ç½®ç¼–ç å­—ç¬¦ã€è¿‡æ»¤é“­æ„Ÿå­—ç¬¦</p>
<p>-&gt;æ‹¦æˆªå™¨åº”ç”¨åœºæ™¯:æ‹¦æˆªæœªç™»é™†ç”¨æˆ·ã€å®¡è®¡æ—¥å¿—</p>
<h3 id="è‡ªå®šä¹‰æ‹¦æˆªå™¨"><a href="#è‡ªå®šä¹‰æ‹¦æˆªå™¨" class="headerlink" title="è‡ªå®šä¹‰æ‹¦æˆªå™¨"></a>è‡ªå®šä¹‰æ‹¦æˆªå™¨</h3><h4 id="ä»£ç -6"><a href="#ä»£ç -6" class="headerlink" title="ä»£ç "></a>ä»£ç </h4><p>æ³¨å†Œæ‹¦æˆªå™¨</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebAppConfig</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> LoginIntercept loginIntercept;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> WebMvcConfigurer <span class="title">WebMvcConfigurer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> WebMvcConfigurer() &#123;</span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">				registry.addInterceptor(loginIntercept).addPathPatterns(<span class="string">"/*"</span>);</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºæ¨¡æ‹Ÿç™»å½•æ‹¦æˆªå™¨ï¼ŒéªŒè¯è¯·æ±‚æ˜¯å¦æœ‰tokenå‚æ•° </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginIntercept</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		log.info(<span class="string">"å¼€å§‹æ‹¦æˆªç™»å½•è¯·æ±‚...."</span>);</span><br><span class="line">		String token = request.getParameter(<span class="string">"token"</span>);</span><br><span class="line">		<span class="keyword">if</span> (StringUtils.isEmpty(token)) &#123;</span><br><span class="line">			response.getWriter().println(<span class="string">"not found token"</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h2><p>åœ¨ Spring Bootä¸­ï¼Œé€šè¿‡<code>@EnableCaching</code>æ³¨è§£è‡ªåŠ¨åŒ–é…ç½®åˆé€‚çš„ç¼“å­˜ç®¡ç†å™¨ï¼ˆCacheManagerï¼‰ï¼ŒSpring Bootæ ¹æ®ä¸‹é¢çš„é¡ºåºå»ä¾¦æµ‹ç¼“å­˜æä¾›è€…ï¼š  Generic  ï¼Œ JCache (JSR-107)ï¼Œ EhCache 2.x  ï¼ŒHazelcast  ï¼Œ Infinispan  ï¼ŒRedis  ï¼ŒGuava ï¼Œ Simple </p>
<h3 id="EhCache"><a href="#EhCache" class="headerlink" title="EhCache"></a>EhCache</h3><h4 id="POM-13"><a href="#POM-13" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-cache<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="æ–°å»ºehcache-xml-æ–‡ä»¶"><a href="#æ–°å»ºehcache-xml-æ–‡ä»¶" class="headerlink" title="æ–°å»ºehcache.xml æ–‡ä»¶"></a>æ–°å»ºehcache.xml æ–‡ä»¶</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">ehcache</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:noNamespaceSchemaLocation</span>=<span class="string">"http://ehcache.org/ehcache.xsd"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">updateCheck</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">diskStore</span> <span class="attr">path</span>=<span class="string">"java.io.tmpdir/Tmp_EhCache"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- é»˜è®¤é…ç½® --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">defaultCache</span> <span class="attr">maxElementsInMemory</span>=<span class="string">"5000"</span> <span class="attr">eternal</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">timeToIdleSeconds</span>=<span class="string">"120"</span> <span class="attr">timeToLiveSeconds</span>=<span class="string">"120"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">memoryStoreEvictionPolicy</span>=<span class="string">"LRU"</span> <span class="attr">overflowToDisk</span>=<span class="string">"false"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">cache</span> <span class="attr">name</span>=<span class="string">"baseCache"</span> <span class="attr">maxElementsInMemory</span>=<span class="string">"10000"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">maxElementsOnDisk</span>=<span class="string">"100000"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">ehcache</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>é…ç½®ä¿¡æ¯ä»‹ç»</p>
<p><code>name</code>:ç¼“å­˜åç§°ã€‚  </p>
<p><code>maxElementsInMemory</code>ï¼šç¼“å­˜æœ€å¤§ä¸ªæ•°ã€‚  </p>
<p><code>eternal</code>:å¯¹è±¡æ˜¯å¦æ°¸ä¹…æœ‰æ•ˆï¼Œä¸€ä½†è®¾ç½®äº†ï¼Œtimeoutå°†ä¸èµ·ä½œç”¨ã€‚  </p>
<p><code>timeToIdleSeconds</code>ï¼šè®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰çš„å…è®¸é—²ç½®æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚ä»…å½“eternal=<strong>false</strong>å¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œå¯é€‰å±æ€§ï¼Œé»˜è®¤å€¼æ˜¯0ï¼Œä¹Ÿå°±æ˜¯å¯é—²ç½®æ—¶é—´æ— ç©·å¤§ã€‚  </p>
<p><code>timeToLiveSeconds</code>ï¼šè®¾ç½®å¯¹è±¡åœ¨å¤±æ•ˆå‰å…è®¸å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚æœ€å¤§æ—¶é—´ä»‹äºåˆ›å»ºæ—¶é—´å’Œå¤±æ•ˆæ—¶é—´ä¹‹é—´ã€‚ä»…å½“eternal=<strong>false</strong>å¯¹è±¡ä¸æ˜¯æ°¸ä¹…æœ‰æ•ˆæ—¶ä½¿ç”¨ï¼Œé»˜è®¤æ˜¯0.ï¼Œä¹Ÿå°±æ˜¯å¯¹è±¡å­˜æ´»æ—¶é—´æ— ç©·å¤§ã€‚  </p>
<p><code>overflowToDisk</code>ï¼šå½“å†…å­˜ä¸­å¯¹è±¡æ•°é‡è¾¾åˆ°maxElementsInMemoryæ—¶ï¼ŒEhcacheå°†ä¼šå¯¹è±¡å†™åˆ°ç£ç›˜ä¸­ã€‚  </p>
<p><code>diskSpoolBufferSizeMB</code>ï¼šè¿™ä¸ªå‚æ•°è®¾ç½®DiskStoreï¼ˆç£ç›˜ç¼“å­˜ï¼‰çš„ç¼“å­˜åŒºå¤§å°ã€‚é»˜è®¤æ˜¯30MBã€‚æ¯ä¸ªCacheéƒ½åº”è¯¥æœ‰è‡ªå·±çš„ä¸€ä¸ªç¼“å†²åŒºã€‚  </p>
<p><code>maxElementsOnDisk</code>ï¼šç¡¬ç›˜æœ€å¤§ç¼“å­˜ä¸ªæ•°ã€‚  </p>
<p><code>diskPersistent</code>ï¼šæ˜¯å¦ç¼“å­˜è™šæ‹Ÿæœºé‡å¯æœŸæ•°æ® Whether the disk store persists between restarts of the Virtual Machine. The <strong>default</strong> value is <strong>false</strong>.  </p>
<p><code>diskExpiryThreadIntervalSeconds</code>ï¼šç£ç›˜å¤±æ•ˆçº¿ç¨‹è¿è¡Œæ—¶é—´é—´éš”ï¼Œé»˜è®¤æ˜¯120ç§’ã€‚  </p>
<p><code>memoryStoreEvictionPolicy</code>ï¼šå½“è¾¾åˆ°maxElementsInMemoryé™åˆ¶æ—¶ï¼ŒEhcacheå°†ä¼šæ ¹æ®æŒ‡å®šçš„ç­–ç•¥å»æ¸…ç†å†…å­˜ã€‚é»˜è®¤ç­–ç•¥æ˜¯LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ã€‚ä½ å¯ä»¥è®¾ç½®ä¸ºFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æˆ–æ˜¯LFUï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰ã€‚  </p>
<p><code>clearOnFlush</code>ï¼šå†…å­˜æ•°é‡æœ€å¤§æ—¶æ˜¯å¦æ¸…é™¤ã€‚  </p>
<h4 id="å…³äºæ³¨è§£å’Œä»£ç ä½¿ç”¨"><a href="#å…³äºæ³¨è§£å’Œä»£ç ä½¿ç”¨" class="headerlink" title="å…³äºæ³¨è§£å’Œä»£ç ä½¿ç”¨"></a>å…³äºæ³¨è§£å’Œä»£ç ä½¿ç”¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@CacheConfig</span>(cacheNames = <span class="string">"baseCache"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Select</span>(<span class="string">"select * from users where name=#&#123;name&#125;"</span>)</span><br><span class="line">	<span class="meta">@Cacheable</span></span><br><span class="line">	<span class="function">UserEntity <span class="title">findName</span><span class="params">(@Param(<span class="string">"name"</span>)</span> String name)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ¸…é™¤ç¼“å­˜"><a href="#æ¸…é™¤ç¼“å­˜" class="headerlink" title="æ¸…é™¤ç¼“å­˜"></a>æ¸…é™¤ç¼“å­˜</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> CacheManager cacheManager;</span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/remoKey"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">remoKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	cacheManager.getCache(<span class="string">"baseCache"</span>).clear();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¯åŠ¨-1"><a href="#å¯åŠ¨-1" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h4><p>ä¸»æ–¹æ³•å¯åŠ¨æ—¶åŠ ä¸Š<code>@EnableCaching</code>å³å¯</p>
<h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><h4 id="ä½¿ç”¨è‡ªå¸¦é©±åŠ¨å™¨è¿æ¥"><a href="#ä½¿ç”¨è‡ªå¸¦é©±åŠ¨å™¨è¿æ¥" class="headerlink" title="ä½¿ç”¨è‡ªå¸¦é©±åŠ¨å™¨è¿æ¥"></a>ä½¿ç”¨è‡ªå¸¦é©±åŠ¨å™¨è¿æ¥</h4><p>ä½¿ç”¨RedisTemplate è¿æ¥</p>
<h5 id="POM-14"><a href="#POM-14" class="headerlink" title="POM"></a>POM</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="é…ç½®æ–‡ä»¶-12"><a href="#é…ç½®æ–‡ä»¶-12" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h5><p>å•æœº</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#redis</span><br><span class="line"># Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰</span><br><span class="line">spring.redis.database=0</span><br><span class="line"># RedisæœåŠ¡å™¨åœ°å€</span><br><span class="line">spring.redis.host=127.0.0.1</span><br><span class="line"># RedisæœåŠ¡å™¨è¿æ¥ç«¯å£</span><br><span class="line">spring.redis.port=6379</span><br><span class="line"># RedisæœåŠ¡å™¨è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰</span><br><span class="line">spring.redis.password=</span><br><span class="line"># è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span><br><span class="line">spring.redis.pool.max-active=8</span><br><span class="line"># è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span><br><span class="line">spring.redis.pool.max-wait=-1</span><br><span class="line"># è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥</span><br><span class="line">spring.redis.pool.max-idle=8</span><br><span class="line"># è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥</span><br><span class="line">spring.redis.pool.min-idle=0</span><br><span class="line"># è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span><br><span class="line">spring.redis.timeout=0</span><br></pre></td></tr></table></figure>
<p>é›†ç¾¤æˆ–å“¨å…µæ¨¡å¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#Matserçš„ipåœ°å€  </span><br><span class="line">redis.hostName=192.168.177.128</span><br><span class="line">#ç«¯å£å·  </span><br><span class="line">redis.port=6382</span><br><span class="line">#å¦‚æœæœ‰å¯†ç   </span><br><span class="line">redis.password=</span><br><span class="line">#å®¢æˆ·ç«¯è¶…æ—¶æ—¶é—´å•ä½æ˜¯æ¯«ç§’ é»˜è®¤æ˜¯2000 </span><br><span class="line">redis.timeout=10000  </span><br><span class="line"></span><br><span class="line">#æœ€å¤§ç©ºé—²æ•°  </span><br><span class="line">redis.maxIdle=300  </span><br><span class="line">#è¿æ¥æ± çš„æœ€å¤§æ•°æ®åº“è¿æ¥æ•°ã€‚è®¾ä¸º0è¡¨ç¤ºæ— é™åˆ¶,å¦‚æœæ˜¯jedis 2.4ä»¥åç”¨redis.maxTotal  </span><br><span class="line">#redis.maxActive=600  </span><br><span class="line">#æ§åˆ¶ä¸€ä¸ªpoolå¯åˆ†é…å¤šå°‘ä¸ªjediså®ä¾‹,ç”¨æ¥æ›¿æ¢ä¸Šé¢çš„redis.maxActive,å¦‚æœæ˜¯jedis 2.4ä»¥åç”¨è¯¥å±æ€§  </span><br><span class="line">redis.maxTotal=1000  </span><br><span class="line">#æœ€å¤§å»ºç«‹è¿æ¥ç­‰å¾…æ—¶é—´ã€‚å¦‚æœè¶…è¿‡æ­¤æ—¶é—´å°†æ¥åˆ°å¼‚å¸¸ã€‚è®¾ä¸º-1è¡¨ç¤ºæ— é™åˆ¶ã€‚  </span><br><span class="line">redis.maxWaitMillis=1000  </span><br><span class="line">#è¿æ¥çš„æœ€å°ç©ºé—²æ—¶é—´ é»˜è®¤1800000æ¯«ç§’(30åˆ†é’Ÿ)  </span><br><span class="line">redis.minEvictableIdleTimeMillis=300000  </span><br><span class="line">#æ¯æ¬¡é‡Šæ”¾è¿æ¥çš„æœ€å¤§æ•°ç›®,é»˜è®¤3  </span><br><span class="line">redis.numTestsPerEvictionRun=1024  </span><br><span class="line">#é€å‡ºæ‰«æçš„æ—¶é—´é—´éš”(æ¯«ç§’) å¦‚æœä¸ºè´Ÿæ•°,åˆ™ä¸è¿è¡Œé€å‡ºçº¿ç¨‹, é»˜è®¤-1  </span><br><span class="line">redis.timeBetweenEvictionRunsMillis=30000  </span><br><span class="line">#æ˜¯å¦åœ¨ä»æ± ä¸­å–å‡ºè¿æ¥å‰è¿›è¡Œæ£€éªŒ,å¦‚æœæ£€éªŒå¤±è´¥,åˆ™ä»æ± ä¸­å»é™¤è¿æ¥å¹¶å°è¯•å–å‡ºå¦ä¸€ä¸ª  </span><br><span class="line">redis.testOnBorrow=true  </span><br><span class="line">#åœ¨ç©ºé—²æ—¶æ£€æŸ¥æœ‰æ•ˆæ€§, é»˜è®¤false  </span><br><span class="line">redis.testWhileIdle=true  </span><br><span class="line"></span><br><span class="line">#redisé›†ç¾¤é…ç½®      </span><br><span class="line">spring.redis.cluster.nodes=192.168.177.128:7001,192.168.177.128:7002,192.168.177.128:7003,192.168.177.128:7004,192.168.177.128:7005,192.168.177.128:7006</span><br><span class="line">spring.redis.cluster.max-redirects=3</span><br><span class="line"></span><br><span class="line">#å“¨å…µæ¨¡å¼</span><br><span class="line">#redis.sentinel.host1=192.168.177.128</span><br><span class="line">#redis.sentinel.port1=26379</span><br><span class="line"></span><br><span class="line">#redis.sentinel.host2=172.20.1.231  </span><br><span class="line">#redis.sentinel.port2=26379</span><br></pre></td></tr></table></figure>
<h5 id="é…ç½®ç±»-1"><a href="#é…ç½®ç±»-1" class="headerlink" title="é…ç½®ç±»"></a>é…ç½®ç±»</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisConfig</span> <span class="keyword">extends</span> <span class="title">CachingConfigurerSupport</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.redis.host&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String host;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.redis.port&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> port;</span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;spring.redis.timeout&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> timeout;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//è‡ªå®šä¹‰ç¼“å­˜keyç”Ÿæˆç­–ç•¥</span></span><br><span class="line"><span class="comment">//    @Bean</span></span><br><span class="line"><span class="comment">//    public KeyGenerator keyGenerator() &#123;</span></span><br><span class="line"><span class="comment">//        return new KeyGenerator()&#123;</span></span><br><span class="line"><span class="comment">//            @Override</span></span><br><span class="line"><span class="comment">//            public Object generate(Object target, java.lang.reflect.Method method, Object... params) &#123;</span></span><br><span class="line"><span class="comment">//                StringBuffer sb = new StringBuffer();</span></span><br><span class="line"><span class="comment">//                sb.append(target.getClass().getName());</span></span><br><span class="line"><span class="comment">//                sb.append(method.getName());</span></span><br><span class="line"><span class="comment">//                for(Object obj:params)&#123;</span></span><br><span class="line"><span class="comment">//                    sb.append(obj.toString());</span></span><br><span class="line"><span class="comment">//                &#125;</span></span><br><span class="line"><span class="comment">//                return sb.toString();</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//        &#125;;</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">    <span class="comment">//ç¼“å­˜ç®¡ç†å™¨</span></span><br><span class="line">    <span class="meta">@Bean</span> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> CacheManager <span class="title">cacheManager</span><span class="params">(@SuppressWarnings(<span class="string">"rawtypes"</span>)</span> RedisTemplate redisTemplate) </span>&#123;</span><br><span class="line">        RedisCacheManager cacheManager = <span class="keyword">new</span> RedisCacheManager(redisTemplate);</span><br><span class="line">        <span class="comment">//è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ </span></span><br><span class="line">        cacheManager.setDefaultExpiration(<span class="number">10000</span>);</span><br><span class="line">        <span class="keyword">return</span> cacheManager;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;String, String&gt; <span class="title">redisTemplate</span><span class="params">(RedisConnectionFactory factory)</span></span>&#123;</span><br><span class="line">        StringRedisTemplate template = <span class="keyword">new</span> StringRedisTemplate(factory);</span><br><span class="line">        setSerializer(template);<span class="comment">//è®¾ç½®åºåˆ—åŒ–å·¥å…·</span></span><br><span class="line">        template.afterPropertiesSet();</span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setSerializer</span><span class="params">(StringRedisTemplate template)</span></span>&#123;</span><br><span class="line">            <span class="meta">@SuppressWarnings</span>(&#123; <span class="string">"rawtypes"</span>, <span class="string">"unchecked"</span> &#125;)</span><br><span class="line">            Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span class="keyword">new</span> Jackson2JsonRedisSerializer(Object.class);</span><br><span class="line">            ObjectMapper om = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">            om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">            om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">            jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line">            template.setValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Dao-1"><a href="#Dao-1" class="headerlink" title="Dao"></a>Dao</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="meta">@CacheConfig</span>(cacheNames = <span class="string">"users"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Insert</span>(<span class="string">"insert into user(name,age) values(#&#123;name&#125;,#&#123;age&#125;)"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(@Param(<span class="string">"name"</span>)</span>String name,@<span class="title">Param</span><span class="params">(<span class="string">"age"</span>)</span>String age)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Select</span>(<span class="string">"select * from user where id =#&#123;id&#125;"</span>)</span><br><span class="line">    <span class="meta">@Cacheable</span>(key =<span class="string">"#p0"</span>) </span><br><span class="line">    <span class="function">User <span class="title">findById</span><span class="params">(@Param(<span class="string">"id"</span>)</span> String id)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@CachePut</span>(key = <span class="string">"#p0"</span>)</span><br><span class="line">    <span class="meta">@Update</span>(<span class="string">"update user set name=#&#123;name&#125; where id=#&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">updataById</span><span class="params">(@Param(<span class="string">"id"</span>)</span>String id,@<span class="title">Param</span><span class="params">(<span class="string">"name"</span>)</span>String name)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å¦‚æœæŒ‡å®šä¸º trueï¼Œåˆ™æ–¹æ³•è°ƒç”¨åå°†ç«‹å³æ¸…ç©ºæ‰€æœ‰ç¼“å­˜</span></span><br><span class="line">    <span class="meta">@CacheEvict</span>(key =<span class="string">"#p0"</span>,allEntries=<span class="keyword">true</span>)</span><br><span class="line">    <span class="meta">@Delete</span>(<span class="string">"delete from user where id=#&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteById</span><span class="params">(@Param(<span class="string">"id"</span>)</span>String id)</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>@Cacheable</code>å°†æŸ¥è¯¢ç»“æœç¼“å­˜åˆ°redisä¸­ï¼Œï¼ˆkey=â€#p0â€ï¼‰æŒ‡å®šä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºredisçš„keyã€‚</p>
<p><code>@CachePut</code>ï¼ŒæŒ‡å®škeyï¼Œå°†æ›´æ–°çš„ç»“æœåŒæ­¥åˆ°redisä¸­</p>
<p><code>@CacheEvict</code>ï¼ŒæŒ‡å®škeyï¼Œåˆ é™¤ç¼“å­˜æ•°æ®ï¼ŒallEntries=true,æ–¹æ³•è°ƒç”¨åå°†ç«‹å³æ¸…é™¤ç¼“å­˜</p>
<h4 id="ä½¿ç”¨Jedisè¿æ¥"><a href="#ä½¿ç”¨Jedisè¿æ¥" class="headerlink" title="ä½¿ç”¨Jedisè¿æ¥"></a>ä½¿ç”¨Jedisè¿æ¥</h4><p>è¦æ³¨æ„ï¼Œredisåœ¨5.0ç‰ˆæœ¬ä»¥åä¸æ”¯æŒJedis</p>
<h5 id="POM-15"><a href="#POM-15" class="headerlink" title="POM"></a>POM</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="é…ç½®ç±»-2"><a href="#é…ç½®ç±»-2" class="headerlink" title="é…ç½®ç±»"></a>é…ç½®ç±»</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties</span>(prefix=<span class="string">"redis"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisConfig</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String host;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> port;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> timeout;<span class="comment">//ç§’</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> poolMaxTotal;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> poolMaxIdle;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> poolMaxWait;<span class="comment">//ç§’</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisPoolFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    RedisConfig redisConfig;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JedisPool <span class="title">edisPoolFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        JedisPoolConfig poolConfig = <span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">        poolConfig.setMaxIdle(redisConfig.getPoolMaxIdle());</span><br><span class="line">        poolConfig.setMaxTotal(redisConfig.getPoolMaxTotal());</span><br><span class="line">        poolConfig.setMaxWaitMillis(redisConfig.getPoolMaxWait() * <span class="number">1000</span>);</span><br><span class="line">        JedisPool jp = <span class="keyword">new</span> JedisPool(poolConfig, redisConfig.getHost(), redisConfig.getPort(),</span><br><span class="line">                redisConfig.getTimeout()*<span class="number">1000</span>, redisConfig.getPassword(), <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> jp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç›‘æ§ä¸­å¿ƒ"><a href="#ç›‘æ§ä¸­å¿ƒ" class="headerlink" title="ç›‘æ§ä¸­å¿ƒ"></a>ç›‘æ§ä¸­å¿ƒ</h2><p>Springbootç›‘æ§ä¸­å¿ƒæ˜¯å¹²ä»€ä¹ˆçš„å‘¢ï¼Ÿä»–æ˜¯é’ˆå¯¹å¾®æœåŠ¡çš„ æœåŠ¡çŠ¶æ€ã€Httpè¯·æ±‚èµ„æºè¿›è¡Œç›‘æ§ï¼Œå¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å†…å­˜å˜åŒ–ï¼ˆå †å†…å­˜ã€çº¿ç¨‹ã€æ—¥å¿—ç®¡ç†ï¼‰ï¼Œå¯ä»¥æ£€æµ‹æœåŠ¡é…ç½®è¿æ¥åœ°å€æ˜¯å¦å¯ç”¨ï¼ˆæ¨¡æ‹Ÿè®¿é—®ï¼Œæ‡’åŠ è½½ï¼‰ï¼Œå¯ä»¥ç»Ÿè®¡æœ‰å¤šå°‘Beanæœ‰ä»€ä¹ˆå•ä¾‹å¤šä¾‹ï¼Œå¯ä»¥ç»Ÿè®¡SpringMVCæœ‰å¤šå°‘@RequestMapping</p>
<h3 id="Actuator"><a href="#Actuator" class="headerlink" title="Actuator"></a>Actuator</h3><p>Actuatoræ˜¯spring bootçš„ä¸€ä¸ªé™„åŠ åŠŸèƒ½,å¯å¸®åŠ©ä½ åœ¨åº”ç”¨ç¨‹åºç”Ÿäº§ç¯å¢ƒæ—¶ç›‘è§†å’Œç®¡ç†åº”ç”¨ç¨‹åºã€‚</p>
<p>å¯ä»¥ä½¿ç”¨HTTPçš„å„ç§è¯·æ±‚æ¥ç›‘ç®¡,å®¡è®¡,æ”¶é›†åº”ç”¨çš„è¿è¡Œæƒ…å†µ.è¿”å›çš„æ˜¯json</p>
<p>ç¼ºç‚¹ï¼šæ²¡æœ‰å¯è§†åŒ–ç•Œé¢ã€‚</p>
<p>åœ¨springboot2.0ä¸­ï¼ŒActuatorçš„ç«¯ç‚¹ï¼ˆendpointï¼‰ç°åœ¨é»˜è®¤æ˜ å°„åˆ°/applicationï¼Œæ¯”å¦‚ï¼Œ/info ç«¯ç‚¹ç°åœ¨å°±æ˜¯åœ¨/application/infoã€‚ä½†ä½ å¯ä»¥ä½¿ç”¨management.context-pathæ¥è¦†ç›–æ­¤é»˜è®¤å€¼ã€‚</p>
<h4 id="POM-16"><a href="#POM-16" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®ä¿¡æ¯"><a href="#é…ç½®ä¿¡æ¯" class="headerlink" title="é…ç½®ä¿¡æ¯"></a>é…ç½®ä¿¡æ¯</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Actuator é€šè¿‡ä¸‹é¢çš„é…ç½®å¯ç”¨æ‰€æœ‰çš„ç›‘æ§ç«¯ç‚¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›ç«¯ç‚¹æ˜¯ç¦ç”¨çš„ï¼›</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line"><span class="attr">  endpoints:</span></span><br><span class="line"><span class="attr">    web:</span></span><br><span class="line"><span class="attr">      exposure:</span></span><br><span class="line"><span class="attr">        include:</span> <span class="string">"*"</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">  profiles:</span></span><br><span class="line"><span class="attr">    active:</span> <span class="string">prod</span></span><br><span class="line"><span class="attr">  datasource:</span></span><br><span class="line"><span class="attr">    driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">    url:</span> <span class="attr">jdbc:mysql://127.0.0.1:3306/test</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">    password:</span> <span class="number">123456</span></span><br></pre></td></tr></table></figure>
<h4 id="Actuatorè®¿é—®è·¯å¾„"><a href="#Actuatorè®¿é—®è·¯å¾„" class="headerlink" title="Actuatorè®¿é—®è·¯å¾„"></a>Actuatorè®¿é—®è·¯å¾„</h4><p>é€šè¿‡actuator/+ç«¯ç‚¹åå°±å¯ä»¥è·å–ç›¸åº”çš„ä¿¡æ¯ã€‚</p>
<table>
<thead>
<tr>
<th>è·¯å¾„</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>/actuator/beans</td>
<td>æ˜¾ç¤ºåº”ç”¨ç¨‹åºä¸­æ‰€æœ‰Spring beançš„å®Œæ•´åˆ—è¡¨ã€‚</td>
</tr>
<tr>
<td>/actuator/configprops</td>
<td>æ˜¾ç¤ºæ‰€æœ‰é…ç½®ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td>/actuator/env</td>
<td>é™ˆåˆ—æ‰€æœ‰çš„ç¯å¢ƒå˜é‡ã€‚</td>
</tr>
<tr>
<td>/actuator/mappings</td>
<td>æ˜¾ç¤ºæ‰€æœ‰@RequestMappingçš„urlæ•´ç†åˆ—è¡¨ã€‚</td>
</tr>
<tr>
<td>/actuator/health</td>
<td>æ˜¾ç¤ºåº”ç”¨ç¨‹åºè¿è¡ŒçŠ¶å†µä¿¡æ¯ upè¡¨ç¤ºæˆåŠŸ downå¤±è´¥</td>
</tr>
<tr>
<td>/actuator/info</td>
<td>æŸ¥çœ‹è‡ªå®šä¹‰åº”ç”¨ä¿¡æ¯</td>
</tr>
</tbody>
</table>
<h3 id="Admin-UIåˆ†å¸ƒå¼å¾®æœåŠ¡ç›‘æ§ä¸­å¿ƒ"><a href="#Admin-UIåˆ†å¸ƒå¼å¾®æœåŠ¡ç›‘æ§ä¸­å¿ƒ" class="headerlink" title="Admin-UIåˆ†å¸ƒå¼å¾®æœåŠ¡ç›‘æ§ä¸­å¿ƒ"></a>Admin-UIåˆ†å¸ƒå¼å¾®æœåŠ¡ç›‘æ§ä¸­å¿ƒ</h3><p>Admin-UIåº•å±‚ä½¿ç”¨actuatorï¼Œå®ç°ç›‘æ§ä¿¡æ¯ çš„ç•Œé¢</p>
<h4 id="POM-17"><a href="#POM-17" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æœåŠ¡ç«¯--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>de.codecentric<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-admin-starter-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å®¢æˆ·ç«¯--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>de.codecentric<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-admin-starter-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.jolokia<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jolokia-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.googlecode.json-simple<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>json-simple<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="application-ymlé…ç½®æ–‡ä»¶"><a href="#application-ymlé…ç½®æ–‡ä»¶" class="headerlink" title="application.ymlé…ç½®æ–‡ä»¶"></a>application.ymlé…ç½®æ–‡ä»¶</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æœåŠ¡ç«¯</span></span><br><span class="line">spring:</span><br><span class="line">  application:</span><br><span class="line">    name: spring-boot-admin-server</span><br><span class="line"><span class="comment">//å®¢æˆ·ç«¯</span></span><br><span class="line">spring:</span><br><span class="line">  boot:</span><br><span class="line">    admin:</span><br><span class="line">      client:</span><br><span class="line">        url: http:<span class="comment">//localhost:8080</span></span><br><span class="line">server:</span><br><span class="line">  port: <span class="number">8081</span></span><br><span class="line">  </span><br><span class="line">management:</span><br><span class="line">  endpoints:</span><br><span class="line">    web:</span><br><span class="line">      exposure:</span><br><span class="line">        include: <span class="string">"*"</span></span><br><span class="line">  endpoint:</span><br><span class="line">    health:</span><br><span class="line">      show-details: ALWAYS</span><br></pre></td></tr></table></figure>
<h2 id="æ€§èƒ½ä¼˜åŒ–"><a href="#æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–"></a>æ€§èƒ½ä¼˜åŒ–</h2><h3 id="æ‰«åŒ…ä¼˜åŒ–"><a href="#æ‰«åŒ…ä¼˜åŒ–" class="headerlink" title="æ‰«åŒ…ä¼˜åŒ–"></a>æ‰«åŒ…ä¼˜åŒ–</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ <code>@SpringBootApplication</code> æ³¨è§£æ¥è‡ªåŠ¨è·å–åº”ç”¨çš„é…ç½®ä¿¡æ¯ï¼Œä½†è¿™æ ·ä¹Ÿä¼šç»™åº”ç”¨å¸¦æ¥ä¸€äº›å‰¯ä½œç”¨ã€‚ä½¿ç”¨è¿™ä¸ªæ³¨è§£åï¼Œä¼šè§¦å‘è‡ªåŠ¨é…ç½®ï¼ˆ auto-configuration ï¼‰å’Œ ç»„ä»¶æ‰«æ ï¼ˆ component scanning ï¼‰ï¼Œè¿™è·Ÿä½¿ç”¨ <code>@Configuration</code>ã€<code>@EnableAutoConfiguration</code> å’Œ <code>@ComponentScan</code> ä¸‰ä¸ªæ³¨è§£çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ã€‚è¿™æ ·åšç»™å¼€å‘å¸¦æ¥æ–¹ä¾¿çš„åŒæ—¶ï¼Œä¹Ÿä¼šæœ‰ä¸‰æ–¹é¢çš„å½±å“ï¼š</p>
<p>1ã€ä¼šå¯¼è‡´é¡¹ç›®å¯åŠ¨æ—¶é—´å˜é•¿ã€‚å½“å¯åŠ¨ä¸€ä¸ªå¤§çš„åº”ç”¨ç¨‹åº,æˆ–å°†åšå¤§é‡çš„é›†æˆæµ‹è¯•å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶ï¼Œå½±å“ä¼šç‰¹åˆ«æ˜æ˜¾ã€‚</p>
<p>2ã€ä¼šåŠ è½½ä¸€äº›ä¸éœ€è¦çš„å¤šä½™çš„å®ä¾‹ï¼ˆbeansï¼‰ã€‚</p>
<p>3ã€ä¼šå¢åŠ  CPU æ¶ˆè€—ã€‚</p>
<p>é’ˆå¯¹ä»¥ä¸Šä¸‰ä¸ªæƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ç§»é™¤ @SpringBootApplication å’Œ @ComponentScan ä¸¤ä¸ªæ³¨è§£æ¥ç¦ç”¨ç»„ä»¶è‡ªåŠ¨æ‰«æï¼Œç„¶ååœ¨æˆ‘ä»¬éœ€è¦çš„ bean ä¸Šè¿›è¡Œæ˜¾å¼é…ç½®ã€‚</p>
<h3 id="SpringBoot-JVMå‚æ•°è°ƒä¼˜"><a href="#SpringBoot-JVMå‚æ•°è°ƒä¼˜" class="headerlink" title="SpringBoot JVMå‚æ•°è°ƒä¼˜"></a>SpringBoot JVMå‚æ•°è°ƒä¼˜</h3><h5 id="å„ç§å‚æ•°"><a href="#å„ç§å‚æ•°" class="headerlink" title="å„ç§å‚æ•°"></a>å„ç§å‚æ•°</h5><table>
<thead>
<tr>
<th>å‚æ•°åç§°</th>
<th>å«ä¹‰</th>
<th>é»˜è®¤å€¼</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>-Xms</td>
<td>åˆå§‹å †å¤§å°</td>
<td>ç‰©ç†å†…å­˜çš„1/64(&lt;1GB)</td>
<td>é»˜è®¤(MinHeapFreeRatioå‚æ•°å¯ä»¥è°ƒæ•´)ç©ºä½™å †å†…å­˜å°äº40%æ—¶ï¼ŒJVMå°±ä¼šå¢å¤§å †ç›´åˆ°-Xmxçš„æœ€å¤§é™åˆ¶.</td>
</tr>
<tr>
<td>-Xmx</td>
<td>æœ€å¤§å †å¤§å°</td>
<td>ç‰©ç†å†…å­˜çš„1/4(&lt;1GB)</td>
<td>é»˜è®¤(MaxHeapFreeRatioå‚æ•°å¯ä»¥è°ƒæ•´)ç©ºä½™å †å†…å­˜å¤§äº70%æ—¶ï¼ŒJVMä¼šå‡å°‘å †ç›´åˆ° -Xmsçš„æœ€å°é™åˆ¶</td>
</tr>
<tr>
<td>-Xmn</td>
<td>å¹´è½»ä»£å¤§å°(1.4or lator)</td>
<td></td>
<td>æ³¨æ„ï¼šæ­¤å¤„çš„å¤§å°æ˜¯ï¼ˆeden+ 2 survivor space).ä¸jmap -heapä¸­æ˜¾ç¤ºçš„New genæ˜¯ä¸åŒçš„ã€‚ æ•´ä¸ªå †å¤§å°=å¹´è½»ä»£å¤§å° + å¹´è€ä»£å¤§å° + æŒä¹…ä»£å¤§å°. å¢å¤§å¹´è½»ä»£å,å°†ä¼šå‡å°å¹´è€ä»£å¤§å°.æ­¤å€¼å¯¹ç³»ç»Ÿæ€§èƒ½å½±å“è¾ƒå¤§,Sunå®˜æ–¹æ¨èé…ç½®ä¸ºæ•´ä¸ªå †çš„3/8</td>
</tr>
<tr>
<td>-XX:NewSize</td>
<td>è®¾ç½®å¹´è½»ä»£å¤§å°(for 1.3/1.4)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>-XX:MaxNewSize</td>
<td>å¹´è½»ä»£æœ€å¤§å€¼(for 1.3/1.4)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>-XX:PermSize</td>
<td>è®¾ç½®æŒä¹…ä»£(perm gen)åˆå§‹å€¼</td>
<td>ç‰©ç†å†…å­˜çš„1/64</td>
<td></td>
</tr>
<tr>
<td>-XX:MaxPermSize</td>
<td>è®¾ç½®æŒä¹…ä»£æœ€å¤§å€¼</td>
<td>ç‰©ç†å†…å­˜çš„1/4</td>
<td></td>
</tr>
<tr>
<td>-Xss</td>
<td>æ¯ä¸ªçº¿ç¨‹çš„å †æ ˆå¤§å°</td>
<td></td>
<td>JDK5.0ä»¥åæ¯ä¸ªçº¿ç¨‹å †æ ˆå¤§å°ä¸º1M,ä»¥å‰æ¯ä¸ªçº¿ç¨‹å †æ ˆå¤§å°ä¸º256K.æ›´å…·åº”ç”¨çš„çº¿ç¨‹æ‰€éœ€å†…å­˜å¤§å°è¿›è¡Œ è°ƒæ•´.åœ¨ç›¸åŒç‰©ç†å†…å­˜ä¸‹,å‡å°è¿™ä¸ªå€¼èƒ½ç”Ÿæˆæ›´å¤šçš„çº¿ç¨‹.ä½†æ˜¯æ“ä½œç³»ç»Ÿå¯¹ä¸€ä¸ªè¿›ç¨‹å†…çš„çº¿ç¨‹æ•°è¿˜æ˜¯æœ‰é™åˆ¶çš„,ä¸èƒ½æ— é™ç”Ÿæˆ,ç»éªŒå€¼åœ¨3000~5000å·¦å³ ä¸€èˆ¬å°çš„åº”ç”¨ï¼Œ å¦‚æœæ ˆä¸æ˜¯å¾ˆæ·±ï¼Œ åº”è¯¥æ˜¯128kå¤Ÿç”¨çš„ å¤§çš„åº”ç”¨å»ºè®®ä½¿ç”¨256kã€‚è¿™ä¸ªé€‰é¡¹å¯¹æ€§èƒ½å½±å“æ¯”è¾ƒå¤§ï¼Œéœ€è¦ä¸¥æ ¼çš„æµ‹è¯•ã€‚ï¼ˆæ ¡é•¿ï¼‰ å’Œthreadstacksizeé€‰é¡¹è§£é‡Šå¾ˆç±»ä¼¼,å®˜æ–¹æ–‡æ¡£ä¼¼ä¹æ²¡æœ‰è§£é‡Š,åœ¨è®ºå›ä¸­æœ‰è¿™æ ·ä¸€å¥è¯:â€â€ -Xss is translated in a VM flag named ThreadStackSizeâ€ ä¸€èˆ¬è®¾ç½®è¿™ä¸ªå€¼å°±å¯ä»¥äº†ã€‚</td>
</tr>
<tr>
<td>-XX:ThreadStackSize</td>
<td>Thread Stack Size</td>
<td></td>
<td>(0 means use default stack size) [Sparc: 512; Solaris x86: 320 (was 256 prior in 5.0 and earlier); Sparc 64 bit: 1024; Linux amd64: 1024 (was 0 in 5.0 and earlier); all others 0.]</td>
</tr>
<tr>
<td>-XX:NewRatio</td>
<td>å¹´è½»ä»£(åŒ…æ‹¬Edenå’Œä¸¤ä¸ªSurvivoråŒº)ä¸å¹´è€ä»£çš„æ¯”å€¼(é™¤å»æŒä¹…ä»£)</td>
<td></td>
<td>-XX:NewRatio=4è¡¨ç¤ºå¹´è½»ä»£ä¸å¹´è€ä»£æ‰€å æ¯”å€¼ä¸º1:4,å¹´è½»ä»£å æ•´ä¸ªå †æ ˆçš„1/5 Xms=Xmxå¹¶ä¸”è®¾ç½®äº†Xmnçš„æƒ…å†µä¸‹ï¼Œè¯¥å‚æ•°ä¸éœ€è¦è¿›è¡Œè®¾ç½®ã€‚</td>
</tr>
<tr>
<td>-XX:SurvivorRatio</td>
<td>EdenåŒºä¸SurvivoråŒºçš„å¤§å°æ¯”å€¼</td>
<td></td>
<td>è®¾ç½®ä¸º8,åˆ™ä¸¤ä¸ªSurvivoråŒºä¸ä¸€ä¸ªEdenåŒºçš„æ¯”å€¼ä¸º2:8,ä¸€ä¸ªSurvivoråŒºå æ•´ä¸ªå¹´è½»ä»£çš„1/10</td>
</tr>
<tr>
<td>-XX:LargePageSizeInBytes</td>
<td>å†…å­˜é¡µçš„å¤§å°ä¸å¯è®¾ç½®è¿‡å¤§ï¼Œ ä¼šå½±å“Permçš„å¤§å°</td>
<td></td>
<td>=128m</td>
</tr>
<tr>
<td>-XX:+UseFastAccessorMethods</td>
<td>åŸå§‹ç±»å‹çš„å¿«é€Ÿä¼˜åŒ–</td>
<td></td>
<td></td>
</tr>
<tr>
<td>-XX:+DisableExplicitGC</td>
<td>å…³é—­System.gc()</td>
<td></td>
<td>è¿™ä¸ªå‚æ•°éœ€è¦ä¸¥æ ¼çš„æµ‹è¯•</td>
</tr>
<tr>
<td>-XX:MaxTenuringThreshold</td>
<td>åƒåœ¾æœ€å¤§å¹´é¾„</td>
<td></td>
<td>å¦‚æœè®¾ç½®ä¸º0çš„è¯,åˆ™å¹´è½»ä»£å¯¹è±¡ä¸ç»è¿‡SurvivoråŒº,ç›´æ¥è¿›å…¥å¹´è€ä»£. å¯¹äºå¹´è€ä»£æ¯”è¾ƒå¤šçš„åº”ç”¨,å¯ä»¥æé«˜æ•ˆç‡.å¦‚æœå°†æ­¤å€¼è®¾ç½®ä¸ºä¸€ä¸ªè¾ƒå¤§å€¼,åˆ™å¹´è½»ä»£å¯¹è±¡ä¼šåœ¨SurvivoråŒºè¿›è¡Œå¤šæ¬¡å¤åˆ¶,è¿™æ ·å¯ä»¥å¢åŠ å¯¹è±¡å†å¹´è½»ä»£çš„å­˜æ´» æ—¶é—´,å¢åŠ åœ¨å¹´è½»ä»£å³è¢«å›æ”¶çš„æ¦‚ç‡ è¯¥å‚æ•°åªæœ‰åœ¨ä¸²è¡ŒGCæ—¶æ‰æœ‰æ•ˆ.</td>
</tr>
<tr>
<td>-XX:+AggressiveOpts</td>
<td>åŠ å¿«ç¼–è¯‘</td>
<td></td>
<td></td>
</tr>
<tr>
<td>-XX:+UseBiasedLocking</td>
<td>é”æœºåˆ¶çš„æ€§èƒ½æ”¹å–„</td>
<td></td>
<td></td>
</tr>
<tr>
<td>-Xnoclassgc</td>
<td>ç¦ç”¨åƒåœ¾å›æ”¶</td>
<td></td>
<td></td>
</tr>
<tr>
<td>-XX:SoftRefLRUPolicyMSPerMB</td>
<td>æ¯å…†å †ç©ºé—²ç©ºé—´ä¸­SoftReferenceçš„å­˜æ´»æ—¶é—´</td>
<td>1s</td>
<td>softly reachable objects will remain alive for some amount of time after the last time they were referenced. The default value is one second of lifetime per free megabyte in the heap</td>
</tr>
<tr>
<td>-XX:PretenureSizeThreshold</td>
<td>å¯¹è±¡è¶…è¿‡å¤šå¤§æ˜¯ç›´æ¥åœ¨æ—§ç”Ÿä»£åˆ†é…</td>
<td>0</td>
<td>å•ä½å­—èŠ‚ æ–°ç”Ÿä»£é‡‡ç”¨Parallel Scavenge GCæ—¶æ— æ•ˆ å¦ä¸€ç§ç›´æ¥åœ¨æ—§ç”Ÿä»£åˆ†é…çš„æƒ…å†µæ˜¯å¤§çš„æ•°ç»„å¯¹è±¡,ä¸”æ•°ç»„ä¸­æ— å¤–éƒ¨å¼•ç”¨å¯¹è±¡.</td>
</tr>
<tr>
<td>-XX:TLABWasteTargetPercent</td>
<td>TLABå edenåŒºçš„ç™¾åˆ†æ¯”</td>
<td>1%</td>
<td></td>
</tr>
<tr>
<td>-XX:+CollectGen0First</td>
<td>FullGCæ—¶æ˜¯å¦å…ˆYGC</td>
<td>false</td>
</tr>
</tbody>
</table>
<h5 id="è°ƒä¼˜ç­–ç•¥"><a href="#è°ƒä¼˜ç­–ç•¥" class="headerlink" title="è°ƒä¼˜ç­–ç•¥"></a>è°ƒä¼˜ç­–ç•¥</h5><ol>
<li>åˆå§‹åŒ–å †å†…å­˜å’Œæœ€å¤§å †ç›¸åŒ</li>
<li>å‡å°‘åƒåœ¾å›æ”¶æ¬¡æ•°</li>
</ol>
<h5 id="å†…éƒ¨è°ƒä¼˜"><a href="#å†…éƒ¨è°ƒä¼˜" class="headerlink" title="å†…éƒ¨è°ƒä¼˜"></a>å†…éƒ¨è°ƒä¼˜</h5><p><img src="/2018/08/04/springboot/4.png" alt="1533633207629"></p>
<p>è¾“å…¥ -XX:+PrintGCDetails æ˜¯ä¸ºäº†åœ¨æ§åˆ¶å°æ˜¾ç¤ºå›æ”¶çš„ä¿¡æ¯</p>
<p><img src="/2018/08/04/springboot/5.png" alt="1533633302622"></p>
<h5 id="å¤–éƒ¨è°ƒä¼˜"><a href="#å¤–éƒ¨è°ƒä¼˜" class="headerlink" title="å¤–éƒ¨è°ƒä¼˜"></a>å¤–éƒ¨è°ƒä¼˜</h5><p>è¿›å…¥å¯¹åº”jarçš„ç›®å½•ï¼Œåœ¨CMDè¾“å…¥<code>java -server -Xms32m -Xmx32m  -jar springboot.jar</code> </p>
<h5 id="ä½¿ç”¨å·¥å…·java-visual-vm"><a href="#ä½¿ç”¨å·¥å…·java-visual-vm" class="headerlink" title="ä½¿ç”¨å·¥å…·java visual vm"></a>ä½¿ç”¨å·¥å…·java visual vm</h5><p><img src="/2018/08/04/springboot/6.jpg" alt="1533633302622"></p>
<h5 id="ä½¿ç”¨å·¥å…·java-console"><a href="#ä½¿ç”¨å·¥å…·java-console" class="headerlink" title="ä½¿ç”¨å·¥å…·java console"></a>ä½¿ç”¨å·¥å…·java console</h5><p><img src="/2018/08/04/springboot/7.png" alt="1533633885354"></p>
<h3 id="å°†Servletå®¹å™¨ä»Tomcatå˜æˆUndertow"><a href="#å°†Servletå®¹å™¨ä»Tomcatå˜æˆUndertow" class="headerlink" title="å°†Servletå®¹å™¨ä»Tomcatå˜æˆUndertow"></a>å°†Servletå®¹å™¨ä»Tomcatå˜æˆUndertow</h3><p>Undertow æ˜¯ä¸€ä¸ªé‡‡ç”¨ Java å¼€å‘çš„çµæ´»çš„é«˜æ€§èƒ½ Web æœåŠ¡å™¨ï¼Œæä¾›åŒ…æ‹¬é˜»å¡å’ŒåŸºäº NIO çš„éå µå¡æœºåˆ¶ã€‚Undertow æ˜¯çº¢å¸½å…¬å¸çš„å¼€æºäº§å“ï¼Œæ˜¯ JBossé»˜è®¤çš„ Web æœåŠ¡å™¨ã€‚ğŸ‘‡</p>
<p><a href="http://undertow.io/" target="_blank" rel="noopener">Undertow</a></p>
<h4 id="POM-18"><a href="#POM-18" class="headerlink" title="POM"></a>POM</h4><p>é¦–å…ˆï¼Œä»ä¾èµ–ä¿¡æ¯é‡Œç§»é™¤ Tomcat é…ç½® </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åæ·»åŠ  Undertowï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-undertow<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Tomcat-ä¼˜åŒ–"><a href="#Tomcat-ä¼˜åŒ–" class="headerlink" title="Tomcat ä¼˜åŒ–"></a>Tomcat ä¼˜åŒ–</h3><p>è§ğŸ‘‰<a href="https://spring.io/blog/2015/12/10/spring-boot-memory-performance" target="_blank" rel="noopener">Spring Boot Memory Performance</a></p>
<h2 id="çƒ­éƒ¨ç½²"><a href="#çƒ­éƒ¨ç½²" class="headerlink" title="çƒ­éƒ¨ç½²"></a>çƒ­éƒ¨ç½²</h2><p>çƒ­éƒ¨ç½²ï¼Œå°±æ˜¯åœ¨åº”ç”¨ç¨‹åºåœ¨ä¸åœæ­¢çš„æƒ…å†µä¸‹ï¼Œè‡ªåŠ¨å®ç°æ–°çš„éƒ¨ç½²</p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>ä½¿ç”¨ç±»åŠ è½½å™¨classroadæ¥æ£€æµ‹å­—èŠ‚ç æ–‡ä»¶ï¼Œç„¶åé‡æ–°åŠ è½½åˆ°jvmå†…å­˜ä¸­</p>
<p>ç¬¬ä¸€æ­¥ï¼šæ£€æµ‹æœ¬åœ°<code>.class</code>æ–‡ä»¶å˜åŠ¨ï¼ˆç‰ˆæœ¬å·ï¼Œä¿®æ”¹æ—¶é—´ä¸ä¸€æ ·ï¼‰</p>
<p>ç¬¬äºŒæ­¥ï¼šè‡ªåŠ¨ç›‘å¬ï¼Œå®ç°éƒ¨ç½²</p>
<h3 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h3><p>æœ¬åœ°å¼€å‘æ—¶ï¼Œå¯ä»¥æé«˜è¿è¡Œç¯å¢ƒ</p>
<h3 id="Dev-tools"><a href="#Dev-tools" class="headerlink" title="Dev-tools"></a>Dev-tools</h3><p>spring-boot-devtools æ˜¯ä¸€ä¸ªä¸ºå¼€å‘è€…æœåŠ¡çš„ä¸€ä¸ªæ¨¡å—ï¼Œå…¶ä¸­æœ€é‡è¦çš„åŠŸèƒ½å°±æ˜¯è‡ªåŠ¨åº”ç”¨ä»£ç æ›´æ”¹åˆ°æœ€æ–°çš„Appä¸Šé¢å»</p>
<h4 id="POM-19"><a href="#POM-19" class="headerlink" title="POM"></a>POM</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">scope</span>&gt;</span>true<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h4><ol>
<li>devtoolsä¼šç›‘å¬classpathä¸‹çš„æ–‡ä»¶å˜åŠ¨ï¼Œå¹¶ä¸”ä¼šç«‹å³é‡å¯åº”ç”¨ï¼ˆå‘ç”Ÿåœ¨ä¿å­˜æ—¶æœºï¼‰ï¼Œå› ä¸ºå…¶é‡‡ç”¨çš„è™šæ‹Ÿæœºæœºåˆ¶ï¼Œè¯¥é¡¹é‡å¯æ˜¯å¾ˆå¿«çš„ã€‚  </li>
<li>devtoolså¯ä»¥å®ç°é¡µé¢çƒ­éƒ¨ç½²ï¼ˆå³é¡µé¢ä¿®æ”¹åä¼šç«‹å³ç”Ÿæ•ˆï¼Œè¿™ä¸ªå¯ä»¥ç›´æ¥åœ¨application.propertiesæ–‡ä»¶ä¸­é…ç½®spring.thymeleaf.cache=falseæ¥å®ç°(æ³¨æ„ï¼šä¸åŒçš„æ¨¡æ¿é…ç½®ä¸ä¸€æ ·)  </li>
</ol>
<h2 id="å‘å¸ƒæ‰“åŒ…"><a href="#å‘å¸ƒæ‰“åŒ…" class="headerlink" title="å‘å¸ƒæ‰“åŒ…"></a>å‘å¸ƒæ‰“åŒ…</h2><h3 id="Jarç±»å‹æ‰“åŒ…æ–¹å¼"><a href="#Jarç±»å‹æ‰“åŒ…æ–¹å¼" class="headerlink" title="Jarç±»å‹æ‰“åŒ…æ–¹å¼"></a>Jarç±»å‹æ‰“åŒ…æ–¹å¼</h3><p>1.ä½¿ç”¨mvn clean  package æ‰“åŒ…</p>
<p>2.ä½¿ç”¨java â€“jar åŒ…å</p>
<h3 id="warç±»å‹æ‰“åŒ…æ–¹å¼"><a href="#warç±»å‹æ‰“åŒ…æ–¹å¼" class="headerlink" title="warç±»å‹æ‰“åŒ…æ–¹å¼"></a>warç±»å‹æ‰“åŒ…æ–¹å¼</h3><p>1.ä½¿ç”¨mvn celan package æ‰“åŒ…</p>
<p>2.ä½¿ç”¨java â€“jar åŒ…å </p>
<h3 id="å¤–éƒ¨Tomcatè¿è¡Œ"><a href="#å¤–éƒ¨Tomcatè¿è¡Œ" class="headerlink" title="å¤–éƒ¨Tomcatè¿è¡Œ"></a>å¤–éƒ¨Tomcatè¿è¡Œ</h3><p>1.ä½¿ç”¨mvn celan package æ‰“åŒ…</p>
<p>2.å°†waråŒ… æ”¾å…¥åˆ°tomcat webappsä¸‹è¿è¡Œå³å¯ã€‚</p>
<p>æ³¨æ„:springboot2.0å†…ç½®tomcat8.5.25ï¼Œå»ºè®®ä½¿ç”¨å¤–éƒ¨Tomcat9.0ç‰ˆæœ¬è¿è¡Œå³å¯,å¦åˆ™æŠ¥é”™ç‰ˆæœ¬ä¸å…¼å®¹ã€‚</p>
<h3 id="POM-20"><a href="#POM-20" class="headerlink" title="POM"></a>POM</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">maimClass</span>&gt;</span>com.itmayiedu.app.App<span class="tag">&lt;/<span class="name">maimClass</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">goal</span>&gt;</span>repackage<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"></span><br><span class="line">			<span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a href="http://blog.didispace.com/springbootdata1/" target="_blank" rel="noopener">JdbcTemplate</a></p>
<p><a href="https://blog.csdn.net/qq_28988969/article/details/78082116" target="_blank" rel="noopener">SpringBootåˆ†é¡µæ’ä»¶PageHelper</a></p>
<p><a href="https://www.cnblogs.com/arli/p/6914057.html" target="_blank" rel="noopener">jpa</a></p>
<p><a href="http://www.spring4all.com/article/558" target="_blank" rel="noopener">Spring For All ç¤¾åŒº Spring å®˜æ–¹æ•™ç¨‹ç¿»è¯‘</a></p>
<p><a href="https://www.cnblogs.com/gdpuzxs/p/7222309.html" target="_blank" rel="noopener">SpringBootä½¿ç”¨Redisç¼“å­˜</a></p>
<p><a href="https://blog.csdn.net/u010889990/article/details/78883764" target="_blank" rel="noopener">Spring Boot Adminç®€å•ä½¿ç”¨</a></p>
<p><a href="https://blog.csdn.net/github_32521685/article/details/50463895" target="_blank" rel="noopener">Spring Boot æ€§èƒ½ä¼˜åŒ–</a></p>
<p><a href="https://blog.csdn.net/u013970971/article/details/79468356" target="_blank" rel="noopener">WebFlux</a></p>
<p>æ„Ÿè°¢ä»¥ä¸Šå¤§å¤§ä»¬~ï¼</p>
<p>å¹¿å‘Šæ—¶é—´ï¼šæƒ³è¦äº†è§£æ›´å¤šç²¾å½©æ–°å§¿åŠ¿ï¼Ÿè¯·è®¿é—®<a href="https://blog.tengshe789.tech/" target="_blank" rel="noopener">æˆ‘çš„åšå®¢</a></p>

      
    </div>
    
    
    
      <div>
        
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------æœ¬ç¨¿ãŒçµ‚ã‚ã‚‹<i class="fa fa-paw"></i>æ„Ÿè°¢æ‚¨çš„é˜…è¯»-------------</div>
    
</div>
        
      </div>
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>æ‰“èµ</span>
  </button>
  <div id="QR" style="display: none;">

    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="tEngSHe789 æ”¯ä»˜å®">
        <p>æ”¯ä»˜å®</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š</strong>
    tEngSHe789
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://tengshe789.github.io/2018/08/04/springboot/" title="è¿™æ˜¯ä¸€ç¯‡ä¼˜é›…çš„Springboot2.0ä½¿ç”¨æ‰‹å†Œ">https://tengshe789.github.io/2018/08/04/springboot/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
    æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/æŠ€æœ¯/" rel="tag"><i class="fa fa-tag"></i> æŠ€æœ¯</a>
          
            <a href="/tags/java/" rel="tag"><i class="fa fa-tag"></i> java</a>
          
            <a href="/tags/Spring/" rel="tag"><i class="fa fa-tag"></i> Spring</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/08/02/å¦‚ä½•ä¸€é”®è£…B/" rel="next" title="å®‰åˆ©è½¯ä»¶-å¦‚ä½•ä¸€é”®è£…B">
                <i class="fa fa-chevron-left"></i> å®‰åˆ©è½¯ä»¶-å¦‚ä½•ä¸€é”®è£…B
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/08/04/åŠ æ²¹/" rel="prev" title="ä¸è¦æ‡’æƒ°ï¼ŒåŠ æ²¹">
                ä¸è¦æ‡’æƒ°ï¼ŒåŠ æ²¹ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-7659349864173199",
    enable_page_level_ads: true
  });
</script>
    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="tEngSHe789">
            
              <p class="site-author-name" itemprop="name">tEngSHe789</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">56</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">29</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/tengshe789" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:randyvan007@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://plus.google.com/101453729765094892757" target="_blank" title="Google">
                      
                        <i class="fa fa-fw fa-google"></i>Google</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/tengshe789" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://t.me/tengshe789" target="_blank" title="Telegram">
                      
                        <i class="fa fa-fw fa-telegram"></i>Telegram</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://steamcommunity.com/id/tengshe789" target="_blank" title="Steam">
                      
                        <i class="fa fa-fw fa-steam"></i>Steam</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://stackoverflow.com/users/9930788/tengshe-789" target="_blank" title="StackOverflow">
                      
                        <i class="fa fa-fw fa-stack-overflow"></i>StackOverflow</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://dribbble.com/tengshe789" target="_blank" title="dribbble">
                      
                        <i class="fa fa-fw fa-dribbble"></i>dribbble</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://instagram.com/ha.7787" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://weibo.com/5649075808" target="_blank" title="å¾®åš">
                      
                        <i class="fa fa-fw fa-weibo"></i>å¾®åš</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://user.qzone.qq.com/970176296" target="_blank" title="QQZone">
                      
                        <i class="fa fa-fw fa-qq"></i>QQZone</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://music.163.com/#/user/home?id=73274594" target="_blank" title="ç½‘æ˜“äº‘éŸ³ä¹">
                      
                        <i class="fa fa-fw fa-music"></i>ç½‘æ˜“äº‘éŸ³ä¹</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im/user/5b4c1dd0e51d45194558166b" target="_blank" title="æ˜é‡‘">
                      
                        <i class="fa fa-fw fa-spinner"></i>æ˜é‡‘</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://segmentfault.com/u/tengshe789" target="_blank" title="æ€å¦">
                      
                        <i class="fa fa-fw fa-scribd"></i>æ€å¦</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#å•¥æ˜¯Springboot"><span class="nav-number">1.</span> <span class="nav-text">å•¥æ˜¯Springboot</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å’ŒJFinalçš„åŒºåˆ«"><span class="nav-number">1.1.</span> <span class="nav-text">å’ŒJFinalçš„åŒºåˆ«</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸Springcloudçš„åŒºåˆ«"><span class="nav-number">1.2.</span> <span class="nav-text">ä¸Springcloudçš„åŒºåˆ«</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SpringBootå’ŒSpringMVCåŒºåˆ«"><span class="nav-number">1.3.</span> <span class="nav-text">SpringBootå’ŒSpringMVCåŒºåˆ«</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¿«é€Ÿä½¿ç”¨"><span class="nav-number">2.</span> <span class="nav-text">å¿«é€Ÿä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å»ºç«‹é¡¹ç›®"><span class="nav-number">2.1.</span> <span class="nav-text">å»ºç«‹é¡¹ç›®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å†™ä¸€ä¸ªDEMO"><span class="nav-number">2.2.</span> <span class="nav-text">å†™ä¸€ä¸ªDEMO</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SpringApplication-run"><span class="nav-number">2.2.1.</span> <span class="nav-text">SpringApplication.run</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åŸºç¡€æ³¨è§£è§£é‡Š"><span class="nav-number">2.3.</span> <span class="nav-text">åŸºç¡€æ³¨è§£è§£é‡Š</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RestController"><span class="nav-number">2.3.1.</span> <span class="nav-text">@RestController</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SpringBootApplication"><span class="nav-number">2.3.2.</span> <span class="nav-text">@SpringBootApplication</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ComponentScan-â€œcn-tengshe789-controllerâ€"><span class="nav-number">2.3.3.</span> <span class="nav-text">@ComponentScan(â€œcn.tengshe789.controllerâ€)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#EnableAutoConfiguration"><span class="nav-number">2.3.4.</span> <span class="nav-text">@EnableAutoConfiguration</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é…ç½®æ–‡ä»¶"><span class="nav-number">3.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#properties"><span class="nav-number">3.1.</span> <span class="nav-text">properties</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#è‡ªå®šä¹‰å‚æ•°"><span class="nav-number">3.1.1.</span> <span class="nav-text">è‡ªå®šä¹‰å‚æ•°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¤šç¯å¢ƒé…ç½®"><span class="nav-number">3.1.2.</span> <span class="nav-text">å¤šç¯å¢ƒé…ç½®</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä¿®æ”¹ç«¯å£å·"><span class="nav-number">3.1.3.</span> <span class="nav-text">ä¿®æ”¹ç«¯å£å·</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#yaml"><span class="nav-number">3.2.</span> <span class="nav-text">yaml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xml"><span class="nav-number">3.3.</span> <span class="nav-text">xml</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Webå¼€å‘"><span class="nav-number">4.</span> <span class="nav-text">Webå¼€å‘</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å¦‚ä½•è®¿é—®é™æ€èµ„æº"><span class="nav-number">4.1.</span> <span class="nav-text">å¦‚ä½•è®¿é—®é™æ€èµ„æº</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å…³äºæ¸²æŸ“Webé¡µé¢"><span class="nav-number">4.2.</span> <span class="nav-text">å…³äºæ¸²æŸ“Webé¡µé¢</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æ¨¡æ¿å¼•æ“æ–¹æ³•"><span class="nav-number">4.2.1.</span> <span class="nav-text">æ¨¡æ¿å¼•æ“æ–¹æ³•</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Thymeleafï¼ˆèƒ¸è…ºï¼‰"><span class="nav-number">4.3.</span> <span class="nav-text">Thymeleafï¼ˆèƒ¸è…ºï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM"><span class="nav-number">4.3.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®æ–‡ä»¶-1"><span class="nav-number">4.3.2.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åå°"><span class="nav-number">4.3.3.</span> <span class="nav-text">åå°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å‰å°"><span class="nav-number">4.3.4.</span> <span class="nav-text">å‰å°</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Freemarker-è‡ªç”±æ ‡è®°"><span class="nav-number">4.4.</span> <span class="nav-text">Freemarker(è‡ªç”±æ ‡è®°)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-1"><span class="nav-number">4.4.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®æ–‡ä»¶-2"><span class="nav-number">4.4.2.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åå°-1"><span class="nav-number">4.4.3.</span> <span class="nav-text">åå°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å‰å°-1"><span class="nav-number">4.4.4.</span> <span class="nav-text">å‰å°</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JSP"><span class="nav-number">4.5.</span> <span class="nav-text">JSP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-2"><span class="nav-number">4.5.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®æ–‡ä»¶-3"><span class="nav-number">4.5.2.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åå°-2"><span class="nav-number">4.5.3.</span> <span class="nav-text">åå°</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å‰å°-2"><span class="nav-number">4.6.</span> <span class="nav-text">å‰å°</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é¢å‘æµç¼–ç¨‹"><span class="nav-number">5.</span> <span class="nav-text">é¢å‘æµç¼–ç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Webflux"><span class="nav-number">5.1.</span> <span class="nav-text">Spring Webflux</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-3"><span class="nav-number">5.1.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å®˜æ–¹å®ä¾‹"><span class="nav-number">5.1.2.</span> <span class="nav-text">å®˜æ–¹å®ä¾‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Controllerå±‚"><span class="nav-number">5.1.3.</span> <span class="nav-text">Controllerå±‚</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Service-å±‚"><span class="nav-number">5.1.4.</span> <span class="nav-text">Service å±‚</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è·¯ç”±å™¨ç±»-Router"><span class="nav-number">5.1.5.</span> <span class="nav-text">è·¯ç”±å™¨ç±» Router</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Async"><span class="nav-number">5.2.</span> <span class="nav-text">@Async</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ•°æ®è®¿é—®"><span class="nav-number">6.</span> <span class="nav-text">æ•°æ®è®¿é—®</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ•´åˆJdbcTemplate"><span class="nav-number">6.1.</span> <span class="nav-text">æ•´åˆJdbcTemplate</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-4"><span class="nav-number">6.1.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®æ–‡ä»¶-4"><span class="nav-number">6.1.2.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åå°-3"><span class="nav-number">6.1.3.</span> <span class="nav-text">åå°</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ•´åˆMybatis"><span class="nav-number">6.2.</span> <span class="nav-text">æ•´åˆMybatis</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-5"><span class="nav-number">6.2.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®æ–‡ä»¶-5"><span class="nav-number">6.2.2.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åå°-4"><span class="nav-number">6.2.3.</span> <span class="nav-text">åå°</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mybatisæ•´åˆåˆ†é¡µæ’ä»¶PageHelper"><span class="nav-number">6.3.</span> <span class="nav-text">Mybatisæ•´åˆåˆ†é¡µæ’ä»¶PageHelper</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-6"><span class="nav-number">6.3.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®æ–‡ä»¶-6"><span class="nav-number">6.3.2.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä»£ç "><span class="nav-number">6.3.3.</span> <span class="nav-text">ä»£ç </span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#å®ä½“å±‚é¢"><span class="nav-number">6.3.3.1.</span> <span class="nav-text">å®ä½“å±‚é¢</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Daoå±‚"><span class="nav-number">6.3.3.2.</span> <span class="nav-text">Daoå±‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Serviceå±‚"><span class="nav-number">6.3.3.3.</span> <span class="nav-text">Serviceå±‚</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ•´åˆSpringJPA"><span class="nav-number">6.4.</span> <span class="nav-text">æ•´åˆSpringJPA</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-7"><span class="nav-number">6.4.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®æ–‡ä»¶-7"><span class="nav-number">6.4.2.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä»£ç -1"><span class="nav-number">6.4.3.</span> <span class="nav-text">ä»£ç </span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Domain"><span class="nav-number">6.4.3.1.</span> <span class="nav-text">Domain</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Daoå±‚-1"><span class="nav-number">6.4.3.2.</span> <span class="nav-text">Daoå±‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Controller"><span class="nav-number">6.4.3.3.</span> <span class="nav-text">Controller</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¤šæ•°æ®æº"><span class="nav-number">6.5.</span> <span class="nav-text">å¤šæ•°æ®æº</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®æ–‡ä»¶-8"><span class="nav-number">6.5.1.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä»£ç -2"><span class="nav-number">6.5.2.</span> <span class="nav-text">ä»£ç </span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#æ·»åŠ é…ç½®"><span class="nav-number">6.5.2.1.</span> <span class="nav-text">æ·»åŠ é…ç½®</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Dao"><span class="nav-number">6.5.2.2.</span> <span class="nav-text">Dao</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ³¨æ„äº‹é¡¹"><span class="nav-number">6.5.3.</span> <span class="nav-text">æ³¨æ„äº‹é¡¹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#äº‹ç‰©ç®¡ç†"><span class="nav-number">7.</span> <span class="nav-text">äº‹ç‰©ç®¡ç†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å£°æ˜å¼äº‹åŠ¡"><span class="nav-number">7.1.</span> <span class="nav-text">å£°æ˜å¼äº‹åŠ¡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆ†å¸ƒå¼äº‹ç‰©ç®¡ç†"><span class="nav-number">7.2.</span> <span class="nav-text">åˆ†å¸ƒå¼äº‹ç‰©ç®¡ç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ç±»äº‹åŠ¡ç®¡ç†å™¨Atomikos"><span class="nav-number">7.2.1.</span> <span class="nav-text">ç±»äº‹åŠ¡ç®¡ç†å™¨Atomikos</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#POM-8"><span class="nav-number">7.2.1.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#é…ç½®æ–‡ä»¶-9"><span class="nav-number">7.2.1.2.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è¯»å–é…ç½®æ–‡ä»¶ä¿¡æ¯"><span class="nav-number">7.2.1.3.</span> <span class="nav-text">è¯»å–é…ç½®æ–‡ä»¶ä¿¡æ¯</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#åˆ›å»ºæ•°æ®æº"><span class="nav-number">7.2.1.4.</span> <span class="nav-text">åˆ›å»ºæ•°æ®æº</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¦‚ä½•å¯åŠ¨"><span class="nav-number">7.2.1.5.</span> <span class="nav-text">å¦‚ä½•å¯åŠ¨</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å®šæ—¶ä»»åŠ¡"><span class="nav-number">8.</span> <span class="nav-text">å®šæ—¶ä»»åŠ¡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Schedule"><span class="nav-number">8.1.</span> <span class="nav-text">Spring Schedule</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ä»£ç -3"><span class="nav-number">8.1.1.</span> <span class="nav-text">ä»£ç </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¯åŠ¨"><span class="nav-number">8.1.2.</span> <span class="nav-text">å¯åŠ¨</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Quartz"><span class="nav-number">8.2.</span> <span class="nav-text">Quartz</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-9"><span class="nav-number">8.2.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®æ–‡ä»¶-10"><span class="nav-number">8.2.2.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®ç±»"><span class="nav-number">8.2.3.</span> <span class="nav-text">é…ç½®ç±»</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å®ç°ç±»"><span class="nav-number">8.2.4.</span> <span class="nav-text">å®ç°ç±»</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ—¥å¿—ç®¡ç†"><span class="nav-number">9.</span> <span class="nav-text">æ—¥å¿—ç®¡ç†</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#log4j"><span class="nav-number">9.1.</span> <span class="nav-text">log4j</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-10"><span class="nav-number">9.1.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®æ–‡ä»¶-11"><span class="nav-number">9.1.2.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨"><span class="nav-number">9.1.3.</span> <span class="nav-text">ä½¿ç”¨</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä½¿ç”¨AOPç»Ÿä¸€å¤„ç†Webè¯·æ±‚æ—¥å¿—"><span class="nav-number">9.2.</span> <span class="nav-text">ä½¿ç”¨AOPç»Ÿä¸€å¤„ç†Webè¯·æ±‚æ—¥å¿—</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-11"><span class="nav-number">9.2.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä»£ç -4"><span class="nav-number">9.2.2.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#lombok-æ’ä»¶"><span class="nav-number">9.3.</span> <span class="nav-text">lombok æ’ä»¶</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-12"><span class="nav-number">9.3.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä»£ç -5"><span class="nav-number">9.3.2.</span> <span class="nav-text">ä»£ç </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Lombokçš„å…¶ä»–ç”¨æ³•"><span class="nav-number">9.3.3.</span> <span class="nav-text">Lombokçš„å…¶ä»–ç”¨æ³•</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ‹¦æˆªå™¨"><span class="nav-number">10.</span> <span class="nav-text">æ‹¦æˆªå™¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#è‡ªå®šä¹‰æ‹¦æˆªå™¨"><span class="nav-number">10.1.</span> <span class="nav-text">è‡ªå®šä¹‰æ‹¦æˆªå™¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ä»£ç -6"><span class="nav-number">10.1.1.</span> <span class="nav-text">ä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç¼“å­˜"><span class="nav-number">11.</span> <span class="nav-text">ç¼“å­˜</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#EhCache"><span class="nav-number">11.1.</span> <span class="nav-text">EhCache</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-13"><span class="nav-number">11.1.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ–°å»ºehcache-xml-æ–‡ä»¶"><span class="nav-number">11.1.2.</span> <span class="nav-text">æ–°å»ºehcache.xml æ–‡ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å…³äºæ³¨è§£å’Œä»£ç ä½¿ç”¨"><span class="nav-number">11.1.3.</span> <span class="nav-text">å…³äºæ³¨è§£å’Œä»£ç ä½¿ç”¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ¸…é™¤ç¼“å­˜"><span class="nav-number">11.1.4.</span> <span class="nav-text">æ¸…é™¤ç¼“å­˜</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¯åŠ¨-1"><span class="nav-number">11.1.5.</span> <span class="nav-text">å¯åŠ¨</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Redis"><span class="nav-number">11.2.</span> <span class="nav-text">Redis</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨è‡ªå¸¦é©±åŠ¨å™¨è¿æ¥"><span class="nav-number">11.2.1.</span> <span class="nav-text">ä½¿ç”¨è‡ªå¸¦é©±åŠ¨å™¨è¿æ¥</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#POM-14"><span class="nav-number">11.2.1.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#é…ç½®æ–‡ä»¶-12"><span class="nav-number">11.2.1.2.</span> <span class="nav-text">é…ç½®æ–‡ä»¶</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#é…ç½®ç±»-1"><span class="nav-number">11.2.1.3.</span> <span class="nav-text">é…ç½®ç±»</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Dao-1"><span class="nav-number">11.2.1.4.</span> <span class="nav-text">Dao</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨Jedisè¿æ¥"><span class="nav-number">11.2.2.</span> <span class="nav-text">ä½¿ç”¨Jedisè¿æ¥</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#POM-15"><span class="nav-number">11.2.2.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#é…ç½®ç±»-2"><span class="nav-number">11.2.2.2.</span> <span class="nav-text">é…ç½®ç±»</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç›‘æ§ä¸­å¿ƒ"><span class="nav-number">12.</span> <span class="nav-text">ç›‘æ§ä¸­å¿ƒ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Actuator"><span class="nav-number">12.1.</span> <span class="nav-text">Actuator</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-16"><span class="nav-number">12.1.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®ä¿¡æ¯"><span class="nav-number">12.1.2.</span> <span class="nav-text">é…ç½®ä¿¡æ¯</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Actuatorè®¿é—®è·¯å¾„"><span class="nav-number">12.1.3.</span> <span class="nav-text">Actuatorè®¿é—®è·¯å¾„</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Admin-UIåˆ†å¸ƒå¼å¾®æœåŠ¡ç›‘æ§ä¸­å¿ƒ"><span class="nav-number">12.2.</span> <span class="nav-text">Admin-UIåˆ†å¸ƒå¼å¾®æœåŠ¡ç›‘æ§ä¸­å¿ƒ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-17"><span class="nav-number">12.2.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#application-ymlé…ç½®æ–‡ä»¶"><span class="nav-number">12.2.2.</span> <span class="nav-text">application.ymlé…ç½®æ–‡ä»¶</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ€§èƒ½ä¼˜åŒ–"><span class="nav-number">13.</span> <span class="nav-text">æ€§èƒ½ä¼˜åŒ–</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ‰«åŒ…ä¼˜åŒ–"><span class="nav-number">13.1.</span> <span class="nav-text">æ‰«åŒ…ä¼˜åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SpringBoot-JVMå‚æ•°è°ƒä¼˜"><span class="nav-number">13.2.</span> <span class="nav-text">SpringBoot JVMå‚æ•°è°ƒä¼˜</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#å„ç§å‚æ•°"><span class="nav-number">13.2.0.1.</span> <span class="nav-text">å„ç§å‚æ•°</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è°ƒä¼˜ç­–ç•¥"><span class="nav-number">13.2.0.2.</span> <span class="nav-text">è°ƒä¼˜ç­–ç•¥</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å†…éƒ¨è°ƒä¼˜"><span class="nav-number">13.2.0.3.</span> <span class="nav-text">å†…éƒ¨è°ƒä¼˜</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¤–éƒ¨è°ƒä¼˜"><span class="nav-number">13.2.0.4.</span> <span class="nav-text">å¤–éƒ¨è°ƒä¼˜</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½¿ç”¨å·¥å…·java-visual-vm"><span class="nav-number">13.2.0.5.</span> <span class="nav-text">ä½¿ç”¨å·¥å…·java visual vm</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ä½¿ç”¨å·¥å…·java-console"><span class="nav-number">13.2.0.6.</span> <span class="nav-text">ä½¿ç”¨å·¥å…·java console</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å°†Servletå®¹å™¨ä»Tomcatå˜æˆUndertow"><span class="nav-number">13.3.</span> <span class="nav-text">å°†Servletå®¹å™¨ä»Tomcatå˜æˆUndertow</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-18"><span class="nav-number">13.3.1.</span> <span class="nav-text">POM</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tomcat-ä¼˜åŒ–"><span class="nav-number">13.4.</span> <span class="nav-text">Tomcat ä¼˜åŒ–</span></a></li></ol><li class="nav-item nav-level-2"><a class="nav-link" href="#çƒ­éƒ¨ç½²"><span class="nav-number">14.</span> <span class="nav-text">çƒ­éƒ¨ç½²</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#åŸç†"><span class="nav-number">14.1.</span> <span class="nav-text">åŸç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åº”ç”¨åœºæ™¯"><span class="nav-number">14.2.</span> <span class="nav-text">åº”ç”¨åœºæ™¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dev-tools"><span class="nav-number">14.3.</span> <span class="nav-text">Dev-tools</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#POM-19"><span class="nav-number">14.3.1.</span> <span class="nav-text">POM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸç†-1"><span class="nav-number">14.3.2.</span> <span class="nav-text">åŸç†</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‘å¸ƒæ‰“åŒ…"><span class="nav-number">15.</span> <span class="nav-text">å‘å¸ƒæ‰“åŒ…</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Jarç±»å‹æ‰“åŒ…æ–¹å¼"><span class="nav-number">15.1.</span> <span class="nav-text">Jarç±»å‹æ‰“åŒ…æ–¹å¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#warç±»å‹æ‰“åŒ…æ–¹å¼"><span class="nav-number">15.2.</span> <span class="nav-text">warç±»å‹æ‰“åŒ…æ–¹å¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¤–éƒ¨Tomcatè¿è¡Œ"><span class="nav-number">15.3.</span> <span class="nav-text">å¤–éƒ¨Tomcatè¿è¡Œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#POM-20"><span class="nav-number">15.4.</span> <span class="nav-text">POM</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‚è€ƒæ–‡çŒ®"><span class="nav-number">16.</span> <span class="nav-text">å‚è€ƒæ–‡çŒ®</span></a></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

      
            <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
            <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
            <div class="widget-wrap">
            <h3 class="widget-title">Tag Cloud</h3>
            <div id="myCanvasContainer" class="widget tagcloud">
                <canvas width="250" height="250" id="resCanvas" style="width=100%">
                    <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/">Spring</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows10/">Windows10</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/">k8s</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å†›äº‹/">å†›äº‹</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/åˆ†äº«/">åˆ†äº«</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/åˆ/">åˆ</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/åæ§½/">åæ§½</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å­¦å¥½åˆ†å¸ƒå¼æ¶æ„/">å­¦å¥½åˆ†å¸ƒå¼æ¶æ„</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/å¹¶å‘/">å¹¶å‘</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æŠ€æœ¯/">æŠ€æœ¯</a><span class="tag-list-count">27</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ“ä½œç³»ç»Ÿ/">æ“ä½œç³»ç»Ÿ</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ•°æ®ç»“æ„ä¸ç®—æ³•/">æ•°æ®ç»“æ„ä¸ç®—æ³•</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ—¥å¸¸/">æ—¥å¸¸</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æ¶æ„/">æ¶æ„</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æµ‹è¯•/">æµ‹è¯•</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/æºç /">æºç </a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç”Ÿæ´»/">ç”Ÿæ´»</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç¡¬ä»¶/">ç¡¬ä»¶</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/çªé—¨/">çªé—¨</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ç½‘ç»œ/">ç½‘ç»œ</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/è®¾è®¡æ¨¡å¼/">è®¾è®¡æ¨¡å¼</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/è½¯ä»¶åˆ†äº«/">è½¯ä»¶åˆ†äº«</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/è½¯ä»¶æ•™å­¦/">è½¯ä»¶æ•™å­¦</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/é”™é¢˜/">é”™é¢˜</a><span class="tag-list-count">1</span></li></ul>
                </canvas>
            </div>
            </div>
      

      
            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <script>
            (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-7659349864173199",
            enable_page_level_ads: true
            });
            </script>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">tEngSHe789</span>

  
</div>


  <!-- <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div> -->







<span id="timeDate">è½½å…¥å¤©æ•°...</span><span id="times">è½½å…¥æ—¶åˆ†ç§’...</span>
<script>
    var now = new Date(); 
    function createtime() { 
        var grt= new Date("01/1/2018 0:00:00");//æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´ 
        now.setTime(now.getTime()+250); 
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
        document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ "+dnum+" å¤© "; 
        document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’"; 
    } 
setInterval("createtime()",250);
</script>

        







        
      </div>
    </footer>

    

    
      <div id="needsharebutton-float">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    

  </div>
  <script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"live2d-widget-model-nipsilon"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"tagMode":true,"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script>
  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  







  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=1.0.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=1.0.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=1.0.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=1.0.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=1.0.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=1.0.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=1.0.0"></script>



  


  

    
      <script id="dsq-count-scr" src="https://.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'https://tengshe789.github.io/2018/08/04/springboot/';
          this.page.identifier = '2018/08/04/springboot/';
          this.page.title = 'è¿™æ˜¯ä¸€ç¯‡ä¼˜é›…çš„Springboot2.0ä½¿ç”¨æ‰‹å†Œ';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  








  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'LNoutjtqdzTwP7Ui74LV5Dw1-gzGzoHsz',
        appKey: 'rO9bQ0F0wlhqulsUoNy80KPb',
        placeholder: 'æ¥è¯´ä¸¤å¥å§~',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("LNoutjtqdzTwP7Ui74LV5Dw1-gzGzoHsz", "rO9bQ0F0wlhqulsUoNy80KPb");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
      flOptions = {};
      
          flOptions.iconStyle = "box";
      
          flOptions.boxForm = "horizontal";
      
          flOptions.position = "middleRight";
      
          flOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-float', flOptions);
    
  </script>

  

  

  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=1.0.0"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=1.0.0"></script>


  

<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"live2d-widget-model-nipsilon"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"tagMode":true,"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/"});</script>
</body>
</html>
<!-- é¡µé¢ç‚¹å‡»å°çº¢å¿ƒ --> 
<script type="text/javascript" src="/js/src/love.js"></script>